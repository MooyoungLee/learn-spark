<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Definitive Draft Chapter 14-16 - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"serverlessDefaultSparkVersion":"2.2.x-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","enableTableHandler":false,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"3.0 beta (Scala 2.11)","packageLabel":"spark-image-20adedc466bac7d0c91242baba4ae70dc8487d6e301359af185601969607d211","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-f43ddf8ad9acfd71338f5a51345f077173d236016ad7e39ffd6f698403acd4ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"3.0 beta (Scala 2.10)","packageLabel":"spark-image-a1d408c36c3e2c79b38783b57b626c7c6847c9639fa15dd22eca009c23b89c6f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":6,"class-node":1,"m4.2xlarge":0.5,"r4.xlarge":1,"m4.4xlarge":0.5,"r4.16xlarge":8,"Standard_DS11":0.5,"p2.8xlarge":16,"m4.10xlarge":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.5,"r4.8xlarge":8,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.5,"p2.16xlarge":24,"i3.8xlarge":12,"i3.16xlarge":24,"Standard_DS12_v2":1,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"i3.2xlarge":3,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":0.5,"c4.8xlarge":4,"i3.xlarge":1.5,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.47","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableNonPollingTableCall":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":180,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"enableElasticDisk":false,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"ea633ce26684806264e7bd2cbb05130eb0f98c4d","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewJobList":false,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"enableEBSVolumesUIByTier":false,"singleSignOnComingSoon":false,"enableNewJobClusterEdit":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2060825016293726,"name":"Definitive Draft Chapter 14-16","language":"python","commands":[{"version":"CommandV1","origId":2060825016293728,"guid":"79d2ed86-8718-413a-be1e-481a3312af8a","subtype":"command","commandType":"auto","position":1.0,"command":"%scala\nimport org.apache.spark.ml.linalg.Vectors\nval denseVec = Vectors.dense(1.0, 2.0, 3.0)\nval size = 3\nval idx = Array(1,2) // locations in vector\nval values = Array(2.0,3.0)\nval sparseVec = Vectors.sparse(size, idx, values)\nsparseVec.toDense\ndenseVec.toSparse\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.linalg.Vectors\ndenseVec: org.apache.spark.ml.linalg.Vector = [1.0,2.0,3.0]\nsize: Int = 3\nidx: Array[Int] = Array(1, 2)\nvalues: Array[Double] = Array(2.0, 3.0)\nsparseVec: org.apache.spark.ml.linalg.Vector = (3,[1,2],[2.0,3.0])\nres0: org.apache.spark.ml.linalg.SparseVector = (3,[0,1,2],[1.0,2.0,3.0])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:11: error: ';' expected but '.' found.\n       from pyspark.ml.linalg import Vectors\n                   ^\n&lt;console&gt;:14: error: illegal start of simple expression\n       idx = [1, 2] # locations in vector\n             ^\n&lt;console&gt;:15: error: illegal start of simple expression\n       values = [2.0, 3.0]\n                ^\n&lt;console&gt;:17: error: ';' expected but '#' found.\n       # sparseVec.toDense() # these two don't work, not sure why\n       ^\n</div>","error":null,"workflows":[],"startTime":1497647130719,"submitTime":1497647130720,"finishTime":1497647131149,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e5b4333d-d109-48d7-95b9-7e0fea7d29b4"},{"version":"CommandV1","origId":2060825016293729,"guid":"16877206-4834-4156-afc8-3fb8bfea272b","subtype":"command","commandType":"auto","position":2.0,"command":"\nfrom pyspark.ml.linalg import Vectors\ndenseVec = Vectors.dense(1.0, 2.0, 3.0)\nsize = 3\nidx = [1, 2] # locations in vector\nvalues = [2.0, 3.0]\nsparseVec = Vectors.sparse(size, idx, values)\n# sparseVec.toDense() # these two don't work, not sure why\n# denseVec.toSparse() # will debug later","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497647138206,"submitTime":1497647138209,"finishTime":1497647138245,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dc308246-d37d-4eee-b205-bf1c996cabeb"},{"version":"CommandV1","origId":2060825016293740,"guid":"7914952d-e65b-4aa2-9a67-c745ee671096","subtype":"command","commandType":"auto","position":2.5,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"190ea03f-3a5d-4226-b027-8b8456c20c18"},{"version":"CommandV1","origId":2060825016293730,"guid":"f90f12af-cf29-45c1-af6c-a0fdf4832966","subtype":"command","commandType":"auto","position":3.0,"command":"%scala\nvar df = spark.read.json(\"/FileStore/tables/ixxwee3q1497648769294/part_r_00000_f5c243b9_a015_4a3b_a4a8_eca00f80f04c-a8b89.json\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df: org.apache.spark.sql.DataFrame = [color: string, lab: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Path does not exist: dbfs:/mnt/defg/simple-ml;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:372)\n\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:360)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:251)\n\tat scala.collection.AbstractTraversable.flatMap(Traversable.scala:105)\n\tat org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:360)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:154)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:148)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:147)\n\tat org.apache.spark.sql.DataFrameReader.json(DataFrameReader.scala:301)\n\tat org.apache.spark.sql.DataFrameReader.json(DataFrameReader.scala:254)</div>","workflows":[],"startTime":1497648847575,"submitTime":1497648847570,"finishTime":1497648847849,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"504a836c-740d-4430-a296-e3308bd69b4c"},{"version":"CommandV1","origId":2060825016293731,"guid":"0688ae7f-994a-451d-a447-e43305f7f0f8","subtype":"command","commandType":"auto","position":4.0,"command":"df = spark.read.json(\"/FileStore/tables/ixxwee3q1497648769294/part_r_00000_f5c243b9_a015_4a3b_a4a8_eca00f80f04c-a8b89.json\")\ndf.orderBy(\"value2\").show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+\n|color| lab|value1|            value2|\n+-----+----+------+------------------+\n|green|good|     1|14.386294994851129|\n|green| bad|    16|14.386294994851129|\n| blue| bad|     8|14.386294994851129|\n| blue| bad|     8|14.386294994851129|\n| blue| bad|    12|14.386294994851129|\n|green| bad|    16|14.386294994851129|\n|green|good|    12|14.386294994851129|\n|  red|good|    35|14.386294994851129|\n|  red|good|    35|14.386294994851129|\n|  red| bad|     2|14.386294994851129|\n|  red| bad|    16|14.386294994851129|\n|  red| bad|    16|14.386294994851129|\n| blue| bad|     8|14.386294994851129|\n|green|good|     1|14.386294994851129|\n|green|good|    12|14.386294994851129|\n| blue| bad|     8|14.386294994851129|\n|  red|good|    35|14.386294994851129|\n| blue| bad|    12|14.386294994851129|\n|  red| bad|    16|14.386294994851129|\n|green|good|    12|14.386294994851129|\n+-----+----+------+------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/simple-ml;&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-2-fec8a7d47b7c&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>df <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>json<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;/mnt/defg/simple-ml&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> df<span class=\"ansiyellow\">.</span>orderBy<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;value2&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/readwriter.pyc</span> in <span class=\"ansicyan\">json</span><span class=\"ansiblue\">(self, path, schema, primitivesAsString, prefersDecimal, allowComments, allowUnquotedFieldNames, allowSingleQuotes, allowNumericLeadingZero, allowBackslashEscapingAnyCharacter, mode, columnNameOfCorruptRecord, dateFormat, timestampFormat)</span>\n<span class=\"ansigreen\">    230</span>             path <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">[</span>path<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    231</span>         <span class=\"ansigreen\">if</span> type<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">==</span> list<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 232</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_df<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jreader<span class=\"ansiyellow\">.</span>json<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_spark<span class=\"ansiyellow\">.</span>_sc<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>PythonUtils<span class=\"ansiyellow\">.</span>toSeq<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    233</span>         <span class=\"ansigreen\">elif</span> isinstance<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">,</span> RDD<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    234</span>             <span class=\"ansigreen\">def</span> func<span class=\"ansiyellow\">(</span>iterator<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/simple-ml;&apos;</div>","workflows":[],"startTime":1497648849545,"submitTime":1497648849539,"finishTime":1497648849867,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a1e8c35c-b9b6-4029-a078-6b41381c82d4"},{"version":"CommandV1","origId":2060825016293736,"guid":"d6957e2f-5510-4023-8daa-9261adb84781","subtype":"command","commandType":"auto","position":4.5,"command":"%sh cd ..\ncd ..\ncd dbfs/FileStore/tables/t4wp8ci61497648354438\nls","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">sample_libsvm_data.txt\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648533189,"submitTime":1497648533189,"finishTime":1497648533612,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"84895ce7-00e7-483f-a4c7-9b0b02a4e489"},{"version":"CommandV1","origId":2060825016293732,"guid":"4be78348-a7c5-4048-897b-c1ebf6be1e6b","subtype":"command","commandType":"auto","position":5.0,"command":"%scala\nval libsvmData = spark.read.format(\"libsvm\")\n.load(\"FileStore/tables/t4wp8ci61497648354438/sample_libsvm_data.txt\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">libsvmData: org.apache.spark.sql.DataFrame = [label: double, features: vector]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Path does not exist: dbfs:/mnt/defg/sample_libsvm_data.txt;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:372)\n\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:360)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:251)\n\tat scala.collection.AbstractTraversable.flatMap(Traversable.scala:105)\n\tat org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:360)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:154)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:148)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:147)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:136)</div>","workflows":[],"startTime":1497648548700,"submitTime":1497648548699,"finishTime":1497648548979,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d1dc4e5c-6199-4c08-96e3-4de2f4eada10"},{"version":"CommandV1","origId":2060825016293733,"guid":"3e2ce83a-9204-41c6-940a-9e08aaf8e43a","subtype":"command","commandType":"auto","position":6.0,"command":"libsvmData = spark.read.format(\"libsvm\")\\\n.load(\"FileStore/tables/t4wp8ci61497648354438/sample_libsvm_data.txt\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/sample_libsvm_data.txt;&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-3-d192c67aeb26&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>libsvmData <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;libsvm&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;/mnt/defg/sample_libsvm_data.txt&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/readwriter.pyc</span> in <span class=\"ansicyan\">load</span><span class=\"ansiblue\">(self, path, format, schema, **options)</span>\n<span class=\"ansigreen\">    147</span>         self<span class=\"ansiyellow\">.</span>options<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">**</span>options<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    148</span>         <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">,</span> basestring<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 149</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_df<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jreader<span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    150</span>         <span class=\"ansigreen\">elif</span> path <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    151</span>             <span class=\"ansigreen\">if</span> type<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">!=</span> list<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/sample_libsvm_data.txt;&apos;</div>","workflows":[],"startTime":1497648557290,"submitTime":1497648557289,"finishTime":1497648557814,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8fba1dc5-cbaa-4e5a-84ca-59bca2cf5d28"},{"version":"CommandV1","origId":2060825016293735,"guid":"e35281fe-8574-4693-9a8f-397887e84808","subtype":"command","commandType":"auto","position":6.5,"command":"%scala\nimport org.apache.spark.ml.feature.RFormula\nval supervised = new RFormula()\n.setFormula(\"lab ~ . + color:value1 + color:value2\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.feature.RFormula\nsupervised: org.apache.spark.ml.feature.RFormula = RFormula(lab ~ . + color:value1 + color:value2) (uid=rFormula_a65873c8fb32)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648596925,"submitTime":1497648596921,"finishTime":1497648597029,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dc62fe14-d37e-4bc3-b350-a0c9fd5cfff4"},{"version":"CommandV1","origId":2060825016293734,"guid":"75ceada2-8c17-4afe-994d-0b291d676127","subtype":"command","commandType":"auto","position":7.0,"command":"from pyspark.ml.feature import RFormula\nsupervised = RFormula()\\\n.setFormula(\"lab ~ . + color:value1 + color:value2\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648604596,"submitTime":1497648604595,"finishTime":1497648604634,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"87efede7-781b-431b-9f75-b403cf5cbf5c"},{"version":"CommandV1","origId":2060825016293737,"guid":"b2e8e502-33af-429a-baa2-1961885feafa","subtype":"command","commandType":"auto","position":8.0,"command":"%scala\nval fittedRF = supervised.fit(df)\nval preparedDF = fittedRF.transform(df)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">fittedRF: org.apache.spark.ml.feature.RFormulaModel = RFormulaModel(ResolvedRFormula(label=lab, terms=[color,value1,value2,{color,value1},{color,value2}], hasIntercept=true)) (uid=rFormula_a65873c8fb32)\npreparedDF: org.apache.spark.sql.DataFrame = [color: string, lab: string ... 4 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:39: error: type mismatch;\n found   : org.apache.spark.ml.feature.RFormula\n required: org.apache.spark.sql.Dataset[_]\n       val fittedRF = supervised.fit(supervised)\n                                     ^\n</div>","error":null,"workflows":[],"startTime":1497648859972,"submitTime":1497648859971,"finishTime":1497648860683,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"15b0947b-5f6f-4acb-8746-5ff53b19dda9"},{"version":"CommandV1","origId":2060825016293738,"guid":"b8db1dfc-c160-44ac-8fff-5a48c5926e31","subtype":"command","commandType":"auto","position":9.0,"command":"fittedRF = supervised.fit(df)\npreparedDF = fittedRF.transform(df)\npreparedDF.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------------------+-----+\n|color| lab|value1|            value2|            features|label|\n+-----+----+------+------------------+--------------------+-----+\n|green|good|     1|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n| blue| bad|     8|14.386294994851129|(10,[2,3,6,9],[8....|  0.0|\n| blue| bad|    12|14.386294994851129|(10,[2,3,6,9],[12...|  0.0|\n|green|good|    15| 38.97187133755819|(10,[1,2,3,5,8],[...|  1.0|\n|green|good|    12|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n|green| bad|    16|14.386294994851129|(10,[1,2,3,5,8],[...|  0.0|\n|  red|good|    35|14.386294994851129|(10,[0,2,3,4,7],[...|  1.0|\n|  red| bad|     1| 38.97187133755819|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|     2|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|    16|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n|  red|good|    45| 38.97187133755819|(10,[0,2,3,4,7],[...|  1.0|\n|green|good|     1|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n| blue| bad|     8|14.386294994851129|(10,[2,3,6,9],[8....|  0.0|\n| blue| bad|    12|14.386294994851129|(10,[2,3,6,9],[12...|  0.0|\n|green|good|    15| 38.97187133755819|(10,[1,2,3,5,8],[...|  1.0|\n|green|good|    12|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n|green| bad|    16|14.386294994851129|(10,[1,2,3,5,8],[...|  0.0|\n|  red|good|    35|14.386294994851129|(10,[0,2,3,4,7],[...|  1.0|\n|  red| bad|     1| 38.97187133755819|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|     2|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n+-----+----+------+------------------+--------------------+-----+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;RFormula&apos; object has no attribute &apos;_jdf&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-16-3e999579bb8b&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>fittedRF <span class=\"ansiyellow\">=</span> supervised<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>supervised<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> preparedDF <span class=\"ansiyellow\">=</span> fittedRF<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>supervised<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> preparedDF<span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/base.pyc</span> in <span class=\"ansicyan\">fit</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     62</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     63</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 64</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     66</span>             raise ValueError(&quot;Params must be either a param map or a list/tuple of param maps, &quot;\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/wrapper.pyc</span> in <span class=\"ansicyan\">_fit</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    234</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    235</span>     <span class=\"ansigreen\">def</span> _fit<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 236</span><span class=\"ansiyellow\">         </span>java_model <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_fit_java<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    237</span>         <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_create_model<span class=\"ansiyellow\">(</span>java_model<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    238</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/wrapper.pyc</span> in <span class=\"ansicyan\">_fit_java</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    231</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    232</span>         self<span class=\"ansiyellow\">.</span>_transfer_params_to_java<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 233</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    234</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    235</span>     <span class=\"ansigreen\">def</span> _fit<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;RFormula&apos; object has no attribute &apos;_jdf&apos;</div>","workflows":[],"startTime":1497648862746,"submitTime":1497648862744,"finishTime":1497648863373,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b5722269-9b49-4fd5-bd0f-3bb05201dcde"},{"version":"CommandV1","origId":2060825016293739,"guid":"12504f28-5516-415b-a0f7-eff91530c533","subtype":"command","commandType":"auto","position":10.0,"command":"%scala\nval Array(train, test) = preparedDF.randomSplit(Array(0.7, 0.3))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">train: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [color: string, lab: string ... 4 more fields]\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [color: string, lab: string ... 4 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648879620,"submitTime":1497648879618,"finishTime":1497648879896,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"128f28f1-e330-46f3-bbbf-e4ddd2c30958"},{"version":"CommandV1","origId":2060825016293741,"guid":"a76764e8-a72b-48e5-9453-558746e08e03","subtype":"command","commandType":"auto","position":11.0,"command":"train, test = preparedDF.randomSplit([0.7, 0.3])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648887077,"submitTime":1497648887040,"finishTime":1497648887148,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7b187ffd-2223-483c-a90a-d95847c07ada"},{"version":"CommandV1","origId":2060825016293742,"guid":"a96625c0-7a7e-492f-be8f-7942b6c34575","subtype":"command","commandType":"auto","position":12.0,"command":"%scala\nimport org.apache.spark.ml.classification.LogisticRegression\nval lr = new LogisticRegression()\n.setLabelCol(\"label\")\n.setFeaturesCol(\"features\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.classification.LogisticRegression\nlr: org.apache.spark.ml.classification.LogisticRegression = logreg_7b803ea87a8f\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648894857,"submitTime":1497648894852,"finishTime":1497648895004,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"48ba7079-f3df-4f4e-919d-b9498d8b2e32"},{"version":"CommandV1","origId":2060825016293743,"guid":"643b5390-a469-4c32-ac68-90abab4c0b33","subtype":"command","commandType":"auto","position":13.0,"command":"from pyspark.ml.classification import LogisticRegression\nlr = LogisticRegression()\\\n.setLabelCol(\"label\")\\\n.setFeaturesCol(\"features\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648900940,"submitTime":1497648900935,"finishTime":1497648900980,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7336699c-0d48-4d0e-934a-cb03afa779ff"},{"version":"CommandV1","origId":2060825016293744,"guid":"38cb33d5-46df-410b-98e0-35bd4f8ff4c9","subtype":"command","commandType":"auto","position":14.0,"command":"%scala\nval fittedLR = lr.fit(train)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">fittedLR: org.apache.spark.ml.classification.LogisticRegressionModel = logreg_7b803ea87a8f\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648908618,"submitTime":1497648908613,"finishTime":1497648910678,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"81fde48b-c8df-4ff0-9e88-30eb21648517"},{"version":"CommandV1","origId":2060825016293745,"guid":"b7409858-151e-47b4-9690-8cba11048551","subtype":"command","commandType":"auto","position":15.0,"command":"fittedLR = lr.fit(train)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648916801,"submitTime":1497648916795,"finishTime":1497648917909,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"07670bae-caa3-48e2-a0b3-a4307d5ca905"},{"version":"CommandV1","origId":2060825016293746,"guid":"f9953fb8-b220-4e5d-80ce-afaf9b8074a4","subtype":"command","commandType":"auto","position":16.0,"command":"fittedLR.transform(train).select(\"label\", \"prediction\").show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----------+\n|label|prediction|\n+-----+----------+\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  0.0|       0.0|\n|  1.0|       1.0|\n|  1.0|       1.0|\n|  1.0|       1.0|\n|  1.0|       1.0|\n+-----+----------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648924431,"submitTime":1497648924425,"finishTime":1497648924803,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6786dd4c-7222-4984-87dc-49ffcfccb9ff"},{"version":"CommandV1","origId":2060825016293747,"guid":"77fe249e-5f2f-47d8-82bb-f66e72a7edf5","subtype":"command","commandType":"auto","position":17.0,"command":"%scala\nval Array(train, test) = df.randomSplit(Array(0.7, 0.3))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">train: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [color: string, lab: string ... 2 more fields]\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [color: string, lab: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648936380,"submitTime":1497648936372,"finishTime":1497648936510,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"583c4950-3515-4a0a-80ef-a28424f61cf8"},{"version":"CommandV1","origId":2060825016293748,"guid":"7d7bd5fe-1eca-4006-801f-f9e295da1989","subtype":"command","commandType":"auto","position":18.0,"command":"train, test = df.randomSplit([0.7, 0.3])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648943230,"submitTime":1497648943223,"finishTime":1497648943300,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6b18e5f3-7e2a-49e4-b138-1ae684885e76"},{"version":"CommandV1","origId":2060825016293749,"guid":"50bfbc4c-6588-4cea-9e1c-f9e0ef76aab6","subtype":"command","commandType":"auto","position":19.0,"command":"%scala\nval rForm = new RFormula()\nval lr = new LogisticRegression()\n.setLabelCol(\"label\")\n.setFeaturesCol(\"features\")\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">rForm: org.apache.spark.ml.feature.RFormula = RFormula() (uid=rFormula_bdb3b9c3ccdb)\nlr: org.apache.spark.ml.classification.LogisticRegression = logreg_349367e74d7e\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:44: error: reassignment to val\n       rForm = RFormula()\n             ^\n</div>","error":null,"workflows":[],"startTime":1497648975633,"submitTime":1497648975631,"finishTime":1497648975720,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a50314c2-ba83-4d61-b83d-8e03e2bf826d"},{"version":"CommandV1","origId":2060825016293750,"guid":"94340474-68db-4a94-b18d-e60a1e8ccf82","subtype":"command","commandType":"auto","position":20.0,"command":"rForm = RFormula()\n\nlr = LogisticRegression()\\\n.setLabelCol(\"label\")\\\n.setFeaturesCol(\"features\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648978054,"submitTime":1497648978047,"finishTime":1497648978124,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b7bf2d3e-87a2-4571-86b6-c3f27e61242a"},{"version":"CommandV1","origId":2060825016293751,"guid":"509cc3a6-7264-493e-ad45-8a061319cc4a","subtype":"command","commandType":"auto","position":21.0,"command":"%scala\nimport org.apache.spark.ml.Pipeline\nval stages = Array(rForm, lr)\nval pipeline = new Pipeline().setStages(stages)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.Pipeline\nstages: Array[org.apache.spark.ml.Estimator[_ &gt;: org.apache.spark.ml.classification.LogisticRegressionModel with org.apache.spark.ml.feature.RFormulaModel &lt;: org.apache.spark.ml.Model[_ &gt;: org.apache.spark.ml.classification.LogisticRegressionModel with org.apache.spark.ml.feature.RFormulaModel &lt;: org.apache.spark.ml.Transformer with org.apache.spark.ml.param.shared.HasLabelCol with org.apache.spark.ml.param.shared.HasFeaturesCol with org.apache.spark.ml.util.MLWritable] with org.apache.spark.ml.param.shared.HasLabelCol with org.apache.spark.ml.param.shared.HasFeaturesCol with org.apache.spark.ml.util.MLWritable] with org.apache.spark.ml.param.shared.HasLabelCol with org.apache.spark.ml.param.shared.HasFeaturesCol with org.apache.spark.ml.util.DefaultParamsWritable{def copy(extra: org.apache.spark.ml.param.ParamMap): org.apache.spark.ml.Estimator[_ &gt;: org.apache.spark.ml.classification.LogisticRegressionModel with org.apache.spark.ml.feature.RFormulaModel &lt;: org.apache.spark.ml.Transformer with org.apache.spark.ml.param.shared.HasLabelCol with org.apache.spark.ml.param.shared.HasFeaturesCol with org.apache.spark.ml.util.MLWritable] with org.apache.spark.ml.param.shared.HasLabelCol with org.apache.spark.ml.param.shared.HasFeaturesCol with org.apache.spark.ml.util.DefaultParamsWritable{def copy(extra: org.apache.spark.ml.param.ParamMap): org.apache.spark.ml.PipelineStage with org.apache.spark.ml.param.shared.HasLabelCol with org.apache.spark.ml.param.shared.HasFeaturesCol with org.apache.spark.ml.util.DefaultParamsWritable}}] = Array(RFormula() (uid=rFormula_bdb3b9c3ccdb), logreg_349367e74d7e)\npipeline: org.apache.spark.ml.Pipeline = pipeline_149c0481ecc9\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497648989191,"submitTime":1497648989190,"finishTime":1497648989382,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"44883196-d371-4d42-b1bc-3a88938cb8cf"},{"version":"CommandV1","origId":2060825016293752,"guid":"434d378d-11ad-46b3-b676-d2ac2ec6c52a","subtype":"command","commandType":"auto","position":22.0,"command":"from pyspark.ml import Pipeline\nstages = [rForm, lr]\npipeline = Pipeline().setStages(stages)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649003169,"submitTime":1497649003159,"finishTime":1497649003239,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c2291a91-23f4-4be4-bf23-96301bf9568b"},{"version":"CommandV1","origId":2060825016293753,"guid":"152f1328-5af1-4374-b76d-4d37b00c08ae","subtype":"command","commandType":"auto","position":23.0,"command":"%scala\nimport org.apache.spark.ml.tuning.ParamGridBuilder\nval params = new ParamGridBuilder()\n.addGrid(rForm.formula, Array(\n\"lab ~ . + color:value1\",\n\"lab ~ . + color:value1 + color:value2\"))\n.addGrid(lr.elasticNetParam, Array(0.0, 0.5, 1.0))\n.addGrid(lr.regParam, Array(0.1, 2.0))\n.build()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.tuning.ParamGridBuilder\nparams: Array[org.apache.spark.ml.param.ParamMap] = \nArray({\n\tlogreg_349367e74d7e-elasticNetParam: 0.0,\n\trFormula_bdb3b9c3ccdb-formula: lab ~ . + color:value1,\n\tlogreg_349367e74d7e-regParam: 0.1\n}, {\n\tlogreg_349367e74d7e-elasticNetParam: 0.0,\n\trFormula_bdb3b9c3ccdb-formula: lab ~ . + color:value1 + color:value2,\n\tlogreg_349367e74d7e-regParam: 0.1\n}, {\n\tlogreg_349367e74d7e-elasticNetParam: 0.5,\n\trFormula_bdb3b9c3ccdb-formula: lab ~ . + color:value1,\n\tlogreg_349367e74d7e-regParam: 0.1\n}, {\n\tlogreg_349367e74d7e-elasticNetParam: 0.5,\n\trFormula_bdb3b9c3ccdb-formula: lab ~ . + color:value1 + color:value2,\n\tlogreg_349367e74d7e-regParam: 0.1\n}, {\n\tlogreg_349367e74d7e-elasticNetParam: 1.0,\n\trFormula_bdb3b9c3ccdb-formula: lab ~ . + color:value1,\n\tlogreg_349367e74d7e-regParam: 0.1\n}, {\n\tlogreg_349367e74d7e-elasticNetParam: 1.0,\n\trFormula_bdb3b9c3ccdb-formula: lab ~ . + color:value1 + color:value2,\n\tlogreg_349367e74d7e-regParam: 0.1\n}, {\n\tlogreg_349367e74d7e-elasticNetParam: 0.0,\n\trFormula_bdb3b9c3ccdb-formula: lab ~ . + color:value1,\n\tlogreg_349367e74d7e-regParam: 2.0\n}, {\n\tlogreg_349367e74d7e-elasticNetParam: 0.0,\n\trFormula_bdb3b9c3ccdb-formula: lab ~ . + color:value1 + color:value2,\n\tlogreg_349367e74d7e-regParam: 2.0\n}, {\n\tlogreg_349367e74d7e-elasticNetParam: 0.5,\n\trFormula_bdb3b9c3ccdb-formula: lab ~ . + color:value1,\n\tlogreg_349367e74d7e-regParam: 2.0\n}, {\n\tlogreg_349367e74d7e-elasticNetParam: 0.5,\n\trFormula_bdb3b9c3ccdb-formula: lab ~ . + color:value1 + color:value2,\n\tlogreg_349367e74d7e-regParam: 2.0\n}, {\n\tlogreg_349367e74d7e-elasticNetParam: 1.0,\n\trFormula_bdb3b9c3ccdb-formula: lab ~ . + color:value1,\n\tlogreg_349367e74d7e-regParam: 2.0\n}, {\n\tlogreg_349367e74d7e-elasticNetParam: 1.0,\n\trFormula_bdb3b9c3ccdb-formula: lab ~ . + color:value1 + color:value2,\n\tlogreg_349367e74d7e-regParam: 2.0\n})\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649011199,"submitTime":1497649011192,"finishTime":1497649011340,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4a66d117-7ba6-4211-b054-b32eec1ef017"},{"version":"CommandV1","origId":2060825016293754,"guid":"f1b67031-d546-412d-b689-85b0896bb2d1","subtype":"command","commandType":"auto","position":24.0,"command":"from pyspark.ml.tuning import ParamGridBuilder\nparams = ParamGridBuilder()\\\n.addGrid(rForm.formula, [\n\"lab ~ . + color:value1\",\n\"lab ~ . + color:value1 + color:value2\"])\\\n.addGrid(lr.elasticNetParam, [0.0, 0.5, 1.0])\\\n.addGrid(lr.regParam, [0.1, 2.0])\\\n.build()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649025296,"submitTime":1497649025289,"finishTime":1497649025366,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c4c25308-43ee-45ec-800d-208b88a59546"},{"version":"CommandV1","origId":2060825016293755,"guid":"3f0443fb-f92c-40f7-8854-bf35e80caa0d","subtype":"command","commandType":"auto","position":25.0,"command":"%scala\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\nval evaluator = new BinaryClassificationEvaluator()\n.setMetricName(\"areaUnderROC\")\n.setRawPredictionCol(\"prediction\")\n.setLabelCol(\"label\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\nevaluator: org.apache.spark.ml.evaluation.BinaryClassificationEvaluator = binEval_12ab7c6a83e7\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649034886,"submitTime":1497649034878,"finishTime":1497649034970,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0efcabf7-8872-4006-9e81-0d59e39a8fc6"},{"version":"CommandV1","origId":2060825016293756,"guid":"5abe6073-6f63-42a1-8817-88fd1d495057","subtype":"command","commandType":"auto","position":26.0,"command":"from pyspark.ml.evaluation import BinaryClassificationEvaluator\nevaluator = BinaryClassificationEvaluator()\\\n.setMetricName(\"areaUnderROC\")\\\n.setRawPredictionCol(\"prediction\")\\\n.setLabelCol(\"label\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649041675,"submitTime":1497649041667,"finishTime":1497649041713,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0a63e4f5-2eef-4d4d-98e3-0029f7091639"},{"version":"CommandV1","origId":2060825016293757,"guid":"602ab8fd-d807-4d3f-a9bb-988eefbfc92a","subtype":"command","commandType":"auto","position":27.0,"command":"%scala\nimport org.apache.spark.ml.tuning.TrainValidationSplit\nval tvs = new TrainValidationSplit()\n.setTrainRatio(0.75) // also the default.\n.setEstimatorParamMaps(params)\n.setEstimator(pipeline)\n.setEvaluator(evaluator)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.tuning.TrainValidationSplit\ntvs: org.apache.spark.ml.tuning.TrainValidationSplit = tvs_c6545278fe15\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649048762,"submitTime":1497649048761,"finishTime":1497649048863,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"eb1ab3d1-7c8d-473c-8398-c0b0a59ff333"},{"version":"CommandV1","origId":2060825016293758,"guid":"d140eb66-fb6b-4937-a218-459fd9b85fad","subtype":"command","commandType":"auto","position":28.0,"command":"from pyspark.ml.tuning import TrainValidationSplit\ntvs = TrainValidationSplit()\\\n.setTrainRatio(0.75)\\\n.setEstimatorParamMaps(params)\\\n.setEstimator(pipeline)\\\n.setEvaluator(evaluator)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649056153,"submitTime":1497649056146,"finishTime":1497649056175,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9f8204ea-1b47-4567-853d-fc7bee4bd3f3"},{"version":"CommandV1","origId":2060825016293759,"guid":"52ba741b-6048-4974-a371-56881624165c","subtype":"command","commandType":"auto","position":29.0,"command":"%scala\nval tvsFitted = tvs.fit(train)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">tvsFitted: org.apache.spark.ml.tuning.TrainValidationSplitModel = tvs_c6545278fe15\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649072794,"submitTime":1497649072786,"finishTime":1497649095449,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cde9deab-800a-4814-8417-c0dc6c710216"},{"version":"CommandV1","origId":2060825016293760,"guid":"5ed0ab68-26d6-44b8-ba5d-5b523847d75a","subtype":"command","commandType":"auto","position":30.0,"command":"tvsFitted = tvs.fit(train)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649095453,"submitTime":1497649080421,"finishTime":1497649113884,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8acf5795-65f8-49be-92dc-0f69c48a8ca2"},{"version":"CommandV1","origId":2060825016293761,"guid":"a9e174b3-e800-4112-9417-51d77a1d34be","subtype":"command","commandType":"auto","position":31.0,"command":"evaluator.evaluate(tvsFitted.transform(test))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">31</span><span class=\"ansired\">]: </span>0.9523809523809523\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649113889,"submitTime":1497649088374,"finishTime":1497649114159,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c0006c34-44b6-4b1a-ab05-ba5f3a1697dd"},{"version":"CommandV1","origId":2060825016293762,"guid":"2cd3fa2e-3484-4ef0-8b1f-122f43fcb89d","subtype":"command","commandType":"auto","position":32.0,"command":"%scala\nimport org.apache.spark.ml.PipelineModel\nimport org.apache.spark.ml.classification.LogisticRegressionModel\nval trainedPipeline = tvsFitted.bestModel.asInstanceOf[PipelineModel]\nval TrainedLR = trainedPipeline.stages(1)\n.asInstanceOf[LogisticRegressionModel]\nval summaryLR = TrainedLR.summary\nsummaryLR.objectiveHistory","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.PipelineModel\nimport org.apache.spark.ml.classification.LogisticRegressionModel\ntrainedPipeline: org.apache.spark.ml.PipelineModel = pipeline_149c0481ecc9\nTrainedLR: org.apache.spark.ml.classification.LogisticRegressionModel = logreg_349367e74d7e\nsummaryLR: org.apache.spark.ml.classification.LogisticRegressionTrainingSummary = org.apache.spark.ml.classification.BinaryLogisticRegressionTrainingSummary@5d89a213\nres1: Array[Double] = Array(0.6930628469360363, 0.664887856377262, 0.5081106980022528, 0.4802975082460226, 0.4711209789992499, 0.4581682135626124, 0.45205175445755, 0.4490985730741287, 0.4461948054300391, 0.4423709199422215, 0.44027275447832337, 0.44004383081858905, 0.44003796370247455, 0.44003620500775936, 0.440036178370071, 0.44003617786390403, 0.4400361776069226, 0.4400361776063507)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649114163,"submitTime":1497649105950,"finishTime":1497649114255,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a39e9f95-c768-462d-adb9-39383a05686b"},{"version":"CommandV1","origId":2060825016293763,"guid":"f25433bd-8b06-41ce-bfd7-868a223de19b","subtype":"command","commandType":"auto","position":33.0,"command":"%scala\ntvsFitted.write.overwrite().save(\"/tmp/modelLocation\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;TrainValidationSplitModel&apos; object has no attribute &apos;write&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-32-8f6b2ed5ef31&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>tvsFitted<span class=\"ansiyellow\">.</span>write<span class=\"ansiyellow\">.</span>overwrite<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>save<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;/tmp/modelLocation&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;TrainValidationSplitModel&apos; object has no attribute &apos;write&apos;</div>","workflows":[],"startTime":1497649127597,"submitTime":1497649127587,"finishTime":1497649152595,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cc96ccb2-9f52-4bc1-a493-20be28e89e63"},{"version":"CommandV1","origId":2060825016293764,"guid":"f5091570-8b7b-484b-acaf-e8893cb90e98","subtype":"command","commandType":"auto","position":34.0,"command":"%scala\nimport org.apache.spark.ml.tuning.TrainValidationSplitModel\nval model = TrainValidationSplitModel.load(\"/tmp/modelLocation\")\nmodel.transform(test)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.tuning.TrainValidationSplitModel\nmodel: org.apache.spark.ml.tuning.TrainValidationSplitModel = tvs_c6545278fe15\nres3: org.apache.spark.sql.DataFrame = [color: string, lab: string ... 7 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649152599,"submitTime":1497649137108,"finishTime":1497649161689,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3ffc3f49-4c3a-4d3b-ae32-f93e9ef547b5"},{"version":"CommandV1","origId":2060825016293765,"guid":"b8d38703-8b5b-44fe-9c1a-e5f12e122cd5","subtype":"command","commandType":"auto","position":35.0,"command":"%scala\nval sales = spark.read.format(\"csv\")\n.option(\"header\", \"true\")\n.option(\"inferSchema\", \"true\")\n.load(\"/FileStore/tables/1x42p66f1497639007910/*.csv\")\n.coalesce(5)\n.where(\"Description IS NOT NULL\")\nval fakeIntDF = spark.read.parquet(\"/FileStore/tables/w90rmm721497649161288/part_00000_ce2a44c8_feb4_4369_a2c3_4bf2f0e63b07_c000_gz-d65b9.parquet\")\nvar simpleDF = spark.read.json(\"/FileStore/tables/ixxwee3q1497648769294/part_r_00000_f5c243b9_a015_4a3b_a4a8_eca00f80f04c-a8b89.json\")\nval scaleDF = spark.read.parquet(\"/FileStore/tables/48se0cwp1497649233518/part_00000_cd03406a_cc9b_42b0_9299_1e259fdd9382_c000_gz-2e0be.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">sales: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [InvoiceNo: string, StockCode: string ... 6 more fields]\nfakeIntDF: org.apache.spark.sql.DataFrame = [int1: int, int2: int ... 1 more field]\nsimpleDF: org.apache.spark.sql.DataFrame = [color: string, lab: string ... 2 more fields]\nscaleDF: org.apache.spark.sql.DataFrame = [id: int, features: vector]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Path does not exist: dbfs:/mnt/defg/retail-data/by-day/*.csv;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:367)\n\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:360)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:251)\n\tat scala.collection.AbstractTraversable.flatMap(Traversable.scala:105)\n\tat org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:360)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:154)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:148)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:147)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:136)</div>","workflows":[],"startTime":1497649418769,"submitTime":1497649418755,"finishTime":1497649420852,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e1d16bbb-03d6-4c5f-b7d3-9b847e3d4bb2"},{"version":"CommandV1","origId":2060825016293766,"guid":"1d3a4fac-1d3c-4fc1-8275-87e4f5e06aa8","subtype":"command","commandType":"auto","position":36.0,"command":"sales = spark.read.format(\"csv\")\\\n.option(\"header\", \"true\")\\\n.option(\"inferSchema\", \"true\")\\\n.load(\"/FileStore/tables/1x42p66f1497639007910/*.csv\")\\\n.coalesce(5)\\\n.where(\"Description IS NOT NULL\")\nfakeIntDF = spark.read.parquet(\"/FileStore/tables/w90rmm721497649161288/part_00000_ce2a44c8_feb4_4369_a2c3_4bf2f0e63b07_c000_gz-d65b9.parquet\")\nsimpleDF = spark.read.json(\"/FileStore/tables/ixxwee3q1497648769294/part_r_00000_f5c243b9_a015_4a3b_a4a8_eca00f80f04c-a8b89.json\")\nscaleDF = spark.read.parquet(\"/FileStore/tables/48se0cwp1497649233518/part_00000_cd03406a_cc9b_42b0_9299_1e259fdd9382_c000_gz-2e0be.parquet\")\nsales.cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">34</span><span class=\"ansired\">]: </span>DataFrame[InvoiceNo: string, StockCode: string, Description: string, Quantity: int, InvoiceDate: string, UnitPrice: double, CustomerID: int, Country: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/retail-data/by-day/*.csv;&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-33-5034367041f0&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>sales <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;csv&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>option<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;header&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;true&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>option<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;inferSchema&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;true&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;dbfs:/mnt/defg/retail-data/by-day/*.csv&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>coalesce<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">5</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>where<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Description IS NOT NULL&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> fakeIntDF <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>parquet<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;/FileStore/tables/w90rmm721497649161288/part_00000_ce2a44c8_feb4_4369_a2c3_4bf2f0e63b07_c000_gz-d65b9.parquet&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> simpleDF <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>json<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;/FileStore/tables/ixxwee3q1497648769294/part_r_00000_f5c243b9_a015_4a3b_a4a8_eca00f80f04c-a8b89.json&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> scaleDF <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>parquet<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;/FileStore/tables/48se0cwp1497649233518/part_00000_cd03406a_cc9b_42b0_9299_1e259fdd9382_c000_gz-2e0be.parquet&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> sales<span class=\"ansiyellow\">.</span>cache<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/readwriter.pyc</span> in <span class=\"ansicyan\">load</span><span class=\"ansiblue\">(self, path, format, schema, **options)</span>\n<span class=\"ansigreen\">    147</span>         self<span class=\"ansiyellow\">.</span>options<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">**</span>options<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    148</span>         <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">,</span> basestring<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 149</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_df<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jreader<span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    150</span>         <span class=\"ansigreen\">elif</span> path <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    151</span>             <span class=\"ansigreen\">if</span> type<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">!=</span> list<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/retail-data/by-day/*.csv;&apos;</div>","workflows":[],"startTime":1497649420856,"submitTime":1497649419107,"finishTime":1497649423371,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7131c2fd-9282-437c-b34b-3c7b3f72da7f"},{"version":"CommandV1","origId":2060825016293767,"guid":"133f21ec-d3ee-422e-828d-edfec167db4f","subtype":"command","commandType":"auto","position":37.0,"command":"%scala\nimport org.apache.spark.ml.feature.Tokenizer\nval tkn = new Tokenizer().setInputCol(\"Description\")\ntkn.transform(sales).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|tok_616ab949ff09__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|    [white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|    [white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|    [cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|    [knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|    [red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|    [set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|    [glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|    [hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|    [hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|    [assorted, colour...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|    [poppy's, playhou...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|    [poppy's, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|    [feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|    [ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|    [box, of, 6, asso...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|    [box, of, vintage...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|    [box, of, vintage...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|    [home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|    [love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|    [recipe, box, wit...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.Tokenizer\ntkn: org.apache.spark.ml.feature.Tokenizer = tok_616ab949ff09\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649444423,"submitTime":1497649444420,"finishTime":1497649445677,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b991ceb9-d3c1-40c2-a1c1-15cf4ec8085b"},{"version":"CommandV1","origId":2060825016293768,"guid":"6394c1a4-5382-4fc5-97ef-48773d89014b","subtype":"command","commandType":"auto","position":38.0,"command":"%scala\nimport org.apache.spark.ml.feature.StandardScaler\nval ss = new StandardScaler().setInputCol(\"features\")\nss.fit(scaleDF).transform(scaleDF).show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+------------------------------------------------------------+\n|id |features      |stdScal_f9f355bf6cb9__output                                |\n+---+--------------+------------------------------------------------------------+\n|0  |[1.0,0.1,-1.0]|[1.1952286093343936,0.02337622911060922,-0.5976143046671968]|\n|1  |[2.0,1.1,1.0] |[2.390457218668787,0.2571385202167014,0.5976143046671968]   |\n|0  |[1.0,0.1,-1.0]|[1.1952286093343936,0.02337622911060922,-0.5976143046671968]|\n|1  |[2.0,1.1,1.0] |[2.390457218668787,0.2571385202167014,0.5976143046671968]   |\n|1  |[3.0,10.1,3.0]|[3.5856858280031805,2.3609991401715313,1.7928429140015902]  |\n+---+--------------+------------------------------------------------------------+\n\nimport org.apache.spark.ml.feature.StandardScaler\nss: org.apache.spark.ml.feature.StandardScaler = stdScal_f9f355bf6cb9\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649457074,"submitTime":1497649457060,"finishTime":1497649457614,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"215efee6-e8ba-4529-a7ac-cdbdc7e36504"},{"version":"CommandV1","origId":2060825016293769,"guid":"df616919-b375-4487-bb93-5b6233fbf173","subtype":"command","commandType":"auto","position":39.0,"command":"%scala\nimport org.apache.spark.ml.feature.RFormula\nval supervised = new RFormula()\n.setFormula(\"lab ~ . + color:value1 + color:value2\")\nsupervised.fit(simpleDF).transform(simpleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------------------+-----+\n|color| lab|value1|            value2|            features|label|\n+-----+----+------+------------------+--------------------+-----+\n|green|good|     1|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n| blue| bad|     8|14.386294994851129|(10,[2,3,6,9],[8....|  0.0|\n| blue| bad|    12|14.386294994851129|(10,[2,3,6,9],[12...|  0.0|\n|green|good|    15| 38.97187133755819|(10,[1,2,3,5,8],[...|  1.0|\n|green|good|    12|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n|green| bad|    16|14.386294994851129|(10,[1,2,3,5,8],[...|  0.0|\n|  red|good|    35|14.386294994851129|(10,[0,2,3,4,7],[...|  1.0|\n|  red| bad|     1| 38.97187133755819|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|     2|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|    16|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n|  red|good|    45| 38.97187133755819|(10,[0,2,3,4,7],[...|  1.0|\n|green|good|     1|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n| blue| bad|     8|14.386294994851129|(10,[2,3,6,9],[8....|  0.0|\n| blue| bad|    12|14.386294994851129|(10,[2,3,6,9],[12...|  0.0|\n|green|good|    15| 38.97187133755819|(10,[1,2,3,5,8],[...|  1.0|\n|green|good|    12|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n|green| bad|    16|14.386294994851129|(10,[1,2,3,5,8],[...|  0.0|\n|  red|good|    35|14.386294994851129|(10,[0,2,3,4,7],[...|  1.0|\n|  red| bad|     1| 38.97187133755819|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|     2|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n+-----+----+------+------------------+--------------------+-----+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.RFormula\nsupervised: org.apache.spark.ml.feature.RFormula = RFormula(lab ~ . + color:value1 + color:value2) (uid=rFormula_082988adc5cd)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649467396,"submitTime":1497649467382,"finishTime":1497649468484,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"78727fee-e9fb-419f-bbb3-fca6f628e1a6"},{"version":"CommandV1","origId":2060825016293770,"guid":"ba0f6e1d-17d5-4646-a30c-1bcdc1cdaebf","subtype":"command","commandType":"auto","position":40.0,"command":"from pyspark.ml.feature import RFormula\nsupervised = RFormula()\\\n.setFormula(\"lab ~ . + color:value1 + color:value2\")\nsupervised.fit(simpleDF).transform(simpleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------------------+-----+\n|color| lab|value1|            value2|            features|label|\n+-----+----+------+------------------+--------------------+-----+\n|green|good|     1|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n| blue| bad|     8|14.386294994851129|(10,[2,3,6,9],[8....|  0.0|\n| blue| bad|    12|14.386294994851129|(10,[2,3,6,9],[12...|  0.0|\n|green|good|    15| 38.97187133755819|(10,[1,2,3,5,8],[...|  1.0|\n|green|good|    12|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n|green| bad|    16|14.386294994851129|(10,[1,2,3,5,8],[...|  0.0|\n|  red|good|    35|14.386294994851129|(10,[0,2,3,4,7],[...|  1.0|\n|  red| bad|     1| 38.97187133755819|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|     2|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|    16|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n|  red|good|    45| 38.97187133755819|(10,[0,2,3,4,7],[...|  1.0|\n|green|good|     1|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n| blue| bad|     8|14.386294994851129|(10,[2,3,6,9],[8....|  0.0|\n| blue| bad|    12|14.386294994851129|(10,[2,3,6,9],[12...|  0.0|\n|green|good|    15| 38.97187133755819|(10,[1,2,3,5,8],[...|  1.0|\n|green|good|    12|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n|green| bad|    16|14.386294994851129|(10,[1,2,3,5,8],[...|  0.0|\n|  red|good|    35|14.386294994851129|(10,[0,2,3,4,7],[...|  1.0|\n|  red| bad|     1| 38.97187133755819|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|     2|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n+-----+----+------+------------------+--------------------+-----+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649475005,"submitTime":1497649474990,"finishTime":1497649475530,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4e86e1f9-882d-43e5-8734-52243e5ba7a3"},{"version":"CommandV1","origId":2060825016293771,"guid":"710c75b5-b51f-49b9-a53b-3fe11f6c279f","subtype":"command","commandType":"auto","position":41.0,"command":"%scala\nimport org.apache.spark.ml.feature.SQLTransformer\nval basicTransformation = new SQLTransformer()\n.setStatement(\"\"\"\nSELECT sum(Quantity), count(*), CustomerID\nFROM __THIS__\nGROUP BY CustomerID\n\"\"\")\nbasicTransformation.transform(sales).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------+--------+----------+\n|sum(Quantity)|count(1)|CustomerID|\n+-------------+--------+----------+\n|          265|      30|     17420|\n|          133|       8|     16861|\n|          567|      86|     16503|\n|         3065|     302|     15727|\n|         7430|     224|     17389|\n|           85|       9|     15447|\n|          241|      40|     14450|\n|          286|      86|     13623|\n|         2051|     187|     13285|\n|           23|      20|     16339|\n|           95|      29|     14570|\n|          224|      88|     16386|\n|          148|      22|     18024|\n|          406|     103|     12940|\n|          729|      30|     17679|\n|          416|      28|     16574|\n|          211|      42|     15957|\n|           25|       4|     13832|\n|          136|       3|     15619|\n|          114|      35|     15790|\n+-------------+--------+----------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.SQLTransformer\nbasicTransformation: org.apache.spark.ml.feature.SQLTransformer = sql_37fb6873d29e\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649482941,"submitTime":1497649482927,"finishTime":1497649484428,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e8abf2ba-52a7-481e-bd93-49b43bb0f665"},{"version":"CommandV1","origId":2060825016293772,"guid":"77b5e9dd-ea39-46cc-b7bd-f9acfd0f8c16","subtype":"command","commandType":"auto","position":42.0,"command":"from pyspark.ml.feature import SQLTransformer\nbasicTransformation = SQLTransformer()\\\n.setStatement(\"\"\"\nSELECT sum(Quantity), count(*), CustomerID\nFROM __THIS__\nGROUP BY CustomerID\n\"\"\")\nbasicTransformation.transform(sales).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------+--------+----------+\n|sum(Quantity)|count(1)|CustomerID|\n+-------------+--------+----------+\n|          265|      30|     17420|\n|          133|       8|     16861|\n|          567|      86|     16503|\n|         3065|     302|     15727|\n|         7430|     224|     17389|\n|           85|       9|     15447|\n|          241|      40|     14450|\n|          286|      86|     13623|\n|         2051|     187|     13285|\n|           23|      20|     16339|\n|           95|      29|     14570|\n|          224|      88|     16386|\n|          148|      22|     18024|\n|          406|     103|     12940|\n|          729|      30|     17679|\n|          416|      28|     16574|\n|          211|      42|     15957|\n|           25|       4|     13832|\n|          136|       3|     15619|\n|          114|      35|     15790|\n+-------------+--------+----------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649490216,"submitTime":1497649490201,"finishTime":1497649491324,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b34f8f4d-c24d-49e6-8ad7-e8e07523a92c"},{"version":"CommandV1","origId":2060825016293773,"guid":"3a2111b8-07ef-4a24-b286-a62e1183e83e","subtype":"command","commandType":"auto","position":43.0,"command":"%scala\nimport org.apache.spark.ml.feature.VectorAssembler\nval va = new VectorAssembler()\n.setInputCols(Array(\"int1\", \"int2\", \"int3\"))\nva.transform(fakeIntDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+----+----+---------------------------------+\n|int1|int2|int3|vecAssembler_5b51c0cff372__output|\n+----+----+----+---------------------------------+\n|   1|   2|   3|                    [1.0,2.0,3.0]|\n+----+----+----+---------------------------------+\n\nimport org.apache.spark.ml.feature.VectorAssembler\nva: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_5b51c0cff372\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:7: error: ';' expected but '.' found.\n       from pyspark.ml.feature import VectorAssembler\n                   ^\n&lt;console&gt;:8: error: illegal start of simple expression\n       va = VectorAssembler().setInputCols([&quot;int1&quot;, &quot;int2&quot;, &quot;int3&quot;])\n                                           ^\n</div>","error":null,"workflows":[],"startTime":1497649520652,"submitTime":1497649520636,"finishTime":1497649521152,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a0c9373e-50db-46ad-9059-919d0567d516"},{"version":"CommandV1","origId":2060825016293774,"guid":"28a64894-0825-4a50-9f31-936952f0c062","subtype":"command","commandType":"auto","position":44.0,"command":"from pyspark.ml.feature import VectorAssembler\nva = VectorAssembler().setInputCols([\"int1\", \"int2\", \"int3\"])\nva.transform(fakeIntDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+----+----+--------------------------------------------+\n|int1|int2|int3|VectorAssembler_4604aebde622cfdc00bc__output|\n+----+----+----+--------------------------------------------+\n|   1|   2|   3|                               [1.0,2.0,3.0]|\n+----+----+----+--------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649524028,"submitTime":1497649524023,"finishTime":1497649524302,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"816faa9b-6013-40fb-b2ab-7b93d16006cd"},{"version":"CommandV1","origId":2060825016293775,"guid":"7007ba8a-220f-4b92-aa9e-c8ec434ecbb2","subtype":"command","commandType":"auto","position":45.0,"command":"%scala\nimport org.apache.spark.ml.feature.Tokenizer\nval tkn = new Tokenizer()\n.setInputCol(\"Description\")\n.setOutputCol(\"DescriptionOut\")\nval tokenized = tkn.transform(sales)\ntokenized.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.Tokenizer\ntkn: org.apache.spark.ml.feature.Tokenizer = tok_cb9adb74282b\ntokenized: org.apache.spark.sql.DataFrame = [InvoiceNo: string, StockCode: string ... 7 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-38-513a0bb3fe29&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">2</span>\n<span class=\"ansiyellow\">    val tkn = new Tokenizer()</span>\n<span class=\"ansigrey\">          ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1497649548215,"submitTime":1497649548199,"finishTime":1497649548511,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"eafae8d3-52df-459a-aae1-c0130f956d2a"},{"version":"CommandV1","origId":2060825016293776,"guid":"4d83804b-57b0-4d14-9a95-06aeb7aed7ce","subtype":"command","commandType":"auto","position":46.0,"command":"from pyspark.ml.feature import Tokenizer\ntkn = Tokenizer()\\\n.setInputCol(\"Description\")\\\n.setOutputCol(\"DescriptionOut\")\ntokenized = tkn.transform(sales)\ntokenized.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|\n|   536367|    22745|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|\n|   536367|    22748|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649555871,"submitTime":1497649555867,"finishTime":1497649556092,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b6a3d61c-e19e-4456-9aa8-2b7584a9bad2"},{"version":"CommandV1","origId":2060825016293777,"guid":"65b956e6-4c40-4458-874b-860c6ac60509","subtype":"command","commandType":"auto","position":47.0,"command":"%scala\nimport org.apache.spark.ml.feature.RegexTokenizer\nval rt = new RegexTokenizer()\n.setInputCol(\"Description\")\n.setOutputCol(\"DescriptionOut\")\n.setPattern(\" \") // starting simple\n.setToLowercase(true)\nrt.transform(sales).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.RegexTokenizer\nrt: org.apache.spark.ml.feature.RegexTokenizer = regexTok_95cd65b21fc2\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649564328,"submitTime":1497649564312,"finishTime":1497649564570,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e47e3ba5-b182-445a-87d7-0d2096543cf4"},{"version":"CommandV1","origId":2060825016293778,"guid":"0de11c29-39a5-48e3-8cd7-fdb18a4b7a8e","subtype":"command","commandType":"auto","position":48.0,"command":"from pyspark.ml.feature import RegexTokenizer\nrt = RegexTokenizer()\\\n.setInputCol(\"Description\")\\\n.setOutputCol(\"DescriptionOut\")\\\n.setPattern(\" \")\\\n.setToLowercase(True)\nrt.transform(sales).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|\n|   536367|    22745|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|\n|   536367|    22748|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649570908,"submitTime":1497649570892,"finishTime":1497649571079,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3fecd183-5824-4919-890b-c0e16e4407e3"},{"version":"CommandV1","origId":2060825016293779,"guid":"17b9348b-0d4b-4c6c-93ac-f6b9c722f8d9","subtype":"command","commandType":"auto","position":49.0,"command":"%scala\nimport org.apache.spark.ml.feature.StopWordsRemover\nval englishStopWords = StopWordsRemover\n.loadDefaultStopWords(\"english\")\nval stops = new StopWordsRemover()\n.setStopWords(englishStopWords)\n.setInputCol(\"DescriptionOut\")\nstops.transform(tokenized).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+------------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|stopWords_fa5a2660645e__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+------------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|          [white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|          [white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|          [cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|          [knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|          [red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|          [set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|          [glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|          [hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|          [hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|          [assorted, colour...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|          [poppy's, playhou...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|          [poppy's, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|          [feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|          [ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|          [box, 6, assorted...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|          [box, vintage, ji...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|          [box, vintage, al...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|          [home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|          [love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|          [recipe, box, met...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+------------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.StopWordsRemover\nenglishStopWords: Array[String] = Array(i, me, my, myself, we, our, ours, ourselves, you, your, yours, yourself, yourselves, he, him, his, himself, she, her, hers, herself, it, its, itself, they, them, their, theirs, themselves, what, which, who, whom, this, that, these, those, am, is, are, was, were, be, been, being, have, has, had, having, do, does, did, doing, a, an, the, and, but, if, or, because, as, until, while, of, at, by, for, with, about, against, between, into, through, during, before, after, above, below, to, from, up, down, in, out, on, off, over, under, again, further, then, once, here, there, when, where, why, how, all, any, both, each, few, more, most, other, some, such, no, nor, not, only, own, same, so, than, too, very, s, t, can, will, just, don, should, now, d, ll, m, o, re, ve, y, ain, aren, couldn, didn, doesn, hadn, hasn, haven, isn, ma, mightn, mustn, needn, shan, shouldn, wasn, weren, won, wouldn)\nstops: org.apache.spark.ml.feature.StopWordsRemover = stopWords_fa5a2660645e\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649579340,"submitTime":1497649579324,"finishTime":1497649579651,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"df45feca-c298-418b-908a-11b63f5564a7"},{"version":"CommandV1","origId":2060825016293780,"guid":"16b1abe0-722e-4f49-9df3-52c43ec1289c","subtype":"command","commandType":"auto","position":50.0,"command":"from pyspark.ml.feature import StopWordsRemover\nenglishStopWords = StopWordsRemover\\\n.loadDefaultStopWords(\"english\")\nstops = StopWordsRemover()\\\n.setStopWords(englishStopWords)\\\n.setInputCol(\"DescriptionOut\")\nstops.transform(tokenized).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+---------------------------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|StopWordsRemover_493296e09f33b826993a__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+---------------------------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|                         [white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|                         [white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|                         [cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|                         [knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|                         [red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|                         [set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|                         [glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|                         [hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|                         [hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|                         [assorted, colour...|\n|   536367|    22745|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|                         [poppy&apos;s, playhou...|\n|   536367|    22748|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|                         [poppy&apos;s, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|                         [feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|                         [ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|                         [box, 6, assorted...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|                         [box, vintage, ji...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|                         [box, vintage, al...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|                         [home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|                         [love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|                         [recipe, box, met...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+---------------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649587071,"submitTime":1497649587053,"finishTime":1497649587444,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1f98babe-e0e0-435c-8954-c8875fd648bc"},{"version":"CommandV1","origId":2060825016293781,"guid":"7c3db786-e552-4c2e-8cc4-ccce43783e73","subtype":"command","commandType":"auto","position":51.0,"command":"%scala\nimport org.apache.spark.ml.feature.NGram\nval unigram = new NGram()\n.setInputCol(\"DescriptionOut\")\n.setN(1)\nval bigram = new NGram()\n.setInputCol(\"DescriptionOut\")\n.setN(2)\nunigram.transform(tokenized).show()\nbigram.transform(tokenized).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|ngram_32a16bfea614__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|      [white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|      [white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|      [cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|      [knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|      [red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|      [set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|      [glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|      [hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|      [hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|      [assorted, colour...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|      [poppy's, playhou...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|      [poppy's, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|      [feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|      [ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|      [box, of, 6, asso...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|      [box, of, vintage...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|      [box, of, vintage...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|      [home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|      [love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|      [recipe, box, wit...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------------+\nonly showing top 20 rows\n\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|ngram_4c8313b6b9e8__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|      [white hanging, h...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|      [white metal, met...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|      [cream cupid, cup...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|      [knitted union, u...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|      [red woolly, wool...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|      [set 7, 7 babushk...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|      [glass star, star...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|      [hand warmer, war...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|      [hand warmer, war...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|      [assorted colour,...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|      [poppy's playhous...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|      [poppy's playhous...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|      [feltcraft prince...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|      [ivory knitted, k...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|      [box of, of 6, 6 ...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|      [box of, of vinta...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|      [box of, of vinta...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|      [home building, b...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|      [love building, b...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|      [recipe box, box ...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.NGram\nunigram: org.apache.spark.ml.feature.NGram = ngram_32a16bfea614\nbigram: org.apache.spark.ml.feature.NGram = ngram_4c8313b6b9e8\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649602618,"submitTime":1497649602602,"finishTime":1497649603073,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bb26503a-4448-4c7c-aa64-c3c8bb1cc8db"},{"version":"CommandV1","origId":2060825016293782,"guid":"151879e4-f29e-44f5-9153-fde8785d70df","subtype":"command","commandType":"auto","position":52.0,"command":"%scala\nimport org.apache.spark.ml.feature.CountVectorizer\nval cv = new CountVectorizer()\n.setInputCol(\"DescriptionOut\")\n.setOutputCol(\"countVec\")\n.setVocabSize(500)\n.setMinTF(1)\n.setMinDF(2)\nval fittedCV = cv.fit(tokenized)\nfittedCV.transform(tokenized).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|            countVec|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|(500,[4,15,19,21,...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|(500,[14,15,208],...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|(500,[57,98,222,2...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|(500,[34,39,40,89...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|(500,[3,15],[1.0,...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|(500,[0,160,163],...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|(500,[21,23,31,84...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|(500,[89,101,112,...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|(500,[3,101,112],...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|(500,[62,79,87,30...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|(500,[317,318],[1...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|(500,[145,317,318...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|(500,[64,77,221,3...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|(500,[54,55,348],...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|(500,[1,10,27,62,...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,274]...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,132]...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|(500,[44,217,258,...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|(500,[59,217,258,...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|(500,[4,10,14,41,...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.CountVectorizer\ncv: org.apache.spark.ml.feature.CountVectorizer = cntVec_b25724fca7c3\nfittedCV: org.apache.spark.ml.feature.CountVectorizerModel = cntVec_b25724fca7c3\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649619342,"submitTime":1497649619325,"finishTime":1497649622629,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a9530426-c72a-45ec-8abc-065ae9a8e809"},{"version":"CommandV1","origId":2060825016293783,"guid":"43cd4a56-8eb0-4284-af70-b4f90a2ee0a3","subtype":"command","commandType":"auto","position":53.0,"command":"from pyspark.ml.feature import CountVectorizer\ncv = CountVectorizer()\\\n.setInputCol(\"DescriptionOut\")\\\n.setOutputCol(\"countVec\")\\\n.setVocabSize(500)\\\n.setMinTF(1)\\\n.setMinDF(2)\nfittedCV = cv.fit(tokenized)\nfittedCV.transform(tokenized).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|            countVec|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|(500,[4,15,19,21,...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|(500,[14,15,208],...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|(500,[57,98,222,2...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|(500,[34,39,40,89...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|(500,[3,15],[1.0,...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|(500,[0,160,163],...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|(500,[21,23,31,84...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|(500,[89,101,112,...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|(500,[3,101,112],...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|(500,[62,79,87,30...|\n|   536367|    22745|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|(500,[317,318],[1...|\n|   536367|    22748|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|(500,[145,317,318...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|(500,[64,77,221,3...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|(500,[54,55,348],...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|(500,[1,10,27,62,...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,274]...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,132]...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|(500,[44,217,258,...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|(500,[59,217,258,...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|(500,[4,10,14,41,...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649627279,"submitTime":1497649627262,"finishTime":1497649630297,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c1b8c312-6307-46fa-9289-de97f2bbfd45"},{"version":"CommandV1","origId":2060825016293784,"guid":"4cbb1547-8dc3-4aa1-9fa2-014942f2a091","subtype":"command","commandType":"auto","position":54.0,"command":"%scala\nval tfIdfIn = tokenized\n.where(\"array_contains(DescriptionOut, 'red')\")\n.select(\"DescriptionOut\")\n.limit(10)\ntfIdfIn.show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------------------------------------+\n|DescriptionOut                      |\n+------------------------------------+\n|[red, woolly, hottie, white, heart.]|\n|[hand, warmer, red, polka, dot]     |\n|[red, coat, rack, paris, fashion]   |\n|[alarm, clock, bakelike, red]       |\n|[set/2, red, retrospot, tea, towels]|\n|[red, toadstool, led, night, light] |\n|[hand, warmer, red, polka, dot]     |\n|[edwardian, parasol, red]           |\n|[red, woolly, hottie, white, heart.]|\n|[edwardian, parasol, red]           |\n+------------------------------------+\n\ntfIdfIn: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [DescriptionOut: array&lt;string&gt;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649634662,"submitTime":1497649634644,"finishTime":1497649634904,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0a73247a-9933-42f3-b943-82bf78c5fe1c"},{"version":"CommandV1","origId":2060825016293785,"guid":"b542287f-08f4-4161-b2a3-11dcfcdf2095","subtype":"command","commandType":"auto","position":55.0,"command":"tfIdfIn = tokenized\\\n.where(\"array_contains(DescriptionOut, 'red')\")\\\n.select(\"DescriptionOut\")\\\n.limit(10)\ntfIdfIn.show(10, False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------------------------------------+\n|DescriptionOut                      |\n+------------------------------------+\n|[red, woolly, hottie, white, heart.]|\n|[hand, warmer, red, polka, dot]     |\n|[red, coat, rack, paris, fashion]   |\n|[alarm, clock, bakelike, red]       |\n|[set/2, red, retrospot, tea, towels]|\n|[red, toadstool, led, night, light] |\n|[hand, warmer, red, polka, dot]     |\n|[edwardian, parasol, red]           |\n|[red, woolly, hottie, white, heart.]|\n|[edwardian, parasol, red]           |\n+------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649641947,"submitTime":1497649641929,"finishTime":1497649642168,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a9561816-3b1c-40f3-954b-d24906475a0c"},{"version":"CommandV1","origId":2060825016293786,"guid":"762825f5-03a1-452a-a858-4344d529a942","subtype":"command","commandType":"auto","position":56.0,"command":"%scala\nimport org.apache.spark.ml.feature.{HashingTF, IDF}\nval tf = new HashingTF()\n.setInputCol(\"DescriptionOut\")\n.setOutputCol(\"TFOut\")\n.setNumFeatures(10000)\nval idf = new IDF()\n.setInputCol(\"TFOut\")\n.setOutputCol(\"IDFOut\")\n.setMinDocFreq(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.feature.{HashingTF, IDF}\ntf: org.apache.spark.ml.feature.HashingTF = hashingTF_445e01f0c133\nidf: org.apache.spark.ml.feature.IDF = idf_4fdd4f2fcdb3\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649650126,"submitTime":1497649650121,"finishTime":1497649650226,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"87a95b78-f915-4d07-86a9-add19ef5676a"},{"version":"CommandV1","origId":2060825016293787,"guid":"dd5008c5-7a4a-4dc4-aea4-7299ebf7c0cd","subtype":"command","commandType":"auto","position":57.0,"command":"from pyspark.ml.feature import HashingTF, IDF\ntf = HashingTF()\\\n.setInputCol(\"DescriptionOut\")\\\n.setOutputCol(\"TFOut\")\\\n.setNumFeatures(10000)\nidf = IDF()\\\n.setInputCol(\"TFOut\")\\\n.setOutputCol(\"IDFOut\")\\\n.setMinDocFreq(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649658976,"submitTime":1497649658958,"finishTime":1497649659048,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"17287aeb-151f-4354-85e5-8287bfdcc98b"},{"version":"CommandV1","origId":2060825016293788,"guid":"6e554feb-25aa-4f0a-be46-84ac077a8029","subtype":"command","commandType":"auto","position":58.0,"command":"%scala\nidf.fit(tf.transform(tfIdfIn))\n.transform(tf.transform(tfIdfIn))\n.show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------------------------------------+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+\n|DescriptionOut                      |TFOut                                                   |IDFOut                                                                                                              |\n+------------------------------------+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+\n|[red, woolly, hottie, white, heart.]|(10000,[4077,4291,6756,6872,7142],[1.0,1.0,1.0,1.0,1.0])|(10000,[4077,4291,6756,6872,7142],[1.2992829841302609,0.0,1.2992829841302609,1.2992829841302609,1.2992829841302609])|\n|[hand, warmer, red, polka, dot]     |(10000,[3280,3423,4220,4291,8977],[1.0,1.0,1.0,1.0,1.0])|(10000,[3280,3423,4220,4291,8977],[1.2992829841302609,1.2992829841302609,1.2992829841302609,0.0,1.2992829841302609])|\n|[red, coat, rack, paris, fashion]   |(10000,[477,598,4291,5106,9627],[1.0,1.0,1.0,1.0,1.0])  |(10000,[477,598,4291,5106,9627],[0.0,0.0,0.0,0.0,0.0])                                                              |\n|[alarm, clock, bakelike, red]       |(10000,[4291,4852,4995,9668],[1.0,1.0,1.0,1.0])         |(10000,[4291,4852,4995,9668],[0.0,0.0,0.0,0.0])                                                                     |\n|[set/2, red, retrospot, tea, towels]|(10000,[811,2591,4291,5716,8540],[1.0,1.0,1.0,1.0,1.0]) |(10000,[811,2591,4291,5716,8540],[0.0,0.0,0.0,0.0,0.0])                                                             |\n|[red, toadstool, led, night, light] |(10000,[76,3526,4291,7860,9159],[1.0,1.0,1.0,1.0,1.0])  |(10000,[76,3526,4291,7860,9159],[0.0,0.0,0.0,0.0,0.0])                                                              |\n|[hand, warmer, red, polka, dot]     |(10000,[3280,3423,4220,4291,8977],[1.0,1.0,1.0,1.0,1.0])|(10000,[3280,3423,4220,4291,8977],[1.2992829841302609,1.2992829841302609,1.2992829841302609,0.0,1.2992829841302609])|\n|[edwardian, parasol, red]           |(10000,[3266,3944,4291],[1.0,1.0,1.0])                  |(10000,[3266,3944,4291],[1.2992829841302609,1.2992829841302609,0.0])                                                |\n|[red, woolly, hottie, white, heart.]|(10000,[4077,4291,6756,6872,7142],[1.0,1.0,1.0,1.0,1.0])|(10000,[4077,4291,6756,6872,7142],[1.2992829841302609,0.0,1.2992829841302609,1.2992829841302609,1.2992829841302609])|\n|[edwardian, parasol, red]           |(10000,[3266,3944,4291],[1.0,1.0,1.0])                  |(10000,[3266,3944,4291],[1.2992829841302609,1.2992829841302609,0.0])                                                |\n+------------------------------------+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649666612,"submitTime":1497649666593,"finishTime":1497649667477,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2d792ddf-e2aa-44c6-8d00-d7fc4be06436"},{"version":"CommandV1","origId":2060825016293789,"guid":"effd9061-f27c-440d-9cdf-e405f54b0f7f","subtype":"command","commandType":"auto","position":59.0,"command":"idf.fit(tf.transform(tfIdfIn))\\\n.transform(tf.transform(tfIdfIn))\\\n.show(10, False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------------------------------------+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+\n|DescriptionOut                      |TFOut                                                   |IDFOut                                                                                                              |\n+------------------------------------+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+\n|[red, woolly, hottie, white, heart.]|(10000,[4077,4291,6756,6872,7142],[1.0,1.0,1.0,1.0,1.0])|(10000,[4077,4291,6756,6872,7142],[1.2992829841302609,0.0,1.2992829841302609,1.2992829841302609,1.2992829841302609])|\n|[hand, warmer, red, polka, dot]     |(10000,[3280,3423,4220,4291,8977],[1.0,1.0,1.0,1.0,1.0])|(10000,[3280,3423,4220,4291,8977],[1.2992829841302609,1.2992829841302609,1.2992829841302609,0.0,1.2992829841302609])|\n|[red, coat, rack, paris, fashion]   |(10000,[477,598,4291,5106,9627],[1.0,1.0,1.0,1.0,1.0])  |(10000,[477,598,4291,5106,9627],[0.0,0.0,0.0,0.0,0.0])                                                              |\n|[alarm, clock, bakelike, red]       |(10000,[4291,4852,4995,9668],[1.0,1.0,1.0,1.0])         |(10000,[4291,4852,4995,9668],[0.0,0.0,0.0,0.0])                                                                     |\n|[set/2, red, retrospot, tea, towels]|(10000,[811,2591,4291,5716,8540],[1.0,1.0,1.0,1.0,1.0]) |(10000,[811,2591,4291,5716,8540],[0.0,0.0,0.0,0.0,0.0])                                                             |\n|[red, toadstool, led, night, light] |(10000,[76,3526,4291,7860,9159],[1.0,1.0,1.0,1.0,1.0])  |(10000,[76,3526,4291,7860,9159],[0.0,0.0,0.0,0.0,0.0])                                                              |\n|[hand, warmer, red, polka, dot]     |(10000,[3280,3423,4220,4291,8977],[1.0,1.0,1.0,1.0,1.0])|(10000,[3280,3423,4220,4291,8977],[1.2992829841302609,1.2992829841302609,1.2992829841302609,0.0,1.2992829841302609])|\n|[edwardian, parasol, red]           |(10000,[3266,3944,4291],[1.0,1.0,1.0])                  |(10000,[3266,3944,4291],[1.2992829841302609,1.2992829841302609,0.0])                                                |\n|[red, woolly, hottie, white, heart.]|(10000,[4077,4291,6756,6872,7142],[1.0,1.0,1.0,1.0,1.0])|(10000,[4077,4291,6756,6872,7142],[1.2992829841302609,0.0,1.2992829841302609,1.2992829841302609,1.2992829841302609])|\n|[edwardian, parasol, red]           |(10000,[3266,3944,4291],[1.0,1.0,1.0])                  |(10000,[3266,3944,4291],[1.2992829841302609,1.2992829841302609,0.0])                                                |\n+------------------------------------+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649673579,"submitTime":1497649673560,"finishTime":1497649674355,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8005f734-1d27-4a10-b0f9-0bda7d2e7002"},{"version":"CommandV1","origId":2060825016293790,"guid":"4c0677ba-aba1-4d01-83aa-59f05ee52883","subtype":"command","commandType":"auto","position":60.0,"command":"%scala\nval contDF = spark.range(500)\n.selectExpr(\"cast(id as double)\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">contDF: org.apache.spark.sql.DataFrame = [id: double]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649681782,"submitTime":1497649681762,"finishTime":1497649681887,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6d4e0d55-04ac-450c-936d-8114dbcd251d"},{"version":"CommandV1","origId":2060825016293791,"guid":"2e9bfdcf-1ff4-47ee-a5e2-c4580f42991e","subtype":"command","commandType":"auto","position":61.0,"command":"contDF = spark.range(500)\\\n.selectExpr(\"cast(id as double)\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649688263,"submitTime":1497649688244,"finishTime":1497649688334,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d4e19c89-d235-453d-a25a-08dcfd58a620"},{"version":"CommandV1","origId":2060825016293792,"guid":"da60651b-8b35-4154-b902-5a7a642bfcbc","subtype":"command","commandType":"auto","position":62.0,"command":"%scala\nimport org.apache.spark.ml.feature.Bucketizer\nval bucketBorders = Array(-1.0, 5.0, 10.0, 250.0, 600.0)\nval bucketer = new Bucketizer()\n.setSplits(bucketBorders)\n.setInputCol(\"id\")\nbucketer.transform(contDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+-------------------------------+\n|  id|bucketizer_a348e14706b8__output|\n+----+-------------------------------+\n| 0.0|                            0.0|\n| 1.0|                            0.0|\n| 2.0|                            0.0|\n| 3.0|                            0.0|\n| 4.0|                            0.0|\n| 5.0|                            1.0|\n| 6.0|                            1.0|\n| 7.0|                            1.0|\n| 8.0|                            1.0|\n| 9.0|                            1.0|\n|10.0|                            2.0|\n|11.0|                            2.0|\n|12.0|                            2.0|\n|13.0|                            2.0|\n|14.0|                            2.0|\n|15.0|                            2.0|\n|16.0|                            2.0|\n|17.0|                            2.0|\n|18.0|                            2.0|\n|19.0|                            2.0|\n+----+-------------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.Bucketizer\nbucketBorders: Array[Double] = Array(-1.0, 5.0, 10.0, 250.0, 600.0)\nbucketer: org.apache.spark.ml.feature.Bucketizer = bucketizer_a348e14706b8\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649696146,"submitTime":1497649696127,"finishTime":1497649696338,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e23f3af8-1623-4091-aabb-f6ad5966395c"},{"version":"CommandV1","origId":2060825016293793,"guid":"a97c6920-e002-4165-af74-c49ad7b19386","subtype":"command","commandType":"auto","position":63.0,"command":"from pyspark.ml.feature import Bucketizer\nbucketBorders = [-1.0, 5.0, 10.0, 250.0, 600.0]\nbucketer = Bucketizer()\\\n.setSplits(bucketBorders)\\\n.setInputCol(\"id\")\nbucketer.transform(contDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+---------------------------------------+\n|  id|Bucketizer_4e10aa7b71e1ee8fc7a3__output|\n+----+---------------------------------------+\n| 0.0|                                    0.0|\n| 1.0|                                    0.0|\n| 2.0|                                    0.0|\n| 3.0|                                    0.0|\n| 4.0|                                    0.0|\n| 5.0|                                    1.0|\n| 6.0|                                    1.0|\n| 7.0|                                    1.0|\n| 8.0|                                    1.0|\n| 9.0|                                    1.0|\n|10.0|                                    2.0|\n|11.0|                                    2.0|\n|12.0|                                    2.0|\n|13.0|                                    2.0|\n|14.0|                                    2.0|\n|15.0|                                    2.0|\n|16.0|                                    2.0|\n|17.0|                                    2.0|\n|18.0|                                    2.0|\n|19.0|                                    2.0|\n+----+---------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649704459,"submitTime":1497649704438,"finishTime":1497649704530,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"df4a0576-35c1-4164-b879-646069e2dcd7"},{"version":"CommandV1","origId":2060825016293794,"guid":"51ab91fa-5607-4b13-baa9-36d43d437e25","subtype":"command","commandType":"auto","position":64.0,"command":"%scala\nimport org.apache.spark.ml.feature.QuantileDiscretizer\nval bucketer = new QuantileDiscretizer()\n.setNumBuckets(5)\n.setInputCol(\"id\")\nval fittedBucketer = bucketer.fit(contDF)\nfittedBucketer.transform(contDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+----------------------------------------+\n|  id|quantileDiscretizer_c4e862777568__output|\n+----+----------------------------------------+\n| 0.0|                                     0.0|\n| 1.0|                                     0.0|\n| 2.0|                                     0.0|\n| 3.0|                                     0.0|\n| 4.0|                                     0.0|\n| 5.0|                                     0.0|\n| 6.0|                                     0.0|\n| 7.0|                                     0.0|\n| 8.0|                                     0.0|\n| 9.0|                                     0.0|\n|10.0|                                     0.0|\n|11.0|                                     0.0|\n|12.0|                                     0.0|\n|13.0|                                     0.0|\n|14.0|                                     0.0|\n|15.0|                                     0.0|\n|16.0|                                     0.0|\n|17.0|                                     0.0|\n|18.0|                                     0.0|\n|19.0|                                     0.0|\n+----+----------------------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.QuantileDiscretizer\nbucketer: org.apache.spark.ml.feature.QuantileDiscretizer = quantileDiscretizer_c4e862777568\nfittedBucketer: org.apache.spark.ml.feature.Bucketizer = quantileDiscretizer_c4e862777568\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649712693,"submitTime":1497649712674,"finishTime":1497649712916,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e5b51d3d-5695-46c1-9215-60225ab35c37"},{"version":"CommandV1","origId":2060825016293795,"guid":"99595912-38b3-4b94-80c3-5a40ae0f02d9","subtype":"command","commandType":"auto","position":65.0,"command":"from pyspark.ml.feature import QuantileDiscretizer\nbucketer = QuantileDiscretizer()\\\n.setNumBuckets(5)\\\n.setInputCol(\"id\")\nfittedBucketer = bucketer.fit(contDF)\nfittedBucketer.transform(contDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+------------------------------------------------+\n|  id|QuantileDiscretizer_47d59527a1a106306fe2__output|\n+----+------------------------------------------------+\n| 0.0|                                             0.0|\n| 1.0|                                             0.0|\n| 2.0|                                             0.0|\n| 3.0|                                             0.0|\n| 4.0|                                             0.0|\n| 5.0|                                             0.0|\n| 6.0|                                             0.0|\n| 7.0|                                             0.0|\n| 8.0|                                             0.0|\n| 9.0|                                             0.0|\n|10.0|                                             0.0|\n|11.0|                                             0.0|\n|12.0|                                             0.0|\n|13.0|                                             0.0|\n|14.0|                                             0.0|\n|15.0|                                             0.0|\n|16.0|                                             0.0|\n|17.0|                                             0.0|\n|18.0|                                             0.0|\n|19.0|                                             0.0|\n+----+------------------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649719888,"submitTime":1497649719865,"finishTime":1497649720010,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9a4c74b0-3c18-40f4-aa27-0bae4d6cde97"},{"version":"CommandV1","origId":2060825016293796,"guid":"32131169-f439-4c29-a9f9-58d061e66e2e","subtype":"command","commandType":"auto","position":66.0,"command":"%scala\nimport org.apache.spark.ml.feature.Normalizer\nval taxicab = new Normalizer()\n.setP(1)\n.setInputCol(\"features\")\ntaxicab.transform(scaleDF).show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+---------------------------------------------------------------+\n|id |features      |normalizer_1781e3ce2035__output                                |\n+---+--------------+---------------------------------------------------------------+\n|0  |[1.0,0.1,-1.0]|[0.47619047619047616,0.047619047619047616,-0.47619047619047616]|\n|1  |[2.0,1.1,1.0] |[0.48780487804878053,0.26829268292682934,0.24390243902439027]  |\n|0  |[1.0,0.1,-1.0]|[0.47619047619047616,0.047619047619047616,-0.47619047619047616]|\n|1  |[2.0,1.1,1.0] |[0.48780487804878053,0.26829268292682934,0.24390243902439027]  |\n|1  |[3.0,10.1,3.0]|[0.18633540372670807,0.6273291925465838,0.18633540372670807]   |\n+---+--------------+---------------------------------------------------------------+\n\nimport org.apache.spark.ml.feature.Normalizer\ntaxicab: org.apache.spark.ml.feature.Normalizer = normalizer_1781e3ce2035\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649728311,"submitTime":1497649728290,"finishTime":1497649729322,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2337b0f6-66bd-4f54-ac2c-e67fb4888a2b"},{"version":"CommandV1","origId":2060825016293797,"guid":"05b6e36a-d604-4b14-bc52-07b75f3354ea","subtype":"command","commandType":"auto","position":67.0,"command":"from pyspark.ml.feature import Normalizer\ntaxicab = Normalizer()\\\n.setP(1)\\\n.setInputCol(\"features\")\ntaxicab.transform(scaleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+---------------------------------------+\n| id|      features|Normalizer_494a9dbee44ee93e6c06__output|\n+---+--------------+---------------------------------------+\n|  0|[1.0,0.1,-1.0]|                   [0.47619047619047...|\n|  1| [2.0,1.1,1.0]|                   [0.48780487804878...|\n|  0|[1.0,0.1,-1.0]|                   [0.47619047619047...|\n|  1| [2.0,1.1,1.0]|                   [0.48780487804878...|\n|  1|[3.0,10.1,3.0]|                   [0.18633540372670...|\n+---+--------------+---------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649735203,"submitTime":1497649735184,"finishTime":1497649735626,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4dedd5d7-1490-4fa1-8519-946f3a206456"},{"version":"CommandV1","origId":2060825016293798,"guid":"f7ec3149-ab4b-4022-9498-41f6bfa43207","subtype":"command","commandType":"auto","position":68.0,"command":"%scala\nimport org.apache.spark.ml.feature.StandardScaler\nval sScaler = new StandardScaler()\n.setInputCol(\"features\")\nsScaler.fit(scaleDF).transform(scaleDF).show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+------------------------------------------------------------+\n|id |features      |stdScal_676826958d50__output                                |\n+---+--------------+------------------------------------------------------------+\n|0  |[1.0,0.1,-1.0]|[1.1952286093343936,0.02337622911060922,-0.5976143046671968]|\n|1  |[2.0,1.1,1.0] |[2.390457218668787,0.2571385202167014,0.5976143046671968]   |\n|0  |[1.0,0.1,-1.0]|[1.1952286093343936,0.02337622911060922,-0.5976143046671968]|\n|1  |[2.0,1.1,1.0] |[2.390457218668787,0.2571385202167014,0.5976143046671968]   |\n|1  |[3.0,10.1,3.0]|[3.5856858280031805,2.3609991401715313,1.7928429140015902]  |\n+---+--------------+------------------------------------------------------------+\n\nimport org.apache.spark.ml.feature.StandardScaler\nsScaler: org.apache.spark.ml.feature.StandardScaler = stdScal_676826958d50\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649746453,"submitTime":1497649746433,"finishTime":1497649746883,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"84c6e402-0176-4d1b-b74a-2b802e2498e1"},{"version":"CommandV1","origId":2060825016293799,"guid":"89f9ed66-81a0-4c1c-b48b-1e6e2520689f","subtype":"command","commandType":"auto","position":69.0,"command":"%scala\nimport org.apache.spark.ml.feature.MinMaxScaler\nval minMax = new MinMaxScaler()\n.setMin(5)\n.setMax(10)\n.setInputCol(\"features\")\nval fittedminMax = minMax.fit(scaleDF)\nfittedminMax.transform(scaleDF).show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+-------------------------------+\n|id |features      |minMaxScal_401616be2bdb__output|\n+---+--------------+-------------------------------+\n|0  |[1.0,0.1,-1.0]|[5.0,5.0,5.0]                  |\n|1  |[2.0,1.1,1.0] |[7.5,5.5,7.5]                  |\n|0  |[1.0,0.1,-1.0]|[5.0,5.0,5.0]                  |\n|1  |[2.0,1.1,1.0] |[7.5,5.5,7.5]                  |\n|1  |[3.0,10.1,3.0]|[10.0,10.0,10.0]               |\n+---+--------------+-------------------------------+\n\nimport org.apache.spark.ml.feature.MinMaxScaler\nminMax: org.apache.spark.ml.feature.MinMaxScaler = minMaxScal_401616be2bdb\nfittedminMax: org.apache.spark.ml.feature.MinMaxScalerModel = minMaxScal_401616be2bdb\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649762160,"submitTime":1497649762140,"finishTime":1497649762575,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e200c43b-a688-4e1a-98a2-c7c17b963013"},{"version":"CommandV1","origId":2060825016293800,"guid":"528ee228-2dfa-437e-b108-2718cf096d25","subtype":"command","commandType":"auto","position":70.0,"command":"from pyspark.ml.feature import MinMaxScaler\nminMax = MinMaxScaler()\\\n.setMin(5)\\\n.setMax(10)\\\n.setInputCol(\"features\")\nfittedminMax = minMax.fit(scaleDF)\nfittedminMax.transform(scaleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+-----------------------------------------+\n| id|      features|MinMaxScaler_49bca4ff4a0a3092ae1e__output|\n+---+--------------+-----------------------------------------+\n|  0|[1.0,0.1,-1.0]|                            [5.0,5.0,5.0]|\n|  1| [2.0,1.1,1.0]|                            [7.5,5.5,7.5]|\n|  0|[1.0,0.1,-1.0]|                            [5.0,5.0,5.0]|\n|  1| [2.0,1.1,1.0]|                            [7.5,5.5,7.5]|\n|  1|[3.0,10.1,3.0]|                         [10.0,10.0,10.0]|\n+---+--------------+-----------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649769028,"submitTime":1497649769009,"finishTime":1497649769401,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9a3e32f4-7c8c-41b0-a93a-91fdadd86685"},{"version":"CommandV1","origId":2060825016293801,"guid":"34433da5-3db1-4379-aff2-0d6a28ee360b","subtype":"command","commandType":"auto","position":71.0,"command":"%scala\nimport org.apache.spark.ml.feature.MaxAbsScaler\nval maScaler = new MaxAbsScaler()\n.setInputCol(\"features\")\nval fittedmaScaler = maScaler.fit(scaleDF)\nfittedmaScaler.transform(scaleDF).show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+-------------------------------------------------------------+\n|id |features      |maxAbsScal_3152fe4b93b0__output                              |\n+---+--------------+-------------------------------------------------------------+\n|0  |[1.0,0.1,-1.0]|[0.3333333333333333,0.009900990099009901,-0.3333333333333333]|\n|1  |[2.0,1.1,1.0] |[0.6666666666666666,0.10891089108910892,0.3333333333333333]  |\n|0  |[1.0,0.1,-1.0]|[0.3333333333333333,0.009900990099009901,-0.3333333333333333]|\n|1  |[2.0,1.1,1.0] |[0.6666666666666666,0.10891089108910892,0.3333333333333333]  |\n|1  |[3.0,10.1,3.0]|[1.0,1.0,1.0]                                                |\n+---+--------------+-------------------------------------------------------------+\n\nimport org.apache.spark.ml.feature.MaxAbsScaler\nmaScaler: org.apache.spark.ml.feature.MaxAbsScaler = maxAbsScal_3152fe4b93b0\nfittedmaScaler: org.apache.spark.ml.feature.MaxAbsScalerModel = maxAbsScal_3152fe4b93b0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649779145,"submitTime":1497649779123,"finishTime":1497649779537,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7046a2e5-7ac1-4e44-b280-172f1afc219e"},{"version":"CommandV1","origId":2060825016293802,"guid":"363874d4-2221-464b-ad76-e7ec6b9e6b5c","subtype":"command","commandType":"auto","position":72.0,"command":"%scala\nimport org.apache.spark.ml.feature.ElementwiseProduct\nimport org.apache.spark.ml.linalg.Vectors\nval scaleUpVec = Vectors.dense(10.0, 15.0, 20.0)\nval scalingUp = new ElementwiseProduct()\n.setScalingVec(scaleUpVec)\n.setInputCol(\"features\")\nscalingUp.transform(scaleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+-----------------------------+\n| id|      features|elemProd_e7a95f98ea0d__output|\n+---+--------------+-----------------------------+\n|  0|[1.0,0.1,-1.0]|             [10.0,1.5,-20.0]|\n|  1| [2.0,1.1,1.0]|             [20.0,16.5,20.0]|\n|  0|[1.0,0.1,-1.0]|             [10.0,1.5,-20.0]|\n|  1| [2.0,1.1,1.0]|             [20.0,16.5,20.0]|\n|  1|[3.0,10.1,3.0]|            [30.0,151.5,60.0]|\n+---+--------------+-----------------------------+\n\nimport org.apache.spark.ml.feature.ElementwiseProduct\nimport org.apache.spark.ml.linalg.Vectors\nscaleUpVec: org.apache.spark.ml.linalg.Vector = [10.0,15.0,20.0]\nscalingUp: org.apache.spark.ml.feature.ElementwiseProduct = elemProd_e7a95f98ea0d\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649786218,"submitTime":1497649786189,"finishTime":1497649786484,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ec80bebc-433c-4fba-beb9-2106a4a8350b"},{"version":"CommandV1","origId":2060825016293803,"guid":"612a6878-2e1b-43a2-8282-e7e757c3affd","subtype":"command","commandType":"auto","position":73.0,"command":"from pyspark.ml.feature import ElementwiseProduct\nfrom pyspark.ml.linalg import Vectors\nscaleUpVec = Vectors.dense(10.0, 15.0, 20.0)\nscalingUp = ElementwiseProduct()\\\n.setScalingVec(scaleUpVec)\\\n.setInputCol(\"features\")\nscalingUp.transform(scaleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+-----------------------------------------------+\n| id|      features|ElementwiseProduct_4beab226bd28a5c87b6c__output|\n+---+--------------+-----------------------------------------------+\n|  0|[1.0,0.1,-1.0]|                               [10.0,1.5,-20.0]|\n|  1| [2.0,1.1,1.0]|                               [20.0,16.5,20.0]|\n|  0|[1.0,0.1,-1.0]|                               [10.0,1.5,-20.0]|\n|  1| [2.0,1.1,1.0]|                               [20.0,16.5,20.0]|\n|  1|[3.0,10.1,3.0]|                              [30.0,151.5,60.0]|\n+---+--------------+-----------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649793113,"submitTime":1497649793092,"finishTime":1497649793385,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9dbffb75-ddb5-4b77-926a-dac08d581827"},{"version":"CommandV1","origId":2060825016293804,"guid":"78bc70df-3f22-497d-9f44-65abe5657992","subtype":"command","commandType":"auto","position":74.0,"command":"%scala\nimport org.apache.spark.ml.feature.StringIndexer\nval labelIndexer = new StringIndexer()\n.setInputCol(\"lab\")\n.setOutputCol(\"labelInd\")\nval idxRes = labelIndexer.fit(simpleDF).transform(simpleDF)\nidxRes.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+\n|color| lab|value1|            value2|labelInd|\n+-----+----+------+------------------+--------+\n|green|good|     1|14.386294994851129|     1.0|\n| blue| bad|     8|14.386294994851129|     0.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     1.0|\n|green|good|    12|14.386294994851129|     1.0|\n|green| bad|    16|14.386294994851129|     0.0|\n|  red|good|    35|14.386294994851129|     1.0|\n|  red| bad|     1| 38.97187133755819|     0.0|\n|  red| bad|     2|14.386294994851129|     0.0|\n|  red| bad|    16|14.386294994851129|     0.0|\n|  red|good|    45| 38.97187133755819|     1.0|\n|green|good|     1|14.386294994851129|     1.0|\n| blue| bad|     8|14.386294994851129|     0.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     1.0|\n|green|good|    12|14.386294994851129|     1.0|\n|green| bad|    16|14.386294994851129|     0.0|\n|  red|good|    35|14.386294994851129|     1.0|\n|  red| bad|     1| 38.97187133755819|     0.0|\n|  red| bad|     2|14.386294994851129|     0.0|\n+-----+----+------+------------------+--------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.StringIndexer\nlabelIndexer: org.apache.spark.ml.feature.StringIndexer = strIdx_0019f515d861\nidxRes: org.apache.spark.sql.DataFrame = [color: string, lab: string ... 3 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649801533,"submitTime":1497649801510,"finishTime":1497649803272,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4e2a80cc-c4c2-4373-9014-f714705f0a17"},{"version":"CommandV1","origId":2060825016293805,"guid":"9f9f6e83-95b6-4f60-a4e6-72042e05e992","subtype":"command","commandType":"auto","position":75.0,"command":"from pyspark.ml.feature import StringIndexer\nlabelIndexer = StringIndexer()\\\n.setInputCol(\"lab\")\\\n.setOutputCol(\"labelInd\")\nidxRes = labelIndexer.fit(simpleDF).transform(simpleDF)\nidxRes.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+\n|color| lab|value1|            value2|labelInd|\n+-----+----+------+------------------+--------+\n|green|good|     1|14.386294994851129|     1.0|\n| blue| bad|     8|14.386294994851129|     0.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     1.0|\n|green|good|    12|14.386294994851129|     1.0|\n|green| bad|    16|14.386294994851129|     0.0|\n|  red|good|    35|14.386294994851129|     1.0|\n|  red| bad|     1| 38.97187133755819|     0.0|\n|  red| bad|     2|14.386294994851129|     0.0|\n|  red| bad|    16|14.386294994851129|     0.0|\n|  red|good|    45| 38.97187133755819|     1.0|\n|green|good|     1|14.386294994851129|     1.0|\n| blue| bad|     8|14.386294994851129|     0.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     1.0|\n|green|good|    12|14.386294994851129|     1.0|\n|green| bad|    16|14.386294994851129|     0.0|\n|  red|good|    35|14.386294994851129|     1.0|\n|  red| bad|     1| 38.97187133755819|     0.0|\n|  red| bad|     2|14.386294994851129|     0.0|\n+-----+----+------+------------------+--------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649815317,"submitTime":1497649815294,"finishTime":1497649815639,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"84b051d7-2a26-417b-9bcb-de8dbc59ccfd"},{"version":"CommandV1","origId":2060825016293806,"guid":"47ae40aa-1a9f-475e-ae0c-daa489229a53","subtype":"command","commandType":"auto","position":76.0,"command":"%scala\nval valIndexer = new StringIndexer()\n.setInputCol(\"value1\")\n.setOutputCol(\"valueInd\")\nvalIndexer.fit(simpleDF).transform(simpleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+\n|color| lab|value1|            value2|valueInd|\n+-----+----+------+------------------+--------+\n|green|good|     1|14.386294994851129|     2.0|\n| blue| bad|     8|14.386294994851129|     4.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     5.0|\n|green|good|    12|14.386294994851129|     0.0|\n|green| bad|    16|14.386294994851129|     1.0|\n|  red|good|    35|14.386294994851129|     6.0|\n|  red| bad|     1| 38.97187133755819|     2.0|\n|  red| bad|     2|14.386294994851129|     7.0|\n|  red| bad|    16|14.386294994851129|     1.0|\n|  red|good|    45| 38.97187133755819|     3.0|\n|green|good|     1|14.386294994851129|     2.0|\n| blue| bad|     8|14.386294994851129|     4.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     5.0|\n|green|good|    12|14.386294994851129|     0.0|\n|green| bad|    16|14.386294994851129|     1.0|\n|  red|good|    35|14.386294994851129|     6.0|\n|  red| bad|     1| 38.97187133755819|     2.0|\n|  red| bad|     2|14.386294994851129|     7.0|\n+-----+----+------+------------------+--------+\nonly showing top 20 rows\n\nvalIndexer: org.apache.spark.ml.feature.StringIndexer = strIdx_c5bd58c003f1\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649822694,"submitTime":1497649822673,"finishTime":1497649823021,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"32e123d4-318f-4f94-b02e-af4252a13a95"},{"version":"CommandV1","origId":2060825016293807,"guid":"419e96ba-eed8-46b6-a20e-e05a701df911","subtype":"command","commandType":"auto","position":77.0,"command":"valIndexer = StringIndexer()\\\n.setInputCol(\"value1\")\\\n.setOutputCol(\"valueInd\")\nvalIndexer.fit(simpleDF).transform(simpleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+\n|color| lab|value1|            value2|valueInd|\n+-----+----+------+------------------+--------+\n|green|good|     1|14.386294994851129|     2.0|\n| blue| bad|     8|14.386294994851129|     4.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     5.0|\n|green|good|    12|14.386294994851129|     0.0|\n|green| bad|    16|14.386294994851129|     1.0|\n|  red|good|    35|14.386294994851129|     6.0|\n|  red| bad|     1| 38.97187133755819|     2.0|\n|  red| bad|     2|14.386294994851129|     7.0|\n|  red| bad|    16|14.386294994851129|     1.0|\n|  red|good|    45| 38.97187133755819|     3.0|\n|green|good|     1|14.386294994851129|     2.0|\n| blue| bad|     8|14.386294994851129|     4.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     5.0|\n|green|good|    12|14.386294994851129|     0.0|\n|green| bad|    16|14.386294994851129|     1.0|\n|  red|good|    35|14.386294994851129|     6.0|\n|  red| bad|     1| 38.97187133755819|     2.0|\n|  red| bad|     2|14.386294994851129|     7.0|\n+-----+----+------+------------------+--------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649831782,"submitTime":1497649831760,"finishTime":1497649832004,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"64210dff-e150-41eb-8d78-18c3753e3fd4"},{"version":"CommandV1","origId":2060825016293808,"guid":"0dd286b2-1aa3-4a66-9b54-76b1faf1ba65","subtype":"command","commandType":"auto","position":78.0,"command":"%scala\nvalIndexer.setHandleInvalid(\"skip\")\nvalIndexer.fit(simpleDF).setHandleInvalid(\"skip\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res25: org.apache.spark.ml.feature.StringIndexerModel = strIdx_c5bd58c003f1\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;StringIndexerModel&apos; object has no attribute &apos;setHandleInvalid&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-54-b7403ccc1fd6&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> valIndexer<span class=\"ansiyellow\">.</span>setHandleInvalid<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;skip&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>valIndexer<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>simpleDF<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>setHandleInvalid<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;skip&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;StringIndexerModel&apos; object has no attribute &apos;setHandleInvalid&apos;</div>","workflows":[],"startTime":1497649844839,"submitTime":1497649844817,"finishTime":1497649845030,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a498dcb8-79c0-4134-a0c1-baa3fd665a8c"},{"version":"CommandV1","origId":2060825016293809,"guid":"a03b59fc-bedf-4d44-8858-c8ea6da4c8f0","subtype":"command","commandType":"auto","position":79.0,"command":"%scala\nimport org.apache.spark.ml.feature.IndexToString\nval labelReverse = new IndexToString()\n.setInputCol(\"labelInd\")\nlabelReverse.transform(idxRes).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+-----------------------------+\n|color| lab|value1|            value2|labelInd|idxToStr_e85703850d86__output|\n+-----+----+------+------------------+--------+-----------------------------+\n|green|good|     1|14.386294994851129|     1.0|                         good|\n| blue| bad|     8|14.386294994851129|     0.0|                          bad|\n| blue| bad|    12|14.386294994851129|     0.0|                          bad|\n|green|good|    15| 38.97187133755819|     1.0|                         good|\n|green|good|    12|14.386294994851129|     1.0|                         good|\n|green| bad|    16|14.386294994851129|     0.0|                          bad|\n|  red|good|    35|14.386294994851129|     1.0|                         good|\n|  red| bad|     1| 38.97187133755819|     0.0|                          bad|\n|  red| bad|     2|14.386294994851129|     0.0|                          bad|\n|  red| bad|    16|14.386294994851129|     0.0|                          bad|\n|  red|good|    45| 38.97187133755819|     1.0|                         good|\n|green|good|     1|14.386294994851129|     1.0|                         good|\n| blue| bad|     8|14.386294994851129|     0.0|                          bad|\n| blue| bad|    12|14.386294994851129|     0.0|                          bad|\n|green|good|    15| 38.97187133755819|     1.0|                         good|\n|green|good|    12|14.386294994851129|     1.0|                         good|\n|green| bad|    16|14.386294994851129|     0.0|                          bad|\n|  red|good|    35|14.386294994851129|     1.0|                         good|\n|  red| bad|     1| 38.97187133755819|     0.0|                          bad|\n|  red| bad|     2|14.386294994851129|     0.0|                          bad|\n+-----+----+------+------------------+--------+-----------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.IndexToString\nlabelReverse: org.apache.spark.ml.feature.IndexToString = idxToStr_e85703850d86\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649853100,"submitTime":1497649853095,"finishTime":1497649853345,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"701600d0-f508-44a6-ac09-c9fedbcbdfc6"},{"version":"CommandV1","origId":2060825016293810,"guid":"e9bff9d9-5d59-4f33-a7ee-4d3a4a77c7f2","subtype":"command","commandType":"auto","position":80.0,"command":"from pyspark.ml.feature import IndexToString\nlabelReverse = IndexToString()\\\n.setInputCol(\"labelInd\")\nlabelReverse.transform(idxRes).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+------------------------------------------+\n|color| lab|value1|            value2|labelInd|IndexToString_4f968556ec8ec765c189__output|\n+-----+----+------+------------------+--------+------------------------------------------+\n|green|good|     1|14.386294994851129|     1.0|                                      good|\n| blue| bad|     8|14.386294994851129|     0.0|                                       bad|\n| blue| bad|    12|14.386294994851129|     0.0|                                       bad|\n|green|good|    15| 38.97187133755819|     1.0|                                      good|\n|green|good|    12|14.386294994851129|     1.0|                                      good|\n|green| bad|    16|14.386294994851129|     0.0|                                       bad|\n|  red|good|    35|14.386294994851129|     1.0|                                      good|\n|  red| bad|     1| 38.97187133755819|     0.0|                                       bad|\n|  red| bad|     2|14.386294994851129|     0.0|                                       bad|\n|  red| bad|    16|14.386294994851129|     0.0|                                       bad|\n|  red|good|    45| 38.97187133755819|     1.0|                                      good|\n|green|good|     1|14.386294994851129|     1.0|                                      good|\n| blue| bad|     8|14.386294994851129|     0.0|                                       bad|\n| blue| bad|    12|14.386294994851129|     0.0|                                       bad|\n|green|good|    15| 38.97187133755819|     1.0|                                      good|\n|green|good|    12|14.386294994851129|     1.0|                                      good|\n|green| bad|    16|14.386294994851129|     0.0|                                       bad|\n|  red|good|    35|14.386294994851129|     1.0|                                      good|\n|  red| bad|     1| 38.97187133755819|     0.0|                                       bad|\n|  red| bad|     2|14.386294994851129|     0.0|                                       bad|\n+-----+----+------+------------------+--------+------------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649866122,"submitTime":1497649866099,"finishTime":1497649866293,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"98c1210b-e84b-4fed-bcb8-3cab4840cf4c"},{"version":"CommandV1","origId":2060825016293811,"guid":"c7eb8c18-3842-49e3-a7b4-ac4a989acf90","subtype":"command","commandType":"auto","position":81.0,"command":"%scala\nimport org.apache.spark.ml.feature.VectorIndexer\nimport org.apache.spark.ml.linalg.Vectors\nval idxIn = spark.createDataFrame(Seq(\n(Vectors.dense(1, 2, 3),1),\n(Vectors.dense(2, 5, 6),2),\n(Vectors.dense(1, 8, 9),3)\n)).toDF(\"features\", \"label\")\nval indxr = new VectorIndexer()\n.setInputCol(\"features\")\n.setOutputCol(\"idxed\")\n.setMaxCategories(2)\nindxr.fit(idxIn).transform(idxIn).show","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------+-----+-------------+\n|     features|label|        idxed|\n+-------------+-----+-------------+\n|[1.0,2.0,3.0]|    1|[0.0,2.0,3.0]|\n|[2.0,5.0,6.0]|    2|[1.0,5.0,6.0]|\n|[1.0,8.0,9.0]|    3|[0.0,8.0,9.0]|\n+-------------+-----+-------------+\n\nimport org.apache.spark.ml.feature.VectorIndexer\nimport org.apache.spark.ml.linalg.Vectors\nidxIn: org.apache.spark.sql.DataFrame = [features: vector, label: int]\nindxr: org.apache.spark.ml.feature.VectorIndexer = vecIdx_5465f9b5c0f6\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649878199,"submitTime":1497649878177,"finishTime":1497649878813,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c4a64fcc-cf36-41dd-bbfe-e525307ae456"},{"version":"CommandV1","origId":2060825016293812,"guid":"3b2215f3-1030-49e9-b09d-6deeef9dd4dc","subtype":"command","commandType":"auto","position":82.0,"command":"from pyspark.ml.feature import VectorIndexer\nfrom pyspark.ml.linalg import Vectors\nidxIn = spark.createDataFrame([\n(Vectors.dense(1, 2, 3),1),\n(Vectors.dense(2, 5, 6),2),\n(Vectors.dense(1, 8, 9),3)\n]).toDF(\"features\", \"label\")\nindxr = VectorIndexer()\\\n.setInputCol(\"features\")\\\n.setOutputCol(\"idxed\")\\\n.setMaxCategories(2)\nindxr.fit(idxIn).transform(idxIn).show","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">56</span><span class=\"ansired\">]: </span>&lt;bound method DataFrame.show of DataFrame[features: vector, label: bigint, idxed: vector]&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649885863,"submitTime":1497649885837,"finishTime":1497649886303,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"663381c0-2ded-4605-a07d-c3bdbbd806de"},{"version":"CommandV1","origId":2060825016293813,"guid":"7aa5cfc0-f14d-4f68-b657-2b36f7044147","subtype":"command","commandType":"auto","position":83.0,"command":"%scala\nval labelIndexer = new StringIndexer()\n.setInputCol(\"color\")\n.setOutputCol(\"colorInd\")\nval colorLab = labelIndexer.fit(simpleDF).transform(simpleDF)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">labelIndexer: org.apache.spark.ml.feature.StringIndexer = strIdx_53b35feb23b4\ncolorLab: org.apache.spark.sql.DataFrame = [color: string, lab: string ... 3 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649894135,"submitTime":1497649894113,"finishTime":1497649894454,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6fa296f9-8541-4c8f-8c69-51f1a7c293e6"},{"version":"CommandV1","origId":2060825016293814,"guid":"b57a5640-24ea-4a3c-b028-18e2402718e5","subtype":"command","commandType":"auto","position":84.0,"command":"labelIndexer = StringIndexer()\\\n.setInputCol(\"color\")\\\n.setOutputCol(\"colorInd\")\ncolorLab = labelIndexer.fit(simpleDF).transform(simpleDF)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649901357,"submitTime":1497649901333,"finishTime":1497649901579,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dd13b727-6847-4915-aea0-cf3bb9baa30c"},{"version":"CommandV1","origId":2060825016293815,"guid":"8f523143-ce6f-4734-b2ed-e0c2119ec6e5","subtype":"command","commandType":"auto","position":85.0,"command":"%scala\nimport org.apache.spark.ml.feature.OneHotEncoder\nval ohe = new OneHotEncoder()\n.setInputCol(\"colorInd\")\nohe.transform(colorLab).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+---------------------------+\n|color| lab|value1|            value2|colorInd|oneHot_e5badae0c2f5__output|\n+-----+----+------+------------------+--------+---------------------------+\n|green|good|     1|14.386294994851129|     1.0|              (2,[1],[1.0])|\n| blue| bad|     8|14.386294994851129|     2.0|                  (2,[],[])|\n| blue| bad|    12|14.386294994851129|     2.0|                  (2,[],[])|\n|green|good|    15| 38.97187133755819|     1.0|              (2,[1],[1.0])|\n|green|good|    12|14.386294994851129|     1.0|              (2,[1],[1.0])|\n|green| bad|    16|14.386294994851129|     1.0|              (2,[1],[1.0])|\n|  red|good|    35|14.386294994851129|     0.0|              (2,[0],[1.0])|\n|  red| bad|     1| 38.97187133755819|     0.0|              (2,[0],[1.0])|\n|  red| bad|     2|14.386294994851129|     0.0|              (2,[0],[1.0])|\n|  red| bad|    16|14.386294994851129|     0.0|              (2,[0],[1.0])|\n|  red|good|    45| 38.97187133755819|     0.0|              (2,[0],[1.0])|\n|green|good|     1|14.386294994851129|     1.0|              (2,[1],[1.0])|\n| blue| bad|     8|14.386294994851129|     2.0|                  (2,[],[])|\n| blue| bad|    12|14.386294994851129|     2.0|                  (2,[],[])|\n|green|good|    15| 38.97187133755819|     1.0|              (2,[1],[1.0])|\n|green|good|    12|14.386294994851129|     1.0|              (2,[1],[1.0])|\n|green| bad|    16|14.386294994851129|     1.0|              (2,[1],[1.0])|\n|  red|good|    35|14.386294994851129|     0.0|              (2,[0],[1.0])|\n|  red| bad|     1| 38.97187133755819|     0.0|              (2,[0],[1.0])|\n|  red| bad|     2|14.386294994851129|     0.0|              (2,[0],[1.0])|\n+-----+----+------+------------------+--------+---------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.OneHotEncoder\nohe: org.apache.spark.ml.feature.OneHotEncoder = oneHot_e5badae0c2f5\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649909799,"submitTime":1497649909777,"finishTime":1497649910052,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d07b7507-3199-4800-a2c7-10e00f9e559a"},{"version":"CommandV1","origId":2060825016293816,"guid":"b61dd107-ef4c-4e68-bd03-c84e251f14fa","subtype":"command","commandType":"auto","position":86.0,"command":"from pyspark.ml.feature import OneHotEncoder\nohe = OneHotEncoder()\\\n.setInputCol(\"colorInd\")\nohe.transform(colorLab).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+------------------------------------------+\n|color| lab|value1|            value2|colorInd|OneHotEncoder_4de4954b9f3740d09d20__output|\n+-----+----+------+------------------+--------+------------------------------------------+\n|green|good|     1|14.386294994851129|     1.0|                             (2,[1],[1.0])|\n| blue| bad|     8|14.386294994851129|     2.0|                                 (2,[],[])|\n| blue| bad|    12|14.386294994851129|     2.0|                                 (2,[],[])|\n|green|good|    15| 38.97187133755819|     1.0|                             (2,[1],[1.0])|\n|green|good|    12|14.386294994851129|     1.0|                             (2,[1],[1.0])|\n|green| bad|    16|14.386294994851129|     1.0|                             (2,[1],[1.0])|\n|  red|good|    35|14.386294994851129|     0.0|                             (2,[0],[1.0])|\n|  red| bad|     1| 38.97187133755819|     0.0|                             (2,[0],[1.0])|\n|  red| bad|     2|14.386294994851129|     0.0|                             (2,[0],[1.0])|\n|  red| bad|    16|14.386294994851129|     0.0|                             (2,[0],[1.0])|\n|  red|good|    45| 38.97187133755819|     0.0|                             (2,[0],[1.0])|\n|green|good|     1|14.386294994851129|     1.0|                             (2,[1],[1.0])|\n| blue| bad|     8|14.386294994851129|     2.0|                                 (2,[],[])|\n| blue| bad|    12|14.386294994851129|     2.0|                                 (2,[],[])|\n|green|good|    15| 38.97187133755819|     1.0|                             (2,[1],[1.0])|\n|green|good|    12|14.386294994851129|     1.0|                             (2,[1],[1.0])|\n|green| bad|    16|14.386294994851129|     1.0|                             (2,[1],[1.0])|\n|  red|good|    35|14.386294994851129|     0.0|                             (2,[0],[1.0])|\n|  red| bad|     1| 38.97187133755819|     0.0|                             (2,[0],[1.0])|\n|  red| bad|     2|14.386294994851129|     0.0|                             (2,[0],[1.0])|\n+-----+----+------+------------------+--------+------------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649917297,"submitTime":1497649917272,"finishTime":1497649917568,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"93e3a010-0d3f-4948-86ba-efa3d98399c6"},{"version":"CommandV1","origId":2060825016293817,"guid":"026a6cd4-ae8d-4e1d-91ab-6152d738f337","subtype":"command","commandType":"auto","position":87.0,"command":"%scala\nimport org.apache.spark.ml.feature.PCA\nval pca = new PCA()\n.setInputCol(\"features\")\n.setK(2)\npca.fit(scaleDF).transform(scaleDF).show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+------------------------------------------+\n|id |features      |pca_53ad92a3a4e1__output                  |\n+---+--------------+------------------------------------------+\n|0  |[1.0,0.1,-1.0]|[0.0713719499248418,-0.4526654888147822]  |\n|1  |[2.0,1.1,1.0] |[-1.680494698407372,1.259340132221917]    |\n|0  |[1.0,0.1,-1.0]|[0.0713719499248418,-0.4526654888147822]  |\n|1  |[2.0,1.1,1.0] |[-1.680494698407372,1.259340132221917]    |\n|1  |[3.0,10.1,3.0]|[-10.872398139848944,0.030962697060150646]|\n+---+--------------+------------------------------------------+\n\nimport org.apache.spark.ml.feature.PCA\npca: org.apache.spark.ml.feature.PCA = pca_53ad92a3a4e1\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649930356,"submitTime":1497649930332,"finishTime":1497649931627,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7d91f35a-4286-45fd-96ce-0648de6a923c"},{"version":"CommandV1","origId":2060825016293818,"guid":"81aa5c0d-6abd-43ba-90bf-5ab00a4801ce","subtype":"command","commandType":"auto","position":88.0,"command":"from pyspark.ml.feature import PCA\npca = PCA()\\\n.setInputCol(\"features\")\\\n.setK(2)\npca.fit(scaleDF).transform(scaleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+--------------------------------+\n| id|      features|PCA_4ce2aaf8e81a35e49b0d__output|\n+---+--------------+--------------------------------+\n|  0|[1.0,0.1,-1.0]|            [0.07137194992484...|\n|  1| [2.0,1.1,1.0]|            [-1.6804946984073...|\n|  0|[1.0,0.1,-1.0]|            [0.07137194992484...|\n|  1| [2.0,1.1,1.0]|            [-1.6804946984073...|\n|  1|[3.0,10.1,3.0]|            [-10.872398139848...|\n+---+--------------+--------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649939284,"submitTime":1497649939261,"finishTime":1497649940110,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7d931872-a0de-42f4-89cc-c0199c66b75d"},{"version":"CommandV1","origId":2060825016293819,"guid":"4384ccab-9f9c-4b22-ab5e-f8141c181b99","subtype":"command","commandType":"auto","position":89.0,"command":"%scala\nimport org.apache.spark.ml.feature.PolynomialExpansion\nval pe = new PolynomialExpansion()\n.setInputCol(\"features\")\n.setDegree(2)\npe.transform(scaleDF).show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+-----------------------------------------------------------------------------------+\n|id |features      |poly_576e79fc8443__output                                                          |\n+---+--------------+-----------------------------------------------------------------------------------+\n|0  |[1.0,0.1,-1.0]|[1.0,1.0,0.1,0.1,0.010000000000000002,-1.0,-1.0,-0.1,1.0]                          |\n|1  |[2.0,1.1,1.0] |[2.0,4.0,1.1,2.2,1.2100000000000002,1.0,2.0,1.1,1.0]                               |\n|0  |[1.0,0.1,-1.0]|[1.0,1.0,0.1,0.1,0.010000000000000002,-1.0,-1.0,-0.1,1.0]                          |\n|1  |[2.0,1.1,1.0] |[2.0,4.0,1.1,2.2,1.2100000000000002,1.0,2.0,1.1,1.0]                               |\n|1  |[3.0,10.1,3.0]|[3.0,9.0,10.1,30.299999999999997,102.00999999999999,3.0,9.0,30.299999999999997,9.0]|\n+---+--------------+-----------------------------------------------------------------------------------+\n\nimport org.apache.spark.ml.feature.PolynomialExpansion\npe: org.apache.spark.ml.feature.PolynomialExpansion = poly_576e79fc8443\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649946923,"submitTime":1497649946900,"finishTime":1497649947201,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f1ad094b-b637-4397-937c-7407b8ccca3a"},{"version":"CommandV1","origId":2060825016293820,"guid":"70b72dfc-c24c-478e-8b8f-7e31552f9936","subtype":"command","commandType":"auto","position":90.0,"command":"from pyspark.ml.feature import PolynomialExpansion\npe = PolynomialExpansion()\\\n.setInputCol(\"features\")\\\n.setDegree(2)\npe.transform(scaleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+------------------------------------------------+\n| id|      features|PolynomialExpansion_4056a002eb860b65f147__output|\n+---+--------------+------------------------------------------------+\n|  0|[1.0,0.1,-1.0]|                            [1.0,1.0,0.1,0.1,...|\n|  1| [2.0,1.1,1.0]|                            [2.0,4.0,1.1,2.2,...|\n|  0|[1.0,0.1,-1.0]|                            [1.0,1.0,0.1,0.1,...|\n|  1| [2.0,1.1,1.0]|                            [2.0,4.0,1.1,2.2,...|\n|  1|[3.0,10.1,3.0]|                            [3.0,9.0,10.1,30....|\n+---+--------------+------------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649953426,"submitTime":1497649953402,"finishTime":1497649953648,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"977ebae7-bc8a-4124-86a6-867be1678f15"},{"version":"CommandV1","origId":2060825016293821,"guid":"313e9fd7-90ce-45c1-95ea-d966fa85a77b","subtype":"command","commandType":"auto","position":91.0,"command":"%scala\nimport org.apache.spark.ml.feature.ChiSqSelector\nval prechi = fittedCV.transform(tokenized)\n.where(\"CustomerId IS NOT NULL\")\nval chisq = new ChiSqSelector()\n.setFeaturesCol(\"countVec\")\n.setLabelCol(\"CustomerID\")\n.setNumTopFeatures(2)\nchisq.fit(prechi).transform(prechi).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+----------------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|            countVec|chiSqSelector_965fc09624b6__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+----------------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|(500,[4,15,19,21,...|                         (2,[],[])|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|(500,[14,15,208],...|                         (2,[],[])|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|(500,[57,98,222,2...|                         (2,[],[])|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|(500,[34,39,40,89...|                         (2,[],[])|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|(500,[3,15],[1.0,...|                         (2,[],[])|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|(500,[0,160,163],...|                     (2,[0],[1.0])|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|(500,[21,23,31,84...|                         (2,[],[])|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|(500,[89,101,112,...|                         (2,[],[])|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|(500,[3,101,112],...|                         (2,[],[])|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|(500,[62,79,87,30...|                         (2,[],[])|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|(500,[317,318],[1...|                         (2,[],[])|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|(500,[145,317,318...|                         (2,[],[])|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|(500,[64,77,221,3...|                         (2,[],[])|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|(500,[54,55,348],...|                         (2,[],[])|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|(500,[1,10,27,62,...|                     (2,[1],[1.0])|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,274]...|                     (2,[1],[1.0])|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,132]...|                     (2,[1],[1.0])|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|(500,[44,217,258,...|                         (2,[],[])|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|(500,[59,217,258,...|                         (2,[],[])|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|(500,[4,10,14,41,...|                         (2,[],[])|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+----------------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.ChiSqSelector\nprechi: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [InvoiceNo: string, StockCode: string ... 8 more fields]\nchisq: org.apache.spark.ml.feature.ChiSqSelector = chiSqSelector_965fc09624b6\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497649960953,"submitTime":1497649960928,"finishTime":1497650080278,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"720210d4-b25a-443f-aeef-41d9fe78db06"},{"version":"CommandV1","origId":2060825016293822,"guid":"1bc11197-c67f-4674-bb05-6c4b37bb07d5","subtype":"command","commandType":"auto","position":92.0,"command":"from pyspark.ml.feature import ChiSqSelector\nprechi = fittedCV.transform(tokenized)\\\n.where(\"CustomerId IS NOT NULL\")\nchisq = ChiSqSelector()\\\n.setFeaturesCol(\"countVec\")\\\n.setLabelCol(\"CustomerID\")\\\n.setNumTopFeatures(2)\nchisq.fit(prechi).transform(prechi).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+------------------------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|            countVec|ChiSqSelector_4be4806a936f16ad8a9d__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+------------------------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|(500,[4,15,19,21,...|                                 (2,[],[])|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|(500,[14,15,208],...|                                 (2,[],[])|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|(500,[57,98,222,2...|                                 (2,[],[])|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|(500,[34,39,40,89...|                                 (2,[],[])|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|(500,[3,15],[1.0,...|                                 (2,[],[])|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|(500,[0,160,163],...|                             (2,[0],[1.0])|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|(500,[21,23,31,84...|                                 (2,[],[])|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|(500,[89,101,112,...|                                 (2,[],[])|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|(500,[3,101,112],...|                                 (2,[],[])|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|(500,[62,79,87,30...|                                 (2,[],[])|\n|   536367|    22745|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|(500,[317,318],[1...|                                 (2,[],[])|\n|   536367|    22748|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|(500,[145,317,318...|                                 (2,[],[])|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|(500,[64,77,221,3...|                                 (2,[],[])|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|(500,[54,55,348],...|                                 (2,[],[])|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|(500,[1,10,27,62,...|                             (2,[1],[1.0])|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,274]...|                             (2,[1],[1.0])|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,132]...|                             (2,[1],[1.0])|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|(500,[44,217,258,...|                                 (2,[],[])|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|(500,[59,217,258,...|                                 (2,[],[])|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|(500,[4,10,14,41,...|                                 (2,[],[])|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+------------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650080293,"submitTime":1497649967647,"finishTime":1497650196422,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3acac4cf-01df-4a3d-97b1-22906f377da7"},{"version":"CommandV1","origId":2060825016293823,"guid":"be10fa32-99fd-4027-8016-6f0fbd9701ce","subtype":"command","commandType":"auto","position":93.0,"command":"%scala\nval fittedPCA = pca.fit(scaleDF)\nfittedPCA.write.overwrite().save(\"/tmp/fittedPCA\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">fittedPCA: org.apache.spark.ml.feature.PCAModel = pca_53ad92a3a4e1\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650196428,"submitTime":1497649977044,"finishTime":1497650199884,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0da15b54-4baf-4a5c-aed6-2caea9ebc114"},{"version":"CommandV1","origId":2060825016293824,"guid":"1bae1316-5bb6-4256-85d4-dabd1d8e3a65","subtype":"command","commandType":"auto","position":94.0,"command":"%scala\nval loadedPCA = PCA.load(\"/tmp/fittedPCA\")\nloadedPCA.transform(scaleDF).show()","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:88: error: value transform is not a member of org.apache.spark.ml.feature.PCA\n              loadedPCA.transform(scaleDF).show()\n                        ^\n</div>","error":null,"workflows":[],"startTime":1497650241169,"submitTime":1497650241169,"finishTime":1497650241242,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a2f0c3a0-c220-44db-a94d-fa320fc29585"},{"version":"CommandV1","origId":2060825016293825,"guid":"8e6e53b9-87ab-434c-b23d-503a78c49756","subtype":"command","commandType":"auto","position":95.0,"command":"%scala\nimport org.apache.spark.ml.UnaryTransformer\nimport org.apache.spark.ml.util.{DefaultParamsReadable, DefaultParamsWritable, Identifiable}\nimport org.apache.spark.sql.types.{ArrayType, StringType, DataType}\nimport org.apache.spark.ml.param.{IntParam, ParamValidators}\nclass MyTokenizer(override val uid: String)\nextends UnaryTransformer[String, Seq[String], MyTokenizer] with DefaultParamsWritable {\ndef this() = this(Identifiable.randomUID(\"myTokenizer\"))\nval maxWords: IntParam = new IntParam(this, \"maxWords\", \"The max number of words to return.\",\nParamValidators.gtEq(0))\ndef setMaxWords(value: Int): this.type = set(maxWords, value)\ndef getMaxWords: Integer = $(maxWords)\noverride protected def createTransformFunc: String => Seq[String] = (inputString: String) => {\ninputString.split(\"\\\\s\").take($(maxWords))\n}\noverride protected def validateInputType(inputType: DataType): Unit = {\nrequire(inputType == StringType, s\"Bad input type: $inputType. Requires String.\")\n}\noverride protected def outputDataType: DataType = new ArrayType(StringType, true)\n}\n// this will allow you to read it back in by using this object.\nobject MyTokenizer extends DefaultParamsReadable[MyTokenizer]\nval myT = new MyTokenizer()\n.setInputCol(\"someCol\")\n.setMaxWords(2)\ndisplay(myT.transform(Seq(\"hello world. This text won't show.\").toDF(\"someCol\")))\nmyT.write.overwrite().save(\"/tmp/something\")","commandVersion":0,"state":"finished","results":{"type":"table","data":[["hello world. This text won't show.",["hello","world."]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"someCol","type":"\"string\"","metadata":"{}"},{"name":"myTokenizer_13772ec0f1ab__output","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650199933,"submitTime":1497650012608,"finishTime":1497650200971,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"de559dc3-9d60-44bf-908a-ec0229eeb138"},{"version":"CommandV1","origId":2060825016293826,"guid":"2d00de4e-ff7c-4568-9b7c-ad23b3977705","subtype":"command","commandType":"auto","position":96.0,"command":"%scala\nval sales = spark.read.format(\"csv\")\n.option(\"header\", \"true\")\n.option(\"inferSchema\", \"true\")\n.load(\"/FileStore/tables/1x42p66f1497639007910/*.csv\")\n.coalesce(5)\n.where(\"Description IS NOT NULL\")\nval fakeIntDF = spark.read.parquet(\"/FileStore/tables/w90rmm721497649161288/part_00000_ce2a44c8_feb4_4369_a2c3_4bf2f0e63b07_c000_gz-d65b9.parquet\")\nvar simpleDF = spark.read.json(\"/FileStore/tables/ixxwee3q1497648769294/part_r_00000_f5c243b9_a015_4a3b_a4a8_eca00f80f04c-a8b89.json\")\nval scaleDF = spark.read.parquet(\"/FileStore/tables/48se0cwp1497649233518/part_00000_cd03406a_cc9b_42b0_9299_1e259fdd9382_c000_gz-2e0be.parquet\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">sales: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [InvoiceNo: string, StockCode: string ... 6 more fields]\nfakeIntDF: org.apache.spark.sql.DataFrame = [int1: int, int2: int ... 1 more field]\nsimpleDF: org.apache.spark.sql.DataFrame = [color: string, lab: string ... 2 more fields]\nscaleDF: org.apache.spark.sql.DataFrame = [id: int, features: vector]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650200976,"submitTime":1497650163116,"finishTime":1497650202807,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9d1c9930-cd45-4664-94ad-e253b623b0bf"},{"version":"CommandV1","origId":2060825016293827,"guid":"29b27f3f-dbbc-4f87-a99f-b9ec4e8a1c96","subtype":"command","commandType":"auto","position":97.0,"command":"sales = spark.read.format(\"csv\")\\\n.option(\"header\", \"true\")\\\n.option(\"inferSchema\", \"true\")\\\n.load(\"/FileStore/tables/1x42p66f1497639007910/*.csv\")\\\n.coalesce(5)\\\n.where(\"Description IS NOT NULL\")\nfakeIntDF = spark.read.parquet(\"/FileStore/tables/w90rmm721497649161288/part_00000_ce2a44c8_feb4_4369_a2c3_4bf2f0e63b07_c000_gz-d65b9.parquet\")\nsimpleDF = spark.read.json(\"/FileStore/tables/ixxwee3q1497648769294/part_r_00000_f5c243b9_a015_4a3b_a4a8_eca00f80f04c-a8b89.json\")\nscaleDF = spark.read.parquet(\"/FileStore/tables/48se0cwp1497649233518/part_00000_cd03406a_cc9b_42b0_9299_1e259fdd9382_c000_gz-2e0be.parquet\")\nsales.cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">62</span><span class=\"ansired\">]: </span>DataFrame[InvoiceNo: string, StockCode: string, Description: string, Quantity: int, InvoiceDate: string, UnitPrice: double, CustomerID: int, Country: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650202811,"submitTime":1497650163955,"finishTime":1497650204723,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"49bff77d-339a-4250-8004-ad409be1e08d"},{"version":"CommandV1","origId":2060825016293828,"guid":"05d375f1-1803-4011-af56-53aa6b38d614","subtype":"command","commandType":"auto","position":98.0,"command":"%scala\nimport org.apache.spark.ml.feature.Tokenizer\nval tkn = new Tokenizer().setInputCol(\"Description\")\ntkn.transform(sales).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|tok_7c0b435e63ee__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|    [white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|    [white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|    [cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|    [knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|    [red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|    [set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|    [glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|    [hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|    [hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|    [assorted, colour...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|    [poppy's, playhou...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|    [poppy's, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|    [feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|    [ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|    [box, of, 6, asso...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|    [box, of, vintage...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|    [box, of, vintage...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|    [home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|    [love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|    [recipe, box, wit...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.Tokenizer\ntkn: org.apache.spark.ml.feature.Tokenizer = tok_7c0b435e63ee\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650204726,"submitTime":1497650175814,"finishTime":1497650205936,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"47676a9b-6caa-4cb1-a3b5-04e13145409f"},{"version":"CommandV1","origId":2060825016293829,"guid":"e01bbbd7-7604-44e2-9bcd-294f037767bf","subtype":"command","commandType":"auto","position":99.0,"command":"%scala\nimport org.apache.spark.ml.feature.StandardScaler\nval ss = new StandardScaler().setInputCol(\"features\")\nss.fit(scaleDF).transform(scaleDF).show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+------------------------------------------------------------+\n|id |features      |stdScal_d6bedc184197__output                                |\n+---+--------------+------------------------------------------------------------+\n|0  |[1.0,0.1,-1.0]|[1.1952286093343936,0.02337622911060922,-0.5976143046671968]|\n|1  |[2.0,1.1,1.0] |[2.390457218668787,0.2571385202167014,0.5976143046671968]   |\n|0  |[1.0,0.1,-1.0]|[1.1952286093343936,0.02337622911060922,-0.5976143046671968]|\n|1  |[2.0,1.1,1.0] |[2.390457218668787,0.2571385202167014,0.5976143046671968]   |\n|1  |[3.0,10.1,3.0]|[3.5856858280031805,2.3609991401715313,1.7928429140015902]  |\n+---+--------------+------------------------------------------------------------+\n\nimport org.apache.spark.ml.feature.StandardScaler\nss: org.apache.spark.ml.feature.StandardScaler = stdScal_d6bedc184197\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650205939,"submitTime":1497650185235,"finishTime":1497650206348,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"938a8441-d7a5-4f24-b10b-912627fea886"},{"version":"CommandV1","origId":2060825016293830,"guid":"17bdca59-7901-4a08-9313-5954fb7fdb3c","subtype":"command","commandType":"auto","position":100.0,"command":"%scala\nimport org.apache.spark.ml.feature.RFormula\nval supervised = new RFormula()\n.setFormula(\"lab ~ . + color:value1 + color:value2\")\nsupervised.fit(simpleDF).transform(simpleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------------------+-----+\n|color| lab|value1|            value2|            features|label|\n+-----+----+------+------------------+--------------------+-----+\n|green|good|     1|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n| blue| bad|     8|14.386294994851129|(10,[2,3,6,9],[8....|  0.0|\n| blue| bad|    12|14.386294994851129|(10,[2,3,6,9],[12...|  0.0|\n|green|good|    15| 38.97187133755819|(10,[1,2,3,5,8],[...|  1.0|\n|green|good|    12|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n|green| bad|    16|14.386294994851129|(10,[1,2,3,5,8],[...|  0.0|\n|  red|good|    35|14.386294994851129|(10,[0,2,3,4,7],[...|  1.0|\n|  red| bad|     1| 38.97187133755819|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|     2|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|    16|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n|  red|good|    45| 38.97187133755819|(10,[0,2,3,4,7],[...|  1.0|\n|green|good|     1|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n| blue| bad|     8|14.386294994851129|(10,[2,3,6,9],[8....|  0.0|\n| blue| bad|    12|14.386294994851129|(10,[2,3,6,9],[12...|  0.0|\n|green|good|    15| 38.97187133755819|(10,[1,2,3,5,8],[...|  1.0|\n|green|good|    12|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n|green| bad|    16|14.386294994851129|(10,[1,2,3,5,8],[...|  0.0|\n|  red|good|    35|14.386294994851129|(10,[0,2,3,4,7],[...|  1.0|\n|  red| bad|     1| 38.97187133755819|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|     2|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n+-----+----+------+------------------+--------------------+-----+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.RFormula\nsupervised: org.apache.spark.ml.feature.RFormula = RFormula(lab ~ . + color:value1 + color:value2) (uid=rFormula_feafe9904754)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650206352,"submitTime":1497650194398,"finishTime":1497650207025,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"49d48893-e309-4d38-9f84-0930dd0535b8"},{"version":"CommandV1","origId":2060825016293831,"guid":"fba43cf8-c055-44ac-8167-9f32e010df83","subtype":"command","commandType":"auto","position":101.0,"command":"from pyspark.ml.feature import RFormula\nsupervised = RFormula()\\\n.setFormula(\"lab ~ . + color:value1 + color:value2\")\nsupervised.fit(simpleDF).transform(simpleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------------------+-----+\n|color| lab|value1|            value2|            features|label|\n+-----+----+------+------------------+--------------------+-----+\n|green|good|     1|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n| blue| bad|     8|14.386294994851129|(10,[2,3,6,9],[8....|  0.0|\n| blue| bad|    12|14.386294994851129|(10,[2,3,6,9],[12...|  0.0|\n|green|good|    15| 38.97187133755819|(10,[1,2,3,5,8],[...|  1.0|\n|green|good|    12|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n|green| bad|    16|14.386294994851129|(10,[1,2,3,5,8],[...|  0.0|\n|  red|good|    35|14.386294994851129|(10,[0,2,3,4,7],[...|  1.0|\n|  red| bad|     1| 38.97187133755819|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|     2|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|    16|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n|  red|good|    45| 38.97187133755819|(10,[0,2,3,4,7],[...|  1.0|\n|green|good|     1|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n| blue| bad|     8|14.386294994851129|(10,[2,3,6,9],[8....|  0.0|\n| blue| bad|    12|14.386294994851129|(10,[2,3,6,9],[12...|  0.0|\n|green|good|    15| 38.97187133755819|(10,[1,2,3,5,8],[...|  1.0|\n|green|good|    12|14.386294994851129|(10,[1,2,3,5,8],[...|  1.0|\n|green| bad|    16|14.386294994851129|(10,[1,2,3,5,8],[...|  0.0|\n|  red|good|    35|14.386294994851129|(10,[0,2,3,4,7],[...|  1.0|\n|  red| bad|     1| 38.97187133755819|(10,[0,2,3,4,7],[...|  0.0|\n|  red| bad|     2|14.386294994851129|(10,[0,2,3,4,7],[...|  0.0|\n+-----+----+------+------------------+--------------------+-----+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650207034,"submitTime":1497650204418,"finishTime":1497650207509,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"889521e0-fbc0-443c-b583-52e9aec3a663"},{"version":"CommandV1","origId":2060825016293832,"guid":"6809c1c0-c725-44ed-b3a6-d6971a445895","subtype":"command","commandType":"auto","position":102.0,"command":"%scala\nimport org.apache.spark.ml.feature.SQLTransformer\nval basicTransformation = new SQLTransformer()\n.setStatement(\"\"\"\nSELECT sum(Quantity), count(*), CustomerID\nFROM __THIS__\nGROUP BY CustomerID\n\"\"\")\nbasicTransformation.transform(sales).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------+--------+----------+\n|sum(Quantity)|count(1)|CustomerID|\n+-------------+--------+----------+\n|          265|      30|     17420|\n|          133|       8|     16861|\n|          567|      86|     16503|\n|         3065|     302|     15727|\n|         7430|     224|     17389|\n|           85|       9|     15447|\n|          241|      40|     14450|\n|          286|      86|     13623|\n|         2051|     187|     13285|\n|           23|      20|     16339|\n|           95|      29|     14570|\n|          224|      88|     16386|\n|          148|      22|     18024|\n|          406|     103|     12940|\n|          729|      30|     17679|\n|          416|      28|     16574|\n|          211|      42|     15957|\n|           25|       4|     13832|\n|          136|       3|     15619|\n|          114|      35|     15790|\n+-------------+--------+----------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.SQLTransformer\nbasicTransformation: org.apache.spark.ml.feature.SQLTransformer = sql_e686208b2566\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650346073,"submitTime":1497650346066,"finishTime":1497650347274,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"25d879ae-b626-4c5b-8b84-fc4aed65bb72"},{"version":"CommandV1","origId":2060825016293833,"guid":"752a263a-d46c-4d8d-a6ab-c29944e37f1e","subtype":"command","commandType":"auto","position":103.0,"command":"from pyspark.ml.feature import SQLTransformer\nbasicTransformation = SQLTransformer()\\\n.setStatement(\"\"\"\nSELECT sum(Quantity), count(*), CustomerID\nFROM __THIS__\nGROUP BY CustomerID\n\"\"\")\nbasicTransformation.transform(sales).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------+--------+----------+\n|sum(Quantity)|count(1)|CustomerID|\n+-------------+--------+----------+\n|          265|      30|     17420|\n|          133|       8|     16861|\n|          567|      86|     16503|\n|         3065|     302|     15727|\n|         7430|     224|     17389|\n|           85|       9|     15447|\n|          241|      40|     14450|\n|          286|      86|     13623|\n|         2051|     187|     13285|\n|           23|      20|     16339|\n|           95|      29|     14570|\n|          224|      88|     16386|\n|          148|      22|     18024|\n|          406|     103|     12940|\n|          729|      30|     17679|\n|          416|      28|     16574|\n|          211|      42|     15957|\n|           25|       4|     13832|\n|          136|       3|     15619|\n|          114|      35|     15790|\n+-------------+--------+----------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650353970,"submitTime":1497650353943,"finishTime":1497650355079,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"791039a4-f816-4b13-ad2d-1d3833b82136"},{"version":"CommandV1","origId":2060825016293834,"guid":"5e09521c-7d02-41e5-90dd-b865a42aea4c","subtype":"command","commandType":"auto","position":104.0,"command":"%scala\nimport org.apache.spark.ml.feature.VectorAssembler\nval va = new VectorAssembler()\n.setInputCols(Array(\"int1\", \"int2\", \"int3\"))\nva.transform(fakeIntDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+----+----+---------------------------------+\n|int1|int2|int3|vecAssembler_34ebd06b4d2f__output|\n+----+----+----+---------------------------------+\n|   1|   2|   3|                    [1.0,2.0,3.0]|\n+----+----+----+---------------------------------+\n\nimport org.apache.spark.ml.feature.VectorAssembler\nva: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_34ebd06b4d2f\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650365309,"submitTime":1497650365282,"finishTime":1497650365756,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1f320ed3-603a-4483-ac29-d4ca97a97fce"},{"version":"CommandV1","origId":2060825016293835,"guid":"05e078dc-01e6-4ef2-909e-814f1df00d4d","subtype":"command","commandType":"auto","position":105.0,"command":"from pyspark.ml.feature import VectorAssembler\nva = VectorAssembler().setInputCols([\"int1\", \"int2\", \"int3\"])\nva.transform(fakeIntDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+----+----+--------------------------------------------+\n|int1|int2|int3|VectorAssembler_4b24b8eb4b86c3e9bac3__output|\n+----+----+----+--------------------------------------------+\n|   1|   2|   3|                               [1.0,2.0,3.0]|\n+----+----+----+--------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650371529,"submitTime":1497650371502,"finishTime":1497650371800,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fb3a47fb-e416-47de-a061-0776579ad135"},{"version":"CommandV1","origId":2060825016293836,"guid":"05344c1b-a08b-4510-988e-a9643e480296","subtype":"command","commandType":"auto","position":106.0,"command":"%scala\nimport org.apache.spark.ml.feature.Tokenizer\nval tkn = new Tokenizer()\n.setInputCol(\"Description\")\n.setOutputCol(\"DescriptionOut\")\nval tokenized = tkn.transform(sales)\ntokenized.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.Tokenizer\ntkn: org.apache.spark.ml.feature.Tokenizer = tok_6767d5fe178c\ntokenized: org.apache.spark.sql.DataFrame = [InvoiceNo: string, StockCode: string ... 7 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650382244,"submitTime":1497650382216,"finishTime":1497650382552,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fb273618-e0cd-4443-8427-a9370e7363d3"},{"version":"CommandV1","origId":2060825016293837,"guid":"933e3b48-fcd9-4230-8b3c-35c928330916","subtype":"command","commandType":"auto","position":107.0,"command":"from pyspark.ml.feature import Tokenizer\ntkn = Tokenizer()\\\n.setInputCol(\"Description\")\\\n.setOutputCol(\"DescriptionOut\")\ntokenized = tkn.transform(sales)\ntokenized.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|\n|   536367|    22745|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|\n|   536367|    22748|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650388008,"submitTime":1497650387981,"finishTime":1497650388280,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ff246c0d-7096-4f1a-b1cb-05cd35ff0a76"},{"version":"CommandV1","origId":2060825016293838,"guid":"0dcc609b-bf35-49bf-9912-e5577d3ac457","subtype":"command","commandType":"auto","position":108.0,"command":"%scala\nimport org.apache.spark.ml.feature.RegexTokenizer\nval rt = new RegexTokenizer()\n.setInputCol(\"Description\")\n.setOutputCol(\"DescriptionOut\")\n.setPattern(\" \") // starting simple\n.setToLowercase(true)\nrt.transform(sales).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.RegexTokenizer\nrt: org.apache.spark.ml.feature.RegexTokenizer = regexTok_ff233d9c218f\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650395404,"submitTime":1497650395376,"finishTime":1497650395680,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5f14b2c4-9328-47c4-b606-604fbe8e3075"},{"version":"CommandV1","origId":2060825016293839,"guid":"d9381918-5ddf-44e3-8269-d59515084aeb","subtype":"command","commandType":"auto","position":109.0,"command":"from pyspark.ml.feature import RegexTokenizer\nrt = RegexTokenizer()\\\n.setInputCol(\"Description\")\\\n.setOutputCol(\"DescriptionOut\")\\\n.setPattern(\" \")\\\n.setToLowercase(True)\nrt.transform(sales).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|\n|   536367|    22745|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|\n|   536367|    22748|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650402768,"submitTime":1497650402739,"finishTime":1497650403043,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cbbb103e-c172-4418-871a-9676cdd115cb"},{"version":"CommandV1","origId":2060825016293840,"guid":"3e90269c-f62d-41c6-ad75-aaef20ff9e3c","subtype":"command","commandType":"auto","position":110.0,"command":"%scala\nimport org.apache.spark.ml.feature.StopWordsRemover\nval englishStopWords = StopWordsRemover\n.loadDefaultStopWords(\"english\")\nval stops = new StopWordsRemover()\n.setStopWords(englishStopWords)\n.setInputCol(\"DescriptionOut\")\nstops.transform(tokenized).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+------------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|stopWords_fbfdf58b62db__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+------------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|          [white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|          [white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|          [cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|          [knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|          [red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|          [set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|          [glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|          [hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|          [hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|          [assorted, colour...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|          [poppy's, playhou...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|          [poppy's, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|          [feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|          [ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|          [box, 6, assorted...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|          [box, vintage, ji...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|          [box, vintage, al...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|          [home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|          [love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|          [recipe, box, met...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+------------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.StopWordsRemover\nenglishStopWords: Array[String] = Array(i, me, my, myself, we, our, ours, ourselves, you, your, yours, yourself, yourselves, he, him, his, himself, she, her, hers, herself, it, its, itself, they, them, their, theirs, themselves, what, which, who, whom, this, that, these, those, am, is, are, was, were, be, been, being, have, has, had, having, do, does, did, doing, a, an, the, and, but, if, or, because, as, until, while, of, at, by, for, with, about, against, between, into, through, during, before, after, above, below, to, from, up, down, in, out, on, off, over, under, again, further, then, once, here, there, when, where, why, how, all, any, both, each, few, more, most, other, some, such, no, nor, not, only, own, same, so, than, too, very, s, t, can, will, just, don, should, now, d, ll, m, o, re, ve, y, ain, aren, couldn, didn, doesn, hadn, hasn, haven, isn, ma, mightn, mustn, needn, shan, shouldn, wasn, weren, won, wouldn)\nstops: org.apache.spark.ml.feature.StopWordsRemover = stopWords_fbfdf58b62db\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650410564,"submitTime":1497650410534,"finishTime":1497650410988,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1e5919e8-962f-4adc-92cf-aef672be0aff"},{"version":"CommandV1","origId":2060825016293841,"guid":"a997a020-8bf1-4fd1-a0fd-c4291d24383b","subtype":"command","commandType":"auto","position":111.0,"command":"from pyspark.ml.feature import StopWordsRemover\nenglishStopWords = StopWordsRemover\\\n.loadDefaultStopWords(\"english\")\nstops = StopWordsRemover()\\\n.setStopWords(englishStopWords)\\\n.setInputCol(\"DescriptionOut\")\nstops.transform(tokenized).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+---------------------------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|StopWordsRemover_4e90ba8afc2412792993__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+---------------------------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|                         [white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|                         [white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|                         [cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|                         [knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|                         [red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|                         [set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|                         [glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|                         [hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|                         [hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|                         [assorted, colour...|\n|   536367|    22745|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|                         [poppy&apos;s, playhou...|\n|   536367|    22748|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|                         [poppy&apos;s, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|                         [feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|                         [ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|                         [box, 6, assorted...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|                         [box, vintage, ji...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|                         [box, vintage, al...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|                         [home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|                         [love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|                         [recipe, box, met...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+---------------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650417006,"submitTime":1497650416978,"finishTime":1497650417278,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"48d78d60-af86-4779-850b-bbcb50e7c19d"},{"version":"CommandV1","origId":2060825016293842,"guid":"f16d03c1-f09b-494a-9c2e-7a6d58116da7","subtype":"command","commandType":"auto","position":112.0,"command":"%scala\nimport org.apache.spark.ml.feature.NGram\nval unigram = new NGram()\n.setInputCol(\"DescriptionOut\")\n.setN(1)\nval bigram = new NGram()\n.setInputCol(\"DescriptionOut\")\n.setN(2)\nunigram.transform(tokenized).show()\nbigram.transform(tokenized).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|ngram_38c6bf946143__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|      [white, hanging, ...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|      [white, metal, la...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|      [cream, cupid, he...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|      [knitted, union, ...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|      [red, woolly, hot...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|      [set, 7, babushka...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|      [glass, star, fro...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|      [hand, warmer, un...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|      [hand, warmer, re...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|      [assorted, colour...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|      [poppy's, playhou...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|      [poppy's, playhou...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|      [feltcraft, princ...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|      [ivory, knitted, ...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|      [box, of, 6, asso...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|      [box, of, vintage...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|      [box, of, vintage...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|      [home, building, ...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|      [love, building, ...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|      [recipe, box, wit...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------------+\nonly showing top 20 rows\n\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|ngram_62b5e8e6ac2f__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|      [white hanging, h...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|      [white metal, met...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|      [cream cupid, cup...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|      [knitted union, u...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|      [red woolly, wool...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|      [set 7, 7 babushk...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|      [glass star, star...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|      [hand warmer, war...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|      [hand warmer, war...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|      [assorted colour,...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|      [poppy's playhous...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|      [poppy's playhous...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|      [feltcraft prince...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|      [ivory knitted, k...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|      [box of, of 6, 6 ...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|      [box of, of vinta...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|      [box of, of vinta...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|      [home building, b...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|      [love building, b...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|      [recipe box, box ...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.NGram\nunigram: org.apache.spark.ml.feature.NGram = ngram_38c6bf946143\nbigram: org.apache.spark.ml.feature.NGram = ngram_62b5e8e6ac2f\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650430003,"submitTime":1497650429974,"finishTime":1497650430486,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4b709eaa-fbc5-4d24-9c76-0bbd9809b062"},{"version":"CommandV1","origId":2060825016293843,"guid":"924258f5-2227-4f65-b8d9-0334aea72c7b","subtype":"command","commandType":"auto","position":113.0,"command":"%scala\nimport org.apache.spark.ml.feature.CountVectorizer\nval cv = new CountVectorizer()\n.setInputCol(\"DescriptionOut\")\n.setOutputCol(\"countVec\")\n.setVocabSize(500)\n.setMinTF(1)\n.setMinDF(2)\nval fittedCV = cv.fit(tokenized)\nfittedCV.transform(tokenized).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|            countVec|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|(500,[4,15,19,21,...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|(500,[14,15,208],...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|(500,[57,98,222,2...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|(500,[34,39,40,89...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|(500,[3,15],[1.0,...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|(500,[0,160,163],...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|(500,[21,23,31,84...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|(500,[89,101,112,...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|(500,[3,101,112],...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|(500,[62,79,87,30...|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|(500,[317,318],[1...|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|(500,[145,317,318...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|(500,[64,77,221,3...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|(500,[54,55,348],...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|(500,[1,10,27,62,...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,274]...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,132]...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|(500,[44,217,258,...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|(500,[59,217,258,...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|(500,[4,10,14,41,...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.CountVectorizer\ncv: org.apache.spark.ml.feature.CountVectorizer = cntVec_9723f6d48c0e\nfittedCV: org.apache.spark.ml.feature.CountVectorizerModel = cntVec_9723f6d48c0e\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:110: error: not found: value setVocabSize\n              setVocabSize(500)\n              ^\n</div>","error":null,"workflows":[],"startTime":1497650448475,"submitTime":1497650448445,"finishTime":1497650451712,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ebea5aee-1e20-4f52-8f09-49139099fd30"},{"version":"CommandV1","origId":2060825016293844,"guid":"d5dba40c-c534-4970-befb-d1e466a6ffe3","subtype":"command","commandType":"auto","position":114.0,"command":"from pyspark.ml.feature import CountVectorizer\ncv = CountVectorizer()\\\n.setInputCol(\"DescriptionOut\")\\\n.setOutputCol(\"countVec\")\\\n.setVocabSize(500)\\\n.setMinTF(1)\\\n.setMinDF(2)\nfittedCV = cv.fit(tokenized)\nfittedCV.transform(tokenized).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|            countVec|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|(500,[4,15,19,21,...|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|(500,[14,15,208],...|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|(500,[57,98,222,2...|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|(500,[34,39,40,89...|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|(500,[3,15],[1.0,...|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|(500,[0,160,163],...|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|(500,[21,23,31,84...|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|(500,[89,101,112,...|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|(500,[3,101,112],...|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|(500,[62,79,87,30...|\n|   536367|    22745|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|(500,[317,318],[1...|\n|   536367|    22748|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|(500,[145,317,318...|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|(500,[64,77,221,3...|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|(500,[54,55,348],...|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|(500,[1,10,27,62,...|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,274]...|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,132]...|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|(500,[44,217,258,...|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|(500,[59,217,258,...|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|(500,[4,10,14,41,...|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650457427,"submitTime":1497650457420,"finishTime":1497650460345,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1ac488e1-96ec-4b29-a092-18086454648a"},{"version":"CommandV1","origId":2060825016293845,"guid":"2cf3aad7-9c71-4522-a8b6-2eb2077a5b71","subtype":"command","commandType":"auto","position":115.0,"command":"%scala\nval tfIdfIn = tokenized\n.where(\"array_contains(DescriptionOut, 'red')\")\n.select(\"DescriptionOut\")\n.limit(10)\ntfIdfIn.show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------------------------------------+\n|DescriptionOut                      |\n+------------------------------------+\n|[red, woolly, hottie, white, heart.]|\n|[hand, warmer, red, polka, dot]     |\n|[red, coat, rack, paris, fashion]   |\n|[alarm, clock, bakelike, red]       |\n|[set/2, red, retrospot, tea, towels]|\n|[red, toadstool, led, night, light] |\n|[hand, warmer, red, polka, dot]     |\n|[edwardian, parasol, red]           |\n|[red, woolly, hottie, white, heart.]|\n|[edwardian, parasol, red]           |\n+------------------------------------+\n\ntfIdfIn: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [DescriptionOut: array&lt;string&gt;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650464169,"submitTime":1497650464140,"finishTime":1497650464438,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"840e7ae8-061f-4209-8396-c024c3dacdf7"},{"version":"CommandV1","origId":2060825016293846,"guid":"b9525894-3950-4b41-a300-93ae405a285e","subtype":"command","commandType":"auto","position":116.0,"command":"tfIdfIn = tokenized\\\n.where(\"array_contains(DescriptionOut, 'red')\")\\\n.select(\"DescriptionOut\")\\\n.limit(10)\ntfIdfIn.show(10, False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------------------------------------+\n|DescriptionOut                      |\n+------------------------------------+\n|[red, woolly, hottie, white, heart.]|\n|[hand, warmer, red, polka, dot]     |\n|[red, coat, rack, paris, fashion]   |\n|[alarm, clock, bakelike, red]       |\n|[set/2, red, retrospot, tea, towels]|\n|[red, toadstool, led, night, light] |\n|[hand, warmer, red, polka, dot]     |\n|[edwardian, parasol, red]           |\n|[red, woolly, hottie, white, heart.]|\n|[edwardian, parasol, red]           |\n+------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650471275,"submitTime":1497650471245,"finishTime":1497650471496,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fe31d562-621c-4b57-86a7-8cece4f0d1a2"},{"version":"CommandV1","origId":2060825016293847,"guid":"b7a97558-6c83-4e58-bbab-37e665ba90ed","subtype":"command","commandType":"auto","position":117.0,"command":"%scala\nimport org.apache.spark.ml.feature.{HashingTF, IDF}\nval tf = new HashingTF()\n.setInputCol(\"DescriptionOut\")\n.setOutputCol(\"TFOut\")\n.setNumFeatures(10000)\nval idf = new IDF()\n.setInputCol(\"TFOut\")\n.setOutputCol(\"IDFOut\")\n.setMinDocFreq(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.feature.{HashingTF, IDF}\ntf: org.apache.spark.ml.feature.HashingTF = hashingTF_fc338be28b38\nidf: org.apache.spark.ml.feature.IDF = idf_b0afe991789a\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650479628,"submitTime":1497650479598,"finishTime":1497650479735,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f4d2681c-1242-4be5-8040-d1177efe8ca2"},{"version":"CommandV1","origId":2060825016293848,"guid":"34a43fd2-800d-4ae8-83ca-285bd543be66","subtype":"command","commandType":"auto","position":118.0,"command":"from pyspark.ml.feature import HashingTF, IDF\ntf = HashingTF()\\\n.setInputCol(\"DescriptionOut\")\\\n.setOutputCol(\"TFOut\")\\\n.setNumFeatures(10000)\nidf = IDF()\\\n.setInputCol(\"TFOut\")\\\n.setOutputCol(\"IDFOut\")\\\n.setMinDocFreq(2)\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-71-28dd94d4408e&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">6</span>\n<span class=\"ansiyellow\">    .transform(tf.transform(tfIdfIn))</span>\n<span class=\"ansigrey\">    ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1497650511050,"submitTime":1497650511020,"finishTime":1497650511172,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2fcfb543-86fa-4796-89c0-52568812d507"},{"version":"CommandV1","origId":2060825016293849,"guid":"ba0038be-bc8f-4a22-800f-86d925e58907","subtype":"command","commandType":"auto","position":119.0,"command":"%scala\nidf.fit(tf.transform(tfIdfIn))\n.transform(tf.transform(tfIdfIn))\n.show(false)\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------------------------------------+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+\n|DescriptionOut                      |TFOut                                                   |IDFOut                                                                                                              |\n+------------------------------------+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+\n|[red, woolly, hottie, white, heart.]|(10000,[4077,4291,6756,6872,7142],[1.0,1.0,1.0,1.0,1.0])|(10000,[4077,4291,6756,6872,7142],[1.2992829841302609,0.0,1.2992829841302609,1.2992829841302609,1.2992829841302609])|\n|[hand, warmer, red, polka, dot]     |(10000,[3280,3423,4220,4291,8977],[1.0,1.0,1.0,1.0,1.0])|(10000,[3280,3423,4220,4291,8977],[1.2992829841302609,1.2992829841302609,1.2992829841302609,0.0,1.2992829841302609])|\n|[red, coat, rack, paris, fashion]   |(10000,[477,598,4291,5106,9627],[1.0,1.0,1.0,1.0,1.0])  |(10000,[477,598,4291,5106,9627],[0.0,0.0,0.0,0.0,0.0])                                                              |\n|[alarm, clock, bakelike, red]       |(10000,[4291,4852,4995,9668],[1.0,1.0,1.0,1.0])         |(10000,[4291,4852,4995,9668],[0.0,0.0,0.0,0.0])                                                                     |\n|[set/2, red, retrospot, tea, towels]|(10000,[811,2591,4291,5716,8540],[1.0,1.0,1.0,1.0,1.0]) |(10000,[811,2591,4291,5716,8540],[0.0,0.0,0.0,0.0,0.0])                                                             |\n|[red, toadstool, led, night, light] |(10000,[76,3526,4291,7860,9159],[1.0,1.0,1.0,1.0,1.0])  |(10000,[76,3526,4291,7860,9159],[0.0,0.0,0.0,0.0,0.0])                                                              |\n|[hand, warmer, red, polka, dot]     |(10000,[3280,3423,4220,4291,8977],[1.0,1.0,1.0,1.0,1.0])|(10000,[3280,3423,4220,4291,8977],[1.2992829841302609,1.2992829841302609,1.2992829841302609,0.0,1.2992829841302609])|\n|[edwardian, parasol, red]           |(10000,[3266,3944,4291],[1.0,1.0,1.0])                  |(10000,[3266,3944,4291],[1.2992829841302609,1.2992829841302609,0.0])                                                |\n|[red, woolly, hottie, white, heart.]|(10000,[4077,4291,6756,6872,7142],[1.0,1.0,1.0,1.0,1.0])|(10000,[4077,4291,6756,6872,7142],[1.2992829841302609,0.0,1.2992829841302609,1.2992829841302609,1.2992829841302609])|\n|[edwardian, parasol, red]           |(10000,[3266,3944,4291],[1.0,1.0,1.0])                  |(10000,[3266,3944,4291],[1.2992829841302609,1.2992829841302609,0.0])                                                |\n+------------------------------------+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650518195,"submitTime":1497650518187,"finishTime":1497650518933,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7b74a095-2338-427e-b8a0-fa3358e4c35e"},{"version":"CommandV1","origId":2060825016293850,"guid":"2c64a812-6f9f-4d0d-9729-9bf691abd93e","subtype":"command","commandType":"auto","position":120.0,"command":"idf.fit(tf.transform(tfIdfIn))\\\n.transform(tf.transform(tfIdfIn))\\\n.show(10, False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------------------------------------+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+\n|DescriptionOut                      |TFOut                                                   |IDFOut                                                                                                              |\n+------------------------------------+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+\n|[red, woolly, hottie, white, heart.]|(10000,[4077,4291,6756,6872,7142],[1.0,1.0,1.0,1.0,1.0])|(10000,[4077,4291,6756,6872,7142],[1.2992829841302609,0.0,1.2992829841302609,1.2992829841302609,1.2992829841302609])|\n|[hand, warmer, red, polka, dot]     |(10000,[3280,3423,4220,4291,8977],[1.0,1.0,1.0,1.0,1.0])|(10000,[3280,3423,4220,4291,8977],[1.2992829841302609,1.2992829841302609,1.2992829841302609,0.0,1.2992829841302609])|\n|[red, coat, rack, paris, fashion]   |(10000,[477,598,4291,5106,9627],[1.0,1.0,1.0,1.0,1.0])  |(10000,[477,598,4291,5106,9627],[0.0,0.0,0.0,0.0,0.0])                                                              |\n|[alarm, clock, bakelike, red]       |(10000,[4291,4852,4995,9668],[1.0,1.0,1.0,1.0])         |(10000,[4291,4852,4995,9668],[0.0,0.0,0.0,0.0])                                                                     |\n|[set/2, red, retrospot, tea, towels]|(10000,[811,2591,4291,5716,8540],[1.0,1.0,1.0,1.0,1.0]) |(10000,[811,2591,4291,5716,8540],[0.0,0.0,0.0,0.0,0.0])                                                             |\n|[red, toadstool, led, night, light] |(10000,[76,3526,4291,7860,9159],[1.0,1.0,1.0,1.0,1.0])  |(10000,[76,3526,4291,7860,9159],[0.0,0.0,0.0,0.0,0.0])                                                              |\n|[hand, warmer, red, polka, dot]     |(10000,[3280,3423,4220,4291,8977],[1.0,1.0,1.0,1.0,1.0])|(10000,[3280,3423,4220,4291,8977],[1.2992829841302609,1.2992829841302609,1.2992829841302609,0.0,1.2992829841302609])|\n|[edwardian, parasol, red]           |(10000,[3266,3944,4291],[1.0,1.0,1.0])                  |(10000,[3266,3944,4291],[1.2992829841302609,1.2992829841302609,0.0])                                                |\n|[red, woolly, hottie, white, heart.]|(10000,[4077,4291,6756,6872,7142],[1.0,1.0,1.0,1.0,1.0])|(10000,[4077,4291,6756,6872,7142],[1.2992829841302609,0.0,1.2992829841302609,1.2992829841302609,1.2992829841302609])|\n|[edwardian, parasol, red]           |(10000,[3266,3944,4291],[1.0,1.0,1.0])                  |(10000,[3266,3944,4291],[1.2992829841302609,1.2992829841302609,0.0])                                                |\n+------------------------------------+--------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650523680,"submitTime":1497650523649,"finishTime":1497650524204,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e52fd85f-758e-4c8c-a68b-0cc2760908d1"},{"version":"CommandV1","origId":2060825016293851,"guid":"104f857c-eba3-4677-93ae-ad34b324cd73","subtype":"command","commandType":"auto","position":121.0,"command":"%scala\nval contDF = spark.range(500)\n.selectExpr(\"cast(id as double)\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">contDF: org.apache.spark.sql.DataFrame = [id: double]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650534870,"submitTime":1497650534839,"finishTime":1497650534973,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1dd0ba47-bc53-4e3c-8caf-64299015ac6b"},{"version":"CommandV1","origId":2060825016293852,"guid":"5e1c6bc2-cfe3-4abb-ab22-3fc3d3572cd5","subtype":"command","commandType":"auto","position":122.0,"command":"contDF = spark.range(500)\\\n.selectExpr(\"cast(id as double)\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650540718,"submitTime":1497650540687,"finishTime":1497650540788,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"345e2db0-d806-401c-a2a2-21c2818a9757"},{"version":"CommandV1","origId":2060825016293853,"guid":"569cd11e-49d7-4ff1-934f-353651cf2252","subtype":"command","commandType":"auto","position":123.0,"command":"%scala\nimport org.apache.spark.ml.feature.Bucketizer\nval bucketBorders = Array(-1.0, 5.0, 10.0, 250.0, 600.0)\nval bucketer = new Bucketizer()\n.setSplits(bucketBorders)\n.setInputCol(\"id\")\nbucketer.transform(contDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+-------------------------------+\n|  id|bucketizer_8643c3d1756a__output|\n+----+-------------------------------+\n| 0.0|                            0.0|\n| 1.0|                            0.0|\n| 2.0|                            0.0|\n| 3.0|                            0.0|\n| 4.0|                            0.0|\n| 5.0|                            1.0|\n| 6.0|                            1.0|\n| 7.0|                            1.0|\n| 8.0|                            1.0|\n| 9.0|                            1.0|\n|10.0|                            2.0|\n|11.0|                            2.0|\n|12.0|                            2.0|\n|13.0|                            2.0|\n|14.0|                            2.0|\n|15.0|                            2.0|\n|16.0|                            2.0|\n|17.0|                            2.0|\n|18.0|                            2.0|\n|19.0|                            2.0|\n+----+-------------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.Bucketizer\nbucketBorders: Array[Double] = Array(-1.0, 5.0, 10.0, 250.0, 600.0)\nbucketer: org.apache.spark.ml.feature.Bucketizer = bucketizer_8643c3d1756a\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650548156,"submitTime":1497650548125,"finishTime":1497650548317,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9dc76c74-24cb-4170-9478-351f783ea6d6"},{"version":"CommandV1","origId":2060825016293854,"guid":"c65db697-05cf-4bac-bbfa-b6a212e8f844","subtype":"command","commandType":"auto","position":124.0,"command":"from pyspark.ml.feature import Bucketizer\nbucketBorders = [-1.0, 5.0, 10.0, 250.0, 600.0]\nbucketer = Bucketizer()\\\n.setSplits(bucketBorders)\\\n.setInputCol(\"id\")\nbucketer.transform(contDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+---------------------------------------+\n|  id|Bucketizer_46738d89be07e93b2790__output|\n+----+---------------------------------------+\n| 0.0|                                    0.0|\n| 1.0|                                    0.0|\n| 2.0|                                    0.0|\n| 3.0|                                    0.0|\n| 4.0|                                    0.0|\n| 5.0|                                    1.0|\n| 6.0|                                    1.0|\n| 7.0|                                    1.0|\n| 8.0|                                    1.0|\n| 9.0|                                    1.0|\n|10.0|                                    2.0|\n|11.0|                                    2.0|\n|12.0|                                    2.0|\n|13.0|                                    2.0|\n|14.0|                                    2.0|\n|15.0|                                    2.0|\n|16.0|                                    2.0|\n|17.0|                                    2.0|\n|18.0|                                    2.0|\n|19.0|                                    2.0|\n+----+---------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650555466,"submitTime":1497650555435,"finishTime":1497650555587,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b715c0a0-4d96-4331-908a-049320376da4"},{"version":"CommandV1","origId":2060825016293855,"guid":"64eeb186-b510-4dd3-b13d-feadd512838a","subtype":"command","commandType":"auto","position":125.0,"command":"%scala\nimport org.apache.spark.ml.feature.QuantileDiscretizer\nval bucketer = new QuantileDiscretizer()\n.setNumBuckets(5)\n.setInputCol(\"id\")\nval fittedBucketer = bucketer.fit(contDF)\nfittedBucketer.transform(contDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+----------------------------------------+\n|  id|quantileDiscretizer_1ce34ed797d6__output|\n+----+----------------------------------------+\n| 0.0|                                     0.0|\n| 1.0|                                     0.0|\n| 2.0|                                     0.0|\n| 3.0|                                     0.0|\n| 4.0|                                     0.0|\n| 5.0|                                     0.0|\n| 6.0|                                     0.0|\n| 7.0|                                     0.0|\n| 8.0|                                     0.0|\n| 9.0|                                     0.0|\n|10.0|                                     0.0|\n|11.0|                                     0.0|\n|12.0|                                     0.0|\n|13.0|                                     0.0|\n|14.0|                                     0.0|\n|15.0|                                     0.0|\n|16.0|                                     0.0|\n|17.0|                                     0.0|\n|18.0|                                     0.0|\n|19.0|                                     0.0|\n+----+----------------------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.QuantileDiscretizer\nbucketer: org.apache.spark.ml.feature.QuantileDiscretizer = quantileDiscretizer_1ce34ed797d6\nfittedBucketer: org.apache.spark.ml.feature.Bucketizer = quantileDiscretizer_1ce34ed797d6\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650561886,"submitTime":1497650561856,"finishTime":1497650562300,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"63c75742-3b00-4961-b3c4-7431fe573fb2"},{"version":"CommandV1","origId":2060825016293856,"guid":"ef49bde0-d72f-4d06-9a5f-316484be243f","subtype":"command","commandType":"auto","position":126.0,"command":"from pyspark.ml.feature import QuantileDiscretizer\nbucketer = QuantileDiscretizer()\\\n.setNumBuckets(5)\\\n.setInputCol(\"id\")\nfittedBucketer = bucketer.fit(contDF)\nfittedBucketer.transform(contDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+------------------------------------------------+\n|  id|QuantileDiscretizer_470580082cf36f8897a0__output|\n+----+------------------------------------------------+\n| 0.0|                                             0.0|\n| 1.0|                                             0.0|\n| 2.0|                                             0.0|\n| 3.0|                                             0.0|\n| 4.0|                                             0.0|\n| 5.0|                                             0.0|\n| 6.0|                                             0.0|\n| 7.0|                                             0.0|\n| 8.0|                                             0.0|\n| 9.0|                                             0.0|\n|10.0|                                             0.0|\n|11.0|                                             0.0|\n|12.0|                                             0.0|\n|13.0|                                             0.0|\n|14.0|                                             0.0|\n|15.0|                                             0.0|\n|16.0|                                             0.0|\n|17.0|                                             0.0|\n|18.0|                                             0.0|\n|19.0|                                             0.0|\n+----+------------------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650568746,"submitTime":1497650568716,"finishTime":1497650568967,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"311a7b54-5658-4a94-87a7-7f6881f40865"},{"version":"CommandV1","origId":2060825016293857,"guid":"913ef7b9-9876-46f0-865f-1b0746df830a","subtype":"command","commandType":"auto","position":127.0,"command":"%scala\nimport org.apache.spark.ml.feature.Normalizer\nval taxicab = new Normalizer()\n.setP(1)\n.setInputCol(\"features\")\ntaxicab.transform(scaleDF).show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+---------------------------------------------------------------+\n|id |features      |normalizer_c9cda7b8c844__output                                |\n+---+--------------+---------------------------------------------------------------+\n|0  |[1.0,0.1,-1.0]|[0.47619047619047616,0.047619047619047616,-0.47619047619047616]|\n|1  |[2.0,1.1,1.0] |[0.48780487804878053,0.26829268292682934,0.24390243902439027]  |\n|0  |[1.0,0.1,-1.0]|[0.47619047619047616,0.047619047619047616,-0.47619047619047616]|\n|1  |[2.0,1.1,1.0] |[0.48780487804878053,0.26829268292682934,0.24390243902439027]  |\n|1  |[3.0,10.1,3.0]|[0.18633540372670807,0.6273291925465838,0.18633540372670807]   |\n+---+--------------+---------------------------------------------------------------+\n\nimport org.apache.spark.ml.feature.Normalizer\ntaxicab: org.apache.spark.ml.feature.Normalizer = normalizer_c9cda7b8c844\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650578420,"submitTime":1497650578389,"finishTime":1497650578713,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5492f5fb-2483-42ac-a7a9-c4647b640586"},{"version":"CommandV1","origId":2060825016293858,"guid":"f854616a-b36c-4d07-b642-5cf5185ec974","subtype":"command","commandType":"auto","position":128.0,"command":"from pyspark.ml.feature import Normalizer\ntaxicab = Normalizer()\\\n.setP(1)\\\n.setInputCol(\"features\")\ntaxicab.transform(scaleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+---------------------------------------+\n| id|      features|Normalizer_469fb601d281700fd28f__output|\n+---+--------------+---------------------------------------+\n|  0|[1.0,0.1,-1.0]|                   [0.47619047619047...|\n|  1| [2.0,1.1,1.0]|                   [0.48780487804878...|\n|  0|[1.0,0.1,-1.0]|                   [0.47619047619047...|\n|  1| [2.0,1.1,1.0]|                   [0.48780487804878...|\n|  1|[3.0,10.1,3.0]|                   [0.18633540372670...|\n+---+--------------+---------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650585899,"submitTime":1497650585867,"finishTime":1497650586120,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3e1521c6-6726-4139-9240-bb82d4f3edb8"},{"version":"CommandV1","origId":2060825016293859,"guid":"d2083068-c18b-44ff-af07-c35182d6b4e0","subtype":"command","commandType":"auto","position":129.0,"command":"%scala\nimport org.apache.spark.ml.feature.StandardScaler\nval sScaler = new StandardScaler()\n.setInputCol(\"features\")\nsScaler.fit(scaleDF).transform(scaleDF).show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+------------------------------------------------------------+\n|id |features      |stdScal_7669571fe266__output                                |\n+---+--------------+------------------------------------------------------------+\n|0  |[1.0,0.1,-1.0]|[1.1952286093343936,0.02337622911060922,-0.5976143046671968]|\n|1  |[2.0,1.1,1.0] |[2.390457218668787,0.2571385202167014,0.5976143046671968]   |\n|0  |[1.0,0.1,-1.0]|[1.1952286093343936,0.02337622911060922,-0.5976143046671968]|\n|1  |[2.0,1.1,1.0] |[2.390457218668787,0.2571385202167014,0.5976143046671968]   |\n|1  |[3.0,10.1,3.0]|[3.5856858280031805,2.3609991401715313,1.7928429140015902]  |\n+---+--------------+------------------------------------------------------------+\n\nimport org.apache.spark.ml.feature.StandardScaler\nsScaler: org.apache.spark.ml.feature.StandardScaler = stdScal_7669571fe266\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650597016,"submitTime":1497650596985,"finishTime":1497650597511,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"63c1c630-1b72-435f-acc0-fde1e33bc263"},{"version":"CommandV1","origId":2060825016293860,"guid":"9986ed0d-8aa8-47b1-b9a4-9c4458b8d145","subtype":"command","commandType":"auto","position":130.0,"command":"%scala\nimport org.apache.spark.ml.feature.MinMaxScaler\nval minMax = new MinMaxScaler()\n.setMin(5)\n.setMax(10)\n.setInputCol(\"features\")\nval fittedminMax = minMax.fit(scaleDF)\nfittedminMax.transform(scaleDF).show(false)\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+-------------------------------+\n|id |features      |minMaxScal_6aa94b5efa76__output|\n+---+--------------+-------------------------------+\n|0  |[1.0,0.1,-1.0]|[5.0,5.0,5.0]                  |\n|1  |[2.0,1.1,1.0] |[7.5,5.5,7.5]                  |\n|0  |[1.0,0.1,-1.0]|[5.0,5.0,5.0]                  |\n|1  |[2.0,1.1,1.0] |[7.5,5.5,7.5]                  |\n|1  |[3.0,10.1,3.0]|[10.0,10.0,10.0]               |\n+---+--------------+-------------------------------+\n\nimport org.apache.spark.ml.feature.MinMaxScaler\nminMax: org.apache.spark.ml.feature.MinMaxScaler = minMaxScal_6aa94b5efa76\nfittedminMax: org.apache.spark.ml.feature.MinMaxScalerModel = minMaxScal_6aa94b5efa76\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:10: error: ';' expected but '.' found.\n       from pyspark.ml.feature import MinMaxScaler\n                   ^\n&lt;console&gt;:12: error: ';' expected but '.' found.\n       .setMin(5)\\\n       ^\n</div>","error":null,"workflows":[],"startTime":1497650627552,"submitTime":1497650627543,"finishTime":1497650628010,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3cb9d1a5-17d3-4343-90a0-d73a1607484d"},{"version":"CommandV1","origId":2060825016293861,"guid":"d4b83af8-f00f-462a-b831-854ef9856865","subtype":"command","commandType":"auto","position":131.0,"command":"from pyspark.ml.feature import MinMaxScaler\nminMax = MinMaxScaler()\\\n.setMin(5)\\\n.setMax(10)\\\n.setInputCol(\"features\")\nfittedminMax = minMax.fit(scaleDF)\nfittedminMax.transform(scaleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+-----------------------------------------+\n| id|      features|MinMaxScaler_47f0bb0bf00a1897ec4f__output|\n+---+--------------+-----------------------------------------+\n|  0|[1.0,0.1,-1.0]|                            [5.0,5.0,5.0]|\n|  1| [2.0,1.1,1.0]|                            [7.5,5.5,7.5]|\n|  0|[1.0,0.1,-1.0]|                            [5.0,5.0,5.0]|\n|  1| [2.0,1.1,1.0]|                            [7.5,5.5,7.5]|\n|  1|[3.0,10.1,3.0]|                         [10.0,10.0,10.0]|\n+---+--------------+-----------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650628734,"submitTime":1497650628702,"finishTime":1497650629306,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8ff97505-0428-4cd7-a045-3084b288ab4d"},{"version":"CommandV1","origId":2060825016293862,"guid":"05da3959-46de-4351-967a-8fce433e7358","subtype":"command","commandType":"auto","position":132.0,"command":"%scala\nimport org.apache.spark.ml.feature.MaxAbsScaler\nval maScaler = new MaxAbsScaler()\n.setInputCol(\"features\")\nval fittedmaScaler = maScaler.fit(scaleDF)\nfittedmaScaler.transform(scaleDF).show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+-------------------------------------------------------------+\n|id |features      |maxAbsScal_27c81847c6a5__output                              |\n+---+--------------+-------------------------------------------------------------+\n|0  |[1.0,0.1,-1.0]|[0.3333333333333333,0.009900990099009901,-0.3333333333333333]|\n|1  |[2.0,1.1,1.0] |[0.6666666666666666,0.10891089108910892,0.3333333333333333]  |\n|0  |[1.0,0.1,-1.0]|[0.3333333333333333,0.009900990099009901,-0.3333333333333333]|\n|1  |[2.0,1.1,1.0] |[0.6666666666666666,0.10891089108910892,0.3333333333333333]  |\n|1  |[3.0,10.1,3.0]|[1.0,1.0,1.0]                                                |\n+---+--------------+-------------------------------------------------------------+\n\nimport org.apache.spark.ml.feature.MaxAbsScaler\nmaScaler: org.apache.spark.ml.feature.MaxAbsScaler = maxAbsScal_27c81847c6a5\nfittedmaScaler: org.apache.spark.ml.feature.MaxAbsScalerModel = maxAbsScal_27c81847c6a5\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650641241,"submitTime":1497650641203,"finishTime":1497650641713,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3ce34871-27cd-4918-b5e7-6f8ee3c1e577"},{"version":"CommandV1","origId":2060825016293863,"guid":"c88ac7c3-cf4d-4e83-8b72-be5f2d18adf0","subtype":"command","commandType":"auto","position":133.0,"command":"%scala\nimport org.apache.spark.ml.feature.ElementwiseProduct\nimport org.apache.spark.ml.linalg.Vectors\nval scaleUpVec = Vectors.dense(10.0, 15.0, 20.0)\nval scalingUp = new ElementwiseProduct()\n.setScalingVec(scaleUpVec)\n.setInputCol(\"features\")\nscalingUp.transform(scaleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+-----------------------------+\n| id|      features|elemProd_27782e8272ea__output|\n+---+--------------+-----------------------------+\n|  0|[1.0,0.1,-1.0]|             [10.0,1.5,-20.0]|\n|  1| [2.0,1.1,1.0]|             [20.0,16.5,20.0]|\n|  0|[1.0,0.1,-1.0]|             [10.0,1.5,-20.0]|\n|  1| [2.0,1.1,1.0]|             [20.0,16.5,20.0]|\n|  1|[3.0,10.1,3.0]|            [30.0,151.5,60.0]|\n+---+--------------+-----------------------------+\n\nimport org.apache.spark.ml.feature.ElementwiseProduct\nimport org.apache.spark.ml.linalg.Vectors\nscaleUpVec: org.apache.spark.ml.linalg.Vector = [10.0,15.0,20.0]\nscalingUp: org.apache.spark.ml.feature.ElementwiseProduct = elemProd_27782e8272ea\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650648585,"submitTime":1497650648553,"finishTime":1497650648977,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"37ab3aed-4267-489a-8e12-e08585884b88"},{"version":"CommandV1","origId":2060825016293864,"guid":"6cf27eab-931a-46ff-8dba-3356f7d61a92","subtype":"command","commandType":"auto","position":134.0,"command":"from pyspark.ml.feature import ElementwiseProduct\nfrom pyspark.ml.linalg import Vectors\nscaleUpVec = Vectors.dense(10.0, 15.0, 20.0)\nscalingUp = ElementwiseProduct()\\\n.setScalingVec(scaleUpVec)\\\n.setInputCol(\"features\")\nscalingUp.transform(scaleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+-----------------------------------------------+\n| id|      features|ElementwiseProduct_461db7494a18142d197d__output|\n+---+--------------+-----------------------------------------------+\n|  0|[1.0,0.1,-1.0]|                               [10.0,1.5,-20.0]|\n|  1| [2.0,1.1,1.0]|                               [20.0,16.5,20.0]|\n|  0|[1.0,0.1,-1.0]|                               [10.0,1.5,-20.0]|\n|  1| [2.0,1.1,1.0]|                               [20.0,16.5,20.0]|\n|  1|[3.0,10.1,3.0]|                              [30.0,151.5,60.0]|\n+---+--------------+-----------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650656241,"submitTime":1497650656208,"finishTime":1497650656513,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4c06a17b-542d-4304-b9fe-b4c4f547cb48"},{"version":"CommandV1","origId":2060825016293865,"guid":"50c4aada-ba62-4a41-bb89-f298c9569d42","subtype":"command","commandType":"auto","position":135.0,"command":"%scala\nimport org.apache.spark.ml.feature.StringIndexer\nval labelIndexer = new StringIndexer()\n.setInputCol(\"lab\")\n.setOutputCol(\"labelInd\")\nval idxRes = labelIndexer.fit(simpleDF).transform(simpleDF)\nidxRes.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+\n|color| lab|value1|            value2|labelInd|\n+-----+----+------+------------------+--------+\n|green|good|     1|14.386294994851129|     1.0|\n| blue| bad|     8|14.386294994851129|     0.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     1.0|\n|green|good|    12|14.386294994851129|     1.0|\n|green| bad|    16|14.386294994851129|     0.0|\n|  red|good|    35|14.386294994851129|     1.0|\n|  red| bad|     1| 38.97187133755819|     0.0|\n|  red| bad|     2|14.386294994851129|     0.0|\n|  red| bad|    16|14.386294994851129|     0.0|\n|  red|good|    45| 38.97187133755819|     1.0|\n|green|good|     1|14.386294994851129|     1.0|\n| blue| bad|     8|14.386294994851129|     0.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     1.0|\n|green|good|    12|14.386294994851129|     1.0|\n|green| bad|    16|14.386294994851129|     0.0|\n|  red|good|    35|14.386294994851129|     1.0|\n|  red| bad|     1| 38.97187133755819|     0.0|\n|  red| bad|     2|14.386294994851129|     0.0|\n+-----+----+------+------------------+--------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.StringIndexer\nlabelIndexer: org.apache.spark.ml.feature.StringIndexer = strIdx_2b9b8e5b5d86\nidxRes: org.apache.spark.sql.DataFrame = [color: string, lab: string ... 3 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650663804,"submitTime":1497650663771,"finishTime":1497650664129,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"96b63dbf-16b1-4807-9c2d-6c21f3f208aa"},{"version":"CommandV1","origId":2060825016293866,"guid":"326a0142-d1f4-40e1-ace9-e297a0d81329","subtype":"command","commandType":"auto","position":136.0,"command":"from pyspark.ml.feature import StringIndexer\nlabelIndexer = StringIndexer()\\\n.setInputCol(\"lab\")\\\n.setOutputCol(\"labelInd\")\nidxRes = labelIndexer.fit(simpleDF).transform(simpleDF)\nidxRes.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+\n|color| lab|value1|            value2|labelInd|\n+-----+----+------+------------------+--------+\n|green|good|     1|14.386294994851129|     1.0|\n| blue| bad|     8|14.386294994851129|     0.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     1.0|\n|green|good|    12|14.386294994851129|     1.0|\n|green| bad|    16|14.386294994851129|     0.0|\n|  red|good|    35|14.386294994851129|     1.0|\n|  red| bad|     1| 38.97187133755819|     0.0|\n|  red| bad|     2|14.386294994851129|     0.0|\n|  red| bad|    16|14.386294994851129|     0.0|\n|  red|good|    45| 38.97187133755819|     1.0|\n|green|good|     1|14.386294994851129|     1.0|\n| blue| bad|     8|14.386294994851129|     0.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     1.0|\n|green|good|    12|14.386294994851129|     1.0|\n|green| bad|    16|14.386294994851129|     0.0|\n|  red|good|    35|14.386294994851129|     1.0|\n|  red| bad|     1| 38.97187133755819|     0.0|\n|  red| bad|     2|14.386294994851129|     0.0|\n+-----+----+------+------------------+--------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650678560,"submitTime":1497650678518,"finishTime":1497650678900,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7664daae-83fa-45f6-af90-0617798519f0"},{"version":"CommandV1","origId":2060825016293867,"guid":"7d7f3b23-eb80-4d73-ab01-54722fcc7aae","subtype":"command","commandType":"auto","position":137.0,"command":"%scala\nval valIndexer = new StringIndexer()\n.setInputCol(\"value1\")\n.setOutputCol(\"valueInd\")\nvalIndexer.fit(simpleDF).transform(simpleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+\n|color| lab|value1|            value2|valueInd|\n+-----+----+------+------------------+--------+\n|green|good|     1|14.386294994851129|     2.0|\n| blue| bad|     8|14.386294994851129|     4.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     5.0|\n|green|good|    12|14.386294994851129|     0.0|\n|green| bad|    16|14.386294994851129|     1.0|\n|  red|good|    35|14.386294994851129|     6.0|\n|  red| bad|     1| 38.97187133755819|     2.0|\n|  red| bad|     2|14.386294994851129|     7.0|\n|  red| bad|    16|14.386294994851129|     1.0|\n|  red|good|    45| 38.97187133755819|     3.0|\n|green|good|     1|14.386294994851129|     2.0|\n| blue| bad|     8|14.386294994851129|     4.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     5.0|\n|green|good|    12|14.386294994851129|     0.0|\n|green| bad|    16|14.386294994851129|     1.0|\n|  red|good|    35|14.386294994851129|     6.0|\n|  red| bad|     1| 38.97187133755819|     2.0|\n|  red| bad|     2|14.386294994851129|     7.0|\n+-----+----+------+------------------+--------+\nonly showing top 20 rows\n\nvalIndexer: org.apache.spark.ml.feature.StringIndexer = strIdx_9402509a0789\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650685046,"submitTime":1497650685013,"finishTime":1497650685514,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"12878b15-7e67-40cf-9302-b3bfc8cc9c1a"},{"version":"CommandV1","origId":2060825016293868,"guid":"05ae02cb-4429-4e72-9ce8-561e38417638","subtype":"command","commandType":"auto","position":138.0,"command":"valIndexer = StringIndexer()\\\n.setInputCol(\"value1\")\\\n.setOutputCol(\"valueInd\")\nvalIndexer.fit(simpleDF).transform(simpleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+\n|color| lab|value1|            value2|valueInd|\n+-----+----+------+------------------+--------+\n|green|good|     1|14.386294994851129|     2.0|\n| blue| bad|     8|14.386294994851129|     4.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     5.0|\n|green|good|    12|14.386294994851129|     0.0|\n|green| bad|    16|14.386294994851129|     1.0|\n|  red|good|    35|14.386294994851129|     6.0|\n|  red| bad|     1| 38.97187133755819|     2.0|\n|  red| bad|     2|14.386294994851129|     7.0|\n|  red| bad|    16|14.386294994851129|     1.0|\n|  red|good|    45| 38.97187133755819|     3.0|\n|green|good|     1|14.386294994851129|     2.0|\n| blue| bad|     8|14.386294994851129|     4.0|\n| blue| bad|    12|14.386294994851129|     0.0|\n|green|good|    15| 38.97187133755819|     5.0|\n|green|good|    12|14.386294994851129|     0.0|\n|green| bad|    16|14.386294994851129|     1.0|\n|  red|good|    35|14.386294994851129|     6.0|\n|  red| bad|     1| 38.97187133755819|     2.0|\n|  red| bad|     2|14.386294994851129|     7.0|\n+-----+----+------+------------------+--------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650692810,"submitTime":1497650692777,"finishTime":1497650693182,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b4dd4a95-ee90-4fc4-8bb7-e75b86fb28e7"},{"version":"CommandV1","origId":2060825016293869,"guid":"415ce493-3a20-41ef-90ef-ea1d727c085f","subtype":"command","commandType":"auto","position":139.0,"command":"%scala\nvalIndexer.setHandleInvalid(\"skip\")\nvalIndexer.fit(simpleDF).setHandleInvalid(\"skip\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res58: org.apache.spark.ml.feature.StringIndexerModel = strIdx_9402509a0789\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;StringIndexerModel&apos; object has no attribute &apos;setHandleInvalid&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-82-b7403ccc1fd6&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> valIndexer<span class=\"ansiyellow\">.</span>setHandleInvalid<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;skip&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>valIndexer<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>simpleDF<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>setHandleInvalid<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;skip&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;StringIndexerModel&apos; object has no attribute &apos;setHandleInvalid&apos;</div>","workflows":[],"startTime":1497650712971,"submitTime":1497650712938,"finishTime":1497650713180,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4f093368-1690-4e0b-bb84-12401ed57fa9"},{"version":"CommandV1","origId":2060825016293870,"guid":"9c71fbf1-6236-45aa-8048-89ef4e3446fb","subtype":"command","commandType":"auto","position":140.0,"command":"%scala\nimport org.apache.spark.ml.feature.IndexToString\nval labelReverse = new IndexToString()\n.setInputCol(\"labelInd\")\nlabelReverse.transform(idxRes).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+-----------------------------+\n|color| lab|value1|            value2|labelInd|idxToStr_06eb1d45c40b__output|\n+-----+----+------+------------------+--------+-----------------------------+\n|green|good|     1|14.386294994851129|     1.0|                         good|\n| blue| bad|     8|14.386294994851129|     0.0|                          bad|\n| blue| bad|    12|14.386294994851129|     0.0|                          bad|\n|green|good|    15| 38.97187133755819|     1.0|                         good|\n|green|good|    12|14.386294994851129|     1.0|                         good|\n|green| bad|    16|14.386294994851129|     0.0|                          bad|\n|  red|good|    35|14.386294994851129|     1.0|                         good|\n|  red| bad|     1| 38.97187133755819|     0.0|                          bad|\n|  red| bad|     2|14.386294994851129|     0.0|                          bad|\n|  red| bad|    16|14.386294994851129|     0.0|                          bad|\n|  red|good|    45| 38.97187133755819|     1.0|                         good|\n|green|good|     1|14.386294994851129|     1.0|                         good|\n| blue| bad|     8|14.386294994851129|     0.0|                          bad|\n| blue| bad|    12|14.386294994851129|     0.0|                          bad|\n|green|good|    15| 38.97187133755819|     1.0|                         good|\n|green|good|    12|14.386294994851129|     1.0|                         good|\n|green| bad|    16|14.386294994851129|     0.0|                          bad|\n|  red|good|    35|14.386294994851129|     1.0|                         good|\n|  red| bad|     1| 38.97187133755819|     0.0|                          bad|\n|  red| bad|     2|14.386294994851129|     0.0|                          bad|\n+-----+----+------+------------------+--------+-----------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.IndexToString\nlabelReverse: org.apache.spark.ml.feature.IndexToString = idxToStr_06eb1d45c40b\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650713944,"submitTime":1497650713911,"finishTime":1497650714145,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5783fc7d-8870-4162-bcb4-aadaa868ab30"},{"version":"CommandV1","origId":2060825016293871,"guid":"b5dcc49b-782b-415c-b0e3-b21971908edb","subtype":"command","commandType":"auto","position":141.0,"command":"from pyspark.ml.feature import IndexToString\nlabelReverse = IndexToString()\\\n.setInputCol(\"labelInd\")\nlabelReverse.transform(idxRes).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+------------------------------------------+\n|color| lab|value1|            value2|labelInd|IndexToString_48938720012babba4486__output|\n+-----+----+------+------------------+--------+------------------------------------------+\n|green|good|     1|14.386294994851129|     1.0|                                      good|\n| blue| bad|     8|14.386294994851129|     0.0|                                       bad|\n| blue| bad|    12|14.386294994851129|     0.0|                                       bad|\n|green|good|    15| 38.97187133755819|     1.0|                                      good|\n|green|good|    12|14.386294994851129|     1.0|                                      good|\n|green| bad|    16|14.386294994851129|     0.0|                                       bad|\n|  red|good|    35|14.386294994851129|     1.0|                                      good|\n|  red| bad|     1| 38.97187133755819|     0.0|                                       bad|\n|  red| bad|     2|14.386294994851129|     0.0|                                       bad|\n|  red| bad|    16|14.386294994851129|     0.0|                                       bad|\n|  red|good|    45| 38.97187133755819|     1.0|                                      good|\n|green|good|     1|14.386294994851129|     1.0|                                      good|\n| blue| bad|     8|14.386294994851129|     0.0|                                       bad|\n| blue| bad|    12|14.386294994851129|     0.0|                                       bad|\n|green|good|    15| 38.97187133755819|     1.0|                                      good|\n|green|good|    12|14.386294994851129|     1.0|                                      good|\n|green| bad|    16|14.386294994851129|     0.0|                                       bad|\n|  red|good|    35|14.386294994851129|     1.0|                                      good|\n|  red| bad|     1| 38.97187133755819|     0.0|                                       bad|\n|  red| bad|     2|14.386294994851129|     0.0|                                       bad|\n+-----+----+------+------------------+--------+------------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650727879,"submitTime":1497650727846,"finishTime":1497650728402,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0c2dc5b0-703a-489f-aca0-fa5731922ae3"},{"version":"CommandV1","origId":2060825016293872,"guid":"d1eff731-50cc-4822-85ff-952812b8f00f","subtype":"command","commandType":"auto","position":142.0,"command":"%scala\nimport org.apache.spark.ml.feature.VectorIndexer\nimport org.apache.spark.ml.linalg.Vectors\nval idxIn = spark.createDataFrame(Seq(\n(Vectors.dense(1, 2, 3),1),\n(Vectors.dense(2, 5, 6),2),\n(Vectors.dense(1, 8, 9),3)\n)).toDF(\"features\", \"label\")\nval indxr = new VectorIndexer()\n.setInputCol(\"features\")\n.setOutputCol(\"idxed\")\n.setMaxCategories(2)\nindxr.fit(idxIn).transform(idxIn).show","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------+-----+-------------+\n|     features|label|        idxed|\n+-------------+-----+-------------+\n|[1.0,2.0,3.0]|    1|[0.0,2.0,3.0]|\n|[2.0,5.0,6.0]|    2|[1.0,5.0,6.0]|\n|[1.0,8.0,9.0]|    3|[0.0,8.0,9.0]|\n+-------------+-----+-------------+\n\nimport org.apache.spark.ml.feature.VectorIndexer\nimport org.apache.spark.ml.linalg.Vectors\nidxIn: org.apache.spark.sql.DataFrame = [features: vector, label: int]\nindxr: org.apache.spark.ml.feature.VectorIndexer = vecIdx_747a09572cbc\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650735697,"submitTime":1497650735664,"finishTime":1497650735956,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"30c2f4a0-8d7e-4211-ac9f-165f5203bfc9"},{"version":"CommandV1","origId":2060825016293873,"guid":"97b220c8-f581-493f-8006-f67d293f3251","subtype":"command","commandType":"auto","position":143.0,"command":"from pyspark.ml.feature import VectorIndexer\nfrom pyspark.ml.linalg import Vectors\nidxIn = spark.createDataFrame([\n(Vectors.dense(1, 2, 3),1),\n(Vectors.dense(2, 5, 6),2),\n(Vectors.dense(1, 8, 9),3)\n]).toDF(\"features\", \"label\")\nindxr = VectorIndexer()\\\n.setInputCol(\"features\")\\\n.setOutputCol(\"idxed\")\\\n.setMaxCategories(2)\nindxr.fit(idxIn).transform(idxIn).show","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">84</span><span class=\"ansired\">]: </span>&lt;bound method DataFrame.show of DataFrame[features: vector, label: bigint, idxed: vector]&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650744102,"submitTime":1497650744067,"finishTime":1497650744376,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cbc3901e-5ae4-4c89-9888-4b6a8986d45f"},{"version":"CommandV1","origId":2060825016293874,"guid":"5badb2c9-cde9-4fbc-bd5d-499a2dbdf9e0","subtype":"command","commandType":"auto","position":144.0,"command":"%scala\nval labelIndexer = new StringIndexer()\n.setInputCol(\"color\")\n.setOutputCol(\"colorInd\")\nval colorLab = labelIndexer.fit(simpleDF).transform(simpleDF)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">labelIndexer: org.apache.spark.ml.feature.StringIndexer = strIdx_39ec98485bf7\ncolorLab: org.apache.spark.sql.DataFrame = [color: string, lab: string ... 3 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650751160,"submitTime":1497650751127,"finishTime":1497650751453,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b1169c4e-7978-4ec1-bde0-192dab53e19d"},{"version":"CommandV1","origId":2060825016293875,"guid":"35b7315f-e660-44f1-9ba4-01781d751786","subtype":"command","commandType":"auto","position":145.0,"command":"labelIndexer = StringIndexer()\\\n.setInputCol(\"color\")\\\n.setOutputCol(\"colorInd\")\ncolorLab = labelIndexer.fit(simpleDF).transform(simpleDF)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650757298,"submitTime":1497650757263,"finishTime":1497650757419,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"03c92af2-d728-49bf-9262-2fe93afd8885"},{"version":"CommandV1","origId":2060825016293876,"guid":"98655adf-8e4a-4c98-8dd0-d9059ab55b0b","subtype":"command","commandType":"auto","position":146.0,"command":"%scala\nimport org.apache.spark.ml.feature.OneHotEncoder\nval ohe = new OneHotEncoder()\n.setInputCol(\"colorInd\")\nohe.transform(colorLab).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+---------------------------+\n|color| lab|value1|            value2|colorInd|oneHot_00e6841f34d4__output|\n+-----+----+------+------------------+--------+---------------------------+\n|green|good|     1|14.386294994851129|     1.0|              (2,[1],[1.0])|\n| blue| bad|     8|14.386294994851129|     2.0|                  (2,[],[])|\n| blue| bad|    12|14.386294994851129|     2.0|                  (2,[],[])|\n|green|good|    15| 38.97187133755819|     1.0|              (2,[1],[1.0])|\n|green|good|    12|14.386294994851129|     1.0|              (2,[1],[1.0])|\n|green| bad|    16|14.386294994851129|     1.0|              (2,[1],[1.0])|\n|  red|good|    35|14.386294994851129|     0.0|              (2,[0],[1.0])|\n|  red| bad|     1| 38.97187133755819|     0.0|              (2,[0],[1.0])|\n|  red| bad|     2|14.386294994851129|     0.0|              (2,[0],[1.0])|\n|  red| bad|    16|14.386294994851129|     0.0|              (2,[0],[1.0])|\n|  red|good|    45| 38.97187133755819|     0.0|              (2,[0],[1.0])|\n|green|good|     1|14.386294994851129|     1.0|              (2,[1],[1.0])|\n| blue| bad|     8|14.386294994851129|     2.0|                  (2,[],[])|\n| blue| bad|    12|14.386294994851129|     2.0|                  (2,[],[])|\n|green|good|    15| 38.97187133755819|     1.0|              (2,[1],[1.0])|\n|green|good|    12|14.386294994851129|     1.0|              (2,[1],[1.0])|\n|green| bad|    16|14.386294994851129|     1.0|              (2,[1],[1.0])|\n|  red|good|    35|14.386294994851129|     0.0|              (2,[0],[1.0])|\n|  red| bad|     1| 38.97187133755819|     0.0|              (2,[0],[1.0])|\n|  red| bad|     2|14.386294994851129|     0.0|              (2,[0],[1.0])|\n+-----+----+------+------------------+--------+---------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.OneHotEncoder\nohe: org.apache.spark.ml.feature.OneHotEncoder = oneHot_00e6841f34d4\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650763221,"submitTime":1497650763187,"finishTime":1497650763523,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7f137a83-307a-4765-80e1-07edc26936e3"},{"version":"CommandV1","origId":2060825016293877,"guid":"3cafb758-13f2-4ebd-b543-3bfda9abca8f","subtype":"command","commandType":"auto","position":147.0,"command":"from pyspark.ml.feature import OneHotEncoder\nohe = OneHotEncoder()\\\n.setInputCol(\"colorInd\")\nohe.transform(colorLab).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+------+------------------+--------+------------------------------------------+\n|color| lab|value1|            value2|colorInd|OneHotEncoder_445c865fde9270fada1f__output|\n+-----+----+------+------------------+--------+------------------------------------------+\n|green|good|     1|14.386294994851129|     1.0|                             (2,[1],[1.0])|\n| blue| bad|     8|14.386294994851129|     2.0|                                 (2,[],[])|\n| blue| bad|    12|14.386294994851129|     2.0|                                 (2,[],[])|\n|green|good|    15| 38.97187133755819|     1.0|                             (2,[1],[1.0])|\n|green|good|    12|14.386294994851129|     1.0|                             (2,[1],[1.0])|\n|green| bad|    16|14.386294994851129|     1.0|                             (2,[1],[1.0])|\n|  red|good|    35|14.386294994851129|     0.0|                             (2,[0],[1.0])|\n|  red| bad|     1| 38.97187133755819|     0.0|                             (2,[0],[1.0])|\n|  red| bad|     2|14.386294994851129|     0.0|                             (2,[0],[1.0])|\n|  red| bad|    16|14.386294994851129|     0.0|                             (2,[0],[1.0])|\n|  red|good|    45| 38.97187133755819|     0.0|                             (2,[0],[1.0])|\n|green|good|     1|14.386294994851129|     1.0|                             (2,[1],[1.0])|\n| blue| bad|     8|14.386294994851129|     2.0|                                 (2,[],[])|\n| blue| bad|    12|14.386294994851129|     2.0|                                 (2,[],[])|\n|green|good|    15| 38.97187133755819|     1.0|                             (2,[1],[1.0])|\n|green|good|    12|14.386294994851129|     1.0|                             (2,[1],[1.0])|\n|green| bad|    16|14.386294994851129|     1.0|                             (2,[1],[1.0])|\n|  red|good|    35|14.386294994851129|     0.0|                             (2,[0],[1.0])|\n|  red| bad|     1| 38.97187133755819|     0.0|                             (2,[0],[1.0])|\n|  red| bad|     2|14.386294994851129|     0.0|                             (2,[0],[1.0])|\n+-----+----+------+------------------+--------+------------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650769172,"submitTime":1497650769137,"finishTime":1497650769343,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5a653b8f-4cdd-41de-a04c-9e42519f6a72"},{"version":"CommandV1","origId":2060825016293878,"guid":"2c379625-9aee-4e3b-b00d-032fe0ccc953","subtype":"command","commandType":"auto","position":148.0,"command":"%scala\nimport org.apache.spark.ml.feature.PCA\nval pca = new PCA()\n.setInputCol(\"features\")\n.setK(2)\npca.fit(scaleDF).transform(scaleDF).show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+------------------------------------------+\n|id |features      |pca_bdb26011b1b5__output                  |\n+---+--------------+------------------------------------------+\n|0  |[1.0,0.1,-1.0]|[0.0713719499248418,-0.4526654888147822]  |\n|1  |[2.0,1.1,1.0] |[-1.680494698407372,1.259340132221917]    |\n|0  |[1.0,0.1,-1.0]|[0.0713719499248418,-0.4526654888147822]  |\n|1  |[2.0,1.1,1.0] |[-1.680494698407372,1.259340132221917]    |\n|1  |[3.0,10.1,3.0]|[-10.872398139848944,0.030962697060150646]|\n+---+--------------+------------------------------------------+\n\nimport org.apache.spark.ml.feature.PCA\npca: org.apache.spark.ml.feature.PCA = pca_bdb26011b1b5\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650782842,"submitTime":1497650782721,"finishTime":1497650783650,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5f820bad-6ec2-4f15-82c0-12f443ea0e64"},{"version":"CommandV1","origId":2060825016293879,"guid":"5436b63a-a6fb-475a-b96d-2a70a60855af","subtype":"command","commandType":"auto","position":149.0,"command":"from pyspark.ml.feature import PCA\npca = PCA()\\\n.setInputCol(\"features\")\\\n.setK(2)\npca.fit(scaleDF).transform(scaleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+--------------------------------+\n| id|      features|PCA_41c59397a4cff1a39a0d__output|\n+---+--------------+--------------------------------+\n|  0|[1.0,0.1,-1.0]|            [0.07137194992484...|\n|  1| [2.0,1.1,1.0]|            [-1.6804946984073...|\n|  0|[1.0,0.1,-1.0]|            [0.07137194992484...|\n|  1| [2.0,1.1,1.0]|            [-1.6804946984073...|\n|  1|[3.0,10.1,3.0]|            [-10.872398139848...|\n+---+--------------+--------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650789735,"submitTime":1497650789700,"finishTime":1497650790658,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f873a64d-fc33-4a76-9627-1b558041a7a5"},{"version":"CommandV1","origId":2060825016293880,"guid":"8056e990-ec35-44f7-9592-8973a4f1a808","subtype":"command","commandType":"auto","position":150.0,"command":"%scala\nimport org.apache.spark.ml.feature.PolynomialExpansion\nval pe = new PolynomialExpansion()\n.setInputCol(\"features\")\n.setDegree(2)\npe.transform(scaleDF).show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+-----------------------------------------------------------------------------------+\n|id |features      |poly_5d66aa554938__output                                                          |\n+---+--------------+-----------------------------------------------------------------------------------+\n|0  |[1.0,0.1,-1.0]|[1.0,1.0,0.1,0.1,0.010000000000000002,-1.0,-1.0,-0.1,1.0]                          |\n|1  |[2.0,1.1,1.0] |[2.0,4.0,1.1,2.2,1.2100000000000002,1.0,2.0,1.1,1.0]                               |\n|0  |[1.0,0.1,-1.0]|[1.0,1.0,0.1,0.1,0.010000000000000002,-1.0,-1.0,-0.1,1.0]                          |\n|1  |[2.0,1.1,1.0] |[2.0,4.0,1.1,2.2,1.2100000000000002,1.0,2.0,1.1,1.0]                               |\n|1  |[3.0,10.1,3.0]|[3.0,9.0,10.1,30.299999999999997,102.00999999999999,3.0,9.0,30.299999999999997,9.0]|\n+---+--------------+-----------------------------------------------------------------------------------+\n\nimport org.apache.spark.ml.feature.PolynomialExpansion\npe: org.apache.spark.ml.feature.PolynomialExpansion = poly_5d66aa554938\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650797046,"submitTime":1497650797013,"finishTime":1497650797348,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0080764d-44bc-4e78-b2ec-b9bd13d326b2"},{"version":"CommandV1","origId":2060825016293881,"guid":"0f924cc6-c935-402b-b8ec-450c547b1a83","subtype":"command","commandType":"auto","position":151.0,"command":"from pyspark.ml.feature import PolynomialExpansion\npe = PolynomialExpansion()\\\n.setInputCol(\"features\")\\\n.setDegree(2)\npe.transform(scaleDF).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+--------------+------------------------------------------------+\n| id|      features|PolynomialExpansion_4f6b8685d368790324ee__output|\n+---+--------------+------------------------------------------------+\n|  0|[1.0,0.1,-1.0]|                            [1.0,1.0,0.1,0.1,...|\n|  1| [2.0,1.1,1.0]|                            [2.0,4.0,1.1,2.2,...|\n|  0|[1.0,0.1,-1.0]|                            [1.0,1.0,0.1,0.1,...|\n|  1| [2.0,1.1,1.0]|                            [2.0,4.0,1.1,2.2,...|\n|  1|[3.0,10.1,3.0]|                            [3.0,9.0,10.1,30....|\n+---+--------------+------------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650804546,"submitTime":1497650804509,"finishTime":1497650804767,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"61d0ee3c-3c38-4cdf-885b-9ad8a33550fa"},{"version":"CommandV1","origId":2060825016293882,"guid":"ca7d8ad3-021f-4b68-842c-4ecaf80dfe20","subtype":"command","commandType":"auto","position":152.0,"command":"%scala\nimport org.apache.spark.ml.feature.ChiSqSelector\nval prechi = fittedCV.transform(tokenized)\n.where(\"CustomerId IS NOT NULL\")\nval chisq = new ChiSqSelector()\n.setFeaturesCol(\"countVec\")\n.setLabelCol(\"CustomerID\")\n.setNumTopFeatures(2)\nchisq.fit(prechi).transform(prechi).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+----------------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|            countVec|chiSqSelector_6fd066430552__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+----------------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|(500,[4,15,19,21,...|                         (2,[],[])|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|(500,[14,15,208],...|                         (2,[],[])|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|(500,[57,98,222,2...|                         (2,[],[])|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|(500,[34,39,40,89...|                         (2,[],[])|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|(500,[3,15],[1.0,...|                         (2,[],[])|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|(500,[0,160,163],...|                     (2,[0],[1.0])|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|(500,[21,23,31,84...|                         (2,[],[])|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|(500,[89,101,112,...|                         (2,[],[])|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|(500,[3,101,112],...|                         (2,[],[])|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|(500,[62,79,87,30...|                         (2,[],[])|\n|   536367|    22745|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|(500,[317,318],[1...|                         (2,[],[])|\n|   536367|    22748|POPPY'S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy's, playhou...|(500,[145,317,318...|                         (2,[],[])|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|(500,[64,77,221,3...|                         (2,[],[])|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|(500,[54,55,348],...|                         (2,[],[])|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|(500,[1,10,27,62,...|                     (2,[1],[1.0])|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,274]...|                     (2,[1],[1.0])|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,132]...|                     (2,[1],[1.0])|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|(500,[44,217,258,...|                         (2,[],[])|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|(500,[59,217,258,...|                         (2,[],[])|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|(500,[4,10,14,41,...|                         (2,[],[])|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+----------------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.ml.feature.ChiSqSelector\nprechi: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [InvoiceNo: string, StockCode: string ... 8 more fields]\nchisq: org.apache.spark.ml.feature.ChiSqSelector = chiSqSelector_6fd066430552\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650811980,"submitTime":1497650811946,"finishTime":1497650932237,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d8375128-2426-4c13-a2e4-03d8707b27fb"},{"version":"CommandV1","origId":2060825016293883,"guid":"42c3d4d0-790e-4fd5-bf45-c94dde9ec632","subtype":"command","commandType":"auto","position":153.0,"command":"from pyspark.ml.feature import ChiSqSelector\nprechi = fittedCV.transform(tokenized)\\\n.where(\"CustomerId IS NOT NULL\")\nchisq = ChiSqSelector()\\\n.setFeaturesCol(\"countVec\")\\\n.setLabelCol(\"CustomerID\")\\\n.setNumTopFeatures(2)\nchisq.fit(prechi).transform(prechi).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+------------------------------------------+\n|InvoiceNo|StockCode|         Description|Quantity|   InvoiceDate|UnitPrice|CustomerID|       Country|      DescriptionOut|            countVec|ChiSqSelector_44bfbbb6a5019487440a__output|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+------------------------------------------+\n|   536365|   85123A|WHITE HANGING HEA...|       6|12/1/2010 8:26|     2.55|     17850|United Kingdom|[white, hanging, ...|(500,[4,15,19,21,...|                                 (2,[],[])|\n|   536365|    71053| WHITE METAL LANTERN|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[white, metal, la...|(500,[14,15,208],...|                                 (2,[],[])|\n|   536365|   84406B|CREAM CUPID HEART...|       8|12/1/2010 8:26|     2.75|     17850|United Kingdom|[cream, cupid, he...|(500,[57,98,222,2...|                                 (2,[],[])|\n|   536365|   84029G|KNITTED UNION FLA...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[knitted, union, ...|(500,[34,39,40,89...|                                 (2,[],[])|\n|   536365|   84029E|RED WOOLLY HOTTIE...|       6|12/1/2010 8:26|     3.39|     17850|United Kingdom|[red, woolly, hot...|(500,[3,15],[1.0,...|                                 (2,[],[])|\n|   536365|    22752|SET 7 BABUSHKA NE...|       2|12/1/2010 8:26|     7.65|     17850|United Kingdom|[set, 7, babushka...|(500,[0,160,163],...|                             (2,[0],[1.0])|\n|   536365|    21730|GLASS STAR FROSTE...|       6|12/1/2010 8:26|     4.25|     17850|United Kingdom|[glass, star, fro...|(500,[21,23,31,84...|                                 (2,[],[])|\n|   536366|    22633|HAND WARMER UNION...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, un...|(500,[89,101,112,...|                                 (2,[],[])|\n|   536366|    22632|HAND WARMER RED P...|       6|12/1/2010 8:28|     1.85|     17850|United Kingdom|[hand, warmer, re...|(500,[3,101,112],...|                                 (2,[],[])|\n|   536367|    84879|ASSORTED COLOUR B...|      32|12/1/2010 8:34|     1.69|     13047|United Kingdom|[assorted, colour...|(500,[62,79,87,30...|                                 (2,[],[])|\n|   536367|    22745|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|(500,[317,318],[1...|                                 (2,[],[])|\n|   536367|    22748|POPPY&apos;S PLAYHOUSE...|       6|12/1/2010 8:34|      2.1|     13047|United Kingdom|[poppy&apos;s, playhou...|(500,[145,317,318...|                                 (2,[],[])|\n|   536367|    22749|FELTCRAFT PRINCES...|       8|12/1/2010 8:34|     3.75|     13047|United Kingdom|[feltcraft, princ...|(500,[64,77,221,3...|                                 (2,[],[])|\n|   536367|    22310|IVORY KNITTED MUG...|       6|12/1/2010 8:34|     1.65|     13047|United Kingdom|[ivory, knitted, ...|(500,[54,55,348],...|                                 (2,[],[])|\n|   536367|    84969|BOX OF 6 ASSORTED...|       6|12/1/2010 8:34|     4.25|     13047|United Kingdom|[box, of, 6, asso...|(500,[1,10,27,62,...|                             (2,[1],[1.0])|\n|   536367|    22623|BOX OF VINTAGE JI...|       3|12/1/2010 8:34|     4.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,274]...|                             (2,[1],[1.0])|\n|   536367|    22622|BOX OF VINTAGE AL...|       2|12/1/2010 8:34|     9.95|     13047|United Kingdom|[box, of, vintage...|(500,[1,6,10,132]...|                             (2,[1],[1.0])|\n|   536367|    21754|HOME BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[home, building, ...|(500,[44,217,258,...|                                 (2,[],[])|\n|   536367|    21755|LOVE BUILDING BLO...|       3|12/1/2010 8:34|     5.95|     13047|United Kingdom|[love, building, ...|(500,[59,217,258,...|                                 (2,[],[])|\n|   536367|    21777|RECIPE BOX WITH M...|       4|12/1/2010 8:34|     7.95|     13047|United Kingdom|[recipe, box, wit...|(500,[4,10,14,41,...|                                 (2,[],[])|\n+---------+---------+--------------------+--------+--------------+---------+----------+--------------+--------------------+--------------------+------------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497650932241,"submitTime":1497650819394,"finishTime":1497651057403,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e764c961-ade5-4e8e-9309-e36f9f5191d5"},{"version":"CommandV1","origId":2060825016293884,"guid":"5c6840b5-16c1-49c1-bbea-97227a82ccab","subtype":"command","commandType":"auto","position":154.0,"command":"%scala\nval fittedPCA = pca.fit(scaleDF)\nfittedPCA.write.overwrite().save(\"/tmp/fittedPCA\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">fittedPCA: org.apache.spark.ml.feature.PCAModel = pca_bdb26011b1b5\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497651057407,"submitTime":1497650829841,"finishTime":1497651060506,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7c638a3e-307e-4e0f-9e74-21e047f5b8d5"},{"version":"CommandV1","origId":2060825016293885,"guid":"8c7a3910-7359-4475-8993-6977a4e4c942","subtype":"command","commandType":"auto","position":155.0,"command":"%scala\nimport org.apache.spark.ml.UnaryTransformer\nimport org.apache.spark.ml.util.{DefaultParamsReadable, DefaultParamsWritable, Identifiable}\nimport org.apache.spark.sql.types.{ArrayType, StringType, DataType}\nimport org.apache.spark.ml.param.{IntParam, ParamValidators}\nclass MyTokenizer(override val uid: String)\nextends UnaryTransformer[String, Seq[String], MyTokenizer] with DefaultParamsWritable {\ndef this() = this(Identifiable.randomUID(\"myTokenizer\"))\nval maxWords: IntParam = new IntParam(this, \"maxWords\", \"The max number of words to return.\",\nParamValidators.gtEq(0))\ndef setMaxWords(value: Int): this.type = set(maxWords, value)\n  def getMaxWords: Integer = $(maxWords)\noverride protected def createTransformFunc: String => Seq[String] = (inputString: String) => {\ninputString.split(\"\\\\s\").take($(maxWords))\n}\noverride protected def validateInputType(inputType: DataType): Unit = {\nrequire(inputType == StringType, s\"Bad input type: $inputType. Requires String.\")\n}\noverride protected def outputDataType: DataType = new ArrayType(StringType, true)\n}\n// this will allow you to read it back in by using this object.\nobject MyTokenizer extends DefaultParamsReadable[MyTokenizer]\nval myT = new MyTokenizer()\n.setInputCol(\"someCol\")\n.setMaxWords(2)\ndisplay(myT.transform(Seq(\"hello world. This text won't show.\").toDF(\"someCol\")))\nmyT.write.overwrite().save(\"/tmp/something\")","commandVersion":0,"state":"finished","results":{"type":"table","data":[["hello world. This text won't show.",["hello","world."]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"someCol","type":"\"string\"","metadata":"{}"},{"name":"myTokenizer_dbf5a2966866__output","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497651060510,"submitTime":1497650867487,"finishTime":1497651061628,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4251a7b9-ed3d-421e-a470-8314ec5fb139"}],"dashboards":[],"guid":"4b83e4b3-751c-4b9c-b72b-c345d61944de","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
