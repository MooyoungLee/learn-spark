<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Definitive Draft Chapter 9-11 - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"serverlessDefaultSparkVersion":"2.2.x-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","enableTableHandler":false,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"3.0 beta (Scala 2.11)","packageLabel":"spark-image-20adedc466bac7d0c91242baba4ae70dc8487d6e301359af185601969607d211","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-f43ddf8ad9acfd71338f5a51345f077173d236016ad7e39ffd6f698403acd4ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"3.0 beta (Scala 2.10)","packageLabel":"spark-image-a1d408c36c3e2c79b38783b57b626c7c6847c9639fa15dd22eca009c23b89c6f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":6,"class-node":1,"m4.2xlarge":0.5,"r4.xlarge":1,"m4.4xlarge":0.5,"r4.16xlarge":8,"Standard_DS11":0.5,"p2.8xlarge":16,"m4.10xlarge":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.5,"r4.8xlarge":8,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.5,"p2.16xlarge":24,"i3.8xlarge":12,"i3.16xlarge":24,"Standard_DS12_v2":1,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"i3.2xlarge":3,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":0.5,"c4.8xlarge":4,"i3.xlarge":1.5,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.47","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableNonPollingTableCall":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":180,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"enableElasticDisk":false,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"ea633ce26684806264e7bd2cbb05130eb0f98c4d","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewJobList":false,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"enableEBSVolumesUIByTier":false,"singleSignOnComingSoon":false,"enableNewJobClusterEdit":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2060825016293633,"name":"Definitive Draft Chapter 9-11","language":"python","commands":[{"version":"CommandV1","origId":2060825016293635,"guid":"4546f663-b919-414e-bca5-ab26390592b0","subtype":"command","commandType":"auto","position":1.0,"command":"%scala\ncase class Flight(DEST_COUNTRY_NAME: String, ORIGIN_COUNTRY_NAME: String, count: BigInt)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class Flight\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645618299,"submitTime":1497645618296,"finishTime":1497645619535,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8d9849d3-f18b-4b2a-a218-36e0f086071e"},{"version":"CommandV1","origId":2060825016293636,"guid":"6ba8257c-8862-484d-974e-f50605a20de9","subtype":"command","commandType":"auto","position":2.0,"command":"%scala\nval flightsDF = spark.read.parquet(\"FileStore/tables/6jc7prea1497642653485/part_r_00000_1a9822ba_b8fb_4d8e_844a_ea30d0801b9e_gz-11168.parquet\")\nval flights = flightsDF.as[Flight]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">flightsDF: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, ORIGIN_COUNTRY_NAME: string ... 1 more field]\nflights: org.apache.spark.sql.Dataset[Flight] = [DEST_COUNTRY_NAME: string, ORIGIN_COUNTRY_NAME: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-1-39ec56fb2f36&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    val flightsDF = spark.read.parquet(&quot;FileStore/tables/6jc7prea1497642653485/part_r_00000_1a9822ba_b8fb_4d8e_844a_ea30d0801b9e_gz-11168.parquet&quot;)</span>\n<span class=\"ansigrey\">                ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1497645693004,"submitTime":1497645693001,"finishTime":1497645694094,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0b7e4d59-6b35-4c18-9068-c7b063bc979d"},{"version":"CommandV1","origId":2060825016293637,"guid":"fa709e6e-c9ed-41dc-a4ae-f559eddeffe1","subtype":"command","commandType":"auto","position":3.0,"command":"%scala\nflights.take(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res0: Array[Flight] = Array(Flight(United States,Romania,1), Flight(United States,Ireland,264))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645707965,"submitTime":1497645707964,"finishTime":1497645708288,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3fc2b379-3949-41bb-97bc-a0a0737f9455"},{"version":"CommandV1","origId":2060825016293638,"guid":"3b3a3f30-b369-478b-a2d5-24c8ccafecb0","subtype":"command","commandType":"auto","position":4.0,"command":"%scala\nflights.first.DEST_COUNTRY_NAME","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res1: String = United States\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645718499,"submitTime":1497645718496,"finishTime":1497645718751,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8459c71c-737d-4eee-bdff-1b913cca66e6"},{"version":"CommandV1","origId":2060825016293639,"guid":"03eb9fe8-d048-48ca-8e7f-f1715591d59a","subtype":"command","commandType":"auto","position":5.0,"command":"%scala\ndef originIsDestination(flight_row: Flight): Boolean = {\nreturn flight_row.ORIGIN_COUNTRY_NAME == flight_row.DEST_COUNTRY_NAME\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">originIsDestination: (flight_row: Flight)Boolean\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645728416,"submitTime":1497645728413,"finishTime":1497645728519,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b8a3acc6-316d-4a6c-ad99-dc778ca0cff7"},{"version":"CommandV1","origId":2060825016293640,"guid":"6b66fbfa-4e58-423e-9eac-3d766f4cf706","subtype":"command","commandType":"auto","position":6.0,"command":"%scala\nflights.filter(flight_row => originIsDestination(flight_row)).first()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res2: Flight = Flight(United States,United States,348113)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645740320,"submitTime":1497645740317,"finishTime":1497645740806,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e65c6ad4-f368-4d16-bde9-dcae2fe23869"},{"version":"CommandV1","origId":2060825016293641,"guid":"49402c3b-178c-421b-8de3-6eac72e99f16","subtype":"command","commandType":"auto","position":7.0,"command":"%scala\nflights.collect().filter(flight_row => originIsDestination(flight_row))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res3: Array[Flight] = Array(Flight(United States,United States,348113))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645750098,"submitTime":1497645750094,"finishTime":1497645750469,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1115a6f2-5892-4c63-ba97-d422de959fbb"},{"version":"CommandV1","origId":2060825016293642,"guid":"4cf027d1-1cbc-4f15-b30f-cfae56f80e2e","subtype":"command","commandType":"auto","position":8.0,"command":"%scala\nval destinations = flights.map(f => f.DEST_COUNTRY_NAME)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">destinations: org.apache.spark.sql.Dataset[String] = [value: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645758258,"submitTime":1497645758255,"finishTime":1497645758369,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5f5c3d7e-1eb0-495b-a674-85da613140e6"},{"version":"CommandV1","origId":2060825016293643,"guid":"b7a66c71-dd31-40a6-9acd-9e046c219bee","subtype":"command","commandType":"auto","position":9.0,"command":"%scala\nval localDestinations = destinations.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">localDestinations: Array[String] = Array(United States, United States, United States, Egypt, Equatorial Guinea, United States, United States, Costa Rica, Senegal, United States)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645766127,"submitTime":1497645766124,"finishTime":1497645766434,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"654889c2-6443-476e-a22f-69612690ef64"},{"version":"CommandV1","origId":2060825016293644,"guid":"be9274c1-e77f-4ca8-ba59-294957eaf47e","subtype":"command","commandType":"auto","position":10.0,"command":"%scala\ncase class FlightMetadata(count: BigInt, randomData: BigInt)\nval flightsMeta = spark.range(500)\n.map(x => (x, scala.util.Random.nextLong))\n.withColumnRenamed(\"_1\", \"count\")\n.withColumnRenamed(\"_2\", \"randomData\")\n.as[FlightMetadata]\nval flights2 = flights\n.joinWith(flightsMeta,\nflights.col(\"count\") === flightsMeta.col(\"count\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class FlightMetadata\nflightsMeta: org.apache.spark.sql.Dataset[FlightMetadata] = [count: bigint, randomData: bigint]\nflights2: org.apache.spark.sql.Dataset[(Flight, FlightMetadata)] = [_1: struct&lt;DEST_COUNTRY_NAME: string, ORIGIN_COUNTRY_NAME: string ... 1 more field&gt;, _2: struct&lt;count: bigint, randomData: bigint&gt;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645777068,"submitTime":1497645777065,"finishTime":1497645777590,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e9899493-dc2d-405e-b1fd-738ac95accf2"},{"version":"CommandV1","origId":2060825016293645,"guid":"a35446ff-82d9-43ac-aef8-a0f316100db3","subtype":"command","commandType":"auto","position":11.0,"command":"%scala\nflights2.selectExpr(\"_1.DEST_COUNTRY_NAME\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res4: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645790619,"submitTime":1497645790616,"finishTime":1497645790698,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1012001d-439e-4cd7-b967-cef33306f3d5"},{"version":"CommandV1","origId":2060825016293646,"guid":"fc333017-27fd-4125-8bd0-8e55a342928d","subtype":"command","commandType":"auto","position":12.0,"command":"%scala\nflights2.take(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res5: Array[(Flight, FlightMetadata)] = Array((Flight(United States,Romania,1),FlightMetadata(1,7390762848989512551)), (Flight(United States,Ireland,264),FlightMetadata(264,-1668277617939568846)))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645800455,"submitTime":1497645800452,"finishTime":1497645800835,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"52d6fed9-23d7-47f0-a3f1-6f9aca2cd7be"},{"version":"CommandV1","origId":2060825016293647,"guid":"82211231-a83b-4c2f-b65e-071f34774b18","subtype":"command","commandType":"auto","position":13.0,"command":"%scala\nval flights2 = flights.join(flightsMeta, Seq(\"count\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">flights2: org.apache.spark.sql.DataFrame = [count: bigint, DEST_COUNTRY_NAME: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645809944,"submitTime":1497645809941,"finishTime":1497645810051,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ed5080fb-0833-4154-99dd-fd3dc5251b0b"},{"version":"CommandV1","origId":2060825016293648,"guid":"3a20498b-dc39-4463-8c58-75f006190284","subtype":"command","commandType":"auto","position":14.0,"command":"%scala\nval flights2 = flights.join(flightsMeta.toDF(), Seq(\"count\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">flights2: org.apache.spark.sql.DataFrame = [count: bigint, DEST_COUNTRY_NAME: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645819169,"submitTime":1497645819165,"finishTime":1497645819267,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fcad7874-6017-4769-ab3c-b814d9ff9852"},{"version":"CommandV1","origId":2060825016293649,"guid":"da4c07e3-42c7-49c3-9357-792187cd45fc","subtype":"command","commandType":"auto","position":15.0,"command":"%scala\ns\"${sc.uiWebUrl.get}/api/v1/applications/${sc.applicationId}\"\nflights.groupBy(\"DEST_COUNTRY_NAME\").count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res6: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, count: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645829607,"submitTime":1497645829604,"finishTime":1497645829691,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2a53698d-dc59-4af4-8a85-7c21eebc7e7b"},{"version":"CommandV1","origId":2060825016293650,"guid":"d41dbf99-f29d-4cf6-b33c-4f4c5ef6139f","subtype":"command","commandType":"auto","position":16.0,"command":"%scala\nflights.groupByKey(x => x.DEST_COUNTRY_NAME).count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res7: org.apache.spark.sql.Dataset[(String, Long)] = [value: string, count(1): bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645837763,"submitTime":1497645837760,"finishTime":1497645837874,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a3b547b2-b790-478b-babc-2868679fa5f4"},{"version":"CommandV1","origId":2060825016293651,"guid":"0d315c2d-ab5f-4b88-b4a6-e456a0aea4d2","subtype":"command","commandType":"auto","position":17.0,"command":"%scala\nflights.groupByKey(x => x.DEST_COUNTRY_NAME).count().explain","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*HashAggregate(keys=[value#14417], functions=[count(1)])\n+- Exchange hashpartitioning(value#14417, 200)\n   +- *HashAggregate(keys=[value#14417], functions=[partial_count(1)])\n      +- *Project [value#14417]\n         +- AppendColumns &lt;function1&gt;, newInstance(class line8d72cea39f66484096f38585a5a0a09312.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$Flight), [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, input[0, java.lang.String, true], true) AS value#14417]\n            +- *FileScan parquet [DEST_COUNTRY_NAME#14338,ORIGIN_COUNTRY_NAME#14339,count#14340L] Batched: true, Format: Parquet, Location: InMemoryFileIndex[dbfs:/FileStore/tables/6jc7prea1497642653485/part_r_00000_1a9822ba_b8fb_4d8e_84..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;DEST_COUNTRY_NAME:string,ORIGIN_COUNTRY_NAME:string,count:bigint&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645847486,"submitTime":1497645847483,"finishTime":1497645847606,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9c1c13ce-a4c3-4845-932a-90c6f8f34cbc"},{"version":"CommandV1","origId":2060825016293652,"guid":"c2915892-fef5-483b-9c6b-6bf1a50732c7","subtype":"command","commandType":"auto","position":18.0,"command":"%scala\ndef grpSum(countryName:String, values: Iterator[Flight]) = {\nvalues.dropWhile(_.count < 5).map(x => (countryName, x))\n}\nflights.groupByKey(x => x.DEST_COUNTRY_NAME).flatMapGroups(grpSum).take(5)\ndef grpSum2(f:Flight):Integer = {\n1\n}\nflights.groupByKey(x => x.DEST_COUNTRY_NAME).mapValues(grpSum2).count().take(5)\ndef sum2(left:Flight, right:Flight) = {\nFlight(left.DEST_COUNTRY_NAME, null, left.count + right.count)\n}\nflights.groupByKey(x => x.DEST_COUNTRY_NAME).reduceGroups((l, r) => sum2(l, r)).take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">grpSum: (countryName: String, values: Iterator[Flight])Iterator[(String, Flight)]\ngrpSum2: (f: Flight)Integer\nsum2: (left: Flight, right: Flight)Flight\nres9: Array[(String, Flight)] = Array((Anguilla,Flight(Anguilla,United States,21)), (Paraguay,Flight(Paraguay,United States,90)), (Russia,Flight(Russia,United States,152)), (Senegal,Flight(Senegal,United States,29)), (Sweden,Flight(Sweden,United States,65)))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645857403,"submitTime":1497645857400,"finishTime":1497645859507,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"02c6010d-6982-4771-b380-64ba279c3adf"},{"version":"CommandV1","origId":2060825016293653,"guid":"551cf4ae-dd3c-432e-b724-a6e3408ab264","subtype":"command","commandType":"auto","position":19.0,"command":"%scala\nflights.groupBy(\"DEST_COUNTRY_NAME\").count().explain","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*HashAggregate(keys=[DEST_COUNTRY_NAME#14338], functions=[count(1)])\n+- Exchange hashpartitioning(DEST_COUNTRY_NAME#14338, 200)\n   +- *HashAggregate(keys=[DEST_COUNTRY_NAME#14338], functions=[partial_count(1)])\n      +- *FileScan parquet [DEST_COUNTRY_NAME#14338] Batched: true, Format: Parquet, Location: InMemoryFileIndex[dbfs:/FileStore/tables/6jc7prea1497642653485/part_r_00000_1a9822ba_b8fb_4d8e_84..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;DEST_COUNTRY_NAME:string&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645868534,"submitTime":1497645868530,"finishTime":1497645868617,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5f181e3e-240c-44ed-a981-a1c4725a2599"},{"version":"CommandV1","origId":2060825016293654,"guid":"3e24de20-af45-4c42-b10c-3e0e80f4c77d","subtype":"command","commandType":"auto","position":20.0,"command":"%scala\ncase class Transaction(customerId: BigInt, amount: Integer, unitCost:Double, itemId: BigInt)\ncase class Receipt(customerId: BigInt, totalCost: Double)\nval localTransactions = Seq(\nTransaction(1, 5, 5.5, 37),\nTransaction(1, 10, 8.24, 67),\nTransaction(1, 1, 3.5, 22)\n)\nval SparkTransactions = localTransactions.toDF().as[Transaction]\ndef isBigTransaction(transaction: Transaction) = {\n(transaction.amount * transaction.unitCost) > 15\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class Transaction\ndefined class Receipt\nlocalTransactions: Seq[Transaction] = List(Transaction(1,5,5.5,37), Transaction(1,10,8.24,67), Transaction(1,1,3.5,22))\nSparkTransactions: org.apache.spark.sql.Dataset[Transaction] = [customerId: decimal(38,0), amount: int ... 2 more fields]\nisBigTransaction: (transaction: Transaction)Boolean\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645880292,"submitTime":1497645880288,"finishTime":1497645880643,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bcc1e73e-619c-4244-aac4-3226701d4a81"},{"version":"CommandV1","origId":2060825016293655,"guid":"2f6b30c4-8171-4908-bb91-a8e32dc941b6","subtype":"command","commandType":"auto","position":21.0,"command":"%scala\nlocalTransactions.filter(isBigTransaction(_))\nSparkTransactions.filter(isBigTransaction(_))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res11: org.apache.spark.sql.Dataset[Transaction] = [customerId: decimal(38,0), amount: int ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645894630,"submitTime":1497645894627,"finishTime":1497645894745,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"db85b111-fec6-4c0a-bf32-8066d251aa10"},{"version":"CommandV1","origId":2060825016293656,"guid":"9a3e54ee-3ae6-4609-a156-ef7c87b214fb","subtype":"command","commandType":"auto","position":22.0,"command":"%scala\nimport org.apache.spark.SparkConf\nval myConf = new SparkConf().setAppName(\"My Application\")\nspark.sparkContext","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.SparkConf\nmyConf: org.apache.spark.SparkConf = org.apache.spark.SparkConf@3e0746d4\nres12: org.apache.spark.SparkContext = org.apache.spark.SparkContext@1ab696d6\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-2-cb00e56d97ca&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">2</span>\n<span class=\"ansiyellow\">    val myConf = new SparkConf().setAppName(&quot;My Application&quot;)</span>\n<span class=\"ansigrey\">             ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1497645935829,"submitTime":1497645935829,"finishTime":1497645935911,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e19fea1a-18c5-4620-aa29-ff988f427083"},{"version":"CommandV1","origId":2060825016293657,"guid":"7e509f6c-1051-44e9-99cd-6f68825a6404","subtype":"command","commandType":"auto","position":23.0,"command":"%scala\nimport org.apache.spark.SparkContext\nval sc = SparkContext.getOrCreate()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.SparkContext\nsc: org.apache.spark.SparkContext = org.apache.spark.SparkContext@1ab696d6\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645945386,"submitTime":1497645945388,"finishTime":1497645945470,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9d2b40e8-11b6-40f4-a00b-ed2b3787e6c7"},{"version":"CommandV1","origId":2060825016293658,"guid":"046794f1-01f7-4876-9ee1-8526159ebaad","subtype":"command","commandType":"auto","position":24.0,"command":"%scala\nval myCollection = \"Spark The Definitive Guide : Big Data Processing Made Simple\".split(\" \")\nval words = spark.sparkContext.parallelize(myCollection, 2)\nwords.setName(\"myWords\")\nwords.name\nwords.distinct().count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">myCollection: Array[String] = Array(Spark, The, Definitive, Guide, :, Big, Data, Processing, Made, Simple)\nwords: org.apache.spark.rdd.RDD[String] = myWords ParallelCollectionRDD[2078] at parallelize at &lt;console&gt;:44\nres14: Long = 10\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646008256,"submitTime":1497646008255,"finishTime":1497646008715,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8ce60b35-4a01-4908-bb62-f44c0410d14e"},{"version":"CommandV1","origId":2060825016293659,"guid":"6b001d15-79e0-4562-abeb-d0b80a47f823","subtype":"command","commandType":"auto","position":25.0,"command":"%scala\ndef startsWithS(individual:String) = {\nindividual.startsWith(\"S\")\n}\nval onlyS = words.filter(word => startsWithS(word))\nonlyS.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">startsWithS: (individual: String)Boolean\nonlyS: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[2082] at filter at &lt;console&gt;:48\nres15: Array[String] = Array(Spark, Simple)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646035191,"submitTime":1497646035187,"finishTime":1497646035337,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6c1c21b5-1534-428c-81cc-acf5d7431878"},{"version":"CommandV1","origId":2060825016293660,"guid":"ce0f387f-2ac1-4aa2-9526-b9cc7fdf14d7","subtype":"command","commandType":"auto","position":26.0,"command":"%scala\nval words2 = words.map(word => (word, word(0), word.startsWith(\"S\")))\nwords2.filter(record => record._3).take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">words2: org.apache.spark.rdd.RDD[(String, Char, Boolean)] = MapPartitionsRDD[2083] at map at &lt;console&gt;:43\nres16: Array[(String, Char, Boolean)] = Array((Spark,S,true), (Simple,S,true))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646055977,"submitTime":1497646055976,"finishTime":1497646056134,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"70b3ed78-25ca-4279-bc4d-f4c046cb96d1"},{"version":"CommandV1","origId":2060825016293661,"guid":"de91ae5e-aeda-4952-a2ba-b13cc7c54ee4","subtype":"command","commandType":"auto","position":27.0,"command":"%scala\nval characters = words.flatMap(word => word.toSeq)\ncharacters.take(5)\nwords.sortBy(word => word.length() * -1).take(2)\nval fiftyFiftySplit = words.randomSplit(Array[Double](0.5, 0.5))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">characters: org.apache.spark.rdd.RDD[Char] = MapPartitionsRDD[2092] at flatMap at &lt;console&gt;:45\nfiftyFiftySplit: Array[org.apache.spark.rdd.RDD[String]] = Array(MapPartitionsRDD[2098] at randomSplit at &lt;console&gt;:48, MapPartitionsRDD[2099] at randomSplit at &lt;console&gt;:48)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646080714,"submitTime":1497646080716,"finishTime":1497646080931,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0c0a78b7-d126-4bc3-a44d-75217ba78e0d"},{"version":"CommandV1","origId":2060825016293662,"guid":"6fcff5b6-48ff-4ae7-9c1b-af1062cfc28e","subtype":"command","commandType":"auto","position":28.0,"command":"%scala\nsc.parallelize(1 to 20).reduce(_ + _)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res20: Int = 210\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Task not serializable","error":"<div class=\"ansiout\">\tat org.apache.spark.util.ClosureCleaner$.ensureSerializable(ClosureCleaner.scala:298)\n\tat org.apache.spark.util.ClosureCleaner$.org$apache$spark$util$ClosureCleaner$$clean(ClosureCleaner.scala:288)\n\tat org.apache.spark.util.ClosureCleaner$.clean(ClosureCleaner.scala:108)\n\tat org.apache.spark.SparkContext.clean(SparkContext.scala:2135)\n\tat org.apache.spark.rdd.RDD$$anonfun$reduce$1.apply(RDD.scala:1009)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n\tat org.apache.spark.rdd.RDD.reduce(RDD.scala:1008)\nCaused by: java.io.NotSerializableException: org.apache.spark.SparkContext\nSerialization stack:\n\t- object not serializable (class: org.apache.spark.SparkContext, value: org.apache.spark.SparkContext@1ab696d6)\n\t- field (class: line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: sc, type: class org.apache.spark.SparkContext)\n\t- object (class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@721ca0e6)\n\t- field (class: line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@24193136)\n\t- field (class: line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC$$iwC, line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC$$iwC@4159cc6e)\n\t- field (class: line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC, name: $iw, type: class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC, line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC@3dd26575)\n\t- field (class: line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC, name: $iw, type: class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC, line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC@8db72a7)\n\t- field (class: line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC, name: $iw, type: class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC$$iwC)\n\t- object (class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC, line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC@a66e68a)\n\t- field (class: line8d72cea39f66484096f38585a5a0a09338.$read$$iwC, name: $iw, type: class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC$$iwC)\n\t- object (class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC, line8d72cea39f66484096f38585a5a0a09338.$read$$iwC@7e04dfdc)\n\t- field (class: line8d72cea39f66484096f38585a5a0a09338.$read, name: $iw, type: class line8d72cea39f66484096f38585a5a0a09338.$read$$iwC)\n\t- object (class line8d72cea39f66484096f38585a5a0a09338.$read, line8d72cea39f66484096f38585a5a0a09338.$read@27dda70a)\n\t- field (class: line8d72cea39f66484096f38585a5a0a09348.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $VAL212, type: class line8d72cea39f66484096f38585a5a0a09338.$read)\n\t- object (class line8d72cea39f66484096f38585a5a0a09348.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line8d72cea39f66484096f38585a5a0a09348.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@4654e1aa)\n\t- field (class: line8d72cea39f66484096f38585a5a0a09348.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: $outer, type: class line8d72cea39f66484096f38585a5a0a09348.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line8d72cea39f66484096f38585a5a0a09348.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, line8d72cea39f66484096f38585a5a0a09348.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC@545d1a81)\n\t- field (class: line8d72cea39f66484096f38585a5a0a09348.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$anonfun$2, name: $outer, type: class line8d72cea39f66484096f38585a5a0a09348.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC)\n\t- object (class line8d72cea39f66484096f38585a5a0a09348.$read$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$anonfun$2, &lt;function2&gt;)\n\tat org.apache.spark.serializer.SerializationDebugger$.improveException(SerializationDebugger.scala:40)\n\tat org.apache.spark.serializer.JavaSerializationStream.writeObject(JavaSerializer.scala:46)\n\tat org.apache.spark.serializer.JavaSerializerInstance.serialize(JavaSerializer.scala:100)\n\tat org.apache.spark.util.ClosureCleaner$.ensureSerializable(ClosureCleaner.scala:295)\n\tat org.apache.spark.util.ClosureCleaner$.org$apache$spark$util$ClosureCleaner$$clean(ClosureCleaner.scala:288)\n\tat org.apache.spark.util.ClosureCleaner$.clean(ClosureCleaner.scala:108)\n\tat org.apache.spark.SparkContext.clean(SparkContext.scala:2135)\n\tat org.apache.spark.rdd.RDD$$anonfun$reduce$1.apply(RDD.scala:1009)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n\tat org.apache.spark.rdd.RDD.reduce(RDD.scala:1008)</div>","workflows":[],"startTime":1497646124808,"submitTime":1497646124803,"finishTime":1497646124933,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4977160c-6e75-4bcc-9fd1-00b7d14e88f5"},{"version":"CommandV1","origId":2060825016293663,"guid":"e61c55dd-1d8b-4cd7-8baf-94c9859929f6","subtype":"command","commandType":"auto","position":29.0,"command":"%scala\ndef wordLengthReducer(leftWord:String, rightWord:String): String = {\nif (leftWord.length >= rightWord.length)\nreturn leftWord\nelse\nreturn rightWord\n}\nwords.reduce(wordLengthReducer)\nwords.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">wordLengthReducer: (leftWord: String, rightWord: String)String\nres21: Long = 10\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646126993,"submitTime":1497646126994,"finishTime":1497646127102,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d7c53e50-44b1-404e-a0ab-c0db3c2c18a5"},{"version":"CommandV1","origId":2060825016293664,"guid":"7b1b7fa3-9f84-4d68-84f4-f59473a644d0","subtype":"command","commandType":"auto","position":30.0,"command":"%scala\nval confidence = 0.95\nval timeoutMilliseconds = 400\nwords.countApprox(timeoutMilliseconds, confidence)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">confidence: Double = 0.95\ntimeoutMilliseconds: Int = 400\nres22: org.apache.spark.partial.PartialResult[org.apache.spark.partial.BoundedDouble] = (final: [10.000, 10.000])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646139657,"submitTime":1497646139654,"finishTime":1497646139748,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1e322989-61e7-4b4b-88c6-b4dfe8218044"},{"version":"CommandV1","origId":2060825016293665,"guid":"59ea0908-5e72-4c1f-8c3d-7fc8a6e29218","subtype":"command","commandType":"auto","position":31.0,"command":"%scala\nwords.countApproxDistinct(0.05)\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res24: Long = 10\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646157771,"submitTime":1497646157767,"finishTime":1497646157881,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"05917c35-8de5-4336-8bca-38d933f01d76"},{"version":"CommandV1","origId":2060825016293666,"guid":"7788d82f-9a66-457d-958f-eaeb3762e9fb","subtype":"command","commandType":"auto","position":32.0,"command":"%scala\nwords.countApproxDistinct(4, 10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res25: Long = 10\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646165441,"submitTime":1497646165443,"finishTime":1497646165533,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8049e22d-c155-4762-a381-4796561b8c19"},{"version":"CommandV1","origId":2060825016293667,"guid":"fb081d83-5437-4565-b22d-3a49675663f0","subtype":"command","commandType":"auto","position":33.0,"command":"%scala\nwords.countByValue()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res26: scala.collection.Map[String,Long] = Map(Definitive -&gt; 1, Simple -&gt; 1, Processing -&gt; 1, The -&gt; 1, Spark -&gt; 1, Made -&gt; 1, Guide -&gt; 1, Big -&gt; 1, : -&gt; 1, Data -&gt; 1)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646173186,"submitTime":1497646173178,"finishTime":1497646173333,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0b3090e4-0200-4da9-bcd8-fae979fba901"},{"version":"CommandV1","origId":2060825016293668,"guid":"e7cadc4d-7740-495c-9528-0491f28233c0","subtype":"command","commandType":"auto","position":34.0,"command":"%scala\nwords.countByValueApprox(1000, 0.95)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res27: org.apache.spark.partial.PartialResult[scala.collection.Map[String,org.apache.spark.partial.BoundedDouble]] = (final: Map(Definitive -&gt; [1.000, 1.000], Simple -&gt; [1.000, 1.000], Processing -&gt; [1.000, 1.000], The -&gt; [1.000, 1.000], Spark -&gt; [1.000, 1.000], Made -&gt; [1.000, 1.000], Guide -&gt; [1.000, 1.000], Big -&gt; [1.000, 1.000], : -&gt; [1.000, 1.000], Data -&gt; [1.000, 1.000]))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646182265,"submitTime":1497646182260,"finishTime":1497646182399,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8a92a643-ece3-4ce5-ba91-52e5a06cdb25"},{"version":"CommandV1","origId":2060825016293669,"guid":"d0779f70-72f5-4e8b-a88c-e39cf1208831","subtype":"command","commandType":"auto","position":35.0,"command":"%scala\nwords.first()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res28: String = Spark\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646193032,"submitTime":1497646193026,"finishTime":1497646193122,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"46e59ec5-e42a-4b72-89d5-3ecb0524b706"},{"version":"CommandV1","origId":2060825016293670,"guid":"5599e2a1-efd6-4bf2-922e-7fa8503f2b0a","subtype":"command","commandType":"auto","position":36.0,"command":"%scala\nsc.parallelize(1 to 20).max()\nsc.parallelize(1 to 20).min()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res29: Int = 1\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646201523,"submitTime":1497646201519,"finishTime":1497646201692,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6791a1f1-0a69-4e17-9f6e-efc1133f8148"},{"version":"CommandV1","origId":2060825016293671,"guid":"06fd8555-0919-44e8-8964-40824701d98d","subtype":"command","commandType":"auto","position":37.0,"command":"%scala\nwords.take(5)\nwords.takeOrdered(5)\nwords.top(5)\nval withReplacement = true\nval numberToTake = 6\nval randomSeed = 100L\nwords.takeSample(withReplacement, numberToTake, randomSeed)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">withReplacement: Boolean = true\nnumberToTake: Int = 6\nrandomSeed: Long = 100\nres30: Array[String] = Array(Guide, Spark, :, Simple, Simple, Spark)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646216526,"submitTime":1497646216526,"finishTime":1497646216719,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1f3baacc-5299-4f5a-a256-4d5af8d0edc5"},{"version":"CommandV1","origId":2060825016293672,"guid":"7493cb87-a2bc-4772-b21b-273d10ced907","subtype":"command","commandType":"auto","position":38.0,"command":"%scala\nwords.saveAsTextFile(\"file:/tmp/bookTitle\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646231061,"submitTime":1497646231057,"finishTime":1497646231190,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7b19bf19-1920-489c-a464-8bd28828921a"},{"version":"CommandV1","origId":2060825016293673,"guid":"910ec631-76ab-4880-ab7a-5d16e8cff18a","subtype":"command","commandType":"auto","position":39.0,"command":"%scala\nimport org.apache.hadoop.io.compress.BZip2Codec\nwords.saveAsTextFile(\"file:/tmp/bookTitleCompressed\", classOf[BZip2Codec])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.hadoop.io.compress.BZip2Codec\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646240422,"submitTime":1497646240415,"finishTime":1497646240577,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a0398da7-0ee0-4a81-8d89-a151bf216b72"},{"version":"CommandV1","origId":2060825016293674,"guid":"af1b194e-5baa-4c2f-8942-f99f95512c1a","subtype":"command","commandType":"auto","position":40.0,"command":"%scala\nwords.saveAsObjectFile(\"file:/tmp/my/sequenceFilePath\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646251287,"submitTime":1497646251283,"finishTime":1497646251442,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"399eed41-ace3-4c3f-b272-b9ade731ca9b"},{"version":"CommandV1","origId":2060825016293675,"guid":"a952929e-19f7-46a3-82ad-ac54b5063db5","subtype":"command","commandType":"auto","position":41.0,"command":"%scala\nwords.cache()\nwords.getStorageLevel","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res34: org.apache.spark.storage.StorageLevel = StorageLevel(memory, deserialized, 1 replicas)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;words&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-3-e1f8d8016084&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>words<span class=\"ansiyellow\">.</span>cache<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> words<span class=\"ansiyellow\">.</span>getStorageLevel<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;words&apos; is not defined</div>","workflows":[],"startTime":1497646271077,"submitTime":1497646271072,"finishTime":1497646271165,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e7d11d69-8c1a-4f67-9357-c6ea3348a978"},{"version":"CommandV1","origId":2060825016293676,"guid":"b72e4420-5082-487f-9e47-df05357796be","subtype":"command","commandType":"auto","position":42.0,"command":"%scala\nspark.range(10).rdd\nspark.range(10).toDF().rdd\nspark.range(10).toDF().rdd.map(rowObject => rowObject.getLong(0))\nspark.range(10).rdd.toDF()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res36: org.apache.spark.sql.DataFrame = [value: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646301289,"submitTime":1497646301284,"finishTime":1497646301448,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"785294c0-cbfe-4cd9-befe-f2db5a578923"},{"version":"CommandV1","origId":2060825016293677,"guid":"e2649605-7add-45bb-8f51-da3809cead09","subtype":"command","commandType":"auto","position":43.0,"command":"spark.range(10).rdd.toDF()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">4</span><span class=\"ansired\">]: </span>DataFrame[id: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646307722,"submitTime":1497646307724,"finishTime":1497646308051,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ca6b602d-1573-483a-8124-6791223ee673"}],"dashboards":[],"guid":"3d176afc-1871-4878-9b8d-9f7946a8bc5f","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
