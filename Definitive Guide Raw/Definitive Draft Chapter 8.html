<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Definitive Draft Chapter 8 - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"serverlessDefaultSparkVersion":"2.2.x-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","enableTableHandler":false,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"3.0 beta (Scala 2.11)","packageLabel":"spark-image-20adedc466bac7d0c91242baba4ae70dc8487d6e301359af185601969607d211","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-f43ddf8ad9acfd71338f5a51345f077173d236016ad7e39ffd6f698403acd4ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"3.0 beta (Scala 2.10)","packageLabel":"spark-image-a1d408c36c3e2c79b38783b57b626c7c6847c9639fa15dd22eca009c23b89c6f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":6,"class-node":1,"m4.2xlarge":0.5,"r4.xlarge":1,"m4.4xlarge":0.5,"r4.16xlarge":8,"Standard_DS11":0.5,"p2.8xlarge":16,"m4.10xlarge":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.5,"r4.8xlarge":8,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.5,"p2.16xlarge":24,"i3.8xlarge":12,"i3.16xlarge":24,"Standard_DS12_v2":1,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"i3.2xlarge":3,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":0.5,"c4.8xlarge":4,"i3.xlarge":1.5,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.47","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableNonPollingTableCall":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":180,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"enableElasticDisk":false,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"ea633ce26684806264e7bd2cbb05130eb0f98c4d","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewJobList":false,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"enableEBSVolumesUIByTier":false,"singleSignOnComingSoon":false,"enableNewJobClusterEdit":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2060825016293568,"name":"Definitive Draft Chapter 8","language":"python","commands":[{"version":"CommandV1","origId":2060825016293570,"guid":"172b2afc-f84e-46d4-b76e-99fdfa05970a","subtype":"command","commandType":"auto","position":1.0,"command":"%scala\nspark.sql(\"SELECT 1 + 1\").collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res0: Array[org.apache.spark.sql.Row] = Array([2])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644377865,"submitTime":1497644377857,"finishTime":1497644379020,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ff486d25-b863-48a1-810d-8f822c571829"},{"version":"CommandV1","origId":2060825016293571,"guid":"42510bd7-0576-4925-b296-5d38aa5736a2","subtype":"command","commandType":"auto","position":2.0,"command":"spark.sql(\"SELECT 1 + 1\").collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">1</span><span class=\"ansired\">]: </span>[Row((1 + 1)=2)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644386346,"submitTime":1497644386337,"finishTime":1497644386468,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"abd91d24-7243-48a4-bea0-d7e4ae061c74"},{"version":"CommandV1","origId":2060825016293572,"guid":"774a6ba2-6342-49f8-89c4-19b9832ce5a0","subtype":"command","commandType":"auto","position":3.0,"command":"%scala\nspark.sql(\"\"\"\nSELECT\nuser_id,\ndepartment,\nfirst_name\nFROM\nprofessors\nWHERE\ndepartment IN\n(SELECT name\nFROM department\nWHERE created_date >= '2016-01-01')\n\"\"\")","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Table or view not found: professors; line 7 pos 0","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveRelations$$lookupTableFromCatalog(Analyzer.scala:465)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$9.applyOrElse(Analyzer.scala:484)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$9.applyOrElse(Analyzer.scala:469)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:60)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:469)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:459)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:85)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:82)\n\tat scala.collection.LinearSeqOptimized$class.foldLeft(LinearSeqOptimized.scala:111)\n\tat scala.collection.immutable.List.foldLeft(List.scala:84)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:82)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:74)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:74)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:60)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:77)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:75)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply$mcV$sp(QueryExecution.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:55)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:63)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:599)</div>","workflows":[],"startTime":1497644406169,"submitTime":1497644406169,"finishTime":1497644406259,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"505f94a0-0314-4ba5-8315-ad3ddba672f6"},{"version":"CommandV1","origId":2060825016293573,"guid":"44fe6f32-9cd2-4b40-b22b-a949f10a79f8","subtype":"command","commandType":"auto","position":4.0,"command":"%sql\nSHOW TABLES\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[["default","bucketedfiles",false],["default","cleaned_taxes",false],["default","cogsley_clients",false],["default","cogsley_sales",false],["default","iris",false],["default","myrange",false],["default","online_retail",false],["default","online_retail_dataset",false],["default","population_v_price",false],["default","product_sales_by_country",false],["default","retailbuday1201",false],["default","state_info",false],["default","summary2010",false],["default","summary2010json",false],["default","summary2010parquet",false],["default","summary2015",false],["default","summary2015csv",false]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"database","type":"\"string\"","metadata":"{}"},{"name":"tableName","type":"\"string\"","metadata":"{}"},{"name":"isTemporary","type":"\"boolean\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: ParseException: \nmismatched input 'case' expecting <EOF>(line 2, pos 0)\n\n== SQL ==\nSHOW TABLES\ncase class Table(database:String, tableName:String, isTemporary:Boolean)\n^^^\nspark.sql(\"SHOW TABLES\").as[Table].collect().map {t =>\ntry {\nspark.sql(s\"DROP TABLE IF EXISTS \").collect()\n}\ncatch {\ncase e: org.apache.spark.sql.AnalysisException => {\nspark.sql(s\"DROP VIEW IF EXISTS \").collect()\n}\n}\n}\n","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.catalyst.parser.ParseException: \nmismatched input 'case' expecting <EOF>(line 2, pos 0)\n\n== SQL ==\nSHOW TABLES\ncase class Table(database:String, tableName:String, isTemporary:Boolean)\n^^^\nspark.sql(\"SHOW TABLES\").as[Table].collect().map {t =>\ntry {\nspark.sql(s\"DROP TABLE IF EXISTS \").collect()\n}\ncatch {\ncase e: org.apache.spark.sql.AnalysisException => {\nspark.sql(s\"DROP VIEW IF EXISTS \").collect()\n}\n}\n}\n\n\tat org.apache.spark.sql.catalyst.parser.ParseException.withCommand(ParseDriver.scala:196)\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parse(ParseDriver.scala:98)\n\tat org.apache.spark.sql.execution.SparkSqlParser.parse(SparkSqlParser.scala:45)\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parsePlan(ParseDriver.scala:52)\n\tat com.databricks.sql.parser.DatabricksSqlParser$$anonfun$parsePlan$1.apply(DatabricksSqlParser.scala:50)\n\tat com.databricks.sql.parser.DatabricksSqlParser$$anonfun$parsePlan$1.apply(DatabricksSqlParser.scala:47)\n\tat com.databricks.sql.parser.DatabricksSqlParser.parse(DatabricksSqlParser.scala:69)\n\tat com.databricks.sql.parser.DatabricksSqlParser.parsePlan(DatabricksSqlParser.scala:47)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:599)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:698)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:230)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:211)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:211)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:230)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:211)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:211)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1497644474487,"submitTime":1497644474476,"finishTime":1497644474520,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"911860ec-62bc-46c8-ad60-bf1c3c53a283"},{"version":"CommandV1","origId":2060825016293574,"guid":"b8db2444-1dfc-4739-a7ed-1559f4e87a5d","subtype":"command","commandType":"auto","position":5.0,"command":"%scala\ncase class Table(database:String, tableName:String, isTemporary:Boolean)\nspark.sql(\"SHOW TABLES\").as[Table].collect().map {t =>\ntry {\nspark.sql(s\"DROP TABLE IF EXISTS ${t.tableName}\").collect()\n}\ncatch {\ncase e: org.apache.spark.sql.AnalysisException => {\nspark.sql(s\"DROP VIEW IF EXISTS ${t.tableName}\").collect()\n}\n}\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class Table\nres2: Array[Array[org.apache.spark.sql.Row]] = Array(Array(), Array(), Array(), Array(), Array(), Array(), Array(), Array(), Array(), Array(), Array(), Array(), Array(), Array(), Array(), Array(), Array())\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644487636,"submitTime":1497644487627,"finishTime":1497644500327,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2f7bbb0d-ea47-4e49-90e6-d296d1e48e4e"},{"version":"CommandV1","origId":2060825016293575,"guid":"05c3b765-4e5d-4463-ae67-4cb0ec58cde6","subtype":"command","commandType":"auto","position":6.0,"command":"%sql\nCREATE TABLE flights (\nDEST_COUNTRY_NAME STRING,\nORIGIN_COUNTRY_NAME STRING,\ncount LONG)\nUSING JSON\nOPTIONS (\npath '/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json')","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644681613,"submitTime":1497644681604,"finishTime":1497644682040,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cbba45f4-4340-4ebb-88c6-41ff94c12983"},{"version":"CommandV1","origId":2060825016293576,"guid":"1e882053-5831-4df7-af2f-cc456a237e4b","subtype":"command","commandType":"auto","position":7.0,"command":"%sql\nCREATE TABLE flights_csv (\nDEST_COUNTRY_NAME STRING,\n  ORIGIN_COUNTRY_NAME STRING COMMENT \"remember that the most prevalent will be the US\",\ncount LONG)\nUSING csv\nOPTIONS (\ninferSchema true,\nheader true,\npath '/FileStore/tables/baae5ww01497633203998/2015_summary-ebaee.csv')","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644752364,"submitTime":1497644752356,"finishTime":1497644752905,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4a07c010-2cdc-42cd-b661-054d76f1b508"},{"version":"CommandV1","origId":2060825016293577,"guid":"4a0acf91-3d50-4be3-a133-eefcf8c9087f","subtype":"command","commandType":"auto","position":8.0,"command":"%sql\nCREATE TABLE flights_from_select\nAS\nSELECT * FROM flights","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644762990,"submitTime":1497644762982,"finishTime":1497644765060,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d6232eb7-923a-45eb-aace-fec907272d67"},{"version":"CommandV1","origId":2060825016293578,"guid":"7ae69f34-7b34-428a-8b1c-54b0f4b3369f","subtype":"command","commandType":"auto","position":9.0,"command":"%sql\nCREATE TABLE IF NOT EXISTS flights_from_select\nAS\nSELECT * FROM flights\nLIMIT 5","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644787851,"submitTime":1497644787845,"finishTime":1497644787890,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5729c7ce-6a96-42e6-8971-6733f9375065"},{"version":"CommandV1","origId":2060825016293579,"guid":"1447f296-902e-4821-b782-2cb73513e713","subtype":"command","commandType":"auto","position":10.0,"command":"%sql\nCREATE TABLE partitioned_flights\nUSING parquet\nPARTITIONED BY (DEST_COUNTRY_NAME)\nAS\nSELECT DEST_COUNTRY_NAME, ORIGIN_COUNTRY_NAME, count FROM flights\nLIMIT 5 -- so we don't create a ton of files","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644778702,"submitTime":1497644778693,"finishTime":1497644781120,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3ba45d4f-6a1c-4422-b813-3388994ccf89"},{"version":"CommandV1","origId":2060825016293580,"guid":"8ce147d5-22c8-4bbb-a113-8aa5237082e4","subtype":"command","commandType":"auto","position":11.0,"command":"%sql\nINSERT INTO flights_from_select\nSELECT DEST_COUNTRY_NAME, ORIGIN_COUNTRY_NAME, count FROM flights\nLIMIT 20","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644797403,"submitTime":1497644797398,"finishTime":1497644799190,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"64a6ba60-07a4-4461-b9b6-f417e4b17af8"},{"version":"CommandV1","origId":2060825016293581,"guid":"52b22b61-a468-49e9-a033-232b9d25ae35","subtype":"command","commandType":"auto","position":12.0,"command":"%sql\nINSERT INTO partitioned_flights\nPARTITION (DEST_COUNTRY_NAME=\"UNITED STATES\")\nSELECT count, ORIGIN_COUNTRY_NAME FROM flights\nWHERE DEST_COUNTRY_NAME='UNITED STATES'\nLIMIT 12","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644816518,"submitTime":1497644816509,"finishTime":1497644817119,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"97f07846-1fb6-41dd-b7d0-b2ad23d7405a"},{"version":"CommandV1","origId":2060825016293582,"guid":"9497389a-f87d-4dcd-9c59-e56b45e805c0","subtype":"command","commandType":"auto","position":13.0,"command":"%sql\nSELECT * FROM flights_csv","commandVersion":0,"state":"finished","results":{"type":"table","data":[["United States","Romania",15],["United States","Croatia",1],["United States","Ireland",344],["Egypt","United States",15],["United States","India",62],["United States","Singapore",1],["United States","Grenada",62],["Costa Rica","United States",588],["Senegal","United States",40],["Moldova","United States",1],["United States","Sint Maarten",325],["United States","Marshall Islands",39],["Guyana","United States",64],["Malta","United States",1],["Anguilla","United States",41],["Bolivia","United States",30],["United States","Paraguay",6],["Algeria","United States",4],["Turks and Caicos Islands","United States",230],["United States","Gibraltar",1],["Saint Vincent and the Grenadines","United States",1],["Italy","United States",382],["United States","Federated States of Micronesia",69],["United States","Russia",161],["Pakistan","United States",12],["United States","Netherlands",660],["Iceland","United States",181],["Marshall Islands","United States",42],["Luxembourg","United States",155],["Honduras","United States",362],["The Bahamas","United States",955],["United States","Senegal",42],["El Salvador","United States",561],["Samoa","United States",25],["United States","Angola",13],["Switzerland","United States",294],["United States","Anguilla",38],["Sint Maarten","United States",325],["Hong Kong","United States",332],["Trinidad and Tobago","United States",211],["Latvia","United States",19],["United States","Ecuador",300],["Suriname","United States",1],["Mexico","United States",7140],["United States","Cyprus",1],["Ecuador","United States",268],["United States","Portugal",134],["United States","Costa Rica",608],["United States","Guatemala",318],["United States","Suriname",34],["Colombia","United States",873],["United States","Cape Verde",14],["United States","Jamaica",712],["Norway","United States",121],["United States","Malaysia",3],["United States","Morocco",19],["Thailand","United States",3],["United States","Samoa",25],["Venezuela","United States",290],["United States","Palau",31],["United States","Venezuela",246],["Panama","United States",510],["Antigua and Barbuda","United States",126],["United States","Chile",185],["Morocco","United States",15],["United States","Finland",28],["Azerbaijan","United States",21],["United States","Greece",23],["United States","The Bahamas",986],["New Zealand","United States",111],["Liberia","United States",2],["United States","Hong Kong",414],["Hungary","United States",2],["United States","China",920],["United States","Vietnam",2],["Burkina Faso","United States",1],["Sweden","United States",118],["United States","Kuwait",28],["United States","Dominican Republic",1420],["United States","Egypt",12],["Israel","United States",134],["United States","United States",370002],["Ethiopia","United States",13],["United States","Luxembourg",134],["United States","Poland",33],["Martinique","United States",44],["United States","Saint Barthelemy",41],["Saint Barthelemy","United States",39],["Barbados","United States",154],["United States","Turkey",129],["Djibouti","United States",1],["United States","Azerbaijan",21],["United States","Estonia",1],["Germany","United States",1468],["United States","South Korea",827],["United States","El Salvador",508],["Ireland","United States",335],["United States","Hungary",3],["Zambia","United States",1],["Malaysia","United States",2],["United States","Ethiopia",12],["United States","Panama",465],["United States","Aruba",342],["United States","Thailand",4],["United States","Turks and Caicos Islands",236],["Croatia","United States",2],["United States","Pakistan",12],["Cyprus","United States",1],["United States","Honduras",407],["Fiji","United States",24],["Qatar","United States",108],["Saint Kitts and Nevis","United States",139],["Kuwait","United States",32],["Taiwan","United States",266],["Haiti","United States",226],["Canada","United States",8399],["Federated States of Micronesia","United States",69],["United States","Liberia",2],["Jamaica","United States",666],["United States","Malta",2],["Dominican Republic","United States",1353],["Japan","United States",1548],["United States","Lithuania",1],["Finland","United States",26],["United States","Guadeloupe",59],["United States","Ukraine",13],["United States","France",952],["United States","Norway",115],["Aruba","United States",346],["French Guiana","United States",5],["United States","Kiribati",35],["India","United States",61],["British Virgin Islands","United States",107],["Brazil","United States",853],["United States","Germany",1336],["United States","New Zealand",74],["French Polynesia","United States",43],["United Arab Emirates","United States",320],["Singapore","United States",3],["United States","Mexico",7187],["United States","Sweden",119],["Netherlands","United States",776],["United States","Martinique",43],["United States","United Arab Emirates",313],["United States","Bulgaria",1],["Denmark","United States",153],["China","United States",772],["United States","Nicaragua",201],["United States","Philippines",126],["United States","Georgia",1],["United States","Belgium",228],["Cayman Islands","United States",314],["Argentina","United States",180],["Peru","United States",279],["South Africa","United States",36],["United States","Iceland",202],["United States","Argentina",141],["Spain","United States",420],["Bermuda","United States",183],["United States","Nigeria",50],["United States","Austria",63],["United States","Bonaire, Sint Eustatius, and Saba",59],["Kiribati","United States",26],["Saudi Arabia","United States",83],["Czech Republic","United States",13],["United States","Israel",127],["Belgium","United States",259],["United States","Saint Lucia",136],["United States","Bahrain",1],["United States","British Virgin Islands",80],["Curacao","United States",90],["Georgia","United States",2],["United States","Denmark",152],["United States","Guyana",63],["Philippines","United States",134],["Grenada","United States",53],["Cape Verde","United States",20],["Cote d'Ivoire","United States",1],["Ukraine","United States",14],["United States","Papua New Guinea",1],["Russia","United States",176],["United States","Saudi Arabia",70],["Guatemala","United States",397],["Saint Lucia","United States",123],["Paraguay","United States",60],["United States","Curacao",83],["Kosovo","United States",1],["United States","Taiwan",235],["Tunisia","United States",3],["United States","South Africa",40],["Niger","United States",2],["Turkey","United States",138],["United Kingdom","United States",2025],["Romania","United States",14],["United States","Greenland",4],["Papua New Guinea","United States",3],["United States","Spain",442],["Iraq","United States",1],["United States","Italy",438],["Cuba","United States",466],["United States","Switzerland",305],["Dominica","United States",20],["United States","Japan",1496],["Portugal","United States",127],["United States","Brazil",619],["Bahrain","United States",19],["United States","Peru",337],["Indonesia","United States",1],["United States","Belize",193],["United States","United Kingdom",1970],["Belize","United States",188],["United States","Ghana",20],["United States","Indonesia",2],["United States","Fiji",25],["United States","Canada",8483],["United States","Antigua and Barbuda",117],["United States","French Polynesia",40],["Nicaragua","United States",179],["United States","Latvia",15],["United States","Dominica",27],["United States","Czech Republic",12],["United States","Australia",258],["United States","Cook Islands",13],["Austria","United States",62],["Jordan","United States",44],["Palau","United States",30],["South Korea","United States",1048],["Angola","United States",15],["Ghana","United States",18],["New Caledonia","United States",1],["Guadeloupe","United States",56],["France","United States",935],["Poland","United States",32],["Nigeria","United States",59],["United States","Uruguay",13],["Greenland","United States",2],["United States","Bermuda",193],["Chile","United States",174],["United States","Cuba",478],["United States","Montenegro",1],["United States","Colombia",867],["United States","Barbados",130],["United States","Qatar",109],["Australia","United States",329],["United States","Cayman Islands",310],["United States","Jordan",44],["United States","Namibia",1],["United States","Trinidad and Tobago",217],["United States","Bolivia",13],["Cook Islands","United States",13],["Bulgaria","United States",3],["United States","Saint Kitts and Nevis",145],["Uruguay","United States",43],["United States","Haiti",225],["Bonaire, Sint Eustatius, and Saba","United States",58],["Greece","United States",30]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"ORIGIN_COUNTRY_NAME","type":"\"string\"","metadata":"{\"comment\":\"remember that the most prevalent will be the US\"}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644837967,"submitTime":1497644837958,"finishTime":1497644838215,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"007dff22-74d9-4842-b9dc-92d20242b0fc"},{"version":"CommandV1","origId":2060825016293583,"guid":"926c5fc0-6815-41f4-bc50-e5cb514683ef","subtype":"command","commandType":"auto","position":14.0,"command":"%sql\nSELECT * FROM flights","commandVersion":0,"state":"finished","results":{"type":"table","data":[[null,null,15],[null,null,1],[null,null,344],[null,null,15],[null,null,62],[null,null,1],[null,null,62],[null,null,588],[null,null,40],[null,null,1],[null,null,325],[null,null,39],[null,null,64],[null,null,1],[null,null,41],[null,null,30],[null,null,6],[null,null,4],[null,null,230],[null,null,1],[null,null,1],[null,null,382],[null,null,69],[null,null,161],[null,null,12],[null,null,660],[null,null,181],[null,null,42],[null,null,155],[null,null,362],[null,null,955],[null,null,42],[null,null,561],[null,null,25],[null,null,13],[null,null,294],[null,null,38],[null,null,325],[null,null,332],[null,null,211],[null,null,19],[null,null,300],[null,null,1],[null,null,7140],[null,null,1],[null,null,268],[null,null,134],[null,null,608],[null,null,318],[null,null,34],[null,null,873],[null,null,14],[null,null,712],[null,null,121],[null,null,3],[null,null,19],[null,null,3],[null,null,25],[null,null,290],[null,null,31],[null,null,246],[null,null,510],[null,null,126],[null,null,185],[null,null,15],[null,null,28],[null,null,21],[null,null,23],[null,null,986],[null,null,111],[null,null,2],[null,null,414],[null,null,2],[null,null,920],[null,null,2],[null,null,1],[null,null,118],[null,null,28],[null,null,1420],[null,null,12],[null,null,134],[null,null,370002],[null,null,13],[null,null,134],[null,null,33],[null,null,44],[null,null,41],[null,null,39],[null,null,154],[null,null,129],[null,null,1],[null,null,21],[null,null,1],[null,null,1468],[null,null,827],[null,null,508],[null,null,335],[null,null,3],[null,null,1],[null,null,2],[null,null,12],[null,null,465],[null,null,342],[null,null,4],[null,null,236],[null,null,2],[null,null,12],[null,null,1],[null,null,407],[null,null,24],[null,null,108],[null,null,139],[null,null,32],[null,null,266],[null,null,226],[null,null,8399],[null,null,69],[null,null,2],[null,null,666],[null,null,2],[null,null,1353],[null,null,1548],[null,null,1],[null,null,26],[null,null,59],[null,null,13],[null,null,952],[null,null,115],[null,null,346],[null,null,5],[null,null,35],[null,null,61],[null,null,107],[null,null,853],[null,null,1336],[null,null,74],[null,null,43],[null,null,320],[null,null,3],[null,null,7187],[null,null,119],[null,null,776],[null,null,43],[null,null,313],[null,null,1],[null,null,153],[null,null,772],[null,null,201],[null,null,126],[null,null,1],[null,null,228],[null,null,314],[null,null,180],[null,null,279],[null,null,36],[null,null,202],[null,null,141],[null,null,420],[null,null,183],[null,null,50],[null,null,63],[null,null,59],[null,null,26],[null,null,83],[null,null,13],[null,null,127],[null,null,259],[null,null,136],[null,null,1],[null,null,80],[null,null,90],[null,null,2],[null,null,152],[null,null,63],[null,null,134],[null,null,53],[null,null,20],[null,null,1],[null,null,14],[null,null,1],[null,null,176],[null,null,70],[null,null,397],[null,null,123],[null,null,60],[null,null,83],[null,null,1],[null,null,235],[null,null,3],[null,null,40],[null,null,2],[null,null,138],[null,null,2025],[null,null,14],[null,null,4],[null,null,3],[null,null,442],[null,null,1],[null,null,438],[null,null,466],[null,null,305],[null,null,20],[null,null,1496],[null,null,127],[null,null,619],[null,null,19],[null,null,337],[null,null,1],[null,null,193],[null,null,1970],[null,null,188],[null,null,20],[null,null,2],[null,null,25],[null,null,8483],[null,null,117],[null,null,40],[null,null,179],[null,null,15],[null,null,27],[null,null,12],[null,null,258],[null,null,13],[null,null,62],[null,null,44],[null,null,30],[null,null,1048],[null,null,15],[null,null,18],[null,null,1],[null,null,56],[null,null,935],[null,null,32],[null,null,59],[null,null,13],[null,null,2],[null,null,193],[null,null,174],[null,null,478],[null,null,1],[null,null,867],[null,null,130],[null,null,109],[null,null,329],[null,null,310],[null,null,44],[null,null,1],[null,null,217],[null,null,13],[null,null,13],[null,null,3],[null,null,145],[null,null,43],[null,null,225],[null,null,58],[null,null,30]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"ORIGIN_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644846487,"submitTime":1497644846478,"finishTime":1497644846610,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e29393d9-902c-474d-b0b0-2226280b9621"},{"version":"CommandV1","origId":2060825016293584,"guid":"62f9dee8-3132-42d5-8f46-b352acac938c","subtype":"command","commandType":"auto","position":15.0,"command":"%sql\nDESCRIBE TABLE flights_csv","commandVersion":0,"state":"finished","results":{"type":"table","data":[["DEST_COUNTRY_NAME","string",null],["ORIGIN_COUNTRY_NAME","string","remember that the most prevalent will be the US"],["count","bigint",null]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_name","type":"\"string\"","metadata":"{\"comment\":\"name of the column\"}"},{"name":"data_type","type":"\"string\"","metadata":"{\"comment\":\"data type of the column\"}"},{"name":"comment","type":"\"string\"","metadata":"{\"comment\":\"comment of the column\"}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644878814,"submitTime":1497644878804,"finishTime":1497644878858,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2532f50f-ea2d-4e58-8776-26b1f4948d4c"},{"version":"CommandV1","origId":2060825016293585,"guid":"500c7acd-99b6-47f9-9716-7155e701bc06","subtype":"command","commandType":"auto","position":16.0,"command":"%sql\nSHOW PARTITIONS partitioned_flights","commandVersion":0,"state":"finished","results":{"type":"table","data":[["DEST_COUNTRY_NAME=__HIVE_DEFAULT_PARTITION__"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"partition","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644887169,"submitTime":1497644887158,"finishTime":1497644887256,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b38b96bf-c3fe-4c53-9075-29a48f9da0c5"},{"version":"CommandV1","origId":2060825016293586,"guid":"09977780-66e9-4bb7-bcd5-3153ae9570a1","subtype":"command","commandType":"auto","position":17.0,"command":"%sql\nREFRESH table partitioned_flights","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644893194,"submitTime":1497644893184,"finishTime":1497644893410,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cc6adc67-bcbf-40bd-857f-907df2aa71f3"},{"version":"CommandV1","origId":2060825016293587,"guid":"9769ca29-4b88-48a3-b9e3-d7b1f2f30fd7","subtype":"command","commandType":"auto","position":18.0,"command":"%sql\nMSCK REPAIR TABLE partitioned_flights","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644898767,"submitTime":1497644898757,"finishTime":1497644899234,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7f2f9c72-bbb5-45c8-a0fd-07623dff9792"},{"version":"CommandV1","origId":2060825016293588,"guid":"0a76f1df-e9ee-45b1-8b9e-1f932b134c81","subtype":"command","commandType":"auto","position":19.0,"command":"%sql\nDROP TABLE flights_csv;","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644904751,"submitTime":1497644904741,"finishTime":1497644904924,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"830eabe5-f3b3-40ef-89a9-eb5ad54c0314"},{"version":"CommandV1","origId":2060825016293589,"guid":"eae4331d-5845-4614-b971-1ec74589a790","subtype":"command","commandType":"auto","position":20.0,"command":"%sql\nDROP TABLE IF EXISTS flights_csv;","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644909755,"submitTime":1497644909745,"finishTime":1497644909773,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"20d07e8b-26ca-4063-81b7-6972ab34c7f2"},{"version":"CommandV1","origId":2060825016293590,"guid":"be22ef06-d583-41f1-96fd-68b8813e0f34","subtype":"command","commandType":"auto","position":21.0,"command":"%sql\nCREATE VIEW just_usa_view AS\nSELECT *\nFROM flights\nWHERE dest_country_name = 'United States'","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644920915,"submitTime":1497644920905,"finishTime":1497644921131,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"65cb3088-807c-4b76-b055-525aef87ada6"},{"version":"CommandV1","origId":2060825016293591,"guid":"86ef8b39-1128-4ab3-bea4-bda6f219cc07","subtype":"command","commandType":"auto","position":22.0,"command":"%sql\nCREATE VIEW just_usa_global AS\nSELECT *\nFROM flights\nWHERE dest_country_name = 'United States'","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644927062,"submitTime":1497644927052,"finishTime":1497644927229,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3dee8c86-26dd-4afd-854c-71310fa04f9a"},{"version":"CommandV1","origId":2060825016293592,"guid":"0326e798-cece-4f1f-9006-c03e5e098fdf","subtype":"command","commandType":"auto","position":23.0,"command":"%sql\nCREATE TEMP VIEW just_usa_view_temp AS\nSELECT *\nFROM flights\nWHERE dest_country_name = 'United States'","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644934804,"submitTime":1497644934793,"finishTime":1497644934829,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"baaa82b9-0173-4ec7-b661-e3139af60b11"},{"version":"CommandV1","origId":2060825016293593,"guid":"0f5b9091-3c9e-4c49-806b-10da69a20099","subtype":"command","commandType":"auto","position":24.0,"command":"%sql\nCREATE GLOBAL TEMP VIEW just_usa_global_view_temp AS\nSELECT *\nFROM flights\nWHERE dest_country_name = 'United States'\n%sql SHOW TABLES","commandVersion":0,"state":"error","results":null,"errorSummary":"Error in SQL statement: ParseException: \nmismatched input 'SHOW' expecting {<EOF>, '.', '[', 'GROUP', 'ORDER', 'HAVING', 'LIMIT', 'OR', 'AND', 'IN', NOT, 'BETWEEN', 'LIKE', RLIKE, 'IS', 'WINDOW', 'UNION', 'EXCEPT', 'MINUS', 'INTERSECT', EQ, '<=>', '<>', '!=', '<', LTE, '>', GTE, '+', '-', '*', '/', '%', 'DIV', '&', '|', '^', 'SORT', 'CLUSTER', 'DISTRIBUTE'}(line 5, pos 5)\n\n== SQL ==\nCREATE GLOBAL TEMP VIEW just_usa_global_view_temp AS\nSELECT *\nFROM flights\nWHERE dest_country_name = 'United States'\n%sql SHOW TABLES\n-----^^^\n","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.catalyst.parser.ParseException: \nmismatched input 'SHOW' expecting {<EOF>, '.', '[', 'GROUP', 'ORDER', 'HAVING', 'LIMIT', 'OR', 'AND', 'IN', NOT, 'BETWEEN', 'LIKE', RLIKE, 'IS', 'WINDOW', 'UNION', 'EXCEPT', 'MINUS', 'INTERSECT', EQ, '<=>', '<>', '!=', '<', LTE, '>', GTE, '+', '-', '*', '/', '%', 'DIV', '&', '|', '^', 'SORT', 'CLUSTER', 'DISTRIBUTE'}(line 5, pos 5)\n\n== SQL ==\nCREATE GLOBAL TEMP VIEW just_usa_global_view_temp AS\nSELECT *\nFROM flights\nWHERE dest_country_name = 'United States'\n%sql SHOW TABLES\n-----^^^\n\n\tat org.apache.spark.sql.catalyst.parser.ParseException.withCommand(ParseDriver.scala:196)\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parse(ParseDriver.scala:98)\n\tat org.apache.spark.sql.execution.SparkSqlParser.parse(SparkSqlParser.scala:45)\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parsePlan(ParseDriver.scala:52)\n\tat com.databricks.sql.parser.DatabricksSqlParser$$anonfun$parsePlan$1.apply(DatabricksSqlParser.scala:50)\n\tat com.databricks.sql.parser.DatabricksSqlParser$$anonfun$parsePlan$1.apply(DatabricksSqlParser.scala:47)\n\tat com.databricks.sql.parser.DatabricksSqlParser.parse(DatabricksSqlParser.scala:69)\n\tat com.databricks.sql.parser.DatabricksSqlParser.parsePlan(DatabricksSqlParser.scala:47)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:599)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:698)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:230)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:211)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:211)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:230)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:211)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:211)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1497644940854,"submitTime":1497644940854,"finishTime":1497644940880,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7a55be20-9597-452a-b946-4208d6ce7065"},{"version":"CommandV1","origId":2060825016293594,"guid":"3c9d4a0c-a90b-4f28-915d-3ccb6f78c20f","subtype":"command","commandType":"auto","position":25.0,"command":"%sql\nCREATE OR REPLACE TEMP VIEW just_usa_view_temp AS\nSELECT *\nFROM flights\nWHERE dest_country_name = 'United States'","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644947388,"submitTime":1497644947377,"finishTime":1497644947412,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2edf73f4-4035-4ef9-9c56-7b24b9bce4b1"},{"version":"CommandV1","origId":2060825016293595,"guid":"57be1189-7818-44a3-a788-b034453eb0fb","subtype":"command","commandType":"auto","position":26.0,"command":"%sql\nSELECT * FROM just_usa_view","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"ORIGIN_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644953928,"submitTime":1497644953916,"finishTime":1497644954129,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"437aab8d-e68a-4008-aa4d-a65d2213e207"},{"version":"CommandV1","origId":2060825016293596,"guid":"2361cbaf-2b0e-4065-924a-ee0d346daa71","subtype":"command","commandType":"auto","position":27.0,"command":"%scala\nval flights = spark.read.format(\"json\")\n.load(\"/mnt/defg/chapter-1-data/json/2015-summary.json\")\nval just_usa_df = flights\n.where(\"dest_country_name = 'United States'\")\njust_usa_df\n.selectExpr(\"*\")\n.explain","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Path does not exist: dbfs:/mnt/defg/chapter-1-data/json/2015-summary.json;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:372)\n\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:360)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:251)\n\tat scala.collection.AbstractTraversable.flatMap(Traversable.scala:105)\n\tat org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:360)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:154)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:148)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:147)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:136)</div>","workflows":[],"startTime":1497644964334,"submitTime":1497644964334,"finishTime":1497644964598,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1988bf4d-407b-41c4-8013-4dc66d7a7f75"},{"version":"CommandV1","origId":2060825016293597,"guid":"97856856-c0e1-486e-882f-b18fa1caf783","subtype":"command","commandType":"auto","position":28.0,"command":"%sql\nEXPLAIN SELECT * FROM just_usa_view","commandVersion":0,"state":"finished","results":{"type":"table","data":[["== Physical Plan ==\n*Project [DEST_COUNTRY_NAME#13801, ORIGIN_COUNTRY_NAME#13802, count#13803L]\n+- *Filter (isnotnull(DEST_COUNTRY_NAME#13801) && (DEST_COUNTRY_NAME#13801 = United States))\n   +- *FileScan json default.flights[DEST_COUNTRY_NAME#13801,ORIGIN_COUNTRY_NAME#13802,count#13803L] Batched: false, Format: JSON, Location: InMemoryFileIndex[dbfs:/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json], PartitionFilters: [], PushedFilters: [IsNotNull(DEST_COUNTRY_NAME), EqualTo(DEST_COUNTRY_NAME,United States)], ReadSchema: struct<DEST_COUNTRY_NAME:string,ORIGIN_COUNTRY_NAME:string,count:bigint>"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"plan","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644971547,"submitTime":1497644971520,"finishTime":1497644971617,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d59f2607-6d58-44b2-a2a5-fd8856efd6e9"},{"version":"CommandV1","origId":2060825016293598,"guid":"a41253af-c192-4604-8e27-137a1fbae9e4","subtype":"command","commandType":"auto","position":29.0,"command":"%sql\nEXPLAIN\nSELECT *\nFROM flights\nWHERE dest_country_name = 'United States'","commandVersion":0,"state":"finished","results":{"type":"table","data":[["== Physical Plan ==\n*Project [DEST_COUNTRY_NAME#13801, ORIGIN_COUNTRY_NAME#13802, count#13803L]\n+- *Filter (isnotnull(dest_country_name#13801) && (dest_country_name#13801 = United States))\n   +- *FileScan json default.flights[DEST_COUNTRY_NAME#13801,ORIGIN_COUNTRY_NAME#13802,count#13803L] Batched: false, Format: JSON, Location: InMemoryFileIndex[dbfs:/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json], PartitionFilters: [], PushedFilters: [IsNotNull(DEST_COUNTRY_NAME), EqualTo(DEST_COUNTRY_NAME,United States)], ReadSchema: struct<DEST_COUNTRY_NAME:string,ORIGIN_COUNTRY_NAME:string,count:bigint>"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"plan","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644978490,"submitTime":1497644978483,"finishTime":1497644978521,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8699309f-d9ed-441b-81c8-e44f7f4136da"},{"version":"CommandV1","origId":2060825016293599,"guid":"33ec4fba-b26c-48a9-9603-8aebfd9df693","subtype":"command","commandType":"auto","position":30.0,"command":"%sql\nDROP VIEW IF EXISTS just_usa_view;","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644984875,"submitTime":1497644984864,"finishTime":1497644985136,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"232646ba-76fa-4758-bb35-fe2ae93165f7"},{"version":"CommandV1","origId":2060825016293600,"guid":"182c05ea-9b40-48f4-acb8-643bc5a2eb05","subtype":"command","commandType":"auto","position":31.0,"command":"%sql\nSHOW DATABASES","commandVersion":0,"state":"finished","results":{"type":"table","data":[["default"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"databaseName","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644991056,"submitTime":1497644991045,"finishTime":1497644991069,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2fbbcd0a-6809-4d88-aa8f-3d89660ac5aa"},{"version":"CommandV1","origId":2060825016293601,"guid":"0252ca2e-a409-4e67-b717-b3d03582db8e","subtype":"command","commandType":"auto","position":32.0,"command":"%sql\nCREATE DATABASE some_db","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497644996966,"submitTime":1497644996955,"finishTime":1497644997210,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7ecacc5b-0442-457d-9b5b-5a6099019a4e"},{"version":"CommandV1","origId":2060825016293602,"guid":"a3f3ef3a-774f-40d5-b639-872027ac5b6d","subtype":"command","commandType":"auto","position":33.0,"command":"%sql\nUSE some_db","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645005230,"submitTime":1497645005217,"finishTime":1497645005244,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f5e48076-5346-4e79-9883-9d1bad20406f"},{"version":"CommandV1","origId":2060825016293603,"guid":"9f2df4c6-8c25-4b83-b840-a885c8abf75a","subtype":"command","commandType":"auto","position":34.0,"command":"%sql\nSHOW tables","commandVersion":0,"state":"finished","results":{"type":"table","data":[["","just_usa_view_temp",true]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"database","type":"\"string\"","metadata":"{}"},{"name":"tableName","type":"\"string\"","metadata":"{}"},{"name":"isTemporary","type":"\"boolean\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645011661,"submitTime":1497645011649,"finishTime":1497645011691,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0695f3de-d770-4be4-be8b-4629379c56e1"},{"version":"CommandV1","origId":2060825016293604,"guid":"47eba1f7-4e99-4016-8711-7bccdbeef517","subtype":"command","commandType":"auto","position":35.0,"command":"%sql\nSELECT * FROM flights","commandVersion":0,"state":"error","results":null,"errorSummary":"Error in SQL statement: AnalysisException: Table or view not found: flights; line 1 pos 14","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.AnalysisException: Table or view not found: flights; line 1 pos 14\n\tat org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveRelations$$lookupTableFromCatalog(Analyzer.scala:465)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$9.applyOrElse(Analyzer.scala:484)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$9.applyOrElse(Analyzer.scala:469)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:60)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:469)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:459)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:85)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:82)\n\tat scala.collection.LinearSeqOptimized$class.foldLeft(LinearSeqOptimized.scala:111)\n\tat scala.collection.immutable.List.foldLeft(List.scala:84)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:82)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:74)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:74)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:60)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:77)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:75)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply$mcV$sp(QueryExecution.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:55)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:63)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:599)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:698)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:230)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:211)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:211)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:230)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:211)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:211)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1497645058646,"submitTime":1497645058646,"finishTime":1497645058708,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a652b88f-9f1d-4b35-b73a-157cf49f3de2"},{"version":"CommandV1","origId":2060825016293605,"guid":"9e3e9488-a76b-4787-b923-da4dbaa61e12","subtype":"command","commandType":"auto","position":36.0,"command":"%sql\nSELECT * FROM default.flights","commandVersion":0,"state":"finished","results":{"type":"table","data":[[null,null,15],[null,null,1],[null,null,344],[null,null,15],[null,null,62],[null,null,1],[null,null,62],[null,null,588],[null,null,40],[null,null,1],[null,null,325],[null,null,39],[null,null,64],[null,null,1],[null,null,41],[null,null,30],[null,null,6],[null,null,4],[null,null,230],[null,null,1],[null,null,1],[null,null,382],[null,null,69],[null,null,161],[null,null,12],[null,null,660],[null,null,181],[null,null,42],[null,null,155],[null,null,362],[null,null,955],[null,null,42],[null,null,561],[null,null,25],[null,null,13],[null,null,294],[null,null,38],[null,null,325],[null,null,332],[null,null,211],[null,null,19],[null,null,300],[null,null,1],[null,null,7140],[null,null,1],[null,null,268],[null,null,134],[null,null,608],[null,null,318],[null,null,34],[null,null,873],[null,null,14],[null,null,712],[null,null,121],[null,null,3],[null,null,19],[null,null,3],[null,null,25],[null,null,290],[null,null,31],[null,null,246],[null,null,510],[null,null,126],[null,null,185],[null,null,15],[null,null,28],[null,null,21],[null,null,23],[null,null,986],[null,null,111],[null,null,2],[null,null,414],[null,null,2],[null,null,920],[null,null,2],[null,null,1],[null,null,118],[null,null,28],[null,null,1420],[null,null,12],[null,null,134],[null,null,370002],[null,null,13],[null,null,134],[null,null,33],[null,null,44],[null,null,41],[null,null,39],[null,null,154],[null,null,129],[null,null,1],[null,null,21],[null,null,1],[null,null,1468],[null,null,827],[null,null,508],[null,null,335],[null,null,3],[null,null,1],[null,null,2],[null,null,12],[null,null,465],[null,null,342],[null,null,4],[null,null,236],[null,null,2],[null,null,12],[null,null,1],[null,null,407],[null,null,24],[null,null,108],[null,null,139],[null,null,32],[null,null,266],[null,null,226],[null,null,8399],[null,null,69],[null,null,2],[null,null,666],[null,null,2],[null,null,1353],[null,null,1548],[null,null,1],[null,null,26],[null,null,59],[null,null,13],[null,null,952],[null,null,115],[null,null,346],[null,null,5],[null,null,35],[null,null,61],[null,null,107],[null,null,853],[null,null,1336],[null,null,74],[null,null,43],[null,null,320],[null,null,3],[null,null,7187],[null,null,119],[null,null,776],[null,null,43],[null,null,313],[null,null,1],[null,null,153],[null,null,772],[null,null,201],[null,null,126],[null,null,1],[null,null,228],[null,null,314],[null,null,180],[null,null,279],[null,null,36],[null,null,202],[null,null,141],[null,null,420],[null,null,183],[null,null,50],[null,null,63],[null,null,59],[null,null,26],[null,null,83],[null,null,13],[null,null,127],[null,null,259],[null,null,136],[null,null,1],[null,null,80],[null,null,90],[null,null,2],[null,null,152],[null,null,63],[null,null,134],[null,null,53],[null,null,20],[null,null,1],[null,null,14],[null,null,1],[null,null,176],[null,null,70],[null,null,397],[null,null,123],[null,null,60],[null,null,83],[null,null,1],[null,null,235],[null,null,3],[null,null,40],[null,null,2],[null,null,138],[null,null,2025],[null,null,14],[null,null,4],[null,null,3],[null,null,442],[null,null,1],[null,null,438],[null,null,466],[null,null,305],[null,null,20],[null,null,1496],[null,null,127],[null,null,619],[null,null,19],[null,null,337],[null,null,1],[null,null,193],[null,null,1970],[null,null,188],[null,null,20],[null,null,2],[null,null,25],[null,null,8483],[null,null,117],[null,null,40],[null,null,179],[null,null,15],[null,null,27],[null,null,12],[null,null,258],[null,null,13],[null,null,62],[null,null,44],[null,null,30],[null,null,1048],[null,null,15],[null,null,18],[null,null,1],[null,null,56],[null,null,935],[null,null,32],[null,null,59],[null,null,13],[null,null,2],[null,null,193],[null,null,174],[null,null,478],[null,null,1],[null,null,867],[null,null,130],[null,null,109],[null,null,329],[null,null,310],[null,null,44],[null,null,1],[null,null,217],[null,null,13],[null,null,13],[null,null,3],[null,null,145],[null,null,43],[null,null,225],[null,null,58],[null,null,30]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"ORIGIN_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645027193,"submitTime":1497645027180,"finishTime":1497645027446,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"86ec0b5c-b784-4d5d-bbc6-d90e73d09eac"},{"version":"CommandV1","origId":2060825016293606,"guid":"3d2fc5fd-2f5a-4be3-8fdd-a3afd8f89e6f","subtype":"command","commandType":"auto","position":37.0,"command":"%sql\nSELECT current_database()","commandVersion":0,"state":"finished","results":{"type":"table","data":[["some_db"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"current_database()","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645273470,"submitTime":1497645273466,"finishTime":1497645273504,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"90d4ea37-9185-44f5-8037-c588392bcd9c"},{"version":"CommandV1","origId":2060825016293607,"guid":"55e31824-dc52-44cd-83f9-2a3903027f57","subtype":"command","commandType":"auto","position":38.0,"command":"%sql\nUSE default;","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645279515,"submitTime":1497645279503,"finishTime":1497645279527,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"84242103-dfd7-4c0f-b38c-dba2554f88b6"},{"version":"CommandV1","origId":2060825016293608,"guid":"818836b2-b8a2-4f10-9f87-8d6a055bf26e","subtype":"command","commandType":"auto","position":39.0,"command":"%sql\nDROP DATABASE IF EXISTS some_db;","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645285902,"submitTime":1497645285890,"finishTime":1497645286313,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"870b48c6-cc69-4855-8bfc-c4bcb2856c5b"},{"version":"CommandV1","origId":2060825016293609,"guid":"428b5e56-7820-4fd5-a0b2-45a9af278d77","subtype":"command","commandType":"auto","position":40.0,"command":"%sql\nSELECT\nCASE WHEN DEST_COUNTRY_NAME = 'UNITED STATES' THEN 1\nWHEN DEST_COUNTRY_NAME = 'Egypt' THEN 0\nELSE -1 END\nFROM\npartitioned_flights","commandVersion":0,"state":"finished","results":{"type":"table","data":[[-1],[-1],[-1],[-1],[-1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"CASE WHEN (DEST_COUNTRY_NAME = UNITED STATES) THEN 1 WHEN (DEST_COUNTRY_NAME = Egypt) THEN 0 ELSE (- 1) END","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: ParseException: \nno viable alternative at input 'SELECT ['(line 1, pos 7)\n\n== SQL ==\nSELECT [ALL|DISTINCT] named_expression[, named_expression, ...]\n-------^^^\nFROM relation[, relation, ...]\n[lateral_view[, lateral_view, ...]]\n[WHERE boolean_expression]\n[aggregation [HAVING boolean_expression]]\n[ORDER BY sort_expressions]\n[CLUSTER BY expressions]\n[DISTRIBUTE BY expressions]\n[SORT BY sort_expressions]\n[WINDOW named_window[, WINDOW named_window, ...]]\n[LIMIT num_rows]\nnamed_expression:\n: expression [AS alias]\nrelation:\n| join_relation\n| (table_name|query|relation) [sample] [AS alias]\n: VALUES (expressions)[, (expressions), ...]\n[AS (column_name[, column_name, ...])]\nexpressions:\n: expression[, expression, ...]\nsort_expressions:\n: expression [ASC|DESC][, expression [ASC|DESC], ...]\n","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.catalyst.parser.ParseException: \nno viable alternative at input 'SELECT ['(line 1, pos 7)\n\n== SQL ==\nSELECT [ALL|DISTINCT] named_expression[, named_expression, ...]\n-------^^^\nFROM relation[, relation, ...]\n[lateral_view[, lateral_view, ...]]\n[WHERE boolean_expression]\n[aggregation [HAVING boolean_expression]]\n[ORDER BY sort_expressions]\n[CLUSTER BY expressions]\n[DISTRIBUTE BY expressions]\n[SORT BY sort_expressions]\n[WINDOW named_window[, WINDOW named_window, ...]]\n[LIMIT num_rows]\nnamed_expression:\n: expression [AS alias]\nrelation:\n| join_relation\n| (table_name|query|relation) [sample] [AS alias]\n: VALUES (expressions)[, (expressions), ...]\n[AS (column_name[, column_name, ...])]\nexpressions:\n: expression[, expression, ...]\nsort_expressions:\n: expression [ASC|DESC][, expression [ASC|DESC], ...]\n\n\tat org.apache.spark.sql.catalyst.parser.ParseException.withCommand(ParseDriver.scala:196)\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parse(ParseDriver.scala:98)\n\tat org.apache.spark.sql.execution.SparkSqlParser.parse(SparkSqlParser.scala:45)\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parsePlan(ParseDriver.scala:52)\n\tat com.databricks.sql.parser.DatabricksSqlParser$$anonfun$parsePlan$1.apply(DatabricksSqlParser.scala:50)\n\tat com.databricks.sql.parser.DatabricksSqlParser$$anonfun$parsePlan$1.apply(DatabricksSqlParser.scala:47)\n\tat com.databricks.sql.parser.DatabricksSqlParser.parse(DatabricksSqlParser.scala:69)\n\tat com.databricks.sql.parser.DatabricksSqlParser.parsePlan(DatabricksSqlParser.scala:47)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:599)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:698)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:230)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:211)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:211)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:230)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:211)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:211)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1497645319342,"submitTime":1497645319330,"finishTime":1497645319986,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ea0f004f-fdb9-4a27-862a-ed03a7236348"},{"version":"CommandV1","origId":2060825016293610,"guid":"479ea9f4-b357-47a6-9763-1bde911dd4aa","subtype":"command","commandType":"auto","position":41.0,"command":"%sql\nCREATE VIEW IF NOT EXISTS\nnested_data\nAS\nSELECT\n(DEST_COUNTRY_NAME, ORIGIN_COUNTRY_NAME) as country,\ncount\nFROM flights","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645329495,"submitTime":1497645329492,"finishTime":1497645329670,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5863f649-445c-44b6-973a-0c01d2f27128"},{"version":"CommandV1","origId":2060825016293611,"guid":"5532d47d-d5ca-4a51-8c3a-8f437f5882d9","subtype":"command","commandType":"auto","position":42.0,"command":"%sql\nSELECT * FROM nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[[null,null],15],[[null,null],1],[[null,null],344],[[null,null],15],[[null,null],62],[[null,null],1],[[null,null],62],[[null,null],588],[[null,null],40],[[null,null],1],[[null,null],325],[[null,null],39],[[null,null],64],[[null,null],1],[[null,null],41],[[null,null],30],[[null,null],6],[[null,null],4],[[null,null],230],[[null,null],1],[[null,null],1],[[null,null],382],[[null,null],69],[[null,null],161],[[null,null],12],[[null,null],660],[[null,null],181],[[null,null],42],[[null,null],155],[[null,null],362],[[null,null],955],[[null,null],42],[[null,null],561],[[null,null],25],[[null,null],13],[[null,null],294],[[null,null],38],[[null,null],325],[[null,null],332],[[null,null],211],[[null,null],19],[[null,null],300],[[null,null],1],[[null,null],7140],[[null,null],1],[[null,null],268],[[null,null],134],[[null,null],608],[[null,null],318],[[null,null],34],[[null,null],873],[[null,null],14],[[null,null],712],[[null,null],121],[[null,null],3],[[null,null],19],[[null,null],3],[[null,null],25],[[null,null],290],[[null,null],31],[[null,null],246],[[null,null],510],[[null,null],126],[[null,null],185],[[null,null],15],[[null,null],28],[[null,null],21],[[null,null],23],[[null,null],986],[[null,null],111],[[null,null],2],[[null,null],414],[[null,null],2],[[null,null],920],[[null,null],2],[[null,null],1],[[null,null],118],[[null,null],28],[[null,null],1420],[[null,null],12],[[null,null],134],[[null,null],370002],[[null,null],13],[[null,null],134],[[null,null],33],[[null,null],44],[[null,null],41],[[null,null],39],[[null,null],154],[[null,null],129],[[null,null],1],[[null,null],21],[[null,null],1],[[null,null],1468],[[null,null],827],[[null,null],508],[[null,null],335],[[null,null],3],[[null,null],1],[[null,null],2],[[null,null],12],[[null,null],465],[[null,null],342],[[null,null],4],[[null,null],236],[[null,null],2],[[null,null],12],[[null,null],1],[[null,null],407],[[null,null],24],[[null,null],108],[[null,null],139],[[null,null],32],[[null,null],266],[[null,null],226],[[null,null],8399],[[null,null],69],[[null,null],2],[[null,null],666],[[null,null],2],[[null,null],1353],[[null,null],1548],[[null,null],1],[[null,null],26],[[null,null],59],[[null,null],13],[[null,null],952],[[null,null],115],[[null,null],346],[[null,null],5],[[null,null],35],[[null,null],61],[[null,null],107],[[null,null],853],[[null,null],1336],[[null,null],74],[[null,null],43],[[null,null],320],[[null,null],3],[[null,null],7187],[[null,null],119],[[null,null],776],[[null,null],43],[[null,null],313],[[null,null],1],[[null,null],153],[[null,null],772],[[null,null],201],[[null,null],126],[[null,null],1],[[null,null],228],[[null,null],314],[[null,null],180],[[null,null],279],[[null,null],36],[[null,null],202],[[null,null],141],[[null,null],420],[[null,null],183],[[null,null],50],[[null,null],63],[[null,null],59],[[null,null],26],[[null,null],83],[[null,null],13],[[null,null],127],[[null,null],259],[[null,null],136],[[null,null],1],[[null,null],80],[[null,null],90],[[null,null],2],[[null,null],152],[[null,null],63],[[null,null],134],[[null,null],53],[[null,null],20],[[null,null],1],[[null,null],14],[[null,null],1],[[null,null],176],[[null,null],70],[[null,null],397],[[null,null],123],[[null,null],60],[[null,null],83],[[null,null],1],[[null,null],235],[[null,null],3],[[null,null],40],[[null,null],2],[[null,null],138],[[null,null],2025],[[null,null],14],[[null,null],4],[[null,null],3],[[null,null],442],[[null,null],1],[[null,null],438],[[null,null],466],[[null,null],305],[[null,null],20],[[null,null],1496],[[null,null],127],[[null,null],619],[[null,null],19],[[null,null],337],[[null,null],1],[[null,null],193],[[null,null],1970],[[null,null],188],[[null,null],20],[[null,null],2],[[null,null],25],[[null,null],8483],[[null,null],117],[[null,null],40],[[null,null],179],[[null,null],15],[[null,null],27],[[null,null],12],[[null,null],258],[[null,null],13],[[null,null],62],[[null,null],44],[[null,null],30],[[null,null],1048],[[null,null],15],[[null,null],18],[[null,null],1],[[null,null],56],[[null,null],935],[[null,null],32],[[null,null],59],[[null,null],13],[[null,null],2],[[null,null],193],[[null,null],174],[[null,null],478],[[null,null],1],[[null,null],867],[[null,null],130],[[null,null],109],[[null,null],329],[[null,null],310],[[null,null],44],[[null,null],1],[[null,null],217],[[null,null],13],[[null,null],13],[[null,null],3],[[null,null],145],[[null,null],43],[[null,null],225],[[null,null],58],[[null,null],30]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"country","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"DEST_COUNTRY_NAME\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"ORIGIN_COUNTRY_NAME\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645339544,"submitTime":1497645339532,"finishTime":1497645339780,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ba3250e8-30f4-4d84-b671-48ccc74e0d1b"},{"version":"CommandV1","origId":2060825016293612,"guid":"2ebf9fdf-8c01-476a-ae76-851521f5cdd9","subtype":"command","commandType":"auto","position":43.0,"command":"%sql\nSELECT country.DEST_COUNTRY_NAME, count\nFROM nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[null,15],[null,1],[null,344],[null,15],[null,62],[null,1],[null,62],[null,588],[null,40],[null,1],[null,325],[null,39],[null,64],[null,1],[null,41],[null,30],[null,6],[null,4],[null,230],[null,1],[null,1],[null,382],[null,69],[null,161],[null,12],[null,660],[null,181],[null,42],[null,155],[null,362],[null,955],[null,42],[null,561],[null,25],[null,13],[null,294],[null,38],[null,325],[null,332],[null,211],[null,19],[null,300],[null,1],[null,7140],[null,1],[null,268],[null,134],[null,608],[null,318],[null,34],[null,873],[null,14],[null,712],[null,121],[null,3],[null,19],[null,3],[null,25],[null,290],[null,31],[null,246],[null,510],[null,126],[null,185],[null,15],[null,28],[null,21],[null,23],[null,986],[null,111],[null,2],[null,414],[null,2],[null,920],[null,2],[null,1],[null,118],[null,28],[null,1420],[null,12],[null,134],[null,370002],[null,13],[null,134],[null,33],[null,44],[null,41],[null,39],[null,154],[null,129],[null,1],[null,21],[null,1],[null,1468],[null,827],[null,508],[null,335],[null,3],[null,1],[null,2],[null,12],[null,465],[null,342],[null,4],[null,236],[null,2],[null,12],[null,1],[null,407],[null,24],[null,108],[null,139],[null,32],[null,266],[null,226],[null,8399],[null,69],[null,2],[null,666],[null,2],[null,1353],[null,1548],[null,1],[null,26],[null,59],[null,13],[null,952],[null,115],[null,346],[null,5],[null,35],[null,61],[null,107],[null,853],[null,1336],[null,74],[null,43],[null,320],[null,3],[null,7187],[null,119],[null,776],[null,43],[null,313],[null,1],[null,153],[null,772],[null,201],[null,126],[null,1],[null,228],[null,314],[null,180],[null,279],[null,36],[null,202],[null,141],[null,420],[null,183],[null,50],[null,63],[null,59],[null,26],[null,83],[null,13],[null,127],[null,259],[null,136],[null,1],[null,80],[null,90],[null,2],[null,152],[null,63],[null,134],[null,53],[null,20],[null,1],[null,14],[null,1],[null,176],[null,70],[null,397],[null,123],[null,60],[null,83],[null,1],[null,235],[null,3],[null,40],[null,2],[null,138],[null,2025],[null,14],[null,4],[null,3],[null,442],[null,1],[null,438],[null,466],[null,305],[null,20],[null,1496],[null,127],[null,619],[null,19],[null,337],[null,1],[null,193],[null,1970],[null,188],[null,20],[null,2],[null,25],[null,8483],[null,117],[null,40],[null,179],[null,15],[null,27],[null,12],[null,258],[null,13],[null,62],[null,44],[null,30],[null,1048],[null,15],[null,18],[null,1],[null,56],[null,935],[null,32],[null,59],[null,13],[null,2],[null,193],[null,174],[null,478],[null,1],[null,867],[null,130],[null,109],[null,329],[null,310],[null,44],[null,1],[null,217],[null,13],[null,13],[null,3],[null,145],[null,43],[null,225],[null,58],[null,30]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645350182,"submitTime":1497645350170,"finishTime":1497645351466,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e04af0dc-83c3-4690-a7c6-c37572b6b296"},{"version":"CommandV1","origId":2060825016293613,"guid":"27b17c68-cc6f-4398-afd4-e471249995ad","subtype":"command","commandType":"auto","position":44.0,"command":"%sql\nSELECT country.*, count\nFROM nested_data","commandVersion":0,"state":"finished","results":{"type":"table","data":[[null,null,15],[null,null,1],[null,null,344],[null,null,15],[null,null,62],[null,null,1],[null,null,62],[null,null,588],[null,null,40],[null,null,1],[null,null,325],[null,null,39],[null,null,64],[null,null,1],[null,null,41],[null,null,30],[null,null,6],[null,null,4],[null,null,230],[null,null,1],[null,null,1],[null,null,382],[null,null,69],[null,null,161],[null,null,12],[null,null,660],[null,null,181],[null,null,42],[null,null,155],[null,null,362],[null,null,955],[null,null,42],[null,null,561],[null,null,25],[null,null,13],[null,null,294],[null,null,38],[null,null,325],[null,null,332],[null,null,211],[null,null,19],[null,null,300],[null,null,1],[null,null,7140],[null,null,1],[null,null,268],[null,null,134],[null,null,608],[null,null,318],[null,null,34],[null,null,873],[null,null,14],[null,null,712],[null,null,121],[null,null,3],[null,null,19],[null,null,3],[null,null,25],[null,null,290],[null,null,31],[null,null,246],[null,null,510],[null,null,126],[null,null,185],[null,null,15],[null,null,28],[null,null,21],[null,null,23],[null,null,986],[null,null,111],[null,null,2],[null,null,414],[null,null,2],[null,null,920],[null,null,2],[null,null,1],[null,null,118],[null,null,28],[null,null,1420],[null,null,12],[null,null,134],[null,null,370002],[null,null,13],[null,null,134],[null,null,33],[null,null,44],[null,null,41],[null,null,39],[null,null,154],[null,null,129],[null,null,1],[null,null,21],[null,null,1],[null,null,1468],[null,null,827],[null,null,508],[null,null,335],[null,null,3],[null,null,1],[null,null,2],[null,null,12],[null,null,465],[null,null,342],[null,null,4],[null,null,236],[null,null,2],[null,null,12],[null,null,1],[null,null,407],[null,null,24],[null,null,108],[null,null,139],[null,null,32],[null,null,266],[null,null,226],[null,null,8399],[null,null,69],[null,null,2],[null,null,666],[null,null,2],[null,null,1353],[null,null,1548],[null,null,1],[null,null,26],[null,null,59],[null,null,13],[null,null,952],[null,null,115],[null,null,346],[null,null,5],[null,null,35],[null,null,61],[null,null,107],[null,null,853],[null,null,1336],[null,null,74],[null,null,43],[null,null,320],[null,null,3],[null,null,7187],[null,null,119],[null,null,776],[null,null,43],[null,null,313],[null,null,1],[null,null,153],[null,null,772],[null,null,201],[null,null,126],[null,null,1],[null,null,228],[null,null,314],[null,null,180],[null,null,279],[null,null,36],[null,null,202],[null,null,141],[null,null,420],[null,null,183],[null,null,50],[null,null,63],[null,null,59],[null,null,26],[null,null,83],[null,null,13],[null,null,127],[null,null,259],[null,null,136],[null,null,1],[null,null,80],[null,null,90],[null,null,2],[null,null,152],[null,null,63],[null,null,134],[null,null,53],[null,null,20],[null,null,1],[null,null,14],[null,null,1],[null,null,176],[null,null,70],[null,null,397],[null,null,123],[null,null,60],[null,null,83],[null,null,1],[null,null,235],[null,null,3],[null,null,40],[null,null,2],[null,null,138],[null,null,2025],[null,null,14],[null,null,4],[null,null,3],[null,null,442],[null,null,1],[null,null,438],[null,null,466],[null,null,305],[null,null,20],[null,null,1496],[null,null,127],[null,null,619],[null,null,19],[null,null,337],[null,null,1],[null,null,193],[null,null,1970],[null,null,188],[null,null,20],[null,null,2],[null,null,25],[null,null,8483],[null,null,117],[null,null,40],[null,null,179],[null,null,15],[null,null,27],[null,null,12],[null,null,258],[null,null,13],[null,null,62],[null,null,44],[null,null,30],[null,null,1048],[null,null,15],[null,null,18],[null,null,1],[null,null,56],[null,null,935],[null,null,32],[null,null,59],[null,null,13],[null,null,2],[null,null,193],[null,null,174],[null,null,478],[null,null,1],[null,null,867],[null,null,130],[null,null,109],[null,null,329],[null,null,310],[null,null,44],[null,null,1],[null,null,217],[null,null,13],[null,null,13],[null,null,3],[null,null,145],[null,null,43],[null,null,225],[null,null,58],[null,null,30]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"ORIGIN_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645357592,"submitTime":1497645357580,"finishTime":1497645357773,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5b384288-d9e0-4884-907a-a0d5df0301d2"},{"version":"CommandV1","origId":2060825016293614,"guid":"7372d415-5494-44de-8b01-8eaac7e925a9","subtype":"command","commandType":"auto","position":45.0,"command":"%sql\nSELECT\nDEST_COUNTRY_NAME as new_name,\ncollect_list(count) as flight_counts,\ncollect_set(ORIGIN_COUNTRY_NAME) as origin_set\nFROM\nflights\nGROUP BY\nDEST_COUNTRY_NAME","commandVersion":0,"state":"finished","results":{"type":"table","data":[[null,[15,1,344,15,62,1,62,588,40,1,325,39,64,1,41,30,6,4,230,1,1,382,69,161,12,660,181,42,155,362,955,42,561,25,13,294,38,325,332,211,19,300,1,7140,1,268,134,608,318,34,873,14,712,121,3,19,3,25,290,31,246,510,126,185,15,28,21,23,986,111,2,414,2,920,2,1,118,28,1420,12,134,370002,13,134,33,44,41,39,154,129,1,21,1,1468,827,508,335,3,1,2,12,465,342,4,236,2,12,1,407,24,108,139,32,266,226,8399,69,2,666,2,1353,1548,1,26,59,13,952,115,346,5,35,61,107,853,1336,74,43,320,3,7187,119,776,43,313,1,153,772,201,126,1,228,314,180,279,36,202,141,420,183,50,63,59,26,83,13,127,259,136,1,80,90,2,152,63,134,53,20,1,14,1,176,70,397,123,60,83,1,235,3,40,2,138,2025,14,4,3,442,1,438,466,305,20,1496,127,619,19,337,1,193,1970,188,20,2,25,8483,117,40,179,15,27,12,258,13,62,44,30,1048,15,18,1,56,935,32,59,13,2,193,174,478,1,867,130,109,329,310,44,1,217,13,13,3,145,43,225,58,30],[]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"new_name","type":"\"string\"","metadata":"{}"},{"name":"flight_counts","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"},{"name":"origin_set","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645365675,"submitTime":1497645365663,"finishTime":1497645366135,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a94df1ab-20c1-4121-b45f-fac2fde8779f"},{"version":"CommandV1","origId":2060825016293615,"guid":"a72b14d4-903d-4c83-837b-1260e21c2e5b","subtype":"command","commandType":"auto","position":46.0,"command":"%sql\nSELECT\nDEST_COUNTRY_NAME as new_name,\ncollect_list(count)[0]\nFROM\nflights\nGROUP BY\nDEST_COUNTRY_NAME","commandVersion":0,"state":"finished","results":{"type":"table","data":[[null,15]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"new_name","type":"\"string\"","metadata":"{}"},{"name":"collect_list(count)[0]","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645372274,"submitTime":1497645372262,"finishTime":1497645372715,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"108f6cf1-ebe4-4bca-9770-09f816770555"},{"version":"CommandV1","origId":2060825016293616,"guid":"848d08e7-976f-41f6-8351-d1a65f64c3c3","subtype":"command","commandType":"auto","position":47.0,"command":"%sql\nCREATE OR REPLACE TEMP VIEW flights_agg\nAS\nSELECT\nDEST_COUNTRY_NAME,\ncollect_list(count) as collected_counts\nFROM\nflights\nGROUP BY\nDEST_COUNTRY_NAME","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645384184,"submitTime":1497645384170,"finishTime":1497645384245,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e3c5c567-0afc-47a7-b352-8a0829a9212c"},{"version":"CommandV1","origId":2060825016293617,"guid":"2cc80967-5049-4535-a19f-c005c9e295ba","subtype":"command","commandType":"auto","position":48.0,"command":"%sql\nSELECT explode(collected_counts), DEST_COUNTRY_NAME\nFROM flights_agg","commandVersion":0,"state":"finished","results":{"type":"table","data":[[15,null],[1,null],[344,null],[15,null],[62,null],[1,null],[62,null],[588,null],[40,null],[1,null],[325,null],[39,null],[64,null],[1,null],[41,null],[30,null],[6,null],[4,null],[230,null],[1,null],[1,null],[382,null],[69,null],[161,null],[12,null],[660,null],[181,null],[42,null],[155,null],[362,null],[955,null],[42,null],[561,null],[25,null],[13,null],[294,null],[38,null],[325,null],[332,null],[211,null],[19,null],[300,null],[1,null],[7140,null],[1,null],[268,null],[134,null],[608,null],[318,null],[34,null],[873,null],[14,null],[712,null],[121,null],[3,null],[19,null],[3,null],[25,null],[290,null],[31,null],[246,null],[510,null],[126,null],[185,null],[15,null],[28,null],[21,null],[23,null],[986,null],[111,null],[2,null],[414,null],[2,null],[920,null],[2,null],[1,null],[118,null],[28,null],[1420,null],[12,null],[134,null],[370002,null],[13,null],[134,null],[33,null],[44,null],[41,null],[39,null],[154,null],[129,null],[1,null],[21,null],[1,null],[1468,null],[827,null],[508,null],[335,null],[3,null],[1,null],[2,null],[12,null],[465,null],[342,null],[4,null],[236,null],[2,null],[12,null],[1,null],[407,null],[24,null],[108,null],[139,null],[32,null],[266,null],[226,null],[8399,null],[69,null],[2,null],[666,null],[2,null],[1353,null],[1548,null],[1,null],[26,null],[59,null],[13,null],[952,null],[115,null],[346,null],[5,null],[35,null],[61,null],[107,null],[853,null],[1336,null],[74,null],[43,null],[320,null],[3,null],[7187,null],[119,null],[776,null],[43,null],[313,null],[1,null],[153,null],[772,null],[201,null],[126,null],[1,null],[228,null],[314,null],[180,null],[279,null],[36,null],[202,null],[141,null],[420,null],[183,null],[50,null],[63,null],[59,null],[26,null],[83,null],[13,null],[127,null],[259,null],[136,null],[1,null],[80,null],[90,null],[2,null],[152,null],[63,null],[134,null],[53,null],[20,null],[1,null],[14,null],[1,null],[176,null],[70,null],[397,null],[123,null],[60,null],[83,null],[1,null],[235,null],[3,null],[40,null],[2,null],[138,null],[2025,null],[14,null],[4,null],[3,null],[442,null],[1,null],[438,null],[466,null],[305,null],[20,null],[1496,null],[127,null],[619,null],[19,null],[337,null],[1,null],[193,null],[1970,null],[188,null],[20,null],[2,null],[25,null],[8483,null],[117,null],[40,null],[179,null],[15,null],[27,null],[12,null],[258,null],[13,null],[62,null],[44,null],[30,null],[1048,null],[15,null],[18,null],[1,null],[56,null],[935,null],[32,null],[59,null],[13,null],[2,null],[193,null],[174,null],[478,null],[1,null],[867,null],[130,null],[109,null],[329,null],[310,null],[44,null],[1,null],[217,null],[13,null],[13,null],[3,null],[145,null],[43,null],[225,null],[58,null],[30,null]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col","type":"\"long\"","metadata":"{}"},{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645390530,"submitTime":1497645390515,"finishTime":1497645390922,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"782f2333-5acb-4a82-af9f-61ed3c99f097"},{"version":"CommandV1","origId":2060825016293618,"guid":"296e6ab8-adca-4fb5-a4e7-42464862b87e","subtype":"command","commandType":"auto","position":49.0,"command":"%sql\nSHOW FUNCTIONS","commandVersion":0,"state":"finished","results":{"type":"table","data":[["!"],["%"],["&"],["*"],["+"],["-"],["/"],["<"],["<="],["<=>"],["="],["=="],[">"],[">="],["^"],["abs"],["acos"],["add_months"],["aggregate"],["and"],["approx_count_distinct"],["approx_percentile"],["array"],["array_contains"],["ascii"],["asin"],["assert_true"],["atan"],["atan2"],["avg"],["base64"],["bigint"],["bin"],["binary"],["boolean"],["bround"],["cbrt"],["ceil"],["ceiling"],["coalesce"],["collect_list"],["collect_set"],["concat"],["concat_ws"],["conv"],["corr"],["cos"],["cosh"],["count"],["covar_pop"],["covar_samp"],["crc32"],["cube"],["cume_dist"],["current_database"],["current_date"],["current_timestamp"],["date"],["date_add"],["date_format"],["date_sub"],["datediff"],["day"],["dayofmonth"],["dayofyear"],["decimal"],["decode"],["degrees"],["dense_rank"],["double"],["e"],["elt"],["encode"],["exists"],["exp"],["explode"],["expm1"],["factorial"],["filter"],["find_in_set"],["first"],["first_value"],["float"],["floor"],["format_number"],["format_string"],["from_unixtime"],["from_utc_timestamp"],["get_json_object"],["getargument"],["greatest"],["grouping"],["grouping_id"],["hash"],["hex"],["hour"],["hypot"],["if"],["ifnull"],["in"],["initcap"],["inline"],["input_file_name"],["instr"],["int"],["isnan"],["isnotnull"],["isnull"],["java_method"],["json_tuple"],["kurtosis"],["lag"],["last"],["last_day"],["last_value"],["lcase"],["lead"],["least"],["length"],["levenshtein"],["like"],["ln"],["locate"],["log"],["log10"],["log1p"],["log2"],["lower"],["lpad"],["ltrim"],["map"],["map_keys"],["map_values"],["max"],["md5"],["mean"],["min"],["minute"],["monotonically_increasing_id"],["month"],["months_between"],["named_struct"],["nanvl"],["negative"],["next_day"],["not"],["now"],["ntile"],["nullif"],["nvl"],["nvl2"],["or"],["parse_url"],["percent_rank"],["percentile"],["percentile_approx"],["pi"],["pmod"],["posexplode"],["positive"],["pow"],["power"],["printf"],["quarter"],["radians"],["rand"],["randn"],["rank"],["reduce"],["reflect"],["regexp_extract"],["regexp_replace"],["repeat"],["reverse"],["rint"],["rlike"],["rollup"],["round"],["row_number"],["rpad"],["rtrim"],["second"],["sentences"],["sha"],["sha1"],["sha2"],["shiftleft"],["shiftright"],["shiftrightunsigned"],["sign"],["signum"],["sin"],["sinh"],["size"],["skewness"],["smallint"],["sort_array"],["soundex"],["space"],["spark_partition_id"],["split"],["sqrt"],["stack"],["std"],["stddev"],["stddev_pop"],["stddev_samp"],["str_to_map"],["string"],["struct"],["substr"],["substring"],["substring_index"],["sum"],["tan"],["tanh"],["timestamp"],["tinyint"],["to_date"],["to_unix_timestamp"],["to_utc_timestamp"],["transform"],["translate"],["trim"],["trunc"],["ucase"],["unbase64"],["unhex"],["unix_timestamp"],["upper"],["var_pop"],["var_samp"],["variance"],["weekofyear"],["when"],["window"],["xpath"],["xpath_boolean"],["xpath_double"],["xpath_float"],["xpath_int"],["xpath_long"],["xpath_number"],["xpath_short"],["xpath_string"],["year"],["|"],["~"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"function","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645396350,"submitTime":1497645396333,"finishTime":1497645396393,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fc3e34f5-d1ed-43fc-b1b4-f58d402186c2"},{"version":"CommandV1","origId":2060825016293619,"guid":"6b4e7b6b-602a-4b41-b57e-a4b1c7a3576e","subtype":"command","commandType":"auto","position":50.0,"command":"%sql\nSHOW SYSTEM FUNCTIONS","commandVersion":0,"state":"finished","results":{"type":"table","data":[["!"],["%"],["&"],["*"],["+"],["-"],["/"],["<"],["<="],["<=>"],["="],["=="],[">"],[">="],["^"],["abs"],["acos"],["add_months"],["aggregate"],["and"],["approx_count_distinct"],["approx_percentile"],["array"],["array_contains"],["ascii"],["asin"],["assert_true"],["atan"],["atan2"],["avg"],["base64"],["bigint"],["bin"],["binary"],["boolean"],["bround"],["cbrt"],["ceil"],["ceiling"],["coalesce"],["collect_list"],["collect_set"],["concat"],["concat_ws"],["conv"],["corr"],["cos"],["cosh"],["count"],["covar_pop"],["covar_samp"],["crc32"],["cube"],["cume_dist"],["current_database"],["current_date"],["current_timestamp"],["date"],["date_add"],["date_format"],["date_sub"],["datediff"],["day"],["dayofmonth"],["dayofyear"],["decimal"],["decode"],["degrees"],["dense_rank"],["double"],["e"],["elt"],["encode"],["exists"],["exp"],["explode"],["expm1"],["factorial"],["filter"],["find_in_set"],["first"],["first_value"],["float"],["floor"],["format_number"],["format_string"],["from_unixtime"],["from_utc_timestamp"],["get_json_object"],["greatest"],["grouping"],["grouping_id"],["hash"],["hex"],["hour"],["hypot"],["if"],["ifnull"],["in"],["initcap"],["inline"],["input_file_name"],["instr"],["int"],["isnan"],["isnotnull"],["isnull"],["java_method"],["json_tuple"],["kurtosis"],["lag"],["last"],["last_day"],["last_value"],["lcase"],["lead"],["least"],["length"],["levenshtein"],["like"],["ln"],["locate"],["log"],["log10"],["log1p"],["log2"],["lower"],["lpad"],["ltrim"],["map"],["map_keys"],["map_values"],["max"],["md5"],["mean"],["min"],["minute"],["monotonically_increasing_id"],["month"],["months_between"],["named_struct"],["nanvl"],["negative"],["next_day"],["not"],["now"],["ntile"],["nullif"],["nvl"],["nvl2"],["or"],["parse_url"],["percent_rank"],["percentile"],["percentile_approx"],["pi"],["pmod"],["posexplode"],["positive"],["pow"],["power"],["printf"],["quarter"],["radians"],["rand"],["randn"],["rank"],["reduce"],["reflect"],["regexp_extract"],["regexp_replace"],["repeat"],["reverse"],["rint"],["rlike"],["rollup"],["round"],["row_number"],["rpad"],["rtrim"],["second"],["sentences"],["sha"],["sha1"],["sha2"],["shiftleft"],["shiftright"],["shiftrightunsigned"],["sign"],["signum"],["sin"],["sinh"],["size"],["skewness"],["smallint"],["sort_array"],["soundex"],["space"],["spark_partition_id"],["split"],["sqrt"],["stack"],["std"],["stddev"],["stddev_pop"],["stddev_samp"],["str_to_map"],["string"],["struct"],["substr"],["substring"],["substring_index"],["sum"],["tan"],["tanh"],["timestamp"],["tinyint"],["to_date"],["to_unix_timestamp"],["to_utc_timestamp"],["transform"],["translate"],["trim"],["trunc"],["ucase"],["unbase64"],["unhex"],["unix_timestamp"],["upper"],["var_pop"],["var_samp"],["variance"],["weekofyear"],["when"],["window"],["xpath"],["xpath_boolean"],["xpath_double"],["xpath_float"],["xpath_int"],["xpath_long"],["xpath_number"],["xpath_short"],["xpath_string"],["year"],["|"],["~"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"function","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645403779,"submitTime":1497645403766,"finishTime":1497645403806,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7c5ba37d-043c-4d24-ac9d-d20bb639edc5"},{"version":"CommandV1","origId":2060825016293620,"guid":"8516b714-80cf-47e1-b840-ef9274863d44","subtype":"command","commandType":"auto","position":51.0,"command":"%sql\nSHOW USER FUNCTIONS","commandVersion":0,"state":"finished","results":{"type":"table","data":[["getargument"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"function","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645411393,"submitTime":1497645411378,"finishTime":1497645411416,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"87db4297-a821-4103-add1-05994ade4d99"},{"version":"CommandV1","origId":2060825016293621,"guid":"db0555f4-a359-4601-8a2b-f7af062fb7b5","subtype":"command","commandType":"auto","position":52.0,"command":"%sql\nSHOW FUNCTIONS \"s*\";","commandVersion":0,"state":"finished","results":{"type":"table","data":[["second"],["sentences"],["sha"],["sha1"],["sha2"],["shiftleft"],["shiftright"],["shiftrightunsigned"],["sign"],["signum"],["sin"],["sinh"],["size"],["skewness"],["smallint"],["sort_array"],["soundex"],["space"],["spark_partition_id"],["split"],["sqrt"],["stack"],["std"],["stddev"],["stddev_pop"],["stddev_samp"],["str_to_map"],["string"],["struct"],["substr"],["substring"],["substring_index"],["sum"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"function","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645418280,"submitTime":1497645418262,"finishTime":1497645418301,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ec3cbfd9-5b6a-4d7f-924e-1b91ffa4965a"},{"version":"CommandV1","origId":2060825016293622,"guid":"ec63cb1d-e9ca-4af7-8c9a-bb4d45f4f218","subtype":"command","commandType":"auto","position":53.0,"command":"%sql\nSHOW FUNCTIONS LIKE \"collect*\";","commandVersion":0,"state":"finished","results":{"type":"table","data":[["collect_list"],["collect_set"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"function","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645425176,"submitTime":1497645425163,"finishTime":1497645425196,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9733cf17-f390-4417-9f7c-59b86499b664"},{"version":"CommandV1","origId":2060825016293623,"guid":"09893231-c9e7-4878-885b-5ad36e6a772e","subtype":"command","commandType":"auto","position":54.0,"command":"%scala\ndef power3(number:Double):Double = {\nnumber * number * number\n}\nspark.udf.register(\"power3\", power3(_:Double):Double)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">power3: (number: Double)Double\nres4: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(&lt;function1&gt;,DoubleType,Some(List(DoubleType)))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645437857,"submitTime":1497645437844,"finishTime":1497645438218,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4b5dc0dd-03df-49f3-b4c7-70f4045bd0a0"},{"version":"CommandV1","origId":2060825016293624,"guid":"65508e5b-f964-4034-895c-7ae92582bedd","subtype":"command","commandType":"auto","position":55.0,"command":"%sql\nSELECT count, power3(count)\nFROM flights","commandVersion":0,"state":"finished","results":{"type":"table","data":[[15,3375.0],[1,1.0],[344,4.0707584E7],[15,3375.0],[62,238328.0],[1,1.0],[62,238328.0],[588,2.03297472E8],[40,64000.0],[1,1.0],[325,3.4328125E7],[39,59319.0],[64,262144.0],[1,1.0],[41,68921.0],[30,27000.0],[6,216.0],[4,64.0],[230,1.2167E7],[1,1.0],[1,1.0],[382,5.5742968E7],[69,328509.0],[161,4173281.0],[12,1728.0],[660,2.87496E8],[181,5929741.0],[42,74088.0],[155,3723875.0],[362,4.7437928E7],[955,8.70983875E8],[42,74088.0],[561,1.76558481E8],[25,15625.0],[13,2197.0],[294,2.5412184E7],[38,54872.0],[325,3.4328125E7],[332,3.6594368E7],[211,9393931.0],[19,6859.0],[300,2.7E7],[1,1.0],[7140,3.63994344E11],[1,1.0],[268,1.9248832E7],[134,2406104.0],[608,2.24755712E8],[318,3.2157432E7],[34,39304.0],[873,6.65338617E8],[14,2744.0],[712,3.60944128E8],[121,1771561.0],[3,27.0],[19,6859.0],[3,27.0],[25,15625.0],[290,2.4389E7],[31,29791.0],[246,1.4886936E7],[510,1.32651E8],[126,2000376.0],[185,6331625.0],[15,3375.0],[28,21952.0],[21,9261.0],[23,12167.0],[986,9.58585256E8],[111,1367631.0],[2,8.0],[414,7.0957944E7],[2,8.0],[920,7.78688E8],[2,8.0],[1,1.0],[118,1643032.0],[28,21952.0],[1420,2.863288E9],[12,1728.0],[134,2406104.0],[370002,5.0653821404440008E16],[13,2197.0],[134,2406104.0],[33,35937.0],[44,85184.0],[41,68921.0],[39,59319.0],[154,3652264.0],[129,2146689.0],[1,1.0],[21,9261.0],[1,1.0],[1468,3.163575232E9],[827,5.65609283E8],[508,1.31096512E8],[335,3.7595375E7],[3,27.0],[1,1.0],[2,8.0],[12,1728.0],[465,1.00544625E8],[342,4.0001688E7],[4,64.0],[236,1.3144256E7],[2,8.0],[12,1728.0],[1,1.0],[407,6.7419143E7],[24,13824.0],[108,1259712.0],[139,2685619.0],[32,32768.0],[266,1.8821096E7],[226,1.1543176E7],[8399,5.92492345199E11],[69,328509.0],[2,8.0],[666,2.95408296E8],[2,8.0],[1353,2.476813977E9],[1548,3.709478592E9],[1,1.0],[26,17576.0],[59,205379.0],[13,2197.0],[952,8.62801408E8],[115,1520875.0],[346,4.1421736E7],[5,125.0],[35,42875.0],[61,226981.0],[107,1225043.0],[853,6.20650477E8],[1336,2.384621056E9],[74,405224.0],[43,79507.0],[320,3.2768E7],[3,27.0],[7187,3.71229888203E11],[119,1685159.0],[776,4.67288576E8],[43,79507.0],[313,3.0664297E7],[1,1.0],[153,3581577.0],[772,4.60099648E8],[201,8120601.0],[126,2000376.0],[1,1.0],[228,1.1852352E7],[314,3.0959144E7],[180,5832000.0],[279,2.1717639E7],[36,46656.0],[202,8242408.0],[141,2803221.0],[420,7.4088E7],[183,6128487.0],[50,125000.0],[63,250047.0],[59,205379.0],[26,17576.0],[83,571787.0],[13,2197.0],[127,2048383.0],[259,1.7373979E7],[136,2515456.0],[1,1.0],[80,512000.0],[90,729000.0],[2,8.0],[152,3511808.0],[63,250047.0],[134,2406104.0],[53,148877.0],[20,8000.0],[1,1.0],[14,2744.0],[1,1.0],[176,5451776.0],[70,343000.0],[397,6.2570773E7],[123,1860867.0],[60,216000.0],[83,571787.0],[1,1.0],[235,1.2977875E7],[3,27.0],[40,64000.0],[2,8.0],[138,2628072.0],[2025,8.303765625E9],[14,2744.0],[4,64.0],[3,27.0],[442,8.6350888E7],[1,1.0],[438,8.4027672E7],[466,1.01194696E8],[305,2.8372625E7],[20,8000.0],[1496,3.348071936E9],[127,2048383.0],[619,2.37176659E8],[19,6859.0],[337,3.8272753E7],[1,1.0],[193,7189057.0],[1970,7.645373E9],[188,6644672.0],[20,8000.0],[2,8.0],[25,15625.0],[8483,6.10447614587E11],[117,1601613.0],[40,64000.0],[179,5735339.0],[15,3375.0],[27,19683.0],[12,1728.0],[258,1.7173512E7],[13,2197.0],[62,238328.0],[44,85184.0],[30,27000.0],[1048,1.151022592E9],[15,3375.0],[18,5832.0],[1,1.0],[56,175616.0],[935,8.17400375E8],[32,32768.0],[59,205379.0],[13,2197.0],[2,8.0],[193,7189057.0],[174,5268024.0],[478,1.09215352E8],[1,1.0],[867,6.51714363E8],[130,2197000.0],[109,1295029.0],[329,3.5611289E7],[310,2.9791E7],[44,85184.0],[1,1.0],[217,1.0218313E7],[13,2197.0],[13,2197.0],[3,27.0],[145,3048625.0],[43,79507.0],[225,1.1390625E7],[58,195112.0],[30,27000.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count","type":"\"long\"","metadata":"{}"},{"name":"UDF:power3(cast(count as double))","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645444211,"submitTime":1497645444198,"finishTime":1497645444380,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"58da7abe-f00a-4fa6-ba6f-6337a7ab23a1"},{"version":"CommandV1","origId":2060825016293625,"guid":"01b4e040-66cf-4397-95e8-6662d1c9edce","subtype":"command","commandType":"auto","position":56.0,"command":"%sql\nCREATE EXTERNAL TABLE hive_flights (\nDEST_COUNTRY_NAME STRING,\nORIGIN_COUNTRY_NAME STRING,\ncount LONG)\nROW FORMAT DELIMITED FIELDS TERMINATED BY ','\nLOCATION '/mnt/defg/flight-data-hive/'","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645477228,"submitTime":1497645477215,"finishTime":1497645477639,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c8ba47fc-f8a1-47ba-921a-30aac8d45197"},{"version":"CommandV1","origId":2060825016293626,"guid":"8ccfbcd5-b241-464b-a994-758b0b7e5e76","subtype":"command","commandType":"auto","position":57.0,"command":"%sql\nCREATE EXTERNAL TABLE hive_flights_2\nROW FORMAT DELIMITED FIELDS TERMINATED BY ','\nLOCATION '/mnt/defg/flight-data-hive/'\nAS SELECT * FROM flights\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: ParseException: \nextraneous input '%' expecting {<EOF>, ',', 'SELECT', 'FROM', 'ADD', 'AS', 'ALL', 'DISTINCT', 'WHERE', 'GROUP', 'BY', 'GROUPING', 'SETS', 'CUBE', 'ROLLUP', 'ORDER', 'HAVING', 'LIMIT', 'AT', 'OR', 'AND', 'IN', NOT, 'NO', 'EXISTS', 'BETWEEN', 'LIKE', RLIKE, 'IS', 'NULL', 'TRUE', 'FALSE', 'NULLS', 'ASC', 'DESC', 'FOR', 'INTERVAL', 'CASE', 'WHEN', 'THEN', 'ELSE', 'END', 'JOIN', 'CROSS', 'OUTER', 'INNER', 'LEFT', 'RIGHT', 'FULL', 'NATURAL', 'LATERAL', 'WINDOW', 'OVER', 'PARTITION', 'RANGE', 'ROWS', 'UNBOUNDED', 'PRECEDING', 'FOLLOWING', 'CURRENT', 'FIRST', 'AFTER', 'LAST', 'ROW', 'WITH', 'VALUES', 'CREATE', 'TABLE', 'VIEW', 'REPLACE', 'INSERT', 'DELETE', 'INTO', 'DESCRIBE', 'EXPLAIN', 'FORMAT', 'LOGICAL', 'CODEGEN', 'CAST', 'SHOW', 'TABLES', 'COLUMNS', 'COLUMN', 'USE', 'PARTITIONS', 'FUNCTIONS', 'DROP', 'UNION', 'EXCEPT', 'MINUS', 'INTERSECT', 'TO', 'TABLESAMPLE', 'STRATIFY', 'ALTER', 'RENAME', 'ARRAY', 'MAP', 'STRUCT', 'COMMENT', 'SET', 'RESET', 'DATA', 'START', 'TRANSACTION', 'COMMIT', 'ROLLBACK', 'MACRO', 'IF', 'DIV', 'PERCENT', 'BUCKET', 'OUT', 'OF', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'OVERWRITE', 'TRANSFORM', 'REDUCE', 'USING', 'SERDE', 'SERDEPROPERTIES', 'RECORDREADER', 'RECORDWRITER', 'DELIMITED', 'FIELDS', 'TERMINATED', 'COLLECTION', 'ITEMS', 'KEYS', 'ESCAPED', 'LINES', 'SEPARATED', 'FUNCTION', 'EXTENDED', 'REFRESH', 'CLEAR', 'CACHE', 'UNCACHE', 'LAZY', 'FORMATTED', 'GLOBAL', TEMPORARY, 'OPTIONS', 'UNSET', 'TBLPROPERTIES', 'DBPROPERTIES', 'BUCKETS', 'SKEWED', 'STORED', 'DIRECTORIES', 'LOCATION', 'EXCHANGE', 'ARCHIVE', 'UNARCHIVE', 'FILEFORMAT', 'TOUCH', 'COMPACT', 'CONCATENATE', 'CHANGE', 'CASCADE', 'RESTRICT', 'CLUSTERED', 'SORTED', 'PURGE', 'INPUTFORMAT', 'OUTPUTFORMAT', DATABASE, DATABASES, 'DFS', 'TRUNCATE', 'ANALYZE', 'COMPUTE', 'LIST', 'STATISTICS', 'PARTITIONED', 'EXTERNAL', 'DEFINED', 'REVOKE', 'GRANT', 'LOCK', 'UNLOCK', 'MSCK', 'REPAIR', 'RECOVER', 'EXPORT', 'IMPORT', 'LOAD', 'ROLE', 'ROLES', 'COMPACTIONS', 'PRINCIPALS', 'TRANSACTIONS', 'INDEX', 'INDEXES', 'LOCKS', 'OPTION', 'ANTI', 'LOCAL', 'INPATH', 'CURRENT_DATE', 'CURRENT_TIMESTAMP', IDENTIFIER, BACKQUOTED_IDENTIFIER}(line 5, pos 0)\n\n== SQL ==\nCREATE EXTERNAL TABLE hive_flights_2\nROW FORMAT DELIMITED FIELDS TERMINATED BY ','\nLOCATION '/mnt/defg/flight-data-hive/'\nAS SELECT * FROM flights\n%sql\n^^^\nSELECT * FROM hive_flights\n","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.catalyst.parser.ParseException: \nextraneous input '%' expecting {<EOF>, ',', 'SELECT', 'FROM', 'ADD', 'AS', 'ALL', 'DISTINCT', 'WHERE', 'GROUP', 'BY', 'GROUPING', 'SETS', 'CUBE', 'ROLLUP', 'ORDER', 'HAVING', 'LIMIT', 'AT', 'OR', 'AND', 'IN', NOT, 'NO', 'EXISTS', 'BETWEEN', 'LIKE', RLIKE, 'IS', 'NULL', 'TRUE', 'FALSE', 'NULLS', 'ASC', 'DESC', 'FOR', 'INTERVAL', 'CASE', 'WHEN', 'THEN', 'ELSE', 'END', 'JOIN', 'CROSS', 'OUTER', 'INNER', 'LEFT', 'RIGHT', 'FULL', 'NATURAL', 'LATERAL', 'WINDOW', 'OVER', 'PARTITION', 'RANGE', 'ROWS', 'UNBOUNDED', 'PRECEDING', 'FOLLOWING', 'CURRENT', 'FIRST', 'AFTER', 'LAST', 'ROW', 'WITH', 'VALUES', 'CREATE', 'TABLE', 'VIEW', 'REPLACE', 'INSERT', 'DELETE', 'INTO', 'DESCRIBE', 'EXPLAIN', 'FORMAT', 'LOGICAL', 'CODEGEN', 'CAST', 'SHOW', 'TABLES', 'COLUMNS', 'COLUMN', 'USE', 'PARTITIONS', 'FUNCTIONS', 'DROP', 'UNION', 'EXCEPT', 'MINUS', 'INTERSECT', 'TO', 'TABLESAMPLE', 'STRATIFY', 'ALTER', 'RENAME', 'ARRAY', 'MAP', 'STRUCT', 'COMMENT', 'SET', 'RESET', 'DATA', 'START', 'TRANSACTION', 'COMMIT', 'ROLLBACK', 'MACRO', 'IF', 'DIV', 'PERCENT', 'BUCKET', 'OUT', 'OF', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'OVERWRITE', 'TRANSFORM', 'REDUCE', 'USING', 'SERDE', 'SERDEPROPERTIES', 'RECORDREADER', 'RECORDWRITER', 'DELIMITED', 'FIELDS', 'TERMINATED', 'COLLECTION', 'ITEMS', 'KEYS', 'ESCAPED', 'LINES', 'SEPARATED', 'FUNCTION', 'EXTENDED', 'REFRESH', 'CLEAR', 'CACHE', 'UNCACHE', 'LAZY', 'FORMATTED', 'GLOBAL', TEMPORARY, 'OPTIONS', 'UNSET', 'TBLPROPERTIES', 'DBPROPERTIES', 'BUCKETS', 'SKEWED', 'STORED', 'DIRECTORIES', 'LOCATION', 'EXCHANGE', 'ARCHIVE', 'UNARCHIVE', 'FILEFORMAT', 'TOUCH', 'COMPACT', 'CONCATENATE', 'CHANGE', 'CASCADE', 'RESTRICT', 'CLUSTERED', 'SORTED', 'PURGE', 'INPUTFORMAT', 'OUTPUTFORMAT', DATABASE, DATABASES, 'DFS', 'TRUNCATE', 'ANALYZE', 'COMPUTE', 'LIST', 'STATISTICS', 'PARTITIONED', 'EXTERNAL', 'DEFINED', 'REVOKE', 'GRANT', 'LOCK', 'UNLOCK', 'MSCK', 'REPAIR', 'RECOVER', 'EXPORT', 'IMPORT', 'LOAD', 'ROLE', 'ROLES', 'COMPACTIONS', 'PRINCIPALS', 'TRANSACTIONS', 'INDEX', 'INDEXES', 'LOCKS', 'OPTION', 'ANTI', 'LOCAL', 'INPATH', 'CURRENT_DATE', 'CURRENT_TIMESTAMP', IDENTIFIER, BACKQUOTED_IDENTIFIER}(line 5, pos 0)\n\n== SQL ==\nCREATE EXTERNAL TABLE hive_flights_2\nROW FORMAT DELIMITED FIELDS TERMINATED BY ','\nLOCATION '/mnt/defg/flight-data-hive/'\nAS SELECT * FROM flights\n%sql\n^^^\nSELECT * FROM hive_flights\n\n\tat org.apache.spark.sql.catalyst.parser.ParseException.withCommand(ParseDriver.scala:196)\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parse(ParseDriver.scala:98)\n\tat org.apache.spark.sql.execution.SparkSqlParser.parse(SparkSqlParser.scala:45)\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parsePlan(ParseDriver.scala:52)\n\tat com.databricks.sql.parser.DatabricksSqlParser$$anonfun$parsePlan$1.apply(DatabricksSqlParser.scala:50)\n\tat com.databricks.sql.parser.DatabricksSqlParser$$anonfun$parsePlan$1.apply(DatabricksSqlParser.scala:47)\n\tat com.databricks.sql.parser.DatabricksSqlParser.parse(DatabricksSqlParser.scala:69)\n\tat com.databricks.sql.parser.DatabricksSqlParser.parsePlan(DatabricksSqlParser.scala:47)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:599)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:698)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:230)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:211)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:211)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:230)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:211)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:211)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1497645504400,"submitTime":1497645504380,"finishTime":1497645507296,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"02c5fbd2-8f10-41b8-bfb4-8d2c43f8030c"},{"version":"CommandV1","origId":2060825016293627,"guid":"f74bf332-d70d-419b-82c0-c4f61302eb04","subtype":"command","commandType":"auto","position":58.0,"command":"%sql\nSELECT * FROM hive_flights","commandVersion":0,"state":"finished","results":{"type":"table","data":[[null,null,15],[null,null,1],[null,null,344],[null,null,15],[null,null,62],[null,null,1],[null,null,62],[null,null,588],[null,null,40],[null,null,1],[null,null,325],[null,null,39],[null,null,64],[null,null,1],[null,null,41],[null,null,30],[null,null,6],[null,null,4],[null,null,230],[null,null,1],[null,null,1],[null,null,382],[null,null,69],[null,null,161],[null,null,12],[null,null,660],[null,null,181],[null,null,42],[null,null,155],[null,null,362],[null,null,955],[null,null,42],[null,null,561],[null,null,25],[null,null,13],[null,null,294],[null,null,38],[null,null,325],[null,null,332],[null,null,211],[null,null,19],[null,null,300],[null,null,1],[null,null,7140],[null,null,1],[null,null,268],[null,null,134],[null,null,608],[null,null,318],[null,null,34],[null,null,873],[null,null,14],[null,null,712],[null,null,121],[null,null,3],[null,null,19],[null,null,3],[null,null,25],[null,null,290],[null,null,31],[null,null,246],[null,null,510],[null,null,126],[null,null,185],[null,null,15],[null,null,28],[null,null,21],[null,null,23],[null,null,986],[null,null,111],[null,null,2],[null,null,414],[null,null,2],[null,null,920],[null,null,2],[null,null,1],[null,null,118],[null,null,28],[null,null,1420],[null,null,12],[null,null,134],[null,null,370002],[null,null,13],[null,null,134],[null,null,33],[null,null,44],[null,null,41],[null,null,39],[null,null,154],[null,null,129],[null,null,1],[null,null,21],[null,null,1],[null,null,1468],[null,null,827],[null,null,508],[null,null,335],[null,null,3],[null,null,1],[null,null,2],[null,null,12],[null,null,465],[null,null,342],[null,null,4],[null,null,236],[null,null,2],[null,null,12],[null,null,1],[null,null,407],[null,null,24],[null,null,108],[null,null,139],[null,null,32],[null,null,266],[null,null,226],[null,null,8399],[null,null,69],[null,null,2],[null,null,666],[null,null,2],[null,null,1353],[null,null,1548],[null,null,1],[null,null,26],[null,null,59],[null,null,13],[null,null,952],[null,null,115],[null,null,346],[null,null,5],[null,null,35],[null,null,61],[null,null,107],[null,null,853],[null,null,1336],[null,null,74],[null,null,43],[null,null,320],[null,null,3],[null,null,7187],[null,null,119],[null,null,776],[null,null,43],[null,null,313],[null,null,1],[null,null,153],[null,null,772],[null,null,201],[null,null,126],[null,null,1],[null,null,228],[null,null,314],[null,null,180],[null,null,279],[null,null,36],[null,null,202],[null,null,141],[null,null,420],[null,null,183],[null,null,50],[null,null,63],[null,null,59],[null,null,26],[null,null,83],[null,null,13],[null,null,127],[null,null,259],[null,null,136],[null,null,1],[null,null,80],[null,null,90],[null,null,2],[null,null,152],[null,null,63],[null,null,134],[null,null,53],[null,null,20],[null,null,1],[null,null,14],[null,null,1],[null,null,176],[null,null,70],[null,null,397],[null,null,123],[null,null,60],[null,null,83],[null,null,1],[null,null,235],[null,null,3],[null,null,40],[null,null,2],[null,null,138],[null,null,2025],[null,null,14],[null,null,4],[null,null,3],[null,null,442],[null,null,1],[null,null,438],[null,null,466],[null,null,305],[null,null,20],[null,null,1496],[null,null,127],[null,null,619],[null,null,19],[null,null,337],[null,null,1],[null,null,193],[null,null,1970],[null,null,188],[null,null,20],[null,null,2],[null,null,25],[null,null,8483],[null,null,117],[null,null,40],[null,null,179],[null,null,15],[null,null,27],[null,null,12],[null,null,258],[null,null,13],[null,null,62],[null,null,44],[null,null,30],[null,null,1048],[null,null,15],[null,null,18],[null,null,1],[null,null,56],[null,null,935],[null,null,32],[null,null,59],[null,null,13],[null,null,2],[null,null,193],[null,null,174],[null,null,478],[null,null,1],[null,null,867],[null,null,130],[null,null,109],[null,null,329],[null,null,310],[null,null,44],[null,null,1],[null,null,217],[null,null,13],[null,null,13],[null,null,3],[null,null,145],[null,null,43],[null,null,225],[null,null,58],[null,null,30]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"ORIGIN_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645509208,"submitTime":1497645509191,"finishTime":1497645509482,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a76b3ba4-6ad4-4346-bdb5-b768e82cd387"},{"version":"CommandV1","origId":2060825016293628,"guid":"6ddaf77d-b6de-4f1a-8c1c-1372113c3b0f","subtype":"command","commandType":"auto","position":59.0,"command":"%sql\nSELECT dest_country_name\nFROM flights\nGROUP BY dest_country_name\nORDER BY sum(count) DESC\nLIMIT 5","commandVersion":0,"state":"finished","results":{"type":"table","data":[[null]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"dest_country_name","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645519485,"submitTime":1497645519470,"finishTime":1497645519984,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7c927415-c437-4a73-8265-26b0375eae26"},{"version":"CommandV1","origId":2060825016293629,"guid":"889dd261-fc00-475f-89e3-b92ed52972be","subtype":"command","commandType":"auto","position":60.0,"command":"%sql\nSELECT *\nFROM flights\nWHERE\norigin_country_name IN (\nSELECT dest_country_name\nFROM flights\nGROUP BY dest_country_name\nORDER BY sum(count) DESC\nLIMIT 5)","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"ORIGIN_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645527142,"submitTime":1497645527127,"finishTime":1497645529881,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4cf2752e-40c4-426a-9329-dade7f15ced9"},{"version":"CommandV1","origId":2060825016293630,"guid":"be365124-1cd8-452a-9a2e-fd61c99e39f2","subtype":"command","commandType":"auto","position":61.0,"command":"%sql\nSELECT *\nFROM flights f1\nWHERE EXISTS (\nSELECT 1\nFROM flights f2\nWHERE f1.dest_country_name = f2.origin_country_name)\nAND EXISTS (\nSELECT 1\nFROM flights f2\nWHERE f2.dest_country_name = f1.origin_country_name)","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"ORIGIN_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645536817,"submitTime":1497645536677,"finishTime":1497645537156,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"22b2e529-c15c-4ecb-b754-7f7d1a6b58af"},{"version":"CommandV1","origId":2060825016293631,"guid":"788fa2f9-94e6-4f37-9d14-680d34d8a869","subtype":"command","commandType":"auto","position":62.0,"command":"%sql\nSELECT *,\n(SELECT max(count) FROM flights) AS maximum\nFROM flights","commandVersion":0,"state":"finished","results":{"type":"table","data":[[null,null,15,370002],[null,null,1,370002],[null,null,344,370002],[null,null,15,370002],[null,null,62,370002],[null,null,1,370002],[null,null,62,370002],[null,null,588,370002],[null,null,40,370002],[null,null,1,370002],[null,null,325,370002],[null,null,39,370002],[null,null,64,370002],[null,null,1,370002],[null,null,41,370002],[null,null,30,370002],[null,null,6,370002],[null,null,4,370002],[null,null,230,370002],[null,null,1,370002],[null,null,1,370002],[null,null,382,370002],[null,null,69,370002],[null,null,161,370002],[null,null,12,370002],[null,null,660,370002],[null,null,181,370002],[null,null,42,370002],[null,null,155,370002],[null,null,362,370002],[null,null,955,370002],[null,null,42,370002],[null,null,561,370002],[null,null,25,370002],[null,null,13,370002],[null,null,294,370002],[null,null,38,370002],[null,null,325,370002],[null,null,332,370002],[null,null,211,370002],[null,null,19,370002],[null,null,300,370002],[null,null,1,370002],[null,null,7140,370002],[null,null,1,370002],[null,null,268,370002],[null,null,134,370002],[null,null,608,370002],[null,null,318,370002],[null,null,34,370002],[null,null,873,370002],[null,null,14,370002],[null,null,712,370002],[null,null,121,370002],[null,null,3,370002],[null,null,19,370002],[null,null,3,370002],[null,null,25,370002],[null,null,290,370002],[null,null,31,370002],[null,null,246,370002],[null,null,510,370002],[null,null,126,370002],[null,null,185,370002],[null,null,15,370002],[null,null,28,370002],[null,null,21,370002],[null,null,23,370002],[null,null,986,370002],[null,null,111,370002],[null,null,2,370002],[null,null,414,370002],[null,null,2,370002],[null,null,920,370002],[null,null,2,370002],[null,null,1,370002],[null,null,118,370002],[null,null,28,370002],[null,null,1420,370002],[null,null,12,370002],[null,null,134,370002],[null,null,370002,370002],[null,null,13,370002],[null,null,134,370002],[null,null,33,370002],[null,null,44,370002],[null,null,41,370002],[null,null,39,370002],[null,null,154,370002],[null,null,129,370002],[null,null,1,370002],[null,null,21,370002],[null,null,1,370002],[null,null,1468,370002],[null,null,827,370002],[null,null,508,370002],[null,null,335,370002],[null,null,3,370002],[null,null,1,370002],[null,null,2,370002],[null,null,12,370002],[null,null,465,370002],[null,null,342,370002],[null,null,4,370002],[null,null,236,370002],[null,null,2,370002],[null,null,12,370002],[null,null,1,370002],[null,null,407,370002],[null,null,24,370002],[null,null,108,370002],[null,null,139,370002],[null,null,32,370002],[null,null,266,370002],[null,null,226,370002],[null,null,8399,370002],[null,null,69,370002],[null,null,2,370002],[null,null,666,370002],[null,null,2,370002],[null,null,1353,370002],[null,null,1548,370002],[null,null,1,370002],[null,null,26,370002],[null,null,59,370002],[null,null,13,370002],[null,null,952,370002],[null,null,115,370002],[null,null,346,370002],[null,null,5,370002],[null,null,35,370002],[null,null,61,370002],[null,null,107,370002],[null,null,853,370002],[null,null,1336,370002],[null,null,74,370002],[null,null,43,370002],[null,null,320,370002],[null,null,3,370002],[null,null,7187,370002],[null,null,119,370002],[null,null,776,370002],[null,null,43,370002],[null,null,313,370002],[null,null,1,370002],[null,null,153,370002],[null,null,772,370002],[null,null,201,370002],[null,null,126,370002],[null,null,1,370002],[null,null,228,370002],[null,null,314,370002],[null,null,180,370002],[null,null,279,370002],[null,null,36,370002],[null,null,202,370002],[null,null,141,370002],[null,null,420,370002],[null,null,183,370002],[null,null,50,370002],[null,null,63,370002],[null,null,59,370002],[null,null,26,370002],[null,null,83,370002],[null,null,13,370002],[null,null,127,370002],[null,null,259,370002],[null,null,136,370002],[null,null,1,370002],[null,null,80,370002],[null,null,90,370002],[null,null,2,370002],[null,null,152,370002],[null,null,63,370002],[null,null,134,370002],[null,null,53,370002],[null,null,20,370002],[null,null,1,370002],[null,null,14,370002],[null,null,1,370002],[null,null,176,370002],[null,null,70,370002],[null,null,397,370002],[null,null,123,370002],[null,null,60,370002],[null,null,83,370002],[null,null,1,370002],[null,null,235,370002],[null,null,3,370002],[null,null,40,370002],[null,null,2,370002],[null,null,138,370002],[null,null,2025,370002],[null,null,14,370002],[null,null,4,370002],[null,null,3,370002],[null,null,442,370002],[null,null,1,370002],[null,null,438,370002],[null,null,466,370002],[null,null,305,370002],[null,null,20,370002],[null,null,1496,370002],[null,null,127,370002],[null,null,619,370002],[null,null,19,370002],[null,null,337,370002],[null,null,1,370002],[null,null,193,370002],[null,null,1970,370002],[null,null,188,370002],[null,null,20,370002],[null,null,2,370002],[null,null,25,370002],[null,null,8483,370002],[null,null,117,370002],[null,null,40,370002],[null,null,179,370002],[null,null,15,370002],[null,null,27,370002],[null,null,12,370002],[null,null,258,370002],[null,null,13,370002],[null,null,62,370002],[null,null,44,370002],[null,null,30,370002],[null,null,1048,370002],[null,null,15,370002],[null,null,18,370002],[null,null,1,370002],[null,null,56,370002],[null,null,935,370002],[null,null,32,370002],[null,null,59,370002],[null,null,13,370002],[null,null,2,370002],[null,null,193,370002],[null,null,174,370002],[null,null,478,370002],[null,null,1,370002],[null,null,867,370002],[null,null,130,370002],[null,null,109,370002],[null,null,329,370002],[null,null,310,370002],[null,null,44,370002],[null,null,1,370002],[null,null,217,370002],[null,null,13,370002],[null,null,13,370002],[null,null,3,370002],[null,null,145,370002],[null,null,43,370002],[null,null,225,370002],[null,null,58,370002],[null,null,30,370002]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"ORIGIN_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"},{"name":"maximum","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497645544902,"submitTime":1497645544888,"finishTime":1497645545186,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c1cfa072-0d33-42e0-8913-70565e8239ef"}],"dashboards":[],"guid":"cbb84dd1-5429-49ea-86d6-8ede524a5f78","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
