<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Definitive Draft Chapter 12-13 - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"serverlessDefaultSparkVersion":"2.2.x-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","enableTableHandler":false,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"3.0 beta (Scala 2.11)","packageLabel":"spark-image-20adedc466bac7d0c91242baba4ae70dc8487d6e301359af185601969607d211","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-f43ddf8ad9acfd71338f5a51345f077173d236016ad7e39ffd6f698403acd4ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"3.0 beta (Scala 2.10)","packageLabel":"spark-image-a1d408c36c3e2c79b38783b57b626c7c6847c9639fa15dd22eca009c23b89c6f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":6,"class-node":1,"m4.2xlarge":0.5,"r4.xlarge":1,"m4.4xlarge":0.5,"r4.16xlarge":8,"Standard_DS11":0.5,"p2.8xlarge":16,"m4.10xlarge":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.5,"r4.8xlarge":8,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.5,"p2.16xlarge":24,"i3.8xlarge":12,"i3.16xlarge":24,"Standard_DS12_v2":1,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"i3.2xlarge":3,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":0.5,"c4.8xlarge":4,"i3.xlarge":1.5,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.47","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableNonPollingTableCall":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":180,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"enableElasticDisk":false,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"ea633ce26684806264e7bd2cbb05130eb0f98c4d","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewJobList":false,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"enableEBSVolumesUIByTier":false,"singleSignOnComingSoon":false,"enableNewJobClusterEdit":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2060825016293679,"name":"Definitive Draft Chapter 12-13","language":"python","commands":[{"version":"CommandV1","origId":2060825016293681,"guid":"c687e4ac-73b7-4028-b11b-88adaf017571","subtype":"command","commandType":"auto","position":1.0,"command":"%scala\nval myCollection = \"Spark The Definitive Guide : Big Data Processing Made Simple\".split(\" \")\nval words = spark.sparkContext.parallelize(myCollection, 2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">myCollection: Array[String] = Array(Spark, The, Definitive, Guide, :, Big, Data, Processing, Made, Simple)\nwords: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[2161] at parallelize at &lt;console&gt;:36\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646353580,"submitTime":1497646353579,"finishTime":1497646354879,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5b7f8343-774c-48c3-9a74-1c540bedf408"},{"version":"CommandV1","origId":2060825016293682,"guid":"130b9829-5cbc-4c29-a6c7-1aca6d892cf7","subtype":"command","commandType":"auto","position":2.0,"command":"%scala\nwords.mapPartitions(part => Iterator[Int](1)).sum()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res0: Double = 2.0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-1-49d91dac8fe9&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    words.mapPartitions(part =&gt; Iterator[Int](1)).sum()</span>\n<span class=\"ansigrey\">                              ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1497646373791,"submitTime":1497646373790,"finishTime":1497646374039,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"af738e1d-f6e1-4c81-8559-5082c1e2734d"},{"version":"CommandV1","origId":2060825016293683,"guid":"fc380eb0-e058-4625-9e5e-d2161520f949","subtype":"command","commandType":"auto","position":3.0,"command":"%scala\ndef indexedFunc(partitionIndex:Int, withinPartIterator: Iterator[String]) = {\nwithinPartIterator.toList.map(value => s\"Partition: $partitionIndex => $value\").iterator\n}\nwords.mapPartitionsWithIndex(indexedFunc).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">indexedFunc: (partitionIndex: Int, withinPartIterator: Iterator[String])Iterator[String]\nres1: Array[String] = Array(Partition: 0 =&gt; Spark, Partition: 0 =&gt; The, Partition: 0 =&gt; Definitive, Partition: 0 =&gt; Guide, Partition: 0 =&gt; :, Partition: 1 =&gt; Big, Partition: 1 =&gt; Data, Partition: 1 =&gt; Processing, Partition: 1 =&gt; Made, Partition: 1 =&gt; Simple)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646383128,"submitTime":1497646383130,"finishTime":1497646383433,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"37efb116-a6a2-4ea6-b50b-3632456bc4c9"},{"version":"CommandV1","origId":2060825016293684,"guid":"c349f900-351c-4136-9cbe-0617d39db34c","subtype":"command","commandType":"auto","position":4.0,"command":"%scala\nwords.foreachPartition { iter =>\nimport java.io._\nimport scala.util.Random\nval randomFileName = new Random().nextInt()\nval pw = new PrintWriter(new File(s\"/tmp/random-file-${randomFileName}.txt\"))\nwhile (iter.hasNext) {\npw.write(iter.next())\n}\npw.close()\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646393491,"submitTime":1497646393491,"finishTime":1497646393634,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"89b44a00-adae-4303-aeca-970161f181ad"},{"version":"CommandV1","origId":2060825016293685,"guid":"71af6b6e-40d3-403e-8226-9030ac6a5d59","subtype":"command","commandType":"auto","position":5.0,"command":"%scala\nsc.parallelize(Seq(\"Hello\", \"World\"), 2).glom().collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res3: Array[Array[String]] = Array(Array(Hello), Array(World))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646401960,"submitTime":1497646401960,"finishTime":1497646402067,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"88db938d-eb36-42c5-ab1b-4221a68e3b29"},{"version":"CommandV1","origId":2060825016293686,"guid":"8169e6a9-f372-4d73-9327-3c8c22b11df4","subtype":"command","commandType":"auto","position":6.0,"command":"%scala\nwords\n.map(word => (word.toLowerCase, 1))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res4: org.apache.spark.rdd.RDD[(String, Int)] = MapPartitionsRDD[2167] at map at &lt;console&gt;:42\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646410568,"submitTime":1497646410567,"finishTime":1497646410711,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a7078a11-9de5-4f71-9710-adef2c85de03"},{"version":"CommandV1","origId":2060825016293687,"guid":"52e718b9-f7b5-4182-b2b7-00c3843d63dd","subtype":"command","commandType":"auto","position":7.0,"command":"%scala\nwords\n.keyBy(word => word.toLowerCase.toSeq(0))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res6: org.apache.spark.rdd.RDD[(Char, String)] = MapPartitionsRDD[2168] at keyBy at &lt;console&gt;:42\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:42: error: value ? is not a member of org.apache.spark.rdd.RDD[(Char, String)]\n              .keyBy(word =&gt; word.toLowerCase.toSeq(0))?\n                                                       ^\n</div>","error":null,"workflows":[],"startTime":1497646421855,"submitTime":1497646421854,"finishTime":1497646421960,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"32b85be5-7a22-42d0-9210-589f15d31798"},{"version":"CommandV1","origId":2060825016293688,"guid":"ce056ff0-00e9-4020-8783-f527a1925f89","subtype":"command","commandType":"auto","position":8.0,"command":"%scala\nwords\n.map(word => (word.toLowerCase.toSeq(0), word))\n.mapValues(word => word.toUpperCase)\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res7: Array[(Char, String)] = Array((s,SPARK), (t,THE), (d,DEFINITIVE), (g,GUIDE), (:,:), (b,BIG), (d,DATA), (p,PROCESSING), (m,MADE), (s,SIMPLE))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646430695,"submitTime":1497646430697,"finishTime":1497646430873,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c0936278-e493-4275-bb79-24135ef74306"},{"version":"CommandV1","origId":2060825016293689,"guid":"a959cc02-7849-4e6e-a8c9-a10a3e910b75","subtype":"command","commandType":"auto","position":9.0,"command":"%scala\nwords\n.map(word => (word.toLowerCase.toSeq(0), word))\n.flatMapValues(word => word.toUpperCase)\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res8: Array[(Char, Char)] = Array((s,S), (s,P), (s,A), (s,R), (s,K), (t,T), (t,H), (t,E), (d,D), (d,E), (d,F), (d,I), (d,N), (d,I), (d,T), (d,I), (d,V), (d,E), (g,G), (g,U), (g,I), (g,D), (g,E), (:,:), (b,B), (b,I), (b,G), (d,D), (d,A), (d,T), (d,A), (p,P), (p,R), (p,O), (p,C), (p,E), (p,S), (p,S), (p,I), (p,N), (p,G), (m,M), (m,A), (m,D), (m,E), (s,S), (s,I), (s,M), (s,P), (s,L), (s,E))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646439670,"submitTime":1497646439670,"finishTime":1497646439853,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"756f3411-87b5-43b3-87c2-48a6a3a7bd27"},{"version":"CommandV1","origId":2060825016293690,"guid":"c7399111-2946-4f47-b7ee-75c0190f6125","subtype":"command","commandType":"auto","position":10.0,"command":"%scala\nwords\n.map(word => (word.toLowerCase.toSeq(0), word))\n.keys\n.collect()\nwords\n.map(word => (word.toLowerCase.toSeq(0), word))\n.values\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res9: Array[String] = Array(Spark, The, Definitive, Guide, :, Big, Data, Processing, Made, Simple)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646458906,"submitTime":1497646458905,"finishTime":1497646459060,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e40880d8-54cc-42db-b9e8-e43b4bc86603"},{"version":"CommandV1","origId":2060825016293691,"guid":"e30011fa-aa81-4866-9ad1-f37038f69b12","subtype":"command","commandType":"auto","position":11.0,"command":"%scala\nwords\n.map(word => (word.toLowerCase, 1))\n.lookup(\"spark\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res10: Seq[Int] = WrappedArray(1)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646473434,"submitTime":1497646473433,"finishTime":1497646473560,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d3dfe5f4-df64-444e-9a87-9679776427e8"},{"version":"CommandV1","origId":2060825016293692,"guid":"248afcc8-486e-4dee-8b11-529b6f7cb603","subtype":"command","commandType":"auto","position":12.0,"command":"%scala\nval chars = words\n.flatMap(word => word.toLowerCase.toSeq)\nval KVcharacters = chars\n.map(letter => (letter, 1))\ndef maxFunc(left:Int, right:Int) = math.max(left, right)\ndef addFunc(left:Int, right:Int) = left + right\nval nums = sc.parallelize(1 to 30, 5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">chars: org.apache.spark.rdd.RDD[Char] = MapPartitionsRDD[2180] at flatMap at &lt;console&gt;:42\nKVcharacters: org.apache.spark.rdd.RDD[(Char, Int)] = MapPartitionsRDD[2181] at map at &lt;console&gt;:44\nmaxFunc: (left: Int, right: Int)Int\naddFunc: (left: Int, right: Int)Int\nnums: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[2182] at parallelize at &lt;console&gt;:47\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646486475,"submitTime":1497646486474,"finishTime":1497646486642,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"62fb6cc5-03c9-48eb-8bd8-392efd1fc5ae"},{"version":"CommandV1","origId":2060825016293693,"guid":"9e12ce91-48b4-495a-8479-65e136076144","subtype":"command","commandType":"auto","position":13.0,"command":"%scala\nKVcharacters.countByKey()\nval timeout = 1000L //milliseconds\nval confidence = 0.95\nKVcharacters.countByKeyApprox(timeout, confidence)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">timeout: Long = 1000\nconfidence: Double = 0.95\nres11: org.apache.spark.partial.PartialResult[scala.collection.Map[Char,org.apache.spark.partial.BoundedDouble]] = (final: Map(e -&gt; [7.000, 7.000], s -&gt; [4.000, 4.000], n -&gt; [2.000, 2.000], t -&gt; [3.000, 3.000], u -&gt; [1.000, 1.000], f -&gt; [1.000, 1.000], a -&gt; [4.000, 4.000], m -&gt; [2.000, 2.000], i -&gt; [7.000, 7.000], v -&gt; [1.000, 1.000], b -&gt; [1.000, 1.000], g -&gt; [3.000, 3.000], l -&gt; [1.000, 1.000], p -&gt; [3.000, 3.000], c -&gt; [1.000, 1.000], h -&gt; [1.000, 1.000], r -&gt; [2.000, 2.000], : -&gt; [1.000, 1.000], k -&gt; [1.000, 1.000], o -&gt; [1.000, 1.000], d -&gt; [4.000, 4.000]))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646507026,"submitTime":1497646507022,"finishTime":1497646507205,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5aa46df5-1ec5-4d67-85c0-7138ae197d12"},{"version":"CommandV1","origId":2060825016293694,"guid":"8c9c4af5-e542-4eb3-9baa-788ee994bd45","subtype":"command","commandType":"auto","position":14.0,"command":"%scala\nKVcharacters\n.groupByKey()\n.map(row => (row._1, row._2.reduce(addFunc)))\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res12: Array[(Char, Int)] = Array((d,4), (p,3), (t,3), (b,1), (h,1), (n,2), (f,1), (v,1), (:,1), (r,2), (l,1), (s,4), (e,7), (a,4), (k,1), (i,7), (u,1), (o,1), (g,3), (m,2), (c,1))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646516538,"submitTime":1497646516540,"finishTime":1497646516726,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8cec3d4a-a7dc-48b7-bb4d-47c047d02769"},{"version":"CommandV1","origId":2060825016293695,"guid":"599d4382-e557-4f32-a230-86fde7424d3f","subtype":"command","commandType":"auto","position":15.0,"command":"%scala\nKVcharacters.reduceByKey(addFunc).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res13: Array[(Char, Int)] = Array((d,4), (p,3), (t,3), (b,1), (h,1), (n,2), (f,1), (v,1), (:,1), (r,2), (l,1), (s,4), (e,7), (a,4), (i,7), (k,1), (u,1), (o,1), (g,3), (m,2), (c,1))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646525252,"submitTime":1497646525251,"finishTime":1497646525394,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"462454ff-5de7-4b12-8883-a29793080464"},{"version":"CommandV1","origId":2060825016293696,"guid":"846b1427-eb89-4786-b81a-d8d068537604","subtype":"command","commandType":"auto","position":16.0,"command":"%scala\nnums.aggregate(0)(maxFunc, addFunc)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res15: Int = 90\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646541109,"submitTime":1497646541107,"finishTime":1497646541273,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1bfc7a6e-ce22-48f9-8d17-11a422b956a5"},{"version":"CommandV1","origId":2060825016293697,"guid":"19192538-4cbd-41e4-8040-3ea02c0b7c34","subtype":"command","commandType":"auto","position":17.0,"command":"%scala\nnums.treeAggregate(0)(maxFunc, addFunc)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res16: Int = 90\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646554391,"submitTime":1497646554394,"finishTime":1497646554509,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"603721ea-77ea-4025-b61b-6c576e4a3a14"},{"version":"CommandV1","origId":2060825016293698,"guid":"9ae62ada-7f93-484d-b8c0-3fdd618b1a8f","subtype":"command","commandType":"auto","position":18.0,"command":"%scala\nKVcharacters.aggregateByKey(0)(addFunc, maxFunc).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res17: Array[(Char, Int)] = Array((d,2), (p,2), (t,2), (b,1), (h,1), (n,1), (f,1), (v,1), (:,1), (r,1), (l,1), (s,3), (e,4), (a,3), (i,4), (k,1), (u,1), (o,1), (g,2), (m,2), (c,1))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646562417,"submitTime":1497646562415,"finishTime":1497646562584,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8e801d95-3c26-4ac7-8aa1-43ae68c2f4a0"},{"version":"CommandV1","origId":2060825016293699,"guid":"3aaeede2-5b76-48ec-ac4d-4565a9b4c880","subtype":"command","commandType":"auto","position":19.0,"command":"%scala\nval valToCombiner = (value:Int) => List(value)\nval mergeValuesFunc = (vals:List[Int], valToAppend:Int) => valToAppend :: vals\nval mergeCombinerFunc = (vals1:List[Int], vals2:List[Int]) => vals1 ::: vals2\n// not we define these as function variables\nval outputPartitions = 6\nKVcharacters\n.combineByKey(\nvalToCombiner,\nmergeValuesFunc,\nmergeCombinerFunc,\noutputPartitions)\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">valToCombiner: Int =&gt; List[Int] = &lt;function1&gt;\nmergeValuesFunc: (List[Int], Int) =&gt; List[Int] = &lt;function2&gt;\nmergeCombinerFunc: (List[Int], List[Int]) =&gt; List[Int] = &lt;function2&gt;\noutputPartitions: Int = 6\nres18: Array[(Char, List[Int])] = Array((f,List(1)), (r,List(1, 1)), (l,List(1)), (s,List(1, 1, 1, 1)), (a,List(1, 1, 1, 1)), (g,List(1, 1, 1)), (m,List(1, 1)), (t,List(1, 1, 1)), (b,List(1)), (h,List(1)), (n,List(1, 1)), (i,List(1, 1, 1, 1, 1, 1, 1)), (u,List(1)), (o,List(1)), (c,List(1)), (d,List(1, 1, 1, 1)), (p,List(1, 1, 1)), (v,List(1)), (:,List(1)), (e,List(1, 1, 1, 1, 1, 1, 1)), (k,List(1)))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646571988,"submitTime":1497646571986,"finishTime":1497646572252,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"85b29f30-ff35-4d20-a9ab-ca1be5f89946"},{"version":"CommandV1","origId":2060825016293700,"guid":"83f46664-d23f-48af-a608-5fa83165e2a4","subtype":"command","commandType":"auto","position":20.0,"command":"%scala\nKVcharacters\n.foldByKey(0)(addFunc)\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res19: Array[(Char, Int)] = Array((d,4), (p,3), (t,3), (b,1), (h,1), (n,2), (f,1), (v,1), (:,1), (r,2), (l,1), (s,4), (e,7), (a,4), (i,7), (k,1), (u,1), (o,1), (g,3), (m,2), (c,1))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646580910,"submitTime":1497646580906,"finishTime":1497646581057,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a43b6371-7c4d-409c-bf55-c9f715257b87"},{"version":"CommandV1","origId":2060825016293701,"guid":"50894ed9-7436-423a-b701-5d8d57a8656a","subtype":"command","commandType":"auto","position":21.0,"command":"%scala\nval distinctChars = words\n.flatMap(word => word.toLowerCase.toSeq)\n.distinct\n.collect()\nimport scala.util.Random\nval sampleMap = distinctChars.map(c => (c, new Random().nextDouble())).toMap\nwords\n.map(word => (word.toLowerCase.toSeq(0), word))\n.sampleByKey(true, sampleMap, 6L)\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">distinctChars: Array[Char] = Array(d, p, t, b, h, n, f, v, :, r, l, s, e, a, i, k, u, o, g, m, c)\nimport scala.util.Random\nsampleMap: scala.collection.immutable.Map[Char,Double] = Map(e -&gt; 0.04233430835914542, s -&gt; 0.902518446671661, n -&gt; 0.3830309015893165, t -&gt; 0.29443136581425133, u -&gt; 0.4057120433448588, f -&gt; 0.5818761732125103, a -&gt; 0.7055997043137747, m -&gt; 0.10002726982630172, i -&gt; 0.37941148672589353, v -&gt; 0.26561742410915246, b -&gt; 0.7905477666636264, g -&gt; 0.8833796865349889, l -&gt; 0.8696704756822681, p -&gt; 0.4548332583775475, c -&gt; 0.48196955013280895, h -&gt; 0.1687157402094831, r -&gt; 0.24137718645956163, : -&gt; 0.8337932008491905, k -&gt; 0.514120052858219, o -&gt; 0.520166721940038, d -&gt; 0.5126802760530601)\nres20: Array[(Char, String)] = Array((s,Spark), (t,The), (d,Definitive), (g,Guide), (:,:))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646590202,"submitTime":1497646590200,"finishTime":1497646590549,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6804c4c1-7b28-4008-9e44-606b14c7e3e5"},{"version":"CommandV1","origId":2060825016293702,"guid":"8f2a9e32-0299-4027-82e2-28e8028f6aa3","subtype":"command","commandType":"auto","position":22.0,"command":"%scala\nwords\n.map(word => (word.toLowerCase.toSeq(0), word))\n.sampleByKeyExact(true, sampleMap, 6L)\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res21: Array[(Char, String)] = Array((s,Spark), (t,The), (d,Definitive), (d,Definitive), (g,Guide), (:,:), (b,Big), (p,Processing), (m,Made), (s,Simple))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646598083,"submitTime":1497646598081,"finishTime":1497646598284,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3eb722cb-3fc5-4f88-bf53-43b705de3e4d"},{"version":"CommandV1","origId":2060825016293703,"guid":"6c546ac8-ceb2-4b1a-9497-5567466e1fea","subtype":"command","commandType":"auto","position":23.0,"command":"%scala\nimport scala.util.Random\nval distinctChars = words\n.flatMap(word => word.toLowerCase.toSeq)\n.distinct\nval charRDD = distinctChars.map(c => (c, new Random().nextDouble()))\nval charRDD2 = distinctChars.map(c => (c, new Random().nextDouble()))\nval charRDD3 = distinctChars.map(c => (c, new Random().nextDouble()))\ncharRDD.cogroup(charRDD2, charRDD3).take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import scala.util.Random\ndistinctChars: org.apache.spark.rdd.RDD[Char] = MapPartitionsRDD[2210] at distinct at &lt;console&gt;:45\ncharRDD: org.apache.spark.rdd.RDD[(Char, Double)] = MapPartitionsRDD[2211] at map at &lt;console&gt;:46\ncharRDD2: org.apache.spark.rdd.RDD[(Char, Double)] = MapPartitionsRDD[2212] at map at &lt;console&gt;:47\ncharRDD3: org.apache.spark.rdd.RDD[(Char, Double)] = MapPartitionsRDD[2213] at map at &lt;console&gt;:48\nres22: Array[(Char, (Iterable[Double], Iterable[Double], Iterable[Double]))] = Array((d,(CompactBuffer(0.801326346126831),CompactBuffer(0.5945996749633656),CompactBuffer(0.37946185930021614))), (p,(CompactBuffer(0.0058003057648614575),CompactBuffer(0.46122493373138584),CompactBuffer(0.8663998542208671))), (t,(CompactBuffer(0.028067876813151704),CompactBuffer(0.7765730265680246),CompactBuffer(0.2900983247597869))), (b,(CompactBuffer(0.6720554604582568),CompactBuffer(0.8152946150205554),CompactBuffer(0.46725353120683644))), (h,(CompactBuffer(0.3757881376709187),CompactBuffer(0.01280586667227035),CompactBuffer(0.29850520432602956))))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646608578,"submitTime":1497646608576,"finishTime":1497646608813,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7f6c4ba0-49e2-455b-b1f5-58c1d7910b86"},{"version":"CommandV1","origId":2060825016293704,"guid":"0b0252ae-f362-493d-b545-be64f6da00bd","subtype":"command","commandType":"auto","position":24.0,"command":"%scala\nval keyedChars = sc.parallelize(distinctChars.map(c => (c, new Random().nextDouble())))\nval outputPartitions = 10\nKVcharacters.join(keyedChars).count()\nKVcharacters.join(keyedChars, outputPartitions).count()\n","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:52: error: type mismatch;\n found   : org.apache.spark.rdd.RDD[(Char, Double)]\n required: Seq[?]\nError occurred in an application involving default arguments.\n              val keyedChars = sc.parallelize(distinctChars.map(c =&gt; (c, new Random().nextDouble())))\n                                                               ^\n</div>","error":null,"workflows":[],"startTime":1497646621792,"submitTime":1497646621792,"finishTime":1497646621889,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"985e06b0-1d68-4c32-b3e8-ab84902edfd0"},{"version":"CommandV1","origId":2060825016293705,"guid":"e327db13-c81b-4b5c-8c82-1dfebfbfe903","subtype":"command","commandType":"auto","position":25.0,"command":"%scala\nval numRange = sc.parallelize(0 to 9, 2)\nwords.zip(numRange).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">numRange: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[2216] at parallelize at &lt;console&gt;:44\nres24: Array[(String, Int)] = Array((Spark,0), (The,1), (Definitive,2), (Guide,3), (:,4), (Big,5), (Data,6), (Processing,7), (Made,8), (Simple,9))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646680690,"submitTime":1497646680687,"finishTime":1497646680822,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dc72edd5-6690-44d3-b959-9140833f4e23"},{"version":"CommandV1","origId":2060825016293706,"guid":"4bf9c9dd-7e4b-4de0-9c89-23d13acccadc","subtype":"command","commandType":"auto","position":26.0,"command":"%scala\nwords.coalesce(1)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res25: org.apache.spark.rdd.RDD[String] = CoalescedRDD[2218] at coalesce at &lt;console&gt;:44\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646691783,"submitTime":1497646691781,"finishTime":1497646691863,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2944f0df-30f3-48e3-b771-b788903fc8de"},{"version":"CommandV1","origId":2060825016293707,"guid":"e636d5d2-daa1-4b26-b336-9953d1bbcac8","subtype":"command","commandType":"auto","position":27.0,"command":"%scala\nwords.repartition(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res26: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[2222] at repartition at &lt;console&gt;:44\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646700055,"submitTime":1497646700053,"finishTime":1497646700139,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c1bf50c3-8c4a-4e40-bef2-6c43e2c67bb8"},{"version":"CommandV1","origId":2060825016293708,"guid":"dc6d023c-d5c2-4877-8a4e-46d1bd729ad6","subtype":"command","commandType":"auto","position":28.0,"command":"%scala\nval df = spark.read\n.option(\"header\", \"true\")\n.option(\"inferSchema\", \"true\")\n.csv(\"dbfs:/mnt/defg/streaming/*.csv\")\nval rdd = df.coalesce(10).rdd","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Path does not exist: dbfs:/mnt/defg/streaming/*.csv;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:367)\n\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:360)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:251)\n\tat scala.collection.AbstractTraversable.flatMap(Traversable.scala:105)\n\tat org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:360)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:154)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:148)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:147)\n\tat org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:418)\n\tat org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:355)</div>","workflows":[],"startTime":1497646709287,"submitTime":1497646709287,"finishTime":1497646709570,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"44da4a69-5934-418e-bf16-2e78ebf0cd97"},{"version":"CommandV1","origId":2060825016293709,"guid":"6f7b2ee8-e470-457d-9999-171925690b3c","subtype":"command","commandType":"auto","position":29.0,"command":"%scala\nrdd.map(r => r(6)).take(5).foreach(println)\nval keyedRDD = rdd.keyBy(row => row(6).asInstanceOf[Double])\nimport org.apache.spark.{HashPartitioner}\nkeyedRDD\n.partitionBy(new HashPartitioner(10))","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:37: error: not found: value keyBy\n              val keyedRDD = keyBy(row =&gt; row(6).asInstanceOf[Double])\n                             ^\n&lt;console&gt;:36: error: not found: value map\n              map(r =&gt; r(6)).take(5).foreach(println)\n              ^\n</div>","error":null,"workflows":[],"startTime":1497646776212,"submitTime":1497646776212,"finishTime":1497646776237,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4d2689a4-91a5-4837-8b57-a77e53969a90"},{"version":"CommandV1","origId":2060825016293710,"guid":"85524cde-ffb2-43ca-805e-4927fa30bb33","subtype":"command","commandType":"auto","position":30.0,"command":"%scala\nimport org.apache.spark.{Partitioner}\nclass DomainPartitioner extends Partitioner {\ndef numPartitions = 20\ndef getPartition(key: Any): Int = {\n(key.asInstanceOf[Double] / 1000).toInt\n}\n}\nval res = keyedRDD\n.partitionBy(new DomainPartitioner)","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:43: error: not found: value keyedRDD\n       val res = keyedRDD\n                 ^\n</div>","error":null,"workflows":[],"startTime":1497646744955,"submitTime":1497646744955,"finishTime":1497646744986,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e6b3628e-7af0-48c0-9fd5-635a9921ae81"},{"version":"CommandV1","origId":2060825016293711,"guid":"56b7d5e9-ff77-43c7-b4fa-5b8122f4a7dc","subtype":"command","commandType":"auto","position":31.0,"command":"%scala\nres\n.glom()\n.collect()\n.map(arr => {\nif (arr.length > 0) {\narr.map(_._2(6)).toSet.toSeq.length\n}\n})","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:38: error: not found: value res\n              res\n              ^\n</div>","error":null,"workflows":[],"startTime":1497646802248,"submitTime":1497646802248,"finishTime":1497646802479,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2b93dfc5-4eca-4148-9b82-64a8b81f03fb"},{"version":"CommandV1","origId":2060825016293712,"guid":"1a91e8b4-1187-4343-b319-fdf85ac41116","subtype":"command","commandType":"auto","position":32.0,"command":"%scala\nkeyedRDD.repartitionAndSortWithinPartitions(new DomainPartitioner)","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:38: error: not found: value keyedRDD\n              keyedRDD.repartitionAndSortWithinPartitions(new DomainPartitioner)\n              ^\n</div>","error":null,"workflows":[],"startTime":1497646811710,"submitTime":1497646811710,"finishTime":1497646811741,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dc0a931c-fe6c-4e3a-8358-1353e8661534"},{"version":"CommandV1","origId":2060825016293713,"guid":"843aad8a-8fc1-4c38-8d04-d7e208f3f0d3","subtype":"command","commandType":"auto","position":33.0,"command":"%scala\nclass SomeClass extends Serializable {\nvar someValue = 0\ndef setSomeValue(i:Int) = {\nsomeValue = i\nthis\n}\n}\nsc.parallelize(1 to 10).map(num => new SomeClass().setSomeValue(num))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class SomeClass\nres32: org.apache.spark.rdd.RDD[SomeClass] = MapPartitionsRDD[2224] at map at &lt;console&gt;:47\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646821037,"submitTime":1497646821035,"finishTime":1497646821150,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"149b7bdc-4161-4bb7-8272-b670094767d3"},{"version":"CommandV1","origId":2060825016293714,"guid":"00b1efc7-d229-4311-9f1a-b07922ff09c5","subtype":"command","commandType":"auto","position":34.0,"command":"%scala\nval myCollection = \"Spark The Definitive Guide : Big Data Processing Made Simple\".split(\" \")\nval words = spark.sparkContext.parallelize(myCollection, 2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">myCollection: Array[String] = Array(Spark, The, Definitive, Guide, :, Big, Data, Processing, Made, Simple)\nwords: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[2225] at parallelize at &lt;console&gt;:41\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646847137,"submitTime":1497646847135,"finishTime":1497646847239,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9c659346-d20d-47fd-bcf3-4e8574d6226d"},{"version":"CommandV1","origId":2060825016293715,"guid":"b9940a5d-871e-45bb-89b9-a4fcaae629ea","subtype":"command","commandType":"auto","position":35.0,"command":"my_collection = \"Spark The Definitive Guide : Big Data Processing Made Simple\".split(\" \")\nwords = spark.sparkContext.parallelize(my_collection, 2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646858419,"submitTime":1497646858417,"finishTime":1497646858493,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dc84fdd0-aa17-4bd3-9c9b-940ce05ee9dd"},{"version":"CommandV1","origId":2060825016293716,"guid":"6bed09da-33e8-4117-8c16-f06edd69ca76","subtype":"command","commandType":"auto","position":36.0,"command":"%scala\nval supplementalData = Map(\n\"Spark\" -> 1000,\n\"Definitive\" -> 200,\n  \"Big\" -> -300,\n\"Simple\" -> 100\n)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">supplementalData: scala.collection.immutable.Map[String,Int] = Map(Spark -&gt; 1000, Definitive -&gt; 200, Big -&gt; -300, Simple -&gt; 100)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646876068,"submitTime":1497646876066,"finishTime":1497646876179,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b3c15c3f-39b2-46db-8b5b-a03038cfa785"},{"version":"CommandV1","origId":2060825016293717,"guid":"001d8dd3-2a68-4700-9bb5-15a6e8d32c2b","subtype":"command","commandType":"auto","position":37.0,"command":"%scala\nval suppBroadcast = spark.sparkContext.broadcast(supplementalData)\nsuppBroadcast.value\nval suppWords = words.map(word => (word, suppBroadcast.value.getOrElse(word, 0)))\nsuppWords.sortBy(wordPair => wordPair._2).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">suppBroadcast: org.apache.spark.broadcast.Broadcast[scala.collection.immutable.Map[String,Int]] = Broadcast(1185)\nsuppWords: org.apache.spark.rdd.RDD[(String, Int)] = MapPartitionsRDD[2227] at map at &lt;console&gt;:48\nres34: Array[(String, Int)] = Array((Big,-300), (The,0), (Guide,0), (:,0), (Data,0), (Processing,0), (Made,0), (Simple,100), (Definitive,200), (Spark,1000))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646908705,"submitTime":1497646908708,"finishTime":1497646908944,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"813e2df4-1cbc-461f-be80-1f385c23b40f"},{"version":"CommandV1","origId":2060825016293718,"guid":"bde68d30-f958-49b1-91cc-10c4beafb8f9","subtype":"command","commandType":"auto","position":38.0,"command":"%scala\ncase class Flight(DEST_COUNTRY_NAME: String, ORIGIN_COUNTRY_NAME: String, count: BigInt)\nval flights = spark.read\n.parquet(\"/mnt/defg/chapter-1-data/parquet/2010-summary.parquet/\")\n.as[Flight]","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Path does not exist: dbfs:/mnt/defg/chapter-1-data/parquet/2010-summary.parquet;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:372)\n\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:360)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:251)\n\tat scala.collection.AbstractTraversable.flatMap(Traversable.scala:105)\n\tat org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:360)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:154)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:148)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:147)\n\tat org.apache.spark.sql.DataFrameReader.parquet(DataFrameReader.scala:444)\n\tat org.apache.spark.sql.DataFrameReader.parquet(DataFrameReader.scala:428)</div>","workflows":[],"startTime":1497646920393,"submitTime":1497646920393,"finishTime":1497646920820,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"55cfba61-5f19-44b2-b394-50a5448703d6"},{"version":"CommandV1","origId":2060825016293719,"guid":"7d1c3f0c-8194-4def-9fd3-1576de41bacd","subtype":"command","commandType":"auto","position":39.0,"command":"%scala\nimport org.apache.spark.util.LongAccumulator\nval accUnnamed = new LongAccumulator\nsc.register(accUnnamed)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.util.LongAccumulator\naccUnnamed: org.apache.spark.util.LongAccumulator = LongAccumulator(id: 314587, name: None, value: 0)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646929208,"submitTime":1497646929205,"finishTime":1497646929278,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"680d5f84-a750-4e01-b5f9-06e3190e14e2"},{"version":"CommandV1","origId":2060825016293720,"guid":"775b946a-2094-4ef5-82a7-578caae1b103","subtype":"command","commandType":"auto","position":40.0,"command":"%scala\nval accChina = new LongAccumulator\nsc.register(accChina, \"China\")\nval accChina2 = sc.longAccumulator(\"China\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">accChina: org.apache.spark.util.LongAccumulator = LongAccumulator(id: 314588, name: Some(China), value: 0)\naccChina2: org.apache.spark.util.LongAccumulator = LongAccumulator(id: 314589, name: Some(China), value: 0)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497646937665,"submitTime":1497646937662,"finishTime":1497646937746,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0fe80ff0-cc0c-4d12-8eb2-611e4aaf3884"},{"version":"CommandV1","origId":2060825016293721,"guid":"4dee4bc4-0835-4614-96a3-57d7d2df4350","subtype":"command","commandType":"auto","position":41.0,"command":"%scala\ndef accChinaFunc(flight_row: Flight) = {\nval destination = flight_row.DEST_COUNTRY_NAME\nval origin = flight_row.ORIGIN_COUNTRY_NAME\nif (destination == \"China\") {\naccChina.add(flight_row.count.toLong)\n}\nif (origin == \"China\") {\naccChina.add(flight_row.count.toLong)\n}\n}","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:39: error: not found: type Flight\n       def accChinaFunc(flight_row: Flight) = {\n                                    ^\n</div>","error":null,"workflows":[],"startTime":1497646951534,"submitTime":1497646951534,"finishTime":1497646951570,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"243de592-8f14-470e-8d39-d480c98ab8f9"},{"version":"CommandV1","origId":2060825016293722,"guid":"a146f8c0-8044-4905-b513-a4fd2cc04cff","subtype":"command","commandType":"auto","position":42.0,"command":"%scala\nflights.foreach(flight_row => accChinaFunc(flight_row))","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:39: error: not found: value flights\n              flights.foreach(flight_row =&gt; accChinaFunc(flight_row))\n              ^\n</div>","error":null,"workflows":[],"startTime":1497646993309,"submitTime":1497646993309,"finishTime":1497646993335,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b95e8853-11a7-42ef-81de-770c6a5b4dfe"},{"version":"CommandV1","origId":2060825016293723,"guid":"a5c453ea-bd81-41da-aaad-150215d0a204","subtype":"command","commandType":"auto","position":43.0,"command":"%scala\naccChina.value","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res37: Long = 0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497647001936,"submitTime":1497647001933,"finishTime":1497647001999,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"38be38dc-8e95-4070-acb2-53d0b0caf692"},{"version":"CommandV1","origId":2060825016293724,"guid":"b559f0e1-aaef-42f7-9741-7eb6888967f7","subtype":"command","commandType":"auto","position":44.0,"command":"%scala\nimport scala.collection.mutable.ArrayBuffer\nval arr = ArrayBuffer[BigInt]()\nimport scala.collection.mutable.ArrayBuffer\nimport org.apache.spark.util.AccumulatorV2\nclass EvenAccumulator extends AccumulatorV2[BigInt, BigInt] {\nprivate var num:BigInt = 0\ndef reset(): Unit = {\nthis.num = 0\n}\ndef add(intValue: BigInt): Unit = {\nif (intValue % 2 == 0) {\nthis.num += intValue\n}\n}\ndef merge(other: AccumulatorV2[BigInt,BigInt]): Unit = {\nthis.num += other.value\n}\ndef value():BigInt = {\nthis.num\n}\ndef copy(): AccumulatorV2[BigInt,BigInt] = {\nnew EvenAccumulator\n}\ndef isZero():Boolean = {\nthis.num == 0\n}\n}\nval acc = new EvenAccumulator\nval newAcc = sc.register(acc, \"evenAcc\")\nacc.value\nflights.foreach(flight_row => acc.add(flight_row.count))\nacc.value","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:69: error: not found: value flights\n              flights.foreach(flight_row =&gt; acc.add(flight_row.count))\n              ^\n</div>","error":null,"workflows":[],"startTime":1497647027003,"submitTime":1497647027003,"finishTime":1497647027071,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f4762f49-4de0-46f8-b243-f4ed7231fca0"}],"dashboards":[],"guid":"4675e3f4-a062-418d-bc69-9860e7178c64","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
