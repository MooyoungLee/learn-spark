<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Definitive Draft Chapter 1-3 - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"serverlessDefaultSparkVersion":"2.2.x-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","enableTableHandler":false,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"3.0 beta (Scala 2.11)","packageLabel":"spark-image-20adedc466bac7d0c91242baba4ae70dc8487d6e301359af185601969607d211","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-f43ddf8ad9acfd71338f5a51345f077173d236016ad7e39ffd6f698403acd4ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"3.0 beta (Scala 2.10)","packageLabel":"spark-image-a1d408c36c3e2c79b38783b57b626c7c6847c9639fa15dd22eca009c23b89c6f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":6,"class-node":1,"m4.2xlarge":0.5,"r4.xlarge":1,"m4.4xlarge":0.5,"r4.16xlarge":8,"Standard_DS11":0.5,"p2.8xlarge":16,"m4.10xlarge":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.5,"r4.8xlarge":8,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.5,"p2.16xlarge":24,"i3.8xlarge":12,"i3.16xlarge":24,"Standard_DS12_v2":1,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"i3.2xlarge":3,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":0.5,"c4.8xlarge":4,"i3.xlarge":1.5,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.47","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableNonPollingTableCall":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":180,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"enableElasticDisk":false,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"ea633ce26684806264e7bd2cbb05130eb0f98c4d","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewJobList":false,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"enableEBSVolumesUIByTier":false,"singleSignOnComingSoon":false,"enableNewJobClusterEdit":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":336718490209982,"name":"Definitive Draft Chapter 1-3","language":"python","commands":[{"version":"CommandV1","origId":336718490209984,"guid":"cd719118-f460-40a7-8947-0f445c2db66a","subtype":"command","commandType":"auto","position":1.0,"command":"%scala\nval myRange = spark.range(1000).toDF(\"number\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">myRange: org.apache.spark.sql.DataFrame = [number: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:38: error: not found: value %\n              %python\n              ^\n&lt;console&gt;:35: warning: a pure expression does nothing in statement position; you may be omitting necessary parentheses\n              spark\n              ^\n</div>","error":null,"workflows":[],"startTime":1497623224496,"submitTime":1497623224426,"finishTime":1497623224717,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1673b461-aa3c-40f2-8d33-e138c60d2770"},{"version":"CommandV1","origId":336718490209987,"guid":"1638d2b3-79ef-4c6f-8ec9-ca07a7496e6e","subtype":"command","commandType":"auto","position":2.0,"command":"%python\nmyRange = spark.range(1000).toDF(\"number\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;write&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-10-b135ae59a515&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> myRange <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>range<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1000</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>toDF<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;number&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>write<span class=\"ansiyellow\">.</span>saveAsTable<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;myRange&apos;</span><span class=\"ansiyellow\">,</span> mode<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&apos;overwrite&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;write&apos; is not defined</div>","workflows":[],"startTime":1497623224725,"submitTime":1497623224427,"finishTime":1497623224814,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a5de7e65-a7cf-4c61-9fb7-95c5ac422d5c"},{"version":"CommandV1","origId":336718490209988,"guid":"6e49e397-53b2-4844-980f-1776eced588b","subtype":"command","commandType":"auto","position":3.0,"command":"%scala\nval divisBy2 = myRange.where(\"number % 2 = 0\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">divisBy2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [number: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497623224820,"submitTime":1497623224432,"finishTime":1497623225014,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5a7b2436-95ec-47e1-84b5-421b45488095"},{"version":"CommandV1","origId":336718490209989,"guid":"5dd5adb2-1d42-445f-b65c-f010e72b55e1","subtype":"command","commandType":"auto","position":4.0,"command":"%python\ndivisBy2 = myRange.where(\"number % 2 = 0\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497623225023,"submitTime":1497623224436,"finishTime":1497623225096,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b9307bce-bf1c-4be7-8dd5-063cb6274acb"},{"version":"CommandV1","origId":336718490209990,"guid":"dfbb82c5-a338-4307-9d1e-750c85020d7d","subtype":"command","commandType":"auto","position":5.0,"command":"%sql\nSELECT * FROM myRange WHERE number % 2 = 0","commandVersion":0,"state":"finished","results":{"type":"table","data":[[876],[878],[880],[882],[884],[886],[888],[890],[892],[894],[896],[898],[900],[902],[904],[906],[908],[910],[912],[914],[916],[918],[920],[922],[924],[926],[928],[930],[932],[934],[936],[938],[940],[942],[944],[946],[948],[950],[952],[954],[956],[958],[960],[962],[964],[966],[968],[970],[972],[974],[976],[978],[980],[982],[984],[986],[988],[990],[992],[994],[996],[998],[376],[378],[380],[382],[384],[386],[388],[390],[392],[394],[396],[398],[400],[402],[404],[406],[408],[410],[412],[414],[416],[418],[420],[422],[424],[426],[428],[430],[432],[434],[436],[438],[440],[442],[444],[446],[448],[450],[452],[454],[456],[458],[460],[462],[464],[466],[468],[470],[472],[474],[476],[478],[480],[482],[484],[486],[488],[490],[492],[494],[496],[498],[626],[628],[630],[632],[634],[636],[638],[640],[642],[644],[646],[648],[650],[652],[654],[656],[658],[660],[662],[664],[666],[668],[670],[672],[674],[676],[678],[680],[682],[684],[686],[688],[690],[692],[694],[696],[698],[700],[702],[704],[706],[708],[710],[712],[714],[716],[718],[720],[722],[724],[726],[728],[730],[732],[734],[736],[738],[740],[742],[744],[746],[748],[500],[502],[504],[506],[508],[510],[512],[514],[516],[518],[520],[522],[524],[526],[528],[530],[532],[534],[536],[538],[540],[542],[544],[546],[548],[550],[552],[554],[556],[558],[560],[562],[564],[566],[568],[570],[572],[574],[576],[578],[580],[582],[584],[586],[588],[590],[592],[594],[596],[598],[600],[602],[604],[606],[608],[610],[612],[614],[616],[618],[620],[622],[624],[750],[752],[754],[756],[758],[760],[762],[764],[766],[768],[770],[772],[774],[776],[778],[780],[782],[784],[786],[788],[790],[792],[794],[796],[798],[800],[802],[804],[806],[808],[810],[812],[814],[816],[818],[820],[822],[824],[826],[828],[830],[832],[834],[836],[838],[840],[842],[844],[846],[848],[850],[852],[854],[856],[858],[860],[862],[864],[866],[868],[870],[872],[874],[126],[128],[130],[132],[134],[136],[138],[140],[142],[144],[146],[148],[150],[152],[154],[156],[158],[160],[162],[164],[166],[168],[170],[172],[174],[176],[178],[180],[182],[184],[186],[188],[190],[192],[194],[196],[198],[200],[202],[204],[206],[208],[210],[212],[214],[216],[218],[220],[222],[224],[226],[228],[230],[232],[234],[236],[238],[240],[242],[244],[246],[248],[0],[2],[4],[6],[8],[10],[12],[14],[16],[18],[20],[22],[24],[26],[28],[30],[32],[34],[36],[38],[40],[42],[44],[46],[48],[50],[52],[54],[56],[58],[60],[62],[64],[66],[68],[70],[72],[74],[76],[78],[80],[82],[84],[86],[88],[90],[92],[94],[96],[98],[100],[102],[104],[106],[108],[110],[112],[114],[116],[118],[120],[122],[124],[250],[252],[254],[256],[258],[260],[262],[264],[266],[268],[270],[272],[274],[276],[278],[280],[282],[284],[286],[288],[290],[292],[294],[296],[298],[300],[302],[304],[306],[308],[310],[312],[314],[316],[318],[320],[322],[324],[326],[328],[330],[332],[334],[336],[338],[340],[342],[344],[346],[348],[350],[352],[354],[356],[358],[360],[362],[364],[366],[368],[370],[372],[374]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"number","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Error in SQL statement: AnalysisException: Table or view not found: myRange; line 1 pos 14","error":"com.databricks.backend.common.rpc.DatabricksExceptions$SQLExecutionException: org.apache.spark.sql.AnalysisException: Table or view not found: myRange; line 1 pos 14\n\tat org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveRelations$$lookupTableFromCatalog(Analyzer.scala:465)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$9.applyOrElse(Analyzer.scala:484)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$9.applyOrElse(Analyzer.scala:469)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:60)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$1.apply(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:58)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:469)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:459)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:85)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:82)\n\tat scala.collection.LinearSeqOptimized$class.foldLeft(LinearSeqOptimized.scala:111)\n\tat scala.collection.immutable.List.foldLeft(List.scala:84)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:82)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:74)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:74)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:60)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:77)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:75)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply$mcV$sp(QueryExecution.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:55)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:63)\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:599)\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:698)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:82)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal$$anonfun$1.apply(SQLDriverLocal.scala:28)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:28)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:230)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:211)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:211)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.executeSql(SQLDriverLocal.scala:116)\n\tat com.databricks.backend.daemon.driver.SQLDriverLocal.repl(SQLDriverLocal.scala:128)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:230)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$2.apply(DriverLocal.scala:211)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:173)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:168)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:206)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:211)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1497623225101,"submitTime":1497623224440,"finishTime":1497623226226,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"07c51441-3a75-4ed9-873c-c4739e9495b6"},{"version":"CommandV1","origId":336718490209991,"guid":"f465fc2f-c853-4be0-b3eb-9386875f7e09","subtype":"command","commandType":"auto","position":6.0,"command":"%scala\ndivisBy2.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res1: Long = 500\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497623226255,"submitTime":1497623224448,"finishTime":1497623226562,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9ea66660-a8ce-4544-bfcd-55985c3945d1"},{"version":"CommandV1","origId":336718490209992,"guid":"cb25b6c8-9b78-43e7-9fc7-ef0b9fc43aff","subtype":"command","commandType":"auto","position":7.0,"command":"%python\ndivisBy2.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">6</span><span class=\"ansired\">]: </span>500\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497623226593,"submitTime":1497623224452,"finishTime":1497623226822,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3f02e896-8da1-4fde-8595-39fa30ddd4e4"},{"version":"CommandV1","origId":336718490209995,"guid":"9e7cb1fc-0aa5-4587-9d3d-f0a86aa7866c","subtype":"command","commandType":"auto","position":10.0,"command":"%sh cd ..\ncd ..\ncd dbfs/FileStore/tables/8su3wraj1497632771405\nls\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">2015_summary-ebaee.json\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497632899416,"submitTime":1497632899411,"finishTime":1497632899689,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b9a80942-4312-4fbc-8e7a-6e1350c44977"},{"version":"CommandV1","origId":336718490209996,"guid":"a2cd35f4-95b7-44ec-adcc-a6bdedcd6642","subtype":"command","commandType":"auto","position":11.0,"command":"%scala\nval flightData2015 = spark\n.read\n.json(\"/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">flightData2015: org.apache.spark.sql.DataFrame = [count: bigint, dest_country_name: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Path does not exist: dbfs:/dbfs/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:372)\n\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:360)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:251)\n\tat scala.collection.AbstractTraversable.flatMap(Traversable.scala:105)\n\tat org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:360)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:154)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:148)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:147)\n\tat org.apache.spark.sql.DataFrameReader.json(DataFrameReader.scala:301)\n\tat org.apache.spark.sql.DataFrameReader.json(DataFrameReader.scala:254)</div>","workflows":[],"startTime":1497632949686,"submitTime":1497632949677,"finishTime":1497632950210,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3d2ace56-921c-41ed-8461-aa5cc7d2a9bb"},{"version":"CommandV1","origId":336718490209997,"guid":"e465fb7e-bba2-4b41-8119-dc81c8d0fb1c","subtype":"command","commandType":"auto","position":12.0,"command":"%python\nflightData2015 = spark\\\n.read\\\n.json(\"/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json\")\nflightData2015","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">69</span><span class=\"ansired\">]: </span>DataFrame[count: bigint, dest_country_name: string, origin_country_name: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497632999081,"submitTime":1497632999077,"finishTime":1497632999354,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"82ee7904-7675-4619-a363-5c17084ba270"},{"version":"CommandV1","origId":336718490209998,"guid":"14959d9c-7ae4-41f2-a1c8-b47ac3f5cb54","subtype":"command","commandType":"auto","position":13.0,"command":"%scala\nflightData2015.take(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res2: Array[org.apache.spark.sql.Row] = Array([15,United States,Romania], [1,United States,Croatia])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633016247,"submitTime":1497633016238,"finishTime":1497633016607,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2d8ddda4-2b64-4d81-a52a-056964485400"},{"version":"CommandV1","origId":336718490209999,"guid":"cfc73e2f-b316-4a01-934f-3f78db131d20","subtype":"command","commandType":"auto","position":14.0,"command":"%python\nflightData2015.take(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">70</span><span class=\"ansired\">]: </span>\n[Row(count=15, dest_country_name=u&apos;United States&apos;, origin_country_name=u&apos;Romania&apos;),\n Row(count=1, dest_country_name=u&apos;United States&apos;, origin_country_name=u&apos;Croatia&apos;)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633025310,"submitTime":1497633025301,"finishTime":1497633025483,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9d43de76-b7b9-476f-8bdc-539a917c9711"},{"version":"CommandV1","origId":336718490210000,"guid":"156fc13a-4a37-48a4-9056-eb70bf5bde5d","subtype":"command","commandType":"auto","position":15.0,"command":"%scala\nflightData2015.explain()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*FileScan json [count#387L,dest_country_name#388,origin_country_name#389] Batched: false, Format: JSON, Location: InMemoryFileIndex[dbfs:/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;count:bigint,dest_country_name:string,origin_country_name:string&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633053289,"submitTime":1497633053280,"finishTime":1497633053418,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"54f7c095-1f68-46cb-a42b-e113d34bfe94"},{"version":"CommandV1","origId":336718490210001,"guid":"ad4e9d85-f9e0-432e-b345-3422c96ea61a","subtype":"command","commandType":"auto","position":16.0,"command":"flightData2015.explain()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*FileScan json [count#394L,dest_country_name#395,origin_country_name#396] Batched: false, Format: JSON, Location: InMemoryFileIndex[dbfs:/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;count:bigint,dest_country_name:string,origin_country_name:string&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633061509,"submitTime":1497633061500,"finishTime":1497633061581,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9d96fc05-1c19-40f0-9c90-4ceb555ee716"},{"version":"CommandV1","origId":336718490210002,"guid":"b2a16f60-9111-42ca-900c-e1c2a893fbc3","subtype":"command","commandType":"auto","position":17.0,"command":"%scala\nval sortedFlightData2015 = flightData2015.sort(\"count\")\nsortedFlightData2015.explain()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*Sort [count#387L ASC NULLS FIRST], true, 0\n+- Exchange rangepartitioning(count#387L ASC NULLS FIRST, 200)\n   +- *FileScan json [count#387L,dest_country_name#388,origin_country_name#389] Batched: false, Format: JSON, Location: InMemoryFileIndex[dbfs:/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;count:bigint,dest_country_name:string,origin_country_name:string&gt;\nsortedFlightData2015: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [count: bigint, dest_country_name: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633077539,"submitTime":1497633077529,"finishTime":1497633077651,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ef7734a5-27e0-4fb8-8614-95adcfa1b2d1"},{"version":"CommandV1","origId":336718490210003,"guid":"a28bdca7-3d08-4ade-a608-baeade0631e7","subtype":"command","commandType":"auto","position":18.0,"command":"sortedFlightData2015 = flightData2015.sort(\"count\")\nsortedFlightData2015.explain()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*Sort [count#394L ASC NULLS FIRST], true, 0\n+- Exchange rangepartitioning(count#394L ASC NULLS FIRST, 200)\n   +- *FileScan json [count#394L,dest_country_name#395,origin_country_name#396] Batched: false, Format: JSON, Location: InMemoryFileIndex[dbfs:/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;count:bigint,dest_country_name:string,origin_country_name:string&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633089913,"submitTime":1497633089902,"finishTime":1497633089984,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"88588a00-85d2-4fac-b5ad-6b301d93d8a4"},{"version":"CommandV1","origId":336718490210004,"guid":"22ca1952-a086-4a50-8765-48713d68c758","subtype":"command","commandType":"auto","position":19.0,"command":"%scala\nsortedFlightData2015.take(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res5: Array[org.apache.spark.sql.Row] = Array([1,United States,Singapore], [1,Moldova,United States])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633098932,"submitTime":1497633098920,"finishTime":1497633099180,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"37c3cda6-069d-4051-8579-4987fc0c200b"},{"version":"CommandV1","origId":336718490210005,"guid":"de5835ce-937e-4aec-bf93-8105d2a38ff8","subtype":"command","commandType":"auto","position":20.0,"command":"sortedFlightData2015.take(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">73</span><span class=\"ansired\">]: </span>\n[Row(count=1, dest_country_name=u&apos;United States&apos;, origin_country_name=u&apos;Singapore&apos;),\n Row(count=1, dest_country_name=u&apos;Moldova&apos;, origin_country_name=u&apos;United States&apos;)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633123379,"submitTime":1497633123369,"finishTime":1497633123551,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"daff6062-9757-4801-abfe-764991ca5aa0"},{"version":"CommandV1","origId":336718490210006,"guid":"a230bfac-5e81-4888-8352-85890e815e5f","subtype":"command","commandType":"auto","position":21.0,"command":"%sh cd ..\ncd ..\ncd dbfs/FileStore/tables/baae5ww01497633203998\nls","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">2015_summary-ebaee.csv\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633383676,"submitTime":1497633383669,"finishTime":1497633383904,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"77d6bdb7-6189-4494-978a-1351a9832c95"},{"version":"CommandV1","origId":336718490210007,"guid":"f38ee6cf-9ba6-48ec-81ac-fdb4d9cef62f","subtype":"command","commandType":"auto","position":22.0,"command":"%scala\nval flightData2015 = spark.read\n.option(\"inferSchema\", \"true\")\n.option(\"header\", \"true\")\n.csv(\"/FileStore/tables/baae5ww01497633203998/2015_summary-ebaee.csv\")\nflightData2015","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">flightData2015: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, ORIGIN_COUNTRY_NAME: string ... 1 more field]\nres6: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, ORIGIN_COUNTRY_NAME: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633424449,"submitTime":1497633424442,"finishTime":1497633425292,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"640bdfb3-9844-4bdd-b38b-3eb5e911a425"},{"version":"CommandV1","origId":336718490210008,"guid":"9746d859-0eed-47b8-9843-73395d940a53","subtype":"command","commandType":"auto","position":23.0,"command":"flightData2015 = spark.read\\\n.option(\"inferSchema\", \"true\")\\\n.option(\"header\", \"true\")\\\n.csv(\"/FileStore/tables/baae5ww01497633203998/2015_summary-ebaee.csv\")\nflightData2015","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">93</span><span class=\"ansired\">]: </span>DataFrame[DEST_COUNTRY_NAME: string, ORIGIN_COUNTRY_NAME: string, count: int]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/chapter-1-data/csv/2015-summary.csv;&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-92-51d1b4b858aa&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>flightData2015 <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>option<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;inferSchema&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;true&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>option<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;header&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;true&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>csv<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;/mnt/defg/chapter-1-data/csv/2015-summary.csv&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> flightData2015<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/readwriter.py</span> in <span class=\"ansicyan\">csv</span><span class=\"ansiblue\">(self, path, schema, sep, encoding, quote, escape, comment, header, inferSchema, ignoreLeadingWhiteSpace, ignoreTrailingWhiteSpace, nullValue, nanValue, positiveInf, negativeInf, dateFormat, timestampFormat, maxColumns, maxCharsPerColumn, maxMalformedLogPerPartition, mode)</span>\n<span class=\"ansigreen\">    378</span>         <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">,</span> basestring<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    379</span>             path <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">[</span>path<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 380</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_df<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jreader<span class=\"ansiyellow\">.</span>csv<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_spark<span class=\"ansiyellow\">.</span>_sc<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>PythonUtils<span class=\"ansiyellow\">.</span>toSeq<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    381</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    382</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.5</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/chapter-1-data/csv/2015-summary.csv;&apos;</div>","workflows":[],"startTime":1497633447927,"submitTime":1497633447915,"finishTime":1497633448407,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0827cc81-60f1-4afc-b980-1604ae6fabb1"},{"version":"CommandV1","origId":336718490210009,"guid":"d54e7d37-d8f8-4e4f-bfe2-26a79aff48e6","subtype":"command","commandType":"auto","position":24.0,"command":"%scala\nval csvSchema = spark.read.format(\"csv\")\n.option(\"inferSchema\", \"true\")\n.option(\"header\", \"true\")\n.load(\"/FileStore/tables/baae5ww01497633203998/2015_summary-ebaee.csv\")\n.schema\nval jsonSchema = spark\n.read.format(\"json\")\n.load(\"/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json\")\n.schema\nprintln(csvSchema)\nprintln(jsonSchema)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">StructType(StructField(DEST_COUNTRY_NAME,StringType,true), StructField(ORIGIN_COUNTRY_NAME,StringType,true), StructField(count,IntegerType,true))\nStructType(StructField(count,LongType,true), StructField(dest_country_name,StringType,true), StructField(origin_country_name,StringType,true))\ncsvSchema: org.apache.spark.sql.types.StructType = StructType(StructField(DEST_COUNTRY_NAME,StringType,true), StructField(ORIGIN_COUNTRY_NAME,StringType,true), StructField(count,IntegerType,true))\njsonSchema: org.apache.spark.sql.types.StructType = StructType(StructField(count,LongType,true), StructField(dest_country_name,StringType,true), StructField(origin_country_name,StringType,true))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633551878,"submitTime":1497633551871,"finishTime":1497633552668,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0b918b69-7b3c-4bee-aa14-5616874402d1"},{"version":"CommandV1","origId":336718490210010,"guid":"2f74357a-bcd6-425a-b92e-f4cc6cf96016","subtype":"command","commandType":"auto","position":25.0,"command":"csvSchema = spark.read.format(\"csv\")\\\n.option(\"inferSchema\", \"true\")\\\n.option(\"header\", \"true\")\\\n.load(\"/FileStore/tables/baae5ww01497633203998/2015_summary-ebaee.csv\")\\\n.schema\njsonSchema = spark.read.format(\"json\")\\\n.load(\"/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json\")\\\n.schema\nprint(csvSchema)\nprint(jsonSchema)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">StructType(List(StructField(DEST_COUNTRY_NAME,StringType,true),StructField(ORIGIN_COUNTRY_NAME,StringType,true),StructField(count,IntegerType,true)))\nStructType(List(StructField(count,LongType,true),StructField(dest_country_name,StringType,true),StructField(origin_country_name,StringType,true)))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633585680,"submitTime":1497633585674,"finishTime":1497633586207,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"faf26e87-abdf-4c8c-86a9-a973c3b3a24c"},{"version":"CommandV1","origId":336718490210011,"guid":"ac8f9635-1acc-4a94-a25e-dd954ef11783","subtype":"command","commandType":"auto","position":26.0,"command":"%scala\nval flightData2015 = spark.read\n.schema(jsonSchema)\n.option(\"header\", \"true\")\n.csv(\"/FileStore/tables/baae5ww01497633203998/2015_summary-ebaee.csv\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">flightData2015: org.apache.spark.sql.DataFrame = [count: bigint, dest_country_name: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633644727,"submitTime":1497633644716,"finishTime":1497633644921,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"51db90a9-aab9-45e8-ae76-fe2b3dc9bb4a"},{"version":"CommandV1","origId":336718490210012,"guid":"d5ac98ee-97fe-4f72-b0c1-dd27c0867c7a","subtype":"command","commandType":"auto","position":27.0,"command":"flightData2015 = spark.read\\\n.schema(jsonSchema)\\\n.option(\"header\", \"true\")\\\n.csv(\"/FileStore/tables/baae5ww01497633203998/2015_summary-ebaee.csv\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633683719,"submitTime":1497633683713,"finishTime":1497633683842,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"41ccacdf-69fb-42e4-8892-869d6421ca0b"},{"version":"CommandV1","origId":336718490210013,"guid":"386e8a35-f5d0-4ead-900f-efbc44db5bb1","subtype":"command","commandType":"auto","position":28.0,"command":"%scala\nflightData2015.createOrReplaceTempView(\"flight_data_2015\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633703214,"submitTime":1497633703208,"finishTime":1497633703303,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"69c11e07-2834-472f-8c63-9993cc1acc58"},{"version":"CommandV1","origId":336718490210014,"guid":"52824ddb-f4d3-483e-94e2-a29b64888b1d","subtype":"command","commandType":"auto","position":29.0,"command":"flightData2015.createOrReplaceTempView(\"flight_data_2015\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633712901,"submitTime":1497633712890,"finishTime":1497633712972,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2df67d1a-449a-4b9b-9687-641967624c63"},{"version":"CommandV1","origId":336718490210015,"guid":"f5e42caa-45e0-49c9-a5c3-e7d822d44578","subtype":"command","commandType":"auto","position":30.0,"command":"%scala\nval sqlWay = spark.sql(\"\"\"\nSELECT DEST_COUNTRY_NAME, count(1)\nFROM flight_data_2015\nGROUP BY DEST_COUNTRY_NAME\n\"\"\")\nval dataFrameWay = flightData2015\n.groupBy('DEST_COUNTRY_NAME)\n.count()\nsqlWay.explain\ndataFrameWay.explain","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*HashAggregate(keys=[DEST_COUNTRY_NAME#681], functions=[count(1)])\n+- Exchange hashpartitioning(DEST_COUNTRY_NAME#681, 200)\n   +- *HashAggregate(keys=[DEST_COUNTRY_NAME#681], functions=[partial_count(1)])\n      +- *FileScan csv [dest_country_name#681] Batched: false, Format: CSV, Location: InMemoryFileIndex[dbfs:/FileStore/tables/baae5ww01497633203998/2015_summary-ebaee.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;dest_country_name:string&gt;\n== Physical Plan ==\n*HashAggregate(keys=[DEST_COUNTRY_NAME#660], functions=[count(1)])\n+- Exchange hashpartitioning(DEST_COUNTRY_NAME#660, 200)\n   +- *HashAggregate(keys=[DEST_COUNTRY_NAME#660], functions=[partial_count(1)])\n      +- *FileScan csv [dest_country_name#660] Batched: false, Format: CSV, Location: InMemoryFileIndex[dbfs:/FileStore/tables/baae5ww01497633203998/2015_summary-ebaee.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;dest_country_name:string&gt;\nsqlWay: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, count(1): bigint]\ndataFrameWay: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, count: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-99-4cbae65bb484&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">2</span>\n<span class=\"ansiyellow\">    val sqlWay = spark.sql(&quot;&quot;&quot;</span>\n<span class=\"ansigrey\">             ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1497633732942,"submitTime":1497633732931,"finishTime":1497633733103,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f9f6513f-3885-4962-bb69-b9ea4fed293a"},{"version":"CommandV1","origId":336718490210016,"guid":"e41bdf41-49c2-403a-9978-9916a98f356a","subtype":"command","commandType":"auto","position":31.0,"command":"sqlWay = spark.sql(\"\"\"\nSELECT DEST_COUNTRY_NAME, count(1)\nFROM flight_data_2015\nGROUP BY DEST_COUNTRY_NAME\n\"\"\")\ndataFrameWay = flightData2015\\\n.groupBy(\"DEST_COUNTRY_NAME\")\\\n.count()\nsqlWay.explain()\ndataFrameWay.explain()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*HashAggregate(keys=[DEST_COUNTRY_NAME#681], functions=[count(1)])\n+- Exchange hashpartitioning(DEST_COUNTRY_NAME#681, 200)\n   +- *HashAggregate(keys=[DEST_COUNTRY_NAME#681], functions=[partial_count(1)])\n      +- *FileScan csv [dest_country_name#681] Batched: false, Format: CSV, Location: InMemoryFileIndex[dbfs:/FileStore/tables/baae5ww01497633203998/2015_summary-ebaee.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;dest_country_name:string&gt;\n== Physical Plan ==\n*HashAggregate(keys=[DEST_COUNTRY_NAME#681], functions=[count(1)])\n+- Exchange hashpartitioning(DEST_COUNTRY_NAME#681, 200)\n   +- *HashAggregate(keys=[DEST_COUNTRY_NAME#681], functions=[partial_count(1)])\n      +- *FileScan csv [dest_country_name#681] Batched: false, Format: CSV, Location: InMemoryFileIndex[dbfs:/FileStore/tables/baae5ww01497633203998/2015_summary-ebaee.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;dest_country_name:string&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497633747035,"submitTime":1497633747028,"finishTime":1497633747157,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2a7042d4-a035-41f0-b862-068f73f11a2a"},{"version":"CommandV1","origId":336718490210017,"guid":"b8272eee-db97-4820-886e-8fb65312d4d6","subtype":"command","commandType":"auto","position":32.0,"command":"%sql\nSELECT max(count) from summary2015","commandVersion":0,"state":"finished","results":{"type":"table","data":[[370002]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"max(count)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 73.0 failed 1 times, most recent failure: Lost task 0.0 in stage 73.0 (TID 160, localhost, executor driver): java.lang.NumberFormatException: For input string: &quot;United States&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-103-3c9d88b3ff5f&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>spark<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;SELECT max(count) from flight_data_2015&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>take<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">take</span><span class=\"ansiblue\">(self, num)</span>\n<span class=\"ansigreen\">    427</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">,</span> name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Alice&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">5</span><span class=\"ansiyellow\">,</span> name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Bob&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    428</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 429</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>limit<span class=\"ansiyellow\">(</span>num<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    430</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    431</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.3</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">collect</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">    389</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    390</span>         <span class=\"ansigreen\">with</span> SCCallSiteSync<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_sc<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">as</span> css<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 391</span><span class=\"ansiyellow\">             </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>collectToPython<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    392</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> BatchedSerializer<span class=\"ansiyellow\">(</span>PickleSerializer<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    393</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o1047.collectToPython.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 73.0 failed 1 times, most recent failure: Lost task 0.0 in stage 73.0 (TID 160, localhost, executor driver): java.lang.NumberFormatException: For input string: &quot;United States&quot;\n\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.lang.Long.parseLong(Long.java:589)\n\tat java.lang.Long.parseLong(Long.java:631)\n\tat scala.collection.immutable.StringLike$class.toLong(StringLike.scala:230)\n\tat scala.collection.immutable.StringOps.toLong(StringOps.scala:31)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVTypeCast$.castTo(CSVInferSchema.scala:253)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:125)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:94)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:173)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:172)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:327)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:235)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:217)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1442)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1430)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1429)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1429)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1657)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1612)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1601)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1937)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1950)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1963)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:333)\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply$mcI$sp(Dataset.scala:2757)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply(Dataset.scala:2754)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply(Dataset.scala:2754)\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:87)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:70)\n\tat org.apache.spark.sql.Dataset.withNewExecutionId(Dataset.scala:2777)\n\tat org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:2754)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.NumberFormatException: For input string: &quot;United States&quot;\n\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.lang.Long.parseLong(Long.java:589)\n\tat java.lang.Long.parseLong(Long.java:631)\n\tat scala.collection.immutable.StringLike$class.toLong(StringLike.scala:230)\n\tat scala.collection.immutable.StringOps.toLong(StringOps.scala:31)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVTypeCast$.castTo(CSVInferSchema.scala:253)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:125)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:94)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:173)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:172)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:327)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:235)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:217)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n</div>","workflows":[],"startTime":1497633981527,"submitTime":1497633981512,"finishTime":1497633981843,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"48b15ab9-3861-4af2-8305-28739a7cf8f7"},{"version":"CommandV1","origId":336718490210018,"guid":"80de2bed-557e-4663-8282-1438de952dac","subtype":"command","commandType":"auto","position":33.0,"command":"%scala\nimport org.apache.spark.sql.functions.max\nflightData2015.select(max(\"count\")).take(1)","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 67.0 failed 1 times, most recent failure: Lost task 0.0 in stage 67.0 (TID 157, localhost, executor driver): java.lang.NumberFormatException: For input string: \"United States\"","error":"<div class=\"ansiout\">\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.lang.Long.parseLong(Long.java:589)\n\tat java.lang.Long.parseLong(Long.java:631)\n\tat scala.collection.immutable.StringLike$class.toLong(StringLike.scala:230)\n\tat scala.collection.immutable.StringOps.toLong(StringOps.scala:31)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVTypeCast$.castTo(CSVInferSchema.scala:253)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:125)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:94)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:173)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:172)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:327)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:235)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:217)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1442)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1430)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1429)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1429)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1657)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1612)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1601)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1937)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1950)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1963)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:333)\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:2807)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2132)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2132)\n\tat org.apache.spark.sql.Dataset$$anonfun$60.apply(Dataset.scala:2791)\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:87)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:70)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:2790)\n\tat org.apache.spark.sql.Dataset.head(Dataset.scala:2132)\n\tat org.apache.spark.sql.Dataset.take(Dataset.scala:2345)\nCaused by: java.lang.NumberFormatException: For input string: &quot;United States&quot;\n\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.lang.Long.parseLong(Long.java:589)\n\tat java.lang.Long.parseLong(Long.java:631)\n\tat scala.collection.immutable.StringLike$class.toLong(StringLike.scala:230)\n\tat scala.collection.immutable.StringOps.toLong(StringOps.scala:31)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVTypeCast$.castTo(CSVInferSchema.scala:253)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:125)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:94)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:173)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:172)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:327)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:235)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:217)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)</div>","workflows":[],"startTime":1497633771667,"submitTime":1497633771667,"finishTime":1497633771898,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"82cf236a-f26f-4f40-ad06-13235a33a150"},{"version":"CommandV1","origId":336718490210019,"guid":"4e1c1dc9-f424-4f51-9fe5-2271e77d8ab0","subtype":"command","commandType":"auto","position":34.0,"command":"from pyspark.sql.functions import max\nflightData2015.select(max(\"count\")).take(1)","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 69.0 failed 1 times, most recent failure: Lost task 0.0 in stage 69.0 (TID 158, localhost, executor driver): java.lang.NumberFormatException: For input string: &quot;United States&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-102-2579f9f3bee6&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">.</span>functions <span class=\"ansigreen\">import</span> max<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>flightData2015<span class=\"ansiyellow\">.</span>select<span class=\"ansiyellow\">(</span>max<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;count&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>take<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">take</span><span class=\"ansiblue\">(self, num)</span>\n<span class=\"ansigreen\">    427</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">,</span> name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Alice&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">5</span><span class=\"ansiyellow\">,</span> name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Bob&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    428</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 429</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>limit<span class=\"ansiyellow\">(</span>num<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    430</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    431</span>     <span class=\"ansiyellow\">@</span>since<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1.3</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">collect</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">    389</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    390</span>         <span class=\"ansigreen\">with</span> SCCallSiteSync<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_sc<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">as</span> css<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 391</span><span class=\"ansiyellow\">             </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>collectToPython<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    392</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> BatchedSerializer<span class=\"ansiyellow\">(</span>PickleSerializer<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    393</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o997.collectToPython.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 69.0 failed 1 times, most recent failure: Lost task 0.0 in stage 69.0 (TID 158, localhost, executor driver): java.lang.NumberFormatException: For input string: &quot;United States&quot;\n\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.lang.Long.parseLong(Long.java:589)\n\tat java.lang.Long.parseLong(Long.java:631)\n\tat scala.collection.immutable.StringLike$class.toLong(StringLike.scala:230)\n\tat scala.collection.immutable.StringOps.toLong(StringOps.scala:31)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVTypeCast$.castTo(CSVInferSchema.scala:253)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:125)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:94)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:173)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:172)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:327)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:235)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:217)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1442)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1430)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1429)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1429)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1657)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1612)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1601)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1937)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1950)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1963)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:333)\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply$mcI$sp(Dataset.scala:2757)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply(Dataset.scala:2754)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply(Dataset.scala:2754)\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:87)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:70)\n\tat org.apache.spark.sql.Dataset.withNewExecutionId(Dataset.scala:2777)\n\tat org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:2754)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.NumberFormatException: For input string: &quot;United States&quot;\n\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.lang.Long.parseLong(Long.java:589)\n\tat java.lang.Long.parseLong(Long.java:631)\n\tat scala.collection.immutable.StringLike$class.toLong(StringLike.scala:230)\n\tat scala.collection.immutable.StringOps.toLong(StringOps.scala:31)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVTypeCast$.castTo(CSVInferSchema.scala:253)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:125)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:94)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:173)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:172)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:327)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:235)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:217)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n</div>","workflows":[],"startTime":1497633779079,"submitTime":1497633779079,"finishTime":1497633779339,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9fbcd78a-0327-44e1-be0a-7d84cd1b8cd0"},{"version":"CommandV1","origId":336718490210020,"guid":"23617df1-bb87-4385-9dea-1bfebb04fcbe","subtype":"command","commandType":"auto","position":35.0,"command":"%sql\nSELECT DEST_COUNTRY_NAME, sum(count) as destination_total\nFROM summary2015\nGROUP BY DEST_COUNTRY_NAME\nORDER BY sum(count) DESC\nLIMIT 5;","commandVersion":0,"state":"finished","results":{"type":"table","data":[["United States",411352],["Canada",8399],["Mexico",7140],["United Kingdom",2025],["Japan",1548]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"destination_total","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 75.0 failed 1 times, most recent failure: Lost task 0.0 in stage 75.0 (TID 161, localhost, executor driver): java.lang.NumberFormatException: For input string: \"United States\"","error":"<div class=\"ansiout\">\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.lang.Long.parseLong(Long.java:589)\n\tat java.lang.Long.parseLong(Long.java:631)\n\tat scala.collection.immutable.StringLike$class.toLong(StringLike.scala:230)\n\tat scala.collection.immutable.StringOps.toLong(StringOps.scala:31)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVTypeCast$.castTo(CSVInferSchema.scala:253)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:125)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:94)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:173)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:172)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:327)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:235)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:217)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1442)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1430)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1429)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1429)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1657)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1612)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1601)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1937)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2000)\n\tat org.apache.spark.rdd.RDD$$anonfun$reduce$1.apply(RDD.scala:1026)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n\tat org.apache.spark.rdd.RDD.reduce(RDD.scala:1008)\n\tat org.apache.spark.rdd.RDD$$anonfun$takeOrdered$1.apply(RDD.scala:1429)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n\tat org.apache.spark.rdd.RDD.takeOrdered(RDD.scala:1416)\n\tat org.apache.spark.sql.execution.TakeOrderedAndProjectExec.executeCollect(limit.scala:133)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:2807)\n\tat org.apache.spark.sql.Dataset$$anonfun$collect$1.apply(Dataset.scala:2369)\n\tat org.apache.spark.sql.Dataset$$anonfun$collect$1.apply(Dataset.scala:2369)\n\tat org.apache.spark.sql.Dataset$$anonfun$60.apply(Dataset.scala:2791)\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:87)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:70)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:2790)\n\tat org.apache.spark.sql.Dataset.collect(Dataset.scala:2369)\nCaused by: java.lang.NumberFormatException: For input string: &quot;United States&quot;\n\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.lang.Long.parseLong(Long.java:589)\n\tat java.lang.Long.parseLong(Long.java:631)\n\tat scala.collection.immutable.StringLike$class.toLong(StringLike.scala:230)\n\tat scala.collection.immutable.StringOps.toLong(StringOps.scala:31)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVTypeCast$.castTo(CSVInferSchema.scala:253)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:125)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:94)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:173)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:172)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:327)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:235)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:217)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)</div>","workflows":[],"startTime":1497634015622,"submitTime":1497634015614,"finishTime":1497634016355,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d1b9aef9-e75b-4262-b1b5-5ceba6b9b1eb"},{"version":"CommandV1","origId":336718490210021,"guid":"fb7b2048-c1b1-4bca-a82e-9d5f18835eb6","subtype":"command","commandType":"auto","position":36.0,"command":"%scala\nimport org.apache.spark.sql.functions.desc\nflightData2015\n.groupBy(\"DEST_COUNTRY_NAME\")\n.sum(\"count\")\n.withColumnRenamed(\"sum(count)\", \"destination_total\")\n.sort(desc(\"destination_total\"))\n.limit(5)\n.collect()","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 85.0 failed 1 times, most recent failure: Lost task 0.0 in stage 85.0 (TID 367, localhost, executor driver): java.lang.NumberFormatException: For input string: \"United States\"","error":"<div class=\"ansiout\">\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.lang.Long.parseLong(Long.java:589)\n\tat java.lang.Long.parseLong(Long.java:631)\n\tat scala.collection.immutable.StringLike$class.toLong(StringLike.scala:230)\n\tat scala.collection.immutable.StringOps.toLong(StringOps.scala:31)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVTypeCast$.castTo(CSVInferSchema.scala:253)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:125)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:94)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:173)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:172)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:327)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:235)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:217)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1442)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1430)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1429)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1429)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1657)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1612)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1601)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1937)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2000)\n\tat org.apache.spark.rdd.RDD$$anonfun$reduce$1.apply(RDD.scala:1026)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n\tat org.apache.spark.rdd.RDD.reduce(RDD.scala:1008)\n\tat org.apache.spark.rdd.RDD$$anonfun$takeOrdered$1.apply(RDD.scala:1429)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n\tat org.apache.spark.rdd.RDD.takeOrdered(RDD.scala:1416)\n\tat org.apache.spark.sql.execution.TakeOrderedAndProjectExec.executeCollect(limit.scala:133)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:2807)\n\tat org.apache.spark.sql.Dataset$$anonfun$collect$1.apply(Dataset.scala:2369)\n\tat org.apache.spark.sql.Dataset$$anonfun$collect$1.apply(Dataset.scala:2369)\n\tat org.apache.spark.sql.Dataset$$anonfun$60.apply(Dataset.scala:2791)\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:87)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:70)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:2790)\n\tat org.apache.spark.sql.Dataset.collect(Dataset.scala:2369)\nCaused by: java.lang.NumberFormatException: For input string: &quot;United States&quot;\n\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.lang.Long.parseLong(Long.java:589)\n\tat java.lang.Long.parseLong(Long.java:631)\n\tat scala.collection.immutable.StringLike$class.toLong(StringLike.scala:230)\n\tat scala.collection.immutable.StringOps.toLong(StringOps.scala:31)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVTypeCast$.castTo(CSVInferSchema.scala:253)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:125)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:94)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:173)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:172)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:327)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:235)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:217)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)</div>","workflows":[],"startTime":1497634225444,"submitTime":1497634225444,"finishTime":1497634225674,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e84b3993-6365-4618-8b82-a74c45019845"},{"version":"CommandV1","origId":336718490210022,"guid":"be6e7011-f976-40bb-b7dc-89441ed75593","subtype":"command","commandType":"auto","position":37.0,"command":"from pyspark.sql.functions import desc\nflightData2015\\\n.groupBy(\"DEST_COUNTRY_NAME\")\\\n.sum(\"count\")\\\n.withColumnRenamed(\"sum(count)\", \"destination_total\")\\\n.sort(desc(\"destination_total\"))\\\n.limit(5)\\\n.collect()","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 87.0 failed 1 times, most recent failure: Lost task 0.0 in stage 87.0 (TID 368, localhost, executor driver): java.lang.NumberFormatException: For input string: &quot;United States&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-104-c381b01afaa8&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">.</span>functions <span class=\"ansigreen\">import</span> desc<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>flightData2015<span class=\"ansiyellow\">.</span>groupBy<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;DEST_COUNTRY_NAME&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>sum<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;count&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>withColumnRenamed<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;sum(count)&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;destination_total&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>sort<span class=\"ansiyellow\">(</span>desc<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;destination_total&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>limit<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">5</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">collect</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">    389</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    390</span>         <span class=\"ansigreen\">with</span> SCCallSiteSync<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_sc<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">as</span> css<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 391</span><span class=\"ansiyellow\">             </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>collectToPython<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    392</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> BatchedSerializer<span class=\"ansiyellow\">(</span>PickleSerializer<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    393</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o1108.collectToPython.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 87.0 failed 1 times, most recent failure: Lost task 0.0 in stage 87.0 (TID 368, localhost, executor driver): java.lang.NumberFormatException: For input string: &quot;United States&quot;\n\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.lang.Long.parseLong(Long.java:589)\n\tat java.lang.Long.parseLong(Long.java:631)\n\tat scala.collection.immutable.StringLike$class.toLong(StringLike.scala:230)\n\tat scala.collection.immutable.StringOps.toLong(StringOps.scala:31)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVTypeCast$.castTo(CSVInferSchema.scala:253)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:125)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:94)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:173)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:172)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:327)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:235)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:217)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1442)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1430)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1429)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1429)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1657)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1612)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1601)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1937)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2000)\n\tat org.apache.spark.rdd.RDD$$anonfun$reduce$1.apply(RDD.scala:1026)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n\tat org.apache.spark.rdd.RDD.reduce(RDD.scala:1008)\n\tat org.apache.spark.rdd.RDD$$anonfun$takeOrdered$1.apply(RDD.scala:1429)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n\tat org.apache.spark.rdd.RDD.takeOrdered(RDD.scala:1416)\n\tat org.apache.spark.sql.execution.TakeOrderedAndProjectExec.executeCollect(limit.scala:133)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply$mcI$sp(Dataset.scala:2757)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply(Dataset.scala:2754)\n\tat org.apache.spark.sql.Dataset$$anonfun$collectToPython$1.apply(Dataset.scala:2754)\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:87)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:70)\n\tat org.apache.spark.sql.Dataset.withNewExecutionId(Dataset.scala:2777)\n\tat org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:2754)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.NumberFormatException: For input string: &quot;United States&quot;\n\tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.lang.Long.parseLong(Long.java:589)\n\tat java.lang.Long.parseLong(Long.java:631)\n\tat scala.collection.immutable.StringLike$class.toLong(StringLike.scala:230)\n\tat scala.collection.immutable.StringOps.toLong(StringOps.scala:31)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVTypeCast$.castTo(CSVInferSchema.scala:253)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:125)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVRelation$$anonfun$csvParser$3.apply(CSVRelation.scala:94)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:173)\n\tat org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anonfun$buildReader$1$$anonfun$apply$2.apply(CSVFileFormat.scala:172)\n\tat scala.collection.Iterator$$anon$13.hasNext(Iterator.scala:371)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:327)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:235)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1$$anonfun$prepareNextFile$1.apply(FileScanRDD.scala:217)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)\n\tat scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n</div>","workflows":[],"startTime":1497634308643,"submitTime":1497634308643,"finishTime":1497634308893,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"db2e220e-528b-48e7-bcd2-287b3bd39e45"},{"version":"CommandV1","origId":336718490210023,"guid":"3d59555e-a664-4f3e-8388-42559c02d551","subtype":"command","commandType":"auto","position":38.0,"command":"flightData2015\n.groupBy(\"DEST_COUNTRY_NAME\")\n.sum(\"count\")\n.withColumnRenamed(\"sum(count)\", \"destination_total\")\n.sort(desc(\"destination_total\"))\n.limit(5)\n.explain()","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-105-c5f96a7b394d&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">2</span>\n<span class=\"ansiyellow\">    .groupBy(&quot;DEST_COUNTRY_NAME&quot;)</span>\n<span class=\"ansigrey\">    ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1497634349625,"submitTime":1497634349625,"finishTime":1497634349717,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"96106c7d-cd45-44e0-9154-b37bb553f6e6"},{"version":"CommandV1","origId":336718490210024,"guid":"27bd9bad-06b2-457f-9ad1-bf5ad9dc2fec","subtype":"command","commandType":"auto","position":39.0,"command":"%scala\nval df = spark.range(500).toDF(\"number\")\nDataFrames and Datasets | 39\ndf.select(df.col(\"number\") + 10)\n// org.apache.spark.sql.DataFrame = [(number + 10): bigint]","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:36: error: not found: value DataFrames\n              DataFrames and Datasets | 39\n              ^\n</div>","error":null,"workflows":[],"startTime":1497634393649,"submitTime":1497634393649,"finishTime":1497634393690,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"df33b38c-405a-440d-b546-f09630f498e1"},{"version":"CommandV1","origId":336718490210025,"guid":"afcb84af-297c-451f-8d6e-a9a25470ed27","subtype":"command","commandType":"auto","position":40.0,"command":"df = spark.range(500).toDF(\"number\")\ndf.select(df[\"number\"] + 10)\n# DataFrame[(number + 10): bigint]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">106</span><span class=\"ansired\">]: </span>DataFrame[(number + 10): bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634409741,"submitTime":1497634409726,"finishTime":1497634409916,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"10e9e2bd-27f6-40ca-a2e8-a24b1389e2ae"},{"version":"CommandV1","origId":336718490210026,"guid":"dc70c30f-8a55-42b5-9cba-28d829e613b1","subtype":"command","commandType":"auto","position":41.0,"command":"%scala\nspark.range(500)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res19: org.apache.spark.sql.Dataset[Long] = [id: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634434775,"submitTime":1497634434760,"finishTime":1497634435010,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"56436b46-87c5-4e58-8e18-56ad8d94ae1c"},{"version":"CommandV1","origId":336718490210027,"guid":"a79acadd-c710-409a-ada3-d96d8d4eb8fb","subtype":"command","commandType":"auto","position":42.0,"command":"spark.range(500)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">107</span><span class=\"ansired\">]: </span>DataFrame[id: bigint]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634441986,"submitTime":1497634441971,"finishTime":1497634442025,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b2b23ecb-ba00-4014-b984-b80f0ee19228"},{"version":"CommandV1","origId":336718490210028,"guid":"9427b1f5-70c6-4b50-afc6-939d88e5776f","subtype":"command","commandType":"auto","position":43.0,"command":"%scala\nspark.range(2).toDF().collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res20: Array[org.apache.spark.sql.Row] = Array([0], [1])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634451187,"submitTime":1497634451172,"finishTime":1497634451342,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ab9f996b-c021-42aa-a7d6-e9451f9375be"},{"version":"CommandV1","origId":336718490210029,"guid":"203c8b44-49fe-4d3f-84c5-d98ae75c78fa","subtype":"command","commandType":"auto","position":44.0,"command":"spark.range(2).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">108</span><span class=\"ansired\">]: </span>[Row(id=0), Row(id=1)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634464977,"submitTime":1497634464963,"finishTime":1497634465048,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"60f12589-3e4b-4749-8e3d-3c6cb51f0ab2"},{"version":"CommandV1","origId":336718490210030,"guid":"fdb1a202-2651-4ee8-a28a-d407dbfd30d6","subtype":"command","commandType":"auto","position":45.0,"command":"%scala\nimport org.apache.spark.sql.types._\nval b = ByteType()","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:34: error: org.apache.spark.sql.types.ByteType.type does not take parameters\n       val b = ByteType()\n                       ^\n</div>","error":null,"workflows":[],"startTime":1497634496015,"submitTime":1497634496015,"finishTime":1497634496066,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6552ff0e-dad9-4182-8567-0db1e6411743"},{"version":"CommandV1","origId":336718490210031,"guid":"afa8cca2-ebda-4c13-a426-1c0bec097443","subtype":"command","commandType":"auto","position":46.0,"command":"from pyspark.sql.types import *\nb = byteType()","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;byteType&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-110-aaa2be24794e&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">.</span>types <span class=\"ansigreen\">import</span> <span class=\"ansiyellow\">*</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>b <span class=\"ansiyellow\">=</span> byteType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;byteType&apos; is not defined</div>","workflows":[],"startTime":1497634518455,"submitTime":1497634518455,"finishTime":1497634518508,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"38b2b814-2125-44dd-a0af-3755607cb6bb"},{"version":"CommandV1","origId":336718490210032,"guid":"beaa8314-93ab-451b-93ea-677847ffc4d3","subtype":"command","commandType":"auto","position":47.0,"command":"%scala\nval df = spark.read.format(\"json\")\n.load(\"/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df: org.apache.spark.sql.DataFrame = [count: bigint, dest_country_name: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Path does not exist: dbfs:/mnt/defg/flight-data/json/2015-summary.json;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:372)\n\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:360)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:251)\n\tat scala.collection.AbstractTraversable.flatMap(Traversable.scala:105)\n\tat org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:360)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:154)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:148)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:147)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:136)</div>","workflows":[],"startTime":1497634584741,"submitTime":1497634584724,"finishTime":1497634585319,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f74b11c0-e195-4b88-bcf9-db0cf1722186"},{"version":"CommandV1","origId":336718490210033,"guid":"3011d657-dbad-4deb-bdc6-30b6d8645271","subtype":"command","commandType":"auto","position":48.0,"command":"df = spark.read.format(\"json\")\\\n.load(\"/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json\")\ndf.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- count: long (nullable = true)\n |-- dest_country_name: string (nullable = true)\n |-- origin_country_name: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634616286,"submitTime":1497634616271,"finishTime":1497634616509,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2b38d27e-11f4-4738-86e7-9444f1d2665b"},{"version":"CommandV1","origId":336718490210034,"guid":"36639306-07e8-4786-9fa1-334d93aad497","subtype":"command","commandType":"auto","position":49.0,"command":"%scala\nspark.read.format(\"json\")\n.load(\"/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json\")\n.schema","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res22: org.apache.spark.sql.types.StructType = StructType(StructField(count,LongType,true), StructField(dest_country_name,StringType,true), StructField(origin_country_name,StringType,true))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Path does not exist: dbfs:/mnt/defg/flight-data/json/2015-summary.json;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:372)\n\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:360)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:251)\n\tat scala.collection.AbstractTraversable.flatMap(Traversable.scala:105)\n\tat org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:360)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:154)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:148)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:147)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:136)</div>","workflows":[],"startTime":1497634644096,"submitTime":1497634644080,"finishTime":1497634644566,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fc6bb18c-668e-4e6f-9a3d-b807f4902e0a"},{"version":"CommandV1","origId":336718490210035,"guid":"472772c0-bae6-41bf-8ab6-b0b7c0fb424f","subtype":"command","commandType":"auto","position":50.0,"command":"spark.read.format(\"json\")\\\n.load(\"/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json\")\\\n.schema","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">114</span><span class=\"ansired\">]: </span>StructType(List(StructField(count,LongType,true),StructField(dest_country_name,StringType,true),StructField(origin_country_name,StringType,true)))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/flight-data/json/2015-summary.json;&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-113-95572b5ffc6c&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>spark<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;json&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;/mnt/defg/flight-data/json/2015-summary.json&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>schema<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/readwriter.py</span> in <span class=\"ansicyan\">load</span><span class=\"ansiblue\">(self, path, format, schema, **options)</span>\n<span class=\"ansigreen\">    147</span>         self<span class=\"ansiyellow\">.</span>options<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">**</span>options<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    148</span>         <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">,</span> basestring<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 149</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_df<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jreader<span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    150</span>         <span class=\"ansigreen\">elif</span> path <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    151</span>             <span class=\"ansigreen\">if</span> type<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">!=</span> list<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/flight-data/json/2015-summary.json;&apos;</div>","workflows":[],"startTime":1497634665915,"submitTime":1497634665898,"finishTime":1497634666137,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"21514d7f-9cbf-43c8-8b0a-44693470a953"},{"version":"CommandV1","origId":336718490210036,"guid":"c58fb8f2-3f74-415c-8570-3a53a38339ae","subtype":"command","commandType":"auto","position":51.0,"command":"%scala\nimport org.apache.spark.sql.types.{StructField, StructType, StringType, LongType}\nval myManualSchema = new StructType(Array(\nnew StructField(\"DEST_COUNTRY_NAME\", StringType, true),\nnew StructField(\"ORIGIN_COUNTRY_NAME\", StringType, true),\nnew StructField(\"count\", LongType, false) // just to illustrate flipping this flag\n))\nval df = spark.read.format(\"json\")\n.schema(myManualSchema)\n.load(\"/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.types.{StructField, StructType, StringType, LongType}\nmyManualSchema: org.apache.spark.sql.types.StructType = StructType(StructField(DEST_COUNTRY_NAME,StringType,true), StructField(ORIGIN_COUNTRY_NAME,StringType,true), StructField(count,LongType,false))\ndf: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, ORIGIN_COUNTRY_NAME: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634694060,"submitTime":1497634694052,"finishTime":1497634694288,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b634bf79-d9ff-451f-982c-d5aa320ac91b"},{"version":"CommandV1","origId":336718490210037,"guid":"0fe8c82d-9e72-4f25-9ceb-3f437d4d61dd","subtype":"command","commandType":"auto","position":52.0,"command":"from pyspark.sql.types import StructField, StructType, StringType, LongType\nmyManualSchema = StructType([\nStructField(\"DEST_COUNTRY_NAME\", StringType(), True),\nStructField(\"ORIGIN_COUNTRY_NAME\", StringType(), True),\nStructField(\"count\", LongType(), False)\n])\ndf = spark.read.format(\"json\")\\\n.schema(myManualSchema)\\\n.load(\"/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634718876,"submitTime":1497634718858,"finishTime":1497634719050,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e6159c65-fd97-4088-a492-cb880ad2da27"},{"version":"CommandV1","origId":336718490210038,"guid":"193edea2-62c3-4960-a7b1-c78db3cdc62a","subtype":"command","commandType":"auto","position":53.0,"command":"%scala\nimport org.apache.spark.sql.functions.{col, column}\ncol(\"someColumnName\")\ncolumn(\"someColumnName\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.{col, column}\nres23: org.apache.spark.sql.Column = someColumnName\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634735102,"submitTime":1497634735086,"finishTime":1497634735175,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"399ed3d8-9575-4a2e-978e-e612e2bf4aff"},{"version":"CommandV1","origId":336718490210039,"guid":"24269cbb-8b73-463e-94e0-63e9c350de9e","subtype":"command","commandType":"auto","position":54.0,"command":"from pyspark.sql.functions import col, column\ncol(\"someColumnName\")\ncolumn(\"someColumnName\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">116</span><span class=\"ansired\">]: </span>Column&lt;someColumnName&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634746331,"submitTime":1497634746315,"finishTime":1497634746370,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b16a0f53-26a0-4014-8762-223a11f38a3e"},{"version":"CommandV1","origId":336718490210040,"guid":"9185ccb2-177e-476d-964d-1716da9b0386","subtype":"command","commandType":"auto","position":55.0,"command":"%scala\n$\"myColumn\"\n'myColumn","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res24: Symbol = 'myColumn\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634759138,"submitTime":1497634759121,"finishTime":1497634759238,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"92cef0d3-d7da-4f1f-b8b9-c2102751fa6f"},{"version":"CommandV1","origId":336718490210041,"guid":"7fa7916a-b853-4936-b024-0470ea78f8b6","subtype":"command","commandType":"auto","position":56.0,"command":"%scala\nimport org.apache.spark.sql.functions.expr\nexpr(\"(((someCol + 5) * 200) - 6) < otherCol\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.expr\nres25: org.apache.spark.sql.Column = ((((someCol + 5) * 200) - 6) &lt; otherCol)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;DataFrame&apos; object has no attribute &apos;col&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-117-b0319c07dbeb&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>df<span class=\"ansiyellow\">.</span>col<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;count&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">__getattr__</span><span class=\"ansiblue\">(self, name)</span>\n<span class=\"ansigreen\">    971</span>         <span class=\"ansigreen\">if</span> name <span class=\"ansigreen\">not</span> <span class=\"ansigreen\">in</span> self<span class=\"ansiyellow\">.</span>columns<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    972</span>             raise AttributeError(\n<span class=\"ansigreen\">--&gt; 973</span><span class=\"ansiyellow\">                 &quot;&apos;%s&apos; object has no attribute &apos;%s&apos;&quot; % (self.__class__.__name__, name))\n</span><span class=\"ansigreen\">    974</span>         jc <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>apply<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    975</span>         <span class=\"ansigreen\">return</span> Column<span class=\"ansiyellow\">(</span>jc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;DataFrame&apos; object has no attribute &apos;col&apos;</div>","workflows":[],"startTime":1497634797468,"submitTime":1497634797447,"finishTime":1497634797544,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"774c1b9b-3d2b-40f6-9651-3053dee03ece"},{"version":"CommandV1","origId":336718490210042,"guid":"c80ba86a-7248-4724-b7aa-f816629fa52e","subtype":"command","commandType":"auto","position":57.0,"command":"from pyspark.sql.functions import expr\nexpr(\"(((someCol + 5) * 200) - 6) < otherCol\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">118</span><span class=\"ansired\">]: </span>Column&lt;((((someCol + 5) * 200) - 6) &lt; otherCol)&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634806971,"submitTime":1497634806964,"finishTime":1497634806994,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f68583f6-1629-4e95-baaa-f29c92102662"},{"version":"CommandV1","origId":336718490210043,"guid":"c427548f-a599-4a09-aae8-c764a581d5b0","subtype":"command","commandType":"auto","position":58.0,"command":"%scala\nspark.read.format(\"json\")\n.load(\"/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json\")\n.columns","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res26: Array[String] = Array(count, dest_country_name, origin_country_name)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-120-c7ca0af210ed&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">2</span>\n<span class=\"ansiyellow\">    .load(&quot;/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json&quot;)</span>\n<span class=\"ansigrey\">    ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1497634880065,"submitTime":1497634880059,"finishTime":1497634880287,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1b94b707-5e6d-4cc1-8a12-b585a147026b"},{"version":"CommandV1","origId":336718490210044,"guid":"d6763670-f8c8-49ed-ac7b-54be698b96a8","subtype":"command","commandType":"auto","position":59.0,"command":"%scala\ndf.first()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res27: org.apache.spark.sql.Row = [null,null,15]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634889619,"submitTime":1497634889612,"finishTime":1497634889795,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"87c30533-d7f0-4f03-82d4-05f38027b9a9"},{"version":"CommandV1","origId":336718490210045,"guid":"d27dc4d2-172c-4596-b16f-11cb623741f0","subtype":"command","commandType":"auto","position":60.0,"command":"df.first()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">121</span><span class=\"ansired\">]: </span>Row(DEST_COUNTRY_NAME=None, ORIGIN_COUNTRY_NAME=None, count=15)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634899531,"submitTime":1497634899514,"finishTime":1497634899703,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"de79a856-4f5a-4c6c-8c51-03af44d744ab"},{"version":"CommandV1","origId":336718490210046,"guid":"ac7ca31e-b9b0-4fbd-b06c-d5ac2eaabb50","subtype":"command","commandType":"auto","position":61.0,"command":"%scala\nimport org.apache.spark.sql.Row\nval myRow = Row(\"Hello\", null, 1, false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.Row\nmyRow: org.apache.spark.sql.Row = [Hello,null,1,false]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634914104,"submitTime":1497634914087,"finishTime":1497634914168,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dec3210a-bdc4-4b13-abb3-9348aa9829c2"},{"version":"CommandV1","origId":336718490210047,"guid":"f92cbf16-8d27-471f-a57e-f4bbecaaa8bc","subtype":"command","commandType":"auto","position":62.0,"command":"from pyspark.sql import Row\nmyRow = Row(\"Hello\", None, 1, False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634923992,"submitTime":1497634923970,"finishTime":1497634924030,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"22eaa0a9-5633-4a2f-aa9f-4803dbedff4a"},{"version":"CommandV1","origId":336718490210048,"guid":"bd7dd4ae-5eab-4a3d-8a9d-a5d594ace67d","subtype":"command","commandType":"auto","position":63.0,"command":"%scala\nmyRow(0) // type Any\nmyRow(0).asInstanceOf[String] // String\nmyRow.getString(0) // String\nmyRow.getInt(2) // String","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res28: Int = 1\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634935990,"submitTime":1497634935974,"finishTime":1497634936051,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ba813fb9-a978-4eee-9eac-b82370ae8403"},{"version":"CommandV1","origId":336718490210049,"guid":"d2cee09b-e8b4-44eb-828d-424f63155fc4","subtype":"command","commandType":"auto","position":64.0,"command":"myRow[0]\nmyRow[2]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">123</span><span class=\"ansired\">]: </span>1\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497634945884,"submitTime":1497634945867,"finishTime":1497634945907,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"06b77630-4ac7-4ab6-86bc-763104966c3d"},{"version":"CommandV1","origId":336718490210050,"guid":"fbe68a4e-e58e-4483-a567-614843f7170f","subtype":"command","commandType":"auto","position":65.0,"command":"%scala\nval df = spark.read.format(\"json\")\n.load(\"/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json\")\ndf.createOrReplaceTempView(\"dfTable\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df: org.apache.spark.sql.DataFrame = [count: bigint, dest_country_name: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Path does not exist: dbfs:/mnt/defg/flight-data/json/2015-summary.json;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:372)\n\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:360)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:251)\n\tat scala.collection.AbstractTraversable.flatMap(Traversable.scala:105)\n\tat org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:360)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:154)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:148)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:147)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:136)</div>","workflows":[],"startTime":1497634976198,"submitTime":1497634976180,"finishTime":1497634976565,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d3dbf7d8-6f9c-4ad0-907f-1f0b73b7853b"},{"version":"CommandV1","origId":336718490210051,"guid":"4e765a3e-0448-4cd2-8407-433e83a93a9a","subtype":"command","commandType":"auto","position":66.0,"command":"df = spark.read.format(\"json\")\\\n.load(\"/FileStore/tables/8su3wraj1497632771405/2015_summary-ebaee.json\")\ndf.createOrReplaceTempView(\"dfTable\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/flight-data/json/2015-summary.json;&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-124-cc44fa29f0cb&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>df <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;json&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;/mnt/defg/flight-data/json/2015-summary.json&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> df<span class=\"ansiyellow\">.</span>createOrReplaceTempView<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;dfTable&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/readwriter.py</span> in <span class=\"ansicyan\">load</span><span class=\"ansiblue\">(self, path, format, schema, **options)</span>\n<span class=\"ansigreen\">    147</span>         self<span class=\"ansiyellow\">.</span>options<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">**</span>options<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    148</span>         <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">,</span> basestring<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 149</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_df<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jreader<span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    150</span>         <span class=\"ansigreen\">elif</span> path <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    151</span>             <span class=\"ansigreen\">if</span> type<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">!=</span> list<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/flight-data/json/2015-summary.json;&apos;</div>","workflows":[],"startTime":1497634998106,"submitTime":1497634998084,"finishTime":1497634998330,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b1bb4b66-5467-46d7-aac1-4b1832910dea"},{"version":"CommandV1","origId":336718490210052,"guid":"4ae50393-7ef6-40f7-9017-b97f1d0db743","subtype":"command","commandType":"auto","position":67.0,"command":"%scala\nimport org.apache.spark.sql.Row\nimport org.apache.spark.sql.types.{StructField, StructType,\nStringType, LongType}\nval myManualSchema = new StructType(Array(\nnew StructField(\"some\", StringType, true),\nnew StructField(\"col\", StringType, true),\nnew StructField(\"names\", LongType, false) // just to illustrate flipping this flag\n))\nval myRows = Seq(Row(\"Hello\", null, 1L))\nval myRDD = spark.sparkContext.parallelize(myRows)\nval myDf = spark.createDataFrame(myRDD, myManualSchema)\nmyDf.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+----+-----+\n| some| col|names|\n+-----+----+-----+\n|Hello|null|    1|\n+-----+----+-----+\n\nimport org.apache.spark.sql.Row\nimport org.apache.spark.sql.types.{StructField, StructType, StringType, LongType}\nmyManualSchema: org.apache.spark.sql.types.StructType = StructType(StructField(some,StringType,true), StructField(col,StringType,true), StructField(names,LongType,false))\nmyRows: Seq[org.apache.spark.sql.Row] = List([Hello,null,1])\nmyRDD: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = ParallelCollectionRDD[317] at parallelize at &lt;console&gt;:50\nmyDf: org.apache.spark.sql.DataFrame = [some: string, col: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635013146,"submitTime":1497635013140,"finishTime":1497635013516,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c9ee8d58-7d0e-4840-b5ea-3bb36cc84184"},{"version":"CommandV1","origId":336718490210053,"guid":"a7d05cb2-8dcb-424d-b7a6-60c718ffc0b6","subtype":"command","commandType":"auto","position":68.0,"command":"%scala\nval myDF = Seq((\"Hello\", 2, 1L)).toDF()\n%python\nfrom pyspark.sql import Row\nfrom pyspark.sql.types import StructField, StructType,\\\nStringType, LongType\nmyManualSchema = StructType([\nStructField(\"some\", StringType(), True),\nStructField(\"col\", StringType(), True),\nStructField(\"names\", LongType(), False)\n])\nmyRow = Row(\"Hello\", None, 1)\nmyDf = spark.createDataFrame([myRow], myManualSchema)\nmyDf.show()","commandVersion":0,"state":"error","results":null,"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:4: error: ';' expected but '.' found.\n       from pyspark.sql import Row\n                   ^\n&lt;console&gt;:5: error: ';' expected but '.' found.\n       from pyspark.sql.types import StructField, StructType,\\\n                   ^\n&lt;console&gt;:6: error: ';' expected but ',' found.\n       StringType, LongType\n                 ^\n&lt;console&gt;:7: error: illegal start of simple expression\n       myManualSchema = StructType([\n                                   ^\n</div>","error":null,"workflows":[],"startTime":1497635028147,"submitTime":1497635028147,"finishTime":1497635028179,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0300df6e-f498-47d2-9309-627fc0b48b81"},{"version":"CommandV1","origId":336718490210054,"guid":"80668a08-dd69-44cd-8da8-62ef3ed0e12d","subtype":"command","commandType":"auto","position":69.0,"command":"%scala\ndf.select(\"DEST_COUNTRY_NAME\").show(2)\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------------+\n|DEST_COUNTRY_NAME|\n+-----------------+\n|    United States|\n|    United States|\n+-----------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:47: error: not found: value %\n              %python\n              ^\n</div>","error":null,"workflows":[],"startTime":1497635145104,"submitTime":1497635145097,"finishTime":1497635145344,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1b629972-4116-4414-a888-a64e77dba948"},{"version":"CommandV1","origId":336718490210055,"guid":"294b1acc-d1db-46db-bd6e-337b1906fecb","subtype":"command","commandType":"auto","position":70.0,"command":"%python\ndf.select(\"DEST_COUNTRY_NAME\").show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------------+\n|DEST_COUNTRY_NAME|\n+-----------------+\n|    United States|\n|    United States|\n+-----------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635149387,"submitTime":1497635149381,"finishTime":1497635149511,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b7c62ecd-668c-4e9f-b52a-47f7e4697f25"},{"version":"CommandV1","origId":336718490210056,"guid":"65d27b82-aac9-4e4f-8eef-8b16719150e8","subtype":"command","commandType":"auto","position":71.0,"command":"%sql\nSELECT DEST_COUNTRY_NAME\nFROM dfTable\nLIMIT 2","commandVersion":0,"state":"finished","results":{"type":"table","data":[["United States"],["United States"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635159809,"submitTime":1497635159792,"finishTime":1497635159900,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"90d6c016-9dbf-46b0-bc88-6811d958282b"},{"version":"CommandV1","origId":336718490210057,"guid":"8ed5685e-d439-4b24-993b-9a4098c1078c","subtype":"command","commandType":"auto","position":72.0,"command":"%scala\ndf.select(\n\"DEST_COUNTRY_NAME\",\n\"ORIGIN_COUNTRY_NAME\")\n.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------------+-------------------+\n|DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|\n+-----------------+-------------------+\n|    United States|            Romania|\n|    United States|            Croatia|\n+-----------------+-------------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635172979,"submitTime":1497635172961,"finishTime":1497635173196,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bb3293d6-be49-4d04-a613-06e09a127469"},{"version":"CommandV1","origId":336718490210058,"guid":"6b755ab7-c192-4ccd-9e8f-4afe9646ba10","subtype":"command","commandType":"auto","position":73.0,"command":"%python\ndf.select(\n\"DEST_COUNTRY_NAME\",\n\"ORIGIN_COUNTRY_NAME\")\\\n.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------------+-------------------+\n|DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|\n+-----------------+-------------------+\n|    United States|            Romania|\n|    United States|            Croatia|\n+-----------------+-------------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635182049,"submitTime":1497635182031,"finishTime":1497635182220,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1ad3fdeb-b019-463b-88dd-7d86262d2072"},{"version":"CommandV1","origId":336718490210059,"guid":"fd430393-fea3-49c3-921b-b1ad79d4652b","subtype":"command","commandType":"auto","position":74.0,"command":"%sql\nSELECT\nDEST_COUNTRY_NAME,\nORIGIN_COUNTRY_NAME\nFROM\ndfTable\nLIMIT 2","commandVersion":0,"state":"finished","results":{"type":"table","data":[["United States","Romania"],["United States","Croatia"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEST_COUNTRY_NAME","type":"\"string\"","metadata":"{}"},{"name":"ORIGIN_COUNTRY_NAME","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635190760,"submitTime":1497635190734,"finishTime":1497635190848,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"43e74346-d580-4e56-8a19-10c46ed09d3a"},{"version":"CommandV1","origId":336718490210060,"guid":"626ef4fd-0b93-4d66-9c7b-77e86d212b30","subtype":"command","commandType":"auto","position":75.0,"command":"%scala\nimport org.apache.spark.sql.functions.{expr, col, column}\ndf.select(\ndf.col(\"DEST_COUNTRY_NAME\"),\ncol(\"DEST_COUNTRY_NAME\"),\ncolumn(\"DEST_COUNTRY_NAME\"),\n'DEST_COUNTRY_NAME,\n$\"DEST_COUNTRY_NAME\",\n  expr(\"DEST_COUNTRY_NAME\")\n).show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+\n|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|\n+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+\n|    United States|    United States|    United States|    United States|    United States|    United States|\n|    United States|    United States|    United States|    United States|    United States|    United States|\n+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+\nonly showing top 2 rows\n\nimport org.apache.spark.sql.functions.{expr, col, column}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635217192,"submitTime":1497635217174,"finishTime":1497635217471,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f1bf3811-0d64-49e2-b81c-c368dc17cccf"},{"version":"CommandV1","origId":336718490210061,"guid":"9208df48-8cd0-4485-846c-467848a224ef","subtype":"command","commandType":"auto","position":76.0,"command":"from pyspark.sql.functions import expr, col, column\ndf.select(\nexpr(\"DEST_COUNTRY_NAME\"),\ncol(\"DEST_COUNTRY_NAME\"),\ncolumn(\"DEST_COUNTRY_NAME\"))\\\n.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------------+-----------------+-----------------+\n|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|DEST_COUNTRY_NAME|\n+-----------------+-----------------+-----------------+\n|    United States|    United States|    United States|\n|    United States|    United States|    United States|\n+-----------------+-----------------+-----------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635229635,"submitTime":1497635229616,"finishTime":1497635229818,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"46099fa5-a197-4dcd-9c2e-577501e39b8e"},{"version":"CommandV1","origId":336718490210062,"guid":"33c319d5-72fe-4d33-9f84-c23895b0ea80","subtype":"command","commandType":"auto","position":77.0,"command":"%scala\ndf.select(expr(\"DEST_COUNTRY_NAME AS destination\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res36: org.apache.spark.sql.DataFrame = [destination: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635238955,"submitTime":1497635238938,"finishTime":1497635239024,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"53ddb2a6-1a45-47b1-a0fd-da1746379810"},{"version":"CommandV1","origId":336718490210063,"guid":"0849cc9c-8222-4419-96a1-e5247b907b92","subtype":"command","commandType":"auto","position":78.0,"command":"%python\ndf.select(expr(\"DEST_COUNTRY_NAME AS destination\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">129</span><span class=\"ansired\">]: </span>DataFrame[destination: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635250334,"submitTime":1497635250316,"finishTime":1497635250405,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"76dc5a32-881d-4d4e-b22f-fea1b2879ddb"},{"version":"CommandV1","origId":336718490210064,"guid":"9fc45d7d-71c8-4e10-96fc-1c0efd232ec8","subtype":"command","commandType":"auto","position":79.0,"command":"%sql\nSELECT\nDEST_COUNTRY_NAME as destination\nFROM\ndfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[["United States"],["United States"],["United States"],["Egypt"],["United States"],["United States"],["United States"],["Costa Rica"],["Senegal"],["Moldova"],["United States"],["United States"],["Guyana"],["Malta"],["Anguilla"],["Bolivia"],["United States"],["Algeria"],["Turks and Caicos Islands"],["United States"],["Saint Vincent and the Grenadines"],["Italy"],["United States"],["United States"],["Pakistan"],["United States"],["Iceland"],["Marshall Islands"],["Luxembourg"],["Honduras"],["The Bahamas"],["United States"],["El Salvador"],["Samoa"],["United States"],["Switzerland"],["United States"],["Sint Maarten"],["Hong Kong"],["Trinidad and Tobago"],["Latvia"],["United States"],["Suriname"],["Mexico"],["United States"],["Ecuador"],["United States"],["United States"],["United States"],["United States"],["Colombia"],["United States"],["United States"],["Norway"],["United States"],["United States"],["Thailand"],["United States"],["Venezuela"],["United States"],["United States"],["Panama"],["Antigua and Barbuda"],["United States"],["Morocco"],["United States"],["Azerbaijan"],["United States"],["United States"],["New Zealand"],["Liberia"],["United States"],["Hungary"],["United States"],["United States"],["Burkina Faso"],["Sweden"],["United States"],["United States"],["United States"],["Israel"],["United States"],["Ethiopia"],["United States"],["United States"],["Martinique"],["United States"],["Saint Barthelemy"],["Barbados"],["United States"],["Djibouti"],["United States"],["United States"],["Germany"],["United States"],["United States"],["Ireland"],["United States"],["Zambia"],["Malaysia"],["United States"],["United States"],["United States"],["United States"],["United States"],["Croatia"],["United States"],["Cyprus"],["United States"],["Fiji"],["Qatar"],["Saint Kitts and Nevis"],["Kuwait"],["Taiwan"],["Haiti"],["Canada"],["Federated States of Micronesia"],["United States"],["Jamaica"],["United States"],["Dominican Republic"],["Japan"],["United States"],["Finland"],["United States"],["United States"],["United States"],["United States"],["Aruba"],["French Guiana"],["United States"],["India"],["British Virgin Islands"],["Brazil"],["United States"],["United States"],["French Polynesia"],["United Arab Emirates"],["Singapore"],["United States"],["United States"],["Netherlands"],["United States"],["United States"],["United States"],["Denmark"],["China"],["United States"],["United States"],["United States"],["United States"],["Cayman Islands"],["Argentina"],["Peru"],["South Africa"],["United States"],["United States"],["Spain"],["Bermuda"],["United States"],["United States"],["United States"],["Kiribati"],["Saudi Arabia"],["Czech Republic"],["United States"],["Belgium"],["United States"],["United States"],["United States"],["Curacao"],["Georgia"],["United States"],["United States"],["Philippines"],["Grenada"],["Cape Verde"],["Cote d'Ivoire"],["Ukraine"],["United States"],["Russia"],["United States"],["Guatemala"],["Saint Lucia"],["Paraguay"],["United States"],["Kosovo"],["United States"],["Tunisia"],["United States"],["Niger"],["Turkey"],["United Kingdom"],["Romania"],["United States"],["Papua New Guinea"],["United States"],["Iraq"],["United States"],["Cuba"],["United States"],["Dominica"],["United States"],["Portugal"],["United States"],["Bahrain"],["United States"],["Indonesia"],["United States"],["United States"],["Belize"],["United States"],["United States"],["United States"],["United States"],["United States"],["United States"],["Nicaragua"],["United States"],["United States"],["United States"],["United States"],["United States"],["Austria"],["Jordan"],["Palau"],["South Korea"],["Angola"],["Ghana"],["New Caledonia"],["Guadeloupe"],["France"],["Poland"],["Nigeria"],["United States"],["Greenland"],["United States"],["Chile"],["United States"],["United States"],["United States"],["United States"],["United States"],["Australia"],["United States"],["United States"],["United States"],["United States"],["United States"],["Cook Islands"],["Bulgaria"],["United States"],["Uruguay"],["United States"],["Bonaire, Sint Eustatius, and Saba"],["Greece"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"destination","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635258992,"submitTime":1497635258972,"finishTime":1497635259148,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a771c665-506e-4e7c-af88-ae9a7faf4719"},{"version":"CommandV1","origId":336718490210065,"guid":"1f07ce9a-5f08-4720-aba0-5276d85787b3","subtype":"command","commandType":"auto","position":80.0,"command":"%scala\ndf.select(\nexpr(\"DEST_COUNTRY_NAME as destination\").alias(\"DEST_COUNTRY_NAME\")\n)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res37: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635269430,"submitTime":1497635269411,"finishTime":1497635269510,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1373bb4c-05a3-4822-a722-4e2480981457"},{"version":"CommandV1","origId":336718490210066,"guid":"7acd7c62-fd0d-4fa8-9b81-970d3e6b739a","subtype":"command","commandType":"auto","position":81.0,"command":"df.select(\nexpr(\"DEST_COUNTRY_NAME as destination\").alias(\"DEST_COUNTRY_NAME\")\n)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">130</span><span class=\"ansired\">]: </span>DataFrame[DEST_COUNTRY_NAME: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635278424,"submitTime":1497635278401,"finishTime":1497635278463,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"83af25f8-0c64-4ab5-bac0-bf654b816934"},{"version":"CommandV1","origId":336718490210067,"guid":"26421034-eaed-4609-a7e7-d545aa210010","subtype":"command","commandType":"auto","position":82.0,"command":"%scala\ndf.selectExpr(\n\"DEST_COUNTRY_NAME as newColumnName\",\n\"DEST_COUNTRY_NAME\")\n.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------+-----------------+\n|newColumnName|DEST_COUNTRY_NAME|\n+-------------+-----------------+\n|United States|    United States|\n|United States|    United States|\n+-------------+-----------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635287020,"submitTime":1497635287000,"finishTime":1497635287187,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"928ab8ac-e08a-4598-b8a5-efc8ada6d657"},{"version":"CommandV1","origId":336718490210068,"guid":"f3b8f619-0ced-48f9-b3aa-8d8809f32b6a","subtype":"command","commandType":"auto","position":83.0,"command":"df.selectExpr(\n\"DEST_COUNTRY_NAME as newColumnName\",\n\"DEST_COUNTRY_NAME\"\n).show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------+-----------------+\n|newColumnName|DEST_COUNTRY_NAME|\n+-------------+-----------------+\n|United States|    United States|\n|United States|    United States|\n+-------------+-----------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635295981,"submitTime":1497635295962,"finishTime":1497635296203,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"20dd3a8f-d1bc-451b-9eb0-51b138036191"},{"version":"CommandV1","origId":336718490210069,"guid":"de535cac-c6e8-44f3-b368-7f54cddcec42","subtype":"command","commandType":"auto","position":84.0,"command":"%scala\ndf.selectExpr(\n\"*\", // all original columns\n\"(DEST_COUNTRY_NAME = ORIGIN_COUNTRY_NAME) as withinCountry\"\n).show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+-------------+\n|count|dest_country_name|origin_country_name|withinCountry|\n+-----+-----------------+-------------------+-------------+\n|   15|    United States|            Romania|        false|\n|    1|    United States|            Croatia|        false|\n+-----+-----------------+-------------------+-------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635304737,"submitTime":1497635304718,"finishTime":1497635304951,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"60fad0c4-fedf-4996-9f9b-bbdd7b2ed862"},{"version":"CommandV1","origId":336718490210070,"guid":"612e866e-7b80-4cbd-bdb5-02320155fa5f","subtype":"command","commandType":"auto","position":85.0,"command":"df.selectExpr(\n\"*\", # all original columns\n\"(DEST_COUNTRY_NAME = ORIGIN_COUNTRY_NAME) as withinCountry\")\\\n.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+-------------+\n|count|dest_country_name|origin_country_name|withinCountry|\n+-----+-----------------+-------------------+-------------+\n|   15|    United States|            Romania|        false|\n|    1|    United States|            Croatia|        false|\n+-----+-----------------+-------------------+-------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635314038,"submitTime":1497635314019,"finishTime":1497635314270,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9c63ce15-b7a5-4f57-a6c1-4af33da7e617"},{"version":"CommandV1","origId":336718490210071,"guid":"3f73b5e7-3b0d-4847-95e5-939093ffba75","subtype":"command","commandType":"auto","position":86.0,"command":"%sql\nSELECT\n*,\n(DEST_COUNTRY_NAME = ORIGIN_COUNTRY_NAME) as withinCountry\nFROM\ndfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[15,"United States","Romania",false],[1,"United States","Croatia",false],[344,"United States","Ireland",false],[15,"Egypt","United States",false],[62,"United States","India",false],[1,"United States","Singapore",false],[62,"United States","Grenada",false],[588,"Costa Rica","United States",false],[40,"Senegal","United States",false],[1,"Moldova","United States",false],[325,"United States","Sint Maarten",false],[39,"United States","Marshall Islands",false],[64,"Guyana","United States",false],[1,"Malta","United States",false],[41,"Anguilla","United States",false],[30,"Bolivia","United States",false],[6,"United States","Paraguay",false],[4,"Algeria","United States",false],[230,"Turks and Caicos Islands","United States",false],[1,"United States","Gibraltar",false],[1,"Saint Vincent and the Grenadines","United States",false],[382,"Italy","United States",false],[69,"United States","Federated States of Micronesia",false],[161,"United States","Russia",false],[12,"Pakistan","United States",false],[660,"United States","Netherlands",false],[181,"Iceland","United States",false],[42,"Marshall Islands","United States",false],[155,"Luxembourg","United States",false],[362,"Honduras","United States",false],[955,"The Bahamas","United States",false],[42,"United States","Senegal",false],[561,"El Salvador","United States",false],[25,"Samoa","United States",false],[13,"United States","Angola",false],[294,"Switzerland","United States",false],[38,"United States","Anguilla",false],[325,"Sint Maarten","United States",false],[332,"Hong Kong","United States",false],[211,"Trinidad and Tobago","United States",false],[19,"Latvia","United States",false],[300,"United States","Ecuador",false],[1,"Suriname","United States",false],[7140,"Mexico","United States",false],[1,"United States","Cyprus",false],[268,"Ecuador","United States",false],[134,"United States","Portugal",false],[608,"United States","Costa Rica",false],[318,"United States","Guatemala",false],[34,"United States","Suriname",false],[873,"Colombia","United States",false],[14,"United States","Cape Verde",false],[712,"United States","Jamaica",false],[121,"Norway","United States",false],[3,"United States","Malaysia",false],[19,"United States","Morocco",false],[3,"Thailand","United States",false],[25,"United States","Samoa",false],[290,"Venezuela","United States",false],[31,"United States","Palau",false],[246,"United States","Venezuela",false],[510,"Panama","United States",false],[126,"Antigua and Barbuda","United States",false],[185,"United States","Chile",false],[15,"Morocco","United States",false],[28,"United States","Finland",false],[21,"Azerbaijan","United States",false],[23,"United States","Greece",false],[986,"United States","The Bahamas",false],[111,"New Zealand","United States",false],[2,"Liberia","United States",false],[414,"United States","Hong Kong",false],[2,"Hungary","United States",false],[920,"United States","China",false],[2,"United States","Vietnam",false],[1,"Burkina Faso","United States",false],[118,"Sweden","United States",false],[28,"United States","Kuwait",false],[1420,"United States","Dominican Republic",false],[12,"United States","Egypt",false],[134,"Israel","United States",false],[370002,"United States","United States",true],[13,"Ethiopia","United States",false],[134,"United States","Luxembourg",false],[33,"United States","Poland",false],[44,"Martinique","United States",false],[41,"United States","Saint Barthelemy",false],[39,"Saint Barthelemy","United States",false],[154,"Barbados","United States",false],[129,"United States","Turkey",false],[1,"Djibouti","United States",false],[21,"United States","Azerbaijan",false],[1,"United States","Estonia",false],[1468,"Germany","United States",false],[827,"United States","South Korea",false],[508,"United States","El Salvador",false],[335,"Ireland","United States",false],[3,"United States","Hungary",false],[1,"Zambia","United States",false],[2,"Malaysia","United States",false],[12,"United States","Ethiopia",false],[465,"United States","Panama",false],[342,"United States","Aruba",false],[4,"United States","Thailand",false],[236,"United States","Turks and Caicos Islands",false],[2,"Croatia","United States",false],[12,"United States","Pakistan",false],[1,"Cyprus","United States",false],[407,"United States","Honduras",false],[24,"Fiji","United States",false],[108,"Qatar","United States",false],[139,"Saint Kitts and Nevis","United States",false],[32,"Kuwait","United States",false],[266,"Taiwan","United States",false],[226,"Haiti","United States",false],[8399,"Canada","United States",false],[69,"Federated States of Micronesia","United States",false],[2,"United States","Liberia",false],[666,"Jamaica","United States",false],[2,"United States","Malta",false],[1353,"Dominican Republic","United States",false],[1548,"Japan","United States",false],[1,"United States","Lithuania",false],[26,"Finland","United States",false],[59,"United States","Guadeloupe",false],[13,"United States","Ukraine",false],[952,"United States","France",false],[115,"United States","Norway",false],[346,"Aruba","United States",false],[5,"French Guiana","United States",false],[35,"United States","Kiribati",false],[61,"India","United States",false],[107,"British Virgin Islands","United States",false],[853,"Brazil","United States",false],[1336,"United States","Germany",false],[74,"United States","New Zealand",false],[43,"French Polynesia","United States",false],[320,"United Arab Emirates","United States",false],[3,"Singapore","United States",false],[7187,"United States","Mexico",false],[119,"United States","Sweden",false],[776,"Netherlands","United States",false],[43,"United States","Martinique",false],[313,"United States","United Arab Emirates",false],[1,"United States","Bulgaria",false],[153,"Denmark","United States",false],[772,"China","United States",false],[201,"United States","Nicaragua",false],[126,"United States","Philippines",false],[1,"United States","Georgia",false],[228,"United States","Belgium",false],[314,"Cayman Islands","United States",false],[180,"Argentina","United States",false],[279,"Peru","United States",false],[36,"South Africa","United States",false],[202,"United States","Iceland",false],[141,"United States","Argentina",false],[420,"Spain","United States",false],[183,"Bermuda","United States",false],[50,"United States","Nigeria",false],[63,"United States","Austria",false],[59,"United States","Bonaire, Sint Eustatius, and Saba",false],[26,"Kiribati","United States",false],[83,"Saudi Arabia","United States",false],[13,"Czech Republic","United States",false],[127,"United States","Israel",false],[259,"Belgium","United States",false],[136,"United States","Saint Lucia",false],[1,"United States","Bahrain",false],[80,"United States","British Virgin Islands",false],[90,"Curacao","United States",false],[2,"Georgia","United States",false],[152,"United States","Denmark",false],[63,"United States","Guyana",false],[134,"Philippines","United States",false],[53,"Grenada","United States",false],[20,"Cape Verde","United States",false],[1,"Cote d'Ivoire","United States",false],[14,"Ukraine","United States",false],[1,"United States","Papua New Guinea",false],[176,"Russia","United States",false],[70,"United States","Saudi Arabia",false],[397,"Guatemala","United States",false],[123,"Saint Lucia","United States",false],[60,"Paraguay","United States",false],[83,"United States","Curacao",false],[1,"Kosovo","United States",false],[235,"United States","Taiwan",false],[3,"Tunisia","United States",false],[40,"United States","South Africa",false],[2,"Niger","United States",false],[138,"Turkey","United States",false],[2025,"United Kingdom","United States",false],[14,"Romania","United States",false],[4,"United States","Greenland",false],[3,"Papua New Guinea","United States",false],[442,"United States","Spain",false],[1,"Iraq","United States",false],[438,"United States","Italy",false],[466,"Cuba","United States",false],[305,"United States","Switzerland",false],[20,"Dominica","United States",false],[1496,"United States","Japan",false],[127,"Portugal","United States",false],[619,"United States","Brazil",false],[19,"Bahrain","United States",false],[337,"United States","Peru",false],[1,"Indonesia","United States",false],[193,"United States","Belize",false],[1970,"United States","United Kingdom",false],[188,"Belize","United States",false],[20,"United States","Ghana",false],[2,"United States","Indonesia",false],[25,"United States","Fiji",false],[8483,"United States","Canada",false],[117,"United States","Antigua and Barbuda",false],[40,"United States","French Polynesia",false],[179,"Nicaragua","United States",false],[15,"United States","Latvia",false],[27,"United States","Dominica",false],[12,"United States","Czech Republic",false],[258,"United States","Australia",false],[13,"United States","Cook Islands",false],[62,"Austria","United States",false],[44,"Jordan","United States",false],[30,"Palau","United States",false],[1048,"South Korea","United States",false],[15,"Angola","United States",false],[18,"Ghana","United States",false],[1,"New Caledonia","United States",false],[56,"Guadeloupe","United States",false],[935,"France","United States",false],[32,"Poland","United States",false],[59,"Nigeria","United States",false],[13,"United States","Uruguay",false],[2,"Greenland","United States",false],[193,"United States","Bermuda",false],[174,"Chile","United States",false],[478,"United States","Cuba",false],[1,"United States","Montenegro",false],[867,"United States","Colombia",false],[130,"United States","Barbados",false],[109,"United States","Qatar",false],[329,"Australia","United States",false],[310,"United States","Cayman Islands",false],[44,"United States","Jordan",false],[1,"United States","Namibia",false],[217,"United States","Trinidad and Tobago",false],[13,"United States","Bolivia",false],[13,"Cook Islands","United States",false],[3,"Bulgaria","United States",false],[145,"United States","Saint Kitts and Nevis",false],[43,"Uruguay","United States",false],[225,"United States","Haiti",false],[58,"Bonaire, Sint Eustatius, and Saba","United States",false],[30,"Greece","United States",false]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count","type":"\"long\"","metadata":"{}"},{"name":"dest_country_name","type":"\"string\"","metadata":"{}"},{"name":"origin_country_name","type":"\"string\"","metadata":"{}"},{"name":"withinCountry","type":"\"boolean\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635321791,"submitTime":1497635321770,"finishTime":1497635321924,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"36788810-57db-4f29-bc39-13ce240236d9"},{"version":"CommandV1","origId":336718490210072,"guid":"7c30bf16-085f-4cad-b4c3-030db60ceb22","subtype":"command","commandType":"auto","position":87.0,"command":"%scala\ndf.selectExpr(\"avg(count)\", \"count(distinct(DEST_COUNTRY_NAME))\").show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------+---------------------------------+\n| avg(count)|count(DISTINCT DEST_COUNTRY_NAME)|\n+-----------+---------------------------------+\n|1770.765625|                              132|\n+-----------+---------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635330837,"submitTime":1497635330817,"finishTime":1497635331959,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0790425b-d513-48f8-b101-abc9c254c9f4"},{"version":"CommandV1","origId":336718490210073,"guid":"5c3721a9-0434-4158-9fe1-18849f48c157","subtype":"command","commandType":"auto","position":88.0,"command":"df.selectExpr(\"avg(count)\", \"count(distinct(DEST_COUNTRY_NAME))\").show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------+---------------------------------+\n| avg(count)|count(DISTINCT DEST_COUNTRY_NAME)|\n+-----------+---------------------------------+\n|1770.765625|                              132|\n+-----------+---------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635342659,"submitTime":1497635342640,"finishTime":1497635343385,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"887daa22-2ae8-44cf-8e58-479cf2da51f1"},{"version":"CommandV1","origId":336718490210074,"guid":"e21ae100-b281-4dd7-bc69-a11f05b2b5a5","subtype":"command","commandType":"auto","position":89.0,"command":"%sql\nSELECT\navg(count),\ncount(distinct(DEST_COUNTRY_NAME))\nFROM\ndfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1770.765625,132]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"avg(count)","type":"\"double\"","metadata":"{}"},{"name":"count(DISTINCT DEST_COUNTRY_NAME)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635351446,"submitTime":1497635351424,"finishTime":1497635352512,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a755e9b5-63ab-473e-a88d-1ffda50313de"},{"version":"CommandV1","origId":336718490210075,"guid":"b9803cd9-7719-4c55-b887-426915b401dc","subtype":"command","commandType":"auto","position":90.0,"command":"%scala\nimport org.apache.spark.sql.functions.lit\ndf.select(\nexpr(\"*\"),\nlit(1).as(\"something\")\n).show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+---------+\n|count|dest_country_name|origin_country_name|something|\n+-----+-----------------+-------------------+---------+\n|   15|    United States|            Romania|        1|\n|    1|    United States|            Croatia|        1|\n+-----+-----------------+-------------------+---------+\nonly showing top 2 rows\n\nimport org.apache.spark.sql.functions.lit\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635363073,"submitTime":1497635363053,"finishTime":1497635363338,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b1f3b756-c7ce-4036-a653-af7b3e61708e"},{"version":"CommandV1","origId":336718490210076,"guid":"8d5a52df-a5c1-4b01-95fa-608b2ff591c5","subtype":"command","commandType":"auto","position":91.0,"command":"from pyspark.sql.functions import lit\ndf.select(\nexpr(\"*\"),\nlit(1).alias(\"One\")\n).show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+---+\n|count|dest_country_name|origin_country_name|One|\n+-----+-----------------+-------------------+---+\n|   15|    United States|            Romania|  1|\n|    1|    United States|            Croatia|  1|\n+-----+-----------------+-------------------+---+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635375738,"submitTime":1497635375732,"finishTime":1497635375909,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"31a4a4d2-6503-4863-9016-d51f6b31905a"},{"version":"CommandV1","origId":336718490210077,"guid":"ea3671db-eb1e-4dea-8873-42a2a7228ec0","subtype":"command","commandType":"auto","position":92.0,"command":"%sql\nSELECT\n*,\n1 as One\nFROM\ndfTable\nLIMIT 2","commandVersion":0,"state":"finished","results":{"type":"table","data":[[15,"United States","Romania",1],[1,"United States","Croatia",1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count","type":"\"long\"","metadata":"{}"},{"name":"dest_country_name","type":"\"string\"","metadata":"{}"},{"name":"origin_country_name","type":"\"string\"","metadata":"{}"},{"name":"One","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635384485,"submitTime":1497635384464,"finishTime":1497635385215,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5724ce9c-52da-4626-9288-70dbb7765f5f"},{"version":"CommandV1","origId":336718490210078,"guid":"8d383519-0a99-4dbb-8785-b893aa6421be","subtype":"command","commandType":"auto","position":93.0,"command":"%scala\ndf.withColumn(\"numberOne\", lit(1)).show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+---------+\n|count|dest_country_name|origin_country_name|numberOne|\n+-----+-----------------+-------------------+---------+\n|   15|    United States|            Romania|        1|\n|    1|    United States|            Croatia|        1|\n+-----+-----------------+-------------------+---------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635394512,"submitTime":1497635394492,"finishTime":1497635394668,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1dbabd0a-6188-4cad-8397-685b3206b82d"},{"version":"CommandV1","origId":336718490210079,"guid":"b1f750c9-3e2b-479a-b3c5-c1a0e3531232","subtype":"command","commandType":"auto","position":94.0,"command":"df.withColumn(\"numberOne\", lit(1)).show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+---------+\n|count|dest_country_name|origin_country_name|numberOne|\n+-----+-----------------+-------------------+---------+\n|   15|    United States|            Romania|        1|\n|    1|    United States|            Croatia|        1|\n+-----+-----------------+-------------------+---------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635402487,"submitTime":1497635402467,"finishTime":1497635402659,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2fda05b8-850c-4585-a0f5-04ac8c6badf3"},{"version":"CommandV1","origId":336718490210080,"guid":"8606d4c7-77c4-4fd1-9343-e9d6983e675f","subtype":"command","commandType":"auto","position":95.0,"command":"%sql\nSELECT\n1 as numberOne\nFROM\ndfTable\nLIMIT 2","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1],[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"numberOne","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635410122,"submitTime":1497635410098,"finishTime":1497635410302,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ecbb51cb-b94e-48d2-a9f5-d1134188a181"},{"version":"CommandV1","origId":336718490210081,"guid":"6c8df7ac-4aea-4a5d-952a-dbef4f4aa024","subtype":"command","commandType":"auto","position":96.0,"command":"%scala\ndf.withColumn(\n\"withinCountry\",\nexpr(\"ORIGIN_COUNTRY_NAME == DEST_COUNTRY_NAME\")\n).show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+-------------+\n|count|dest_country_name|origin_country_name|withinCountry|\n+-----+-----------------+-------------------+-------------+\n|   15|    United States|            Romania|        false|\n|    1|    United States|            Croatia|        false|\n+-----+-----------------+-------------------+-------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635418407,"submitTime":1497635418387,"finishTime":1497635418586,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"42834a19-bcb7-4ead-813f-cd6e12505dc6"},{"version":"CommandV1","origId":336718490210082,"guid":"9df9f462-7fa4-40bb-b1f9-ac3312ea0b47","subtype":"command","commandType":"auto","position":97.0,"command":"df.withColumn(\n\"withinCountry\",\nexpr(\"ORIGIN_COUNTRY_NAME == DEST_COUNTRY_NAME\"))\\\n.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+-------------+\n|count|dest_country_name|origin_country_name|withinCountry|\n+-----+-----------------+-------------------+-------------+\n|   15|    United States|            Romania|        false|\n|    1|    United States|            Croatia|        false|\n+-----+-----------------+-------------------+-------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635426699,"submitTime":1497635426672,"finishTime":1497635426872,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"590544cf-d346-4674-8e49-6de23d028b29"},{"version":"CommandV1","origId":336718490210083,"guid":"faf5ac99-913d-4fac-98af-e39c16c4a224","subtype":"command","commandType":"auto","position":98.0,"command":"%scala\ndf.withColumn(\n\"Destination\",\ndf.col(\"DEST_COUNTRY_NAME\"))\n.columns","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res44: Array[String] = Array(count, dest_country_name, origin_country_name, Destination)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635437252,"submitTime":1497635437228,"finishTime":1497635437341,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"df25c883-062e-4108-9d05-fe07db454203"},{"version":"CommandV1","origId":336718490210084,"guid":"20d45962-e8eb-4d8a-bca4-c01673d84d2b","subtype":"command","commandType":"auto","position":99.0,"command":"%scala\ndf.withColumnRenamed(\"DEST_COUNTRY_NAME\", \"dest\").columns","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res45: Array[String] = Array(count, dest, origin_country_name)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635445748,"submitTime":1497635445728,"finishTime":1497635445808,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b7a653cd-a9e6-4ee6-8d38-3595d266c1ec"},{"version":"CommandV1","origId":336718490210085,"guid":"8ad82f9f-b5f1-4393-8ea5-faaa74974b82","subtype":"command","commandType":"auto","position":100.0,"command":"df.withColumnRenamed(\"DEST_COUNTRY_NAME\", \"dest\").columns","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">137</span><span class=\"ansired\">]: </span>[&apos;count&apos;, &apos;dest&apos;, &apos;origin_country_name&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635451917,"submitTime":1497635451896,"finishTime":1497635451989,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"78e63aa9-6c45-49cf-ad6c-692c4ea83e6c"},{"version":"CommandV1","origId":336718490210086,"guid":"a6a2166a-b927-47d1-b1f6-e82488ba18c6","subtype":"command","commandType":"auto","position":101.0,"command":"%scala\nimport org.apache.spark.sql.functions.expr\nval dfWithLongColName = df\n.withColumn(\n\"This Long Column-Name\",\nexpr(\"ORIGIN_COUNTRY_NAME\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.expr\ndfWithLongColName: org.apache.spark.sql.DataFrame = [count: bigint, dest_country_name: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635459986,"submitTime":1497635459963,"finishTime":1497635460060,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1946dba7-ed25-497c-8025-88f33584fe03"},{"version":"CommandV1","origId":336718490210087,"guid":"b59786c6-b407-425d-9a0a-b3fa75494b7c","subtype":"command","commandType":"auto","position":102.0,"command":"dfWithLongColName = df\\\n.withColumn(\n\"This Long Column-Name\",\nexpr(\"ORIGIN_COUNTRY_NAME\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635470012,"submitTime":1497635469988,"finishTime":1497635470050,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d5fa74e1-b1ba-4069-9a65-055a510de090"},{"version":"CommandV1","origId":336718490210088,"guid":"09812549-06bf-4ccb-9244-b91d30c48d81","subtype":"command","commandType":"auto","position":103.0,"command":"%scala\ndfWithLongColName\n.selectExpr(\n\"`This Long Column-Name`\",\n\"`This Long Column-Name` as `new col`\")\n.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------------------+-------+\n|This Long Column-Name|new col|\n+---------------------+-------+\n|              Romania|Romania|\n|              Croatia|Croatia|\n+---------------------+-------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635479226,"submitTime":1497635479205,"finishTime":1497635479380,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dca16e5f-5777-4aea-a513-f09a669cd803"},{"version":"CommandV1","origId":336718490210089,"guid":"45e9ddb1-98b4-405c-b570-c576af064559","subtype":"command","commandType":"auto","position":104.0,"command":"dfWithLongColName\\\n.selectExpr(\n\"`This Long Column-Name`\",\n\"`This Long Column-Name` as `new col`\")\\\n.show(2)\ndfWithLongColName.createOrReplaceTempView(\"dfTableLong\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------------------+-------+\n|This Long Column-Name|new col|\n+---------------------+-------+\n|              Romania|Romania|\n|              Croatia|Croatia|\n+---------------------+-------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635494955,"submitTime":1497635494932,"finishTime":1497635495077,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"40443ca8-846d-4452-bffd-947d862f339a"},{"version":"CommandV1","origId":336718490210090,"guid":"62b317e4-bcf3-4fa5-a200-e2bab9e681e4","subtype":"command","commandType":"auto","position":105.0,"command":"%sql\nSELECT `This Long Column-Name` FROM dfTableLong","commandVersion":0,"state":"finished","results":{"type":"table","data":[["Romania"],["Croatia"],["Ireland"],["United States"],["India"],["Singapore"],["Grenada"],["United States"],["United States"],["United States"],["Sint Maarten"],["Marshall Islands"],["United States"],["United States"],["United States"],["United States"],["Paraguay"],["United States"],["United States"],["Gibraltar"],["United States"],["United States"],["Federated States of Micronesia"],["Russia"],["United States"],["Netherlands"],["United States"],["United States"],["United States"],["United States"],["United States"],["Senegal"],["United States"],["United States"],["Angola"],["United States"],["Anguilla"],["United States"],["United States"],["United States"],["United States"],["Ecuador"],["United States"],["United States"],["Cyprus"],["United States"],["Portugal"],["Costa Rica"],["Guatemala"],["Suriname"],["United States"],["Cape Verde"],["Jamaica"],["United States"],["Malaysia"],["Morocco"],["United States"],["Samoa"],["United States"],["Palau"],["Venezuela"],["United States"],["United States"],["Chile"],["United States"],["Finland"],["United States"],["Greece"],["The Bahamas"],["United States"],["United States"],["Hong Kong"],["United States"],["China"],["Vietnam"],["United States"],["United States"],["Kuwait"],["Dominican Republic"],["Egypt"],["United States"],["United States"],["United States"],["Luxembourg"],["Poland"],["United States"],["Saint Barthelemy"],["United States"],["United States"],["Turkey"],["United States"],["Azerbaijan"],["Estonia"],["United States"],["South Korea"],["El Salvador"],["United States"],["Hungary"],["United States"],["United States"],["Ethiopia"],["Panama"],["Aruba"],["Thailand"],["Turks and Caicos Islands"],["United States"],["Pakistan"],["United States"],["Honduras"],["United States"],["United States"],["United States"],["United States"],["United States"],["United States"],["United States"],["United States"],["Liberia"],["United States"],["Malta"],["United States"],["United States"],["Lithuania"],["United States"],["Guadeloupe"],["Ukraine"],["France"],["Norway"],["United States"],["United States"],["Kiribati"],["United States"],["United States"],["United States"],["Germany"],["New Zealand"],["United States"],["United States"],["United States"],["Mexico"],["Sweden"],["United States"],["Martinique"],["United Arab Emirates"],["Bulgaria"],["United States"],["United States"],["Nicaragua"],["Philippines"],["Georgia"],["Belgium"],["United States"],["United States"],["United States"],["United States"],["Iceland"],["Argentina"],["United States"],["United States"],["Nigeria"],["Austria"],["Bonaire, Sint Eustatius, and Saba"],["United States"],["United States"],["United States"],["Israel"],["United States"],["Saint Lucia"],["Bahrain"],["British Virgin Islands"],["United States"],["United States"],["Denmark"],["Guyana"],["United States"],["United States"],["United States"],["United States"],["United States"],["Papua New Guinea"],["United States"],["Saudi Arabia"],["United States"],["United States"],["United States"],["Curacao"],["United States"],["Taiwan"],["United States"],["South Africa"],["United States"],["United States"],["United States"],["United States"],["Greenland"],["United States"],["Spain"],["United States"],["Italy"],["United States"],["Switzerland"],["United States"],["Japan"],["United States"],["Brazil"],["United States"],["Peru"],["United States"],["Belize"],["United Kingdom"],["United States"],["Ghana"],["Indonesia"],["Fiji"],["Canada"],["Antigua and Barbuda"],["French Polynesia"],["United States"],["Latvia"],["Dominica"],["Czech Republic"],["Australia"],["Cook Islands"],["United States"],["United States"],["United States"],["United States"],["United States"],["United States"],["United States"],["United States"],["United States"],["United States"],["United States"],["Uruguay"],["United States"],["Bermuda"],["United States"],["Cuba"],["Montenegro"],["Colombia"],["Barbados"],["Qatar"],["United States"],["Cayman Islands"],["Jordan"],["Namibia"],["Trinidad and Tobago"],["Bolivia"],["United States"],["United States"],["Saint Kitts and Nevis"],["United States"],["Haiti"],["United States"],["United States"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"This Long Column-Name","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635506826,"submitTime":1497635506797,"finishTime":1497635506912,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f86a5103-e5ae-474c-a2e5-b47ccee9a0a1"},{"version":"CommandV1","origId":336718490210091,"guid":"4d7466b9-66c6-4f09-b2f8-25655a40ea9d","subtype":"command","commandType":"auto","position":106.0,"command":"%scala\ndfWithLongColName.select(col(\"This Long Column-Name\")).columns","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res47: Array[String] = Array(This Long Column-Name)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635517004,"submitTime":1497635516978,"finishTime":1497635517075,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b674a1c7-cd6c-48bf-8c7c-8a4ddb39be49"},{"version":"CommandV1","origId":336718490210092,"guid":"5900238f-1e2b-42b0-a60e-a2c485f69d3d","subtype":"command","commandType":"auto","position":107.0,"command":"dfWithLongColName.select(expr(\"`This Long Column-Name`\")).columns","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">140</span><span class=\"ansired\">]: </span>[&apos;This Long Column-Name&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635524037,"submitTime":1497635524016,"finishTime":1497635524109,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"258bdfd6-9335-4cdc-b45f-3bbe7edcf251"},{"version":"CommandV1","origId":336718490210093,"guid":"e30e2fd5-5bff-4f67-81b3-0ac57dc084b9","subtype":"command","commandType":"auto","position":108.0,"command":"df.drop(\"ORIGIN_COUNTRY_NAME\").columns","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">141</span><span class=\"ansired\">]: </span>[&apos;count&apos;, &apos;dest_country_name&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635532749,"submitTime":1497635532727,"finishTime":1497635532820,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bd125d10-1db6-49a1-9bd6-7fa7574a8ae6"},{"version":"CommandV1","origId":336718490210094,"guid":"b4c1ca27-d1b8-4a10-a97d-f3291d768ed7","subtype":"command","commandType":"auto","position":109.0,"command":"dfWithLongColName.drop(\"ORIGIN_COUNTRY_NAME\", \"DEST_COUNTRY_NAME\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">142</span><span class=\"ansired\">]: </span>DataFrame[count: bigint, This Long Column-Name: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635542734,"submitTime":1497635542713,"finishTime":1497635542805,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f6fb4e7e-8a89-4fb4-82d6-3b1a39dd2ed8"},{"version":"CommandV1","origId":336718490210095,"guid":"2cf65dcd-e202-4294-a54c-e51773d06055","subtype":"command","commandType":"auto","position":110.0,"command":"df.printSchema()\ndf.withColumn(\"count\", col(\"count\").cast(\"int\")).printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- count: long (nullable = true)\n |-- dest_country_name: string (nullable = true)\n |-- origin_country_name: string (nullable = true)\n\nroot\n |-- count: integer (nullable = true)\n |-- dest_country_name: string (nullable = true)\n |-- origin_country_name: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635560386,"submitTime":1497635560363,"finishTime":1497635560457,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"da10503d-535d-408f-bc11-b84ce3df0f4a"},{"version":"CommandV1","origId":336718490210096,"guid":"b21948c1-3746-40b2-bf7e-8c03f58ad65e","subtype":"command","commandType":"auto","position":111.0,"command":"%sql\nSELECT\ncast(count as int)\nFROM\ndfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[15],[1],[344],[15],[62],[1],[62],[588],[40],[1],[325],[39],[64],[1],[41],[30],[6],[4],[230],[1],[1],[382],[69],[161],[12],[660],[181],[42],[155],[362],[955],[42],[561],[25],[13],[294],[38],[325],[332],[211],[19],[300],[1],[7140],[1],[268],[134],[608],[318],[34],[873],[14],[712],[121],[3],[19],[3],[25],[290],[31],[246],[510],[126],[185],[15],[28],[21],[23],[986],[111],[2],[414],[2],[920],[2],[1],[118],[28],[1420],[12],[134],[370002],[13],[134],[33],[44],[41],[39],[154],[129],[1],[21],[1],[1468],[827],[508],[335],[3],[1],[2],[12],[465],[342],[4],[236],[2],[12],[1],[407],[24],[108],[139],[32],[266],[226],[8399],[69],[2],[666],[2],[1353],[1548],[1],[26],[59],[13],[952],[115],[346],[5],[35],[61],[107],[853],[1336],[74],[43],[320],[3],[7187],[119],[776],[43],[313],[1],[153],[772],[201],[126],[1],[228],[314],[180],[279],[36],[202],[141],[420],[183],[50],[63],[59],[26],[83],[13],[127],[259],[136],[1],[80],[90],[2],[152],[63],[134],[53],[20],[1],[14],[1],[176],[70],[397],[123],[60],[83],[1],[235],[3],[40],[2],[138],[2025],[14],[4],[3],[442],[1],[438],[466],[305],[20],[1496],[127],[619],[19],[337],[1],[193],[1970],[188],[20],[2],[25],[8483],[117],[40],[179],[15],[27],[12],[258],[13],[62],[44],[30],[1048],[15],[18],[1],[56],[935],[32],[59],[13],[2],[193],[174],[478],[1],[867],[130],[109],[329],[310],[44],[1],[217],[13],[13],[3],[145],[43],[225],[58],[30]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635569066,"submitTime":1497635569043,"finishTime":1497635569206,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d78c82dd-a10b-4df2-ab97-73aa9b3e2524"},{"version":"CommandV1","origId":336718490210097,"guid":"c058dc13-2775-426f-919e-18a1d97e01b3","subtype":"command","commandType":"auto","position":112.0,"command":"%scala\nval colCondition = df.filter(col(\"count\") < 2).take(2)\nval conditional = df.where(\"count < 2\").take(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">colCondition: Array[org.apache.spark.sql.Row] = Array([1,United States,Croatia], [1,United States,Singapore])\nconditional: Array[org.apache.spark.sql.Row] = Array([1,United States,Croatia], [1,United States,Singapore])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635580486,"submitTime":1497635580464,"finishTime":1497635580777,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c5ca183a-4725-4bef-ab0a-240f0a1c3807"},{"version":"CommandV1","origId":336718490210098,"guid":"cc4d5ed2-b74e-47f4-b95b-350496e66fe6","subtype":"command","commandType":"auto","position":113.0,"command":"colCondition = df.filter(col(\"count\") < 2).take(2)\nconditional = df.where(\"count < 2\").take(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635589112,"submitTime":1497635589090,"finishTime":1497635589384,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2e70335c-7459-4800-96be-2198fc8b8716"},{"version":"CommandV1","origId":336718490210099,"guid":"43a6eda1-6f78-4197-ad8a-f8dc1f66601e","subtype":"command","commandType":"auto","position":114.0,"command":"%sql\nSELECT\n*\nFROM dfTable\nWHERE\ncount < 2","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1,"United States","Croatia"],[1,"United States","Singapore"],[1,"Moldova","United States"],[1,"Malta","United States"],[1,"United States","Gibraltar"],[1,"Saint Vincent and the Grenadines","United States"],[1,"Suriname","United States"],[1,"United States","Cyprus"],[1,"Burkina Faso","United States"],[1,"Djibouti","United States"],[1,"United States","Estonia"],[1,"Zambia","United States"],[1,"Cyprus","United States"],[1,"United States","Lithuania"],[1,"United States","Bulgaria"],[1,"United States","Georgia"],[1,"United States","Bahrain"],[1,"Cote d'Ivoire","United States"],[1,"United States","Papua New Guinea"],[1,"Kosovo","United States"],[1,"Iraq","United States"],[1,"Indonesia","United States"],[1,"New Caledonia","United States"],[1,"United States","Montenegro"],[1,"United States","Namibia"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count","type":"\"long\"","metadata":"{}"},{"name":"dest_country_name","type":"\"string\"","metadata":"{}"},{"name":"origin_country_name","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635597246,"submitTime":1497635597222,"finishTime":1497635597371,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1205a06d-f608-49bd-b54f-be9e27835758"},{"version":"CommandV1","origId":336718490210100,"guid":"ed08d820-d1f2-4126-8337-8452b33c7f13","subtype":"command","commandType":"auto","position":115.0,"command":"%scala\ndf.where(col(\"count\") < 2)\n.where(col(\"ORIGIN_COUNTRY_NAME\") =!= \"Croatia\")\n.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|    1|    United States|          Singapore|\n|    1|          Moldova|      United States|\n+-----+-----------------+-------------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635606809,"submitTime":1497635606787,"finishTime":1497635607439,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7641e838-6a2a-48c1-b26c-20737ca3fee5"},{"version":"CommandV1","origId":336718490210101,"guid":"d8d0134c-8fbd-4966-8b6b-147f7c4da7cc","subtype":"command","commandType":"auto","position":116.0,"command":"df.where(col(\"count\") < 2)\\\n.where(col(\"ORIGIN_COUNTRY_NAME\") != \"Croatia\")\\\n.show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|    1|    United States|          Singapore|\n|    1|          Moldova|      United States|\n+-----+-----------------+-------------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635617530,"submitTime":1497635617506,"finishTime":1497635617752,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b6458837-6ba7-4919-a69a-04dbbcc3eb7a"},{"version":"CommandV1","origId":336718490210102,"guid":"ebaad5d2-a9c8-4f32-961c-e91919888ede","subtype":"command","commandType":"auto","position":117.0,"command":"%sql\nSELECT *\nFROM dfTable\nWHERE\ncount < 2 AND\nORIGIN_COUNTRY_NAME != \"Croatia\"","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1,"United States","Singapore"],[1,"Moldova","United States"],[1,"Malta","United States"],[1,"United States","Gibraltar"],[1,"Saint Vincent and the Grenadines","United States"],[1,"Suriname","United States"],[1,"United States","Cyprus"],[1,"Burkina Faso","United States"],[1,"Djibouti","United States"],[1,"United States","Estonia"],[1,"Zambia","United States"],[1,"Cyprus","United States"],[1,"United States","Lithuania"],[1,"United States","Bulgaria"],[1,"United States","Georgia"],[1,"United States","Bahrain"],[1,"Cote d'Ivoire","United States"],[1,"United States","Papua New Guinea"],[1,"Kosovo","United States"],[1,"Iraq","United States"],[1,"Indonesia","United States"],[1,"New Caledonia","United States"],[1,"United States","Montenegro"],[1,"United States","Namibia"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count","type":"\"long\"","metadata":"{}"},{"name":"dest_country_name","type":"\"string\"","metadata":"{}"},{"name":"origin_country_name","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635631885,"submitTime":1497635631862,"finishTime":1497635632045,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2e669778-ee66-4b3f-a483-6f416fe42b1f"},{"version":"CommandV1","origId":336718490210103,"guid":"2e27eaec-5546-4481-b9d7-76cc1dffdda7","subtype":"command","commandType":"auto","position":118.0,"command":"%scala\ndf.select(\"ORIGIN_COUNTRY_NAME\", \"DEST_COUNTRY_NAME\").count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res49: Long = 256\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635651884,"submitTime":1497635651860,"finishTime":1497635652073,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fbbab848-cd54-4087-8a59-1f52101ccad6"},{"version":"CommandV1","origId":336718490210104,"guid":"3f880690-ed5e-43db-badf-360e986c54c5","subtype":"command","commandType":"auto","position":119.0,"command":"df.select(\"ORIGIN_COUNTRY_NAME\", \"DEST_COUNTRY_NAME\").count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">146</span><span class=\"ansired\">]: </span>256\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635659133,"submitTime":1497635659111,"finishTime":1497635659317,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4c5c452f-df9d-4855-84fd-35e436b41233"},{"version":"CommandV1","origId":336718490210105,"guid":"ae049f5e-fbeb-45e0-b97c-6f0b5b1fa8c5","subtype":"command","commandType":"auto","position":120.0,"command":"%sql\nSELECT\nCOUNT(DISTINCT ORIGIN_COUNTRY_NAME, DEST_COUNTRY_NAME)\nFROM dfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[256]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count(DISTINCT ORIGIN_COUNTRY_NAME, DEST_COUNTRY_NAME)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635669050,"submitTime":1497635669026,"finishTime":1497635669667,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fe5405c1-286c-470a-9d20-9fda6e15423b"},{"version":"CommandV1","origId":336718490210106,"guid":"72381dbf-6221-4862-81fc-4bcc3f0e432b","subtype":"command","commandType":"auto","position":121.0,"command":"%scala\ndf.select(\"ORIGIN_COUNTRY_NAME\").distinct().count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res50: Long = 125\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635678082,"submitTime":1497635678058,"finishTime":1497635678785,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1cefa693-fe0c-4991-8d34-9cb65d4855bd"},{"version":"CommandV1","origId":336718490210107,"guid":"bdaa1b40-a91e-4223-8f6b-e594b7841abb","subtype":"command","commandType":"auto","position":122.0,"command":"df.select(\"ORIGIN_COUNTRY_NAME\").distinct().count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">147</span><span class=\"ansired\">]: </span>125\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635686782,"submitTime":1497635686755,"finishTime":1497635687407,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0372aa5b-a0a5-483b-aedf-92b8f9917906"},{"version":"CommandV1","origId":336718490210108,"guid":"90f4769e-1145-46ab-9553-ff0b00b55e44","subtype":"command","commandType":"auto","position":123.0,"command":"%sql\nSELECT\nCOUNT(DISTINCT ORIGIN_COUNTRY_NAME)\nFROM dfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[125]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count(DISTINCT ORIGIN_COUNTRY_NAME)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635695952,"submitTime":1497635695929,"finishTime":1497635696632,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0d13db83-6bb9-4f8e-9e06-f0d518828ed7"},{"version":"CommandV1","origId":336718490210109,"guid":"6cbb00e4-d580-4c33-a3a0-cf105497962f","subtype":"command","commandType":"auto","position":124.0,"command":"%scala\nval seed = 5\nval withReplacement = false\nval fraction = 0.5\ndf.sample(withReplacement, fraction, seed).count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">seed: Int = 5\nwithReplacement: Boolean = false\nfraction: Double = 0.5\nres51: Long = 126\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635718221,"submitTime":1497635718197,"finishTime":1497635718431,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cf1685e3-6635-4653-b0cc-80cb5eb00152"},{"version":"CommandV1","origId":336718490210110,"guid":"19d96f17-acbc-4f2f-af48-e62aa3ea8dca","subtype":"command","commandType":"auto","position":125.0,"command":"seed = 5\nwithReplacement = False\nfraction = 0.5\ndf.sample(withReplacement, fraction, seed).count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">148</span><span class=\"ansired\">]: </span>126\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635728070,"submitTime":1497635728037,"finishTime":1497635728243,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6ae0bdb8-320b-4ab2-a9fc-97039383064d"},{"version":"CommandV1","origId":336718490210111,"guid":"bdeb9120-658b-4392-87b7-1485bb0f268c","subtype":"command","commandType":"auto","position":126.0,"command":"%scala\nval dataFrames = df.randomSplit(Array(0.25, 0.75), seed)\ndataFrames(0).count() > dataFrames(1).count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">dataFrames: Array[org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]] = Array([count: bigint, dest_country_name: string ... 1 more field], [count: bigint, dest_country_name: string ... 1 more field])\nres52: Boolean = false\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635750532,"submitTime":1497635750508,"finishTime":1497635751003,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6459cd95-c5f7-49f7-8d07-01094d1eff35"},{"version":"CommandV1","origId":336718490210112,"guid":"e41a35ba-cc41-46e8-a661-d1045b464a41","subtype":"command","commandType":"auto","position":127.0,"command":"dataFrames = df.randomSplit([0.25, 0.75], seed)\ndataFrames[0].count() > dataFrames[1].count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">149</span><span class=\"ansired\">]: </span>False\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635761004,"submitTime":1497635760981,"finishTime":1497635761279,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4fb4d1bd-7953-49b9-b8c1-3472cfcffc15"},{"version":"CommandV1","origId":336718490210113,"guid":"f549a13e-844e-43f4-984e-bfe65319406c","subtype":"command","commandType":"auto","position":128.0,"command":"%scala\nimport org.apache.spark.sql.Row\nval schema = df.schema\nval newRows = Seq(\nRow(\"New Country\", \"Other Country\", 5L),\n  Row(\"New Country 2\", \"Other Country 3\", 1L)\n)\nval parallelizedRows = spark.sparkContext.parallelize(newRows)\nval newDF = spark.createDataFrame(parallelizedRows, schema)\ndf.union(newDF)\n.where(\"count = 1\")\n.where($\"ORIGIN_COUNTRY_NAME\" =!= \"United States\")\n.show() // get all of them and we'll see our new rows at the end","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 2 in stage 177.0 failed 1 times, most recent failure: Lost task 2.0 in stage 177.0 (TID 1879, localhost, executor driver): java.lang.RuntimeException: Error while encoding: java.lang.RuntimeException: java.lang.String is not a valid external type for schema of bigint","error":"<div class=\"ansiout\">if (assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt) null else validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 0, count), LongType) AS count#1645L\n+- if (assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt) null else validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 0, count), LongType)\n   :- assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt\n   :  :- assertnotnull(input[0, org.apache.spark.sql.Row, true])\n   :  :  +- input[0, org.apache.spark.sql.Row, true]\n   :  +- 0\n   :- null\n   +- validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 0, count), LongType)\n      +- getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 0, count)\n         +- assertnotnull(input[0, org.apache.spark.sql.Row, true])\n            +- input[0, org.apache.spark.sql.Row, true]\n\nif (assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt) null else staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 1, dest_country_name), StringType), true) AS dest_country_name#1646\n+- if (assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt) null else staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 1, dest_country_name), StringType), true)\n   :- assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt\n   :  :- assertnotnull(input[0, org.apache.spark.sql.Row, true])\n   :  :  +- input[0, org.apache.spark.sql.Row, true]\n   :  +- 1\n   :- null\n   +- staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 1, dest_country_name), StringType), true)\n      +- validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 1, dest_country_name), StringType)\n         +- getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 1, dest_country_name)\n            +- assertnotnull(input[0, org.apache.spark.sql.Row, true])\n               +- input[0, org.apache.spark.sql.Row, true]\n\nif (assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt) null else staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 2, origin_country_name), StringType), true) AS origin_country_name#1647\n+- if (assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt) null else staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 2, origin_country_name), StringType), true)\n   :- assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt\n   :  :- assertnotnull(input[0, org.apache.spark.sql.Row, true])\n   :  :  +- input[0, org.apache.spark.sql.Row, true]\n   :  +- 2\n   :- null\n   +- staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 2, origin_country_name), StringType), true)\n      +- validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 2, origin_country_name), StringType)\n         +- getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 2, origin_country_name)\n            +- assertnotnull(input[0, org.apache.spark.sql.Row, true])\n               +- input[0, org.apache.spark.sql.Row, true]\n\n\tat org.apache.spark.sql.catalyst.encoders.ExpressionEncoder.toRow(ExpressionEncoder.scala:293)\n\tat org.apache.spark.sql.SparkSession$$anonfun$4.apply(SparkSession.scala:554)\n\tat org.apache.spark.sql.SparkSession$$anonfun$4.apply(SparkSession.scala:554)\n\tat scala.collection.Iterator$$anon$11.next(Iterator.scala:328)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8$$anon$1.hasNext(WholeStageCodegenExec.scala:377)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:231)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:225)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:99)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:322)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.RuntimeException: java.lang.String is not a valid external type for schema of bigint\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.evalIfFalseExpr$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.apply(Unknown Source)\n\tat org.apache.spark.sql.catalyst.encoders.ExpressionEncoder.toRow(ExpressionEncoder.scala:290)\n\t... 19 more\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1442)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1430)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1429)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1429)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1657)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1612)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1601)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1937)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1950)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1963)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:333)\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n\tat org.apache.spark.sql.Dataset$$anonfun$7.apply(Dataset.scala:252)\n\tat org.apache.spark.sql.Dataset$$anonfun$7.apply(Dataset.scala:248)\n\tat org.apache.spark.sql.Dataset$$anonfun$60.apply(Dataset.scala:2791)\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:87)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:70)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:2790)\n\tat org.apache.spark.sql.Dataset.showString(Dataset.scala:248)\n\tat org.apache.spark.sql.Dataset.show(Dataset.scala:643)\n\tat org.apache.spark.sql.Dataset.show(Dataset.scala:602)\n\tat org.apache.spark.sql.Dataset.show(Dataset.scala:611)\nCaused by: java.lang.RuntimeException: Error while encoding: java.lang.RuntimeException: java.lang.String is not a valid external type for schema of bigint\nif (assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt) null else validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 0, count), LongType) AS count#1645L\n+- if (assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt) null else validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 0, count), LongType)\n   :- assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt\n   :  :- assertnotnull(input[0, org.apache.spark.sql.Row, true])\n   :  :  +- input[0, org.apache.spark.sql.Row, true]\n   :  +- 0\n   :- null\n   +- validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 0, count), LongType)\n      +- getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 0, count)\n         +- assertnotnull(input[0, org.apache.spark.sql.Row, true])\n            +- input[0, org.apache.spark.sql.Row, true]\n\nif (assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt) null else staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 1, dest_country_name), StringType), true) AS dest_country_name#1646\n+- if (assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt) null else staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 1, dest_country_name), StringType), true)\n   :- assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt\n   :  :- assertnotnull(input[0, org.apache.spark.sql.Row, true])\n   :  :  +- input[0, org.apache.spark.sql.Row, true]\n   :  +- 1\n   :- null\n   +- staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 1, dest_country_name), StringType), true)\n      +- validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 1, dest_country_name), StringType)\n         +- getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 1, dest_country_name)\n            +- assertnotnull(input[0, org.apache.spark.sql.Row, true])\n               +- input[0, org.apache.spark.sql.Row, true]\n\nif (assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt) null else staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 2, origin_country_name), StringType), true) AS origin_country_name#1647\n+- if (assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt) null else staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 2, origin_country_name), StringType), true)\n   :- assertnotnull(input[0, org.apache.spark.sql.Row, true]).isNullAt\n   :  :- assertnotnull(input[0, org.apache.spark.sql.Row, true])\n   :  :  +- input[0, org.apache.spark.sql.Row, true]\n   :  +- 2\n   :- null\n   +- staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 2, origin_country_name), StringType), true)\n      +- validateexternaltype(getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 2, origin_country_name), StringType)\n         +- getexternalrowfield(assertnotnull(input[0, org.apache.spark.sql.Row, true]), 2, origin_country_name)\n            +- assertnotnull(input[0, org.apache.spark.sql.Row, true])\n               +- input[0, org.apache.spark.sql.Row, true]\n\n\tat org.apache.spark.sql.catalyst.encoders.ExpressionEncoder.toRow(ExpressionEncoder.scala:293)\n\tat org.apache.spark.sql.SparkSession$$anonfun$4.apply(SparkSession.scala:554)\n\tat org.apache.spark.sql.SparkSession$$anonfun$4.apply(SparkSession.scala:554)\n\tat scala.collection.Iterator$$anon$11.next(Iterator.scala:328)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8$$anon$1.hasNext(WholeStageCodegenExec.scala:377)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:231)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:225)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:99)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:322)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.RuntimeException: java.lang.String is not a valid external type for schema of bigint\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.evalIfFalseExpr$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificUnsafeProjection.apply(Unknown Source)\n\tat org.apache.spark.sql.catalyst.encoders.ExpressionEncoder.toRow(ExpressionEncoder.scala:290)\n\tat org.apache.spark.sql.SparkSession$$anonfun$4.apply(SparkSession.scala:554)\n\tat org.apache.spark.sql.SparkSession$$anonfun$4.apply(SparkSession.scala:554)\n\tat scala.collection.Iterator$$anon$11.next(Iterator.scala:328)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIterator.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$8$$anon$1.hasNext(WholeStageCodegenExec.scala:377)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:231)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$2.apply(SparkPlan.scala:225)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$25.apply(RDD.scala:827)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:99)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:322)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)</div>","workflows":[],"startTime":1497635782445,"submitTime":1497635782445,"finishTime":1497635782893,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2d26e6f5-0e31-4226-89c0-6e8fa031e162"},{"version":"CommandV1","origId":336718490210114,"guid":"8b498212-2370-4285-97e4-5cc918336734","subtype":"command","commandType":"auto","position":129.0,"command":"from pyspark.sql import Row\nschema = df.schema\nnewRows = [\nRow(\"New Country\", \"Other Country\", 5L),\nRow(\"New Country 2\", \"Other Country 3\", 1L)\n]\nparallelizedRows = spark.sparkContext.parallelize(newRows)\nnewDF = spark.createDataFrame(parallelizedRows, schema)\n%python\ndf.union(newDF)\\\n.where(\"count = 1\")\\\n.where(col(\"ORIGIN_COUNTRY_NAME\") != \"United States\")\\\n.show()","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\">ERROR: Line magic function &#96;%python&#96; not found (But cell magic &#96;%%python&#96; exists, did you mean that instead?).\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 2 in stage 180.0 failed 1 times, most recent failure: Lost task 2.0 in stage 180.0 (TID 1884, localhost, executor driver): org.apache.spark.api.python.PythonException: Traceback (most recent call last):","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-150-62d9eb2f5739&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      8</span> newDF <span class=\"ansiyellow\">=</span> spark<span class=\"ansiyellow\">.</span>createDataFrame<span class=\"ansiyellow\">(</span>parallelizedRows<span class=\"ansiyellow\">,</span> schema<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      9</span> get_ipython<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>magic<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">u&apos;python&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 10</span><span class=\"ansiyellow\"> </span>df<span class=\"ansiyellow\">.</span>union<span class=\"ansiyellow\">(</span>newDF<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>where<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;count = 1&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>where<span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;ORIGIN_COUNTRY_NAME&quot;</span><span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">!=</span> <span class=\"ansiblue\">&quot;United States&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.py</span> in <span class=\"ansicyan\">show</span><span class=\"ansiblue\">(self, n, truncate)</span>\n<span class=\"ansigreen\">    316</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    317</span>         <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>truncate<span class=\"ansiyellow\">,</span> bool<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">and</span> truncate<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 318</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">print</span><span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>showString<span class=\"ansiyellow\">(</span>n<span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">20</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    319</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">print</span><span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>showString<span class=\"ansiyellow\">(</span>n<span class=\"ansiyellow\">,</span> int<span class=\"ansiyellow\">(</span>truncate<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o1692.showString.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 2 in stage 180.0 failed 1 times, most recent failure: Lost task 2.0 in stage 180.0 (TID 1884, localhost, executor driver): org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 171, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 166, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/serializers.py&quot;, line 268, in dump_stream\n    vs = list(itertools.islice(iterator, batch))\n  File &quot;/databricks/spark/python/pyspark/sql/session.py&quot;, line 509, in prepare\n    verify_func(obj, schema)\n  File &quot;/databricks/spark/python/pyspark/sql/types.py&quot;, line 1360, in _verify_type\n    _verify_type(v, f.dataType, f.nullable)\n  File &quot;/databricks/spark/python/pyspark/sql/types.py&quot;, line 1324, in _verify_type\n    raise TypeError(&quot;%s can not accept object %r in type %s&quot; % (dataType, obj, type(obj)))\nTypeError: LongType can not accept object &apos;New Country&apos; in type &lt;type &apos;str&apos;&gt;\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:193)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:234)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:152)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:63)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.rdd.UnionRDD.compute(UnionRDD.scala:105)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:99)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:322)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1442)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1430)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1429)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1429)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:803)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:803)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1657)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1612)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1601)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1937)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1950)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1963)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:333)\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n\tat org.apache.spark.sql.Dataset$$anonfun$7.apply(Dataset.scala:252)\n\tat org.apache.spark.sql.Dataset$$anonfun$7.apply(Dataset.scala:248)\n\tat org.apache.spark.sql.Dataset$$anonfun$60.apply(Dataset.scala:2791)\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:87)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:70)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:2790)\n\tat org.apache.spark.sql.Dataset.showString(Dataset.scala:248)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 171, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 166, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/serializers.py&quot;, line 268, in dump_stream\n    vs = list(itertools.islice(iterator, batch))\n  File &quot;/databricks/spark/python/pyspark/sql/session.py&quot;, line 509, in prepare\n    verify_func(obj, schema)\n  File &quot;/databricks/spark/python/pyspark/sql/types.py&quot;, line 1360, in _verify_type\n    _verify_type(v, f.dataType, f.nullable)\n  File &quot;/databricks/spark/python/pyspark/sql/types.py&quot;, line 1324, in _verify_type\n    raise TypeError(&quot;%s can not accept object %r in type %s&quot; % (dataType, obj, type(obj)))\nTypeError: LongType can not accept object &apos;New Country&apos; in type &lt;type &apos;str&apos;&gt;\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:193)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:234)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:152)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:63)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.rdd.UnionRDD.compute(UnionRDD.scala:105)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:99)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:322)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n</div>","workflows":[],"startTime":1497635794792,"submitTime":1497635794792,"finishTime":1497635795575,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5a37d43b-0f7a-4889-86d8-02306c82a74a"},{"version":"CommandV1","origId":336718490210115,"guid":"644603b5-4b37-42b0-b59f-41df60cec8ed","subtype":"command","commandType":"auto","position":130.0,"command":"%scala\ndf.sort(\"count\").show(5)\ndf.orderBy(\"count\", \"DEST_COUNTRY_NAME\").show(5)\ndf.orderBy(col(\"count\"), col(\"DEST_COUNTRY_NAME\")).show(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+--------------------+-------------------+\n|count|   dest_country_name|origin_country_name|\n+-----+--------------------+-------------------+\n|    1|               Malta|      United States|\n|    1|Saint Vincent and...|      United States|\n|    1|       United States|            Croatia|\n|    1|       United States|          Gibraltar|\n|    1|       United States|          Singapore|\n+-----+--------------------+-------------------+\nonly showing top 5 rows\n\n+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|    1|     Burkina Faso|      United States|\n|    1|    Cote d'Ivoire|      United States|\n|    1|           Cyprus|      United States|\n|    1|         Djibouti|      United States|\n|    1|        Indonesia|      United States|\n+-----+-----------------+-------------------+\nonly showing top 5 rows\n\n+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|    1|     Burkina Faso|      United States|\n|    1|    Cote d'Ivoire|      United States|\n|    1|           Cyprus|      United States|\n|    1|         Djibouti|      United States|\n|    1|        Indonesia|      United States|\n+-----+-----------------+-------------------+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635805659,"submitTime":1497635805635,"finishTime":1497635806015,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8d37edda-58e0-4aa5-9f54-a207bd363fb0"},{"version":"CommandV1","origId":336718490210116,"guid":"7be442d8-f1ac-4d87-8047-1c31bccca42e","subtype":"command","commandType":"auto","position":131.0,"command":"df.sort(\"count\").show(5)\ndf.orderBy(\"count\", \"DEST_COUNTRY_NAME\").show(5)\ndf.orderBy(col(\"count\"), col(\"DEST_COUNTRY_NAME\")).show(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+--------------------+-------------------+\n|count|   dest_country_name|origin_country_name|\n+-----+--------------------+-------------------+\n|    1|               Malta|      United States|\n|    1|Saint Vincent and...|      United States|\n|    1|       United States|            Croatia|\n|    1|       United States|          Gibraltar|\n|    1|       United States|          Singapore|\n+-----+--------------------+-------------------+\nonly showing top 5 rows\n\n+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|    1|     Burkina Faso|      United States|\n|    1|    Cote d&apos;Ivoire|      United States|\n|    1|           Cyprus|      United States|\n|    1|         Djibouti|      United States|\n|    1|        Indonesia|      United States|\n+-----+-----------------+-------------------+\nonly showing top 5 rows\n\n+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|    1|     Burkina Faso|      United States|\n|    1|    Cote d&apos;Ivoire|      United States|\n|    1|           Cyprus|      United States|\n|    1|         Djibouti|      United States|\n|    1|        Indonesia|      United States|\n+-----+-----------------+-------------------+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635815622,"submitTime":1497635815597,"finishTime":1497635816045,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"04df3c72-d043-4a6d-949b-7fa57e9471ee"},{"version":"CommandV1","origId":336718490210117,"guid":"76612b0a-8d09-4982-b0e2-9f4012672f5d","subtype":"command","commandType":"auto","position":132.0,"command":"%scala\nimport org.apache.spark.sql.functions.{desc, asc}\ndf.orderBy(expr(\"count desc\")).show(2)\ndf.orderBy(desc(\"count\"), asc(\"DEST_COUNTRY_NAME\")).show(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|    1|          Moldova|      United States|\n|    1|    United States|            Croatia|\n+-----+-----------------+-------------------+\nonly showing top 2 rows\n\n+------+-----------------+-------------------+\n| count|dest_country_name|origin_country_name|\n+------+-----------------+-------------------+\n|370002|    United States|      United States|\n|  8483|    United States|             Canada|\n+------+-----------------+-------------------+\nonly showing top 2 rows\n\nimport org.apache.spark.sql.functions.{desc, asc}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635826903,"submitTime":1497635826681,"finishTime":1497635827247,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a9354152-7f4b-4a77-9f2f-a76e89eced41"},{"version":"CommandV1","origId":336718490210118,"guid":"70a8aee6-7578-46bf-89ad-bba88dc92567","subtype":"command","commandType":"auto","position":133.0,"command":"from pyspark.sql.functions import desc, asc\ndf.orderBy(expr(\"count desc\")).show(2)\ndf.orderBy(desc(col(\"count\")), asc(col(\"DEST_COUNTRY_NAME\"))).show(2)","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|    1|          Moldova|      United States|\n|    1|    United States|            Croatia|\n+-----+-----------------+-------------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"py4j.Py4JException: Method desc([class org.apache.spark.sql.Column]) does not exist","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-152-ee09295137ef&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">.</span>functions <span class=\"ansigreen\">import</span> desc<span class=\"ansiyellow\">,</span> asc<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> df<span class=\"ansiyellow\">.</span>orderBy<span class=\"ansiyellow\">(</span>expr<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;count desc&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span>df<span class=\"ansiyellow\">.</span>orderBy<span class=\"ansiyellow\">(</span>desc<span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;count&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> asc<span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;DEST_COUNTRY_NAME&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/functions.py</span> in <span class=\"ansicyan\">_</span><span class=\"ansiblue\">(col)</span>\n<span class=\"ansigreen\">     37</span>     <span class=\"ansigreen\">def</span> _<span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     38</span>         sc <span class=\"ansiyellow\">=</span> SparkContext<span class=\"ansiyellow\">.</span>_active_spark_context<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 39</span><span class=\"ansiyellow\">         </span>jc <span class=\"ansiyellow\">=</span> getattr<span class=\"ansiyellow\">(</span>sc<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>functions<span class=\"ansiyellow\">,</span> name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">.</span>_jc <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>col<span class=\"ansiyellow\">,</span> Column<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">else</span> col<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     40</span>         <span class=\"ansigreen\">return</span> Column<span class=\"ansiyellow\">(</span>jc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     41</span>     _<span class=\"ansiyellow\">.</span>__name__ <span class=\"ansiyellow\">=</span> name<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n<span class=\"ansigreen\">    322</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}. Trace:\\n{3}\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 323</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name, value))\n</span><span class=\"ansigreen\">    324</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    325</span>             raise Py4JError(\n\n<span class=\"ansired\">Py4JError</span>: An error occurred while calling z:org.apache.spark.sql.functions.desc. Trace:\npy4j.Py4JException: Method desc([class org.apache.spark.sql.Column]) does not exist\n\tat py4j.reflection.ReflectionEngine.getMethod(ReflectionEngine.java:318)\n\tat py4j.reflection.ReflectionEngine.getMethod(ReflectionEngine.java:339)\n\tat py4j.Gateway.invoke(Gateway.java:274)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\n\n</div>","workflows":[],"startTime":1497635835928,"submitTime":1497635835928,"finishTime":1497635836210,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0b6bf53a-0df7-4d85-a21b-60555f7d6bae"},{"version":"CommandV1","origId":336718490210119,"guid":"5b4db8c4-22de-4245-9075-7851773e5cf0","subtype":"command","commandType":"auto","position":134.0,"command":"%sql\nSELECT *\nFROM dfTable\nORDER BY count DESC, DEST_COUNTRY_NAME ASC","commandVersion":0,"state":"finished","results":{"type":"table","data":[[370002,"United States","United States"],[8483,"United States","Canada"],[8399,"Canada","United States"],[7187,"United States","Mexico"],[7140,"Mexico","United States"],[2025,"United Kingdom","United States"],[1970,"United States","United Kingdom"],[1548,"Japan","United States"],[1496,"United States","Japan"],[1468,"Germany","United States"],[1420,"United States","Dominican Republic"],[1353,"Dominican Republic","United States"],[1336,"United States","Germany"],[1048,"South Korea","United States"],[986,"United States","The Bahamas"],[955,"The Bahamas","United States"],[952,"United States","France"],[935,"France","United States"],[920,"United States","China"],[873,"Colombia","United States"],[867,"United States","Colombia"],[853,"Brazil","United States"],[827,"United States","South Korea"],[776,"Netherlands","United States"],[772,"China","United States"],[712,"United States","Jamaica"],[666,"Jamaica","United States"],[660,"United States","Netherlands"],[619,"United States","Brazil"],[608,"United States","Costa Rica"],[588,"Costa Rica","United States"],[561,"El Salvador","United States"],[510,"Panama","United States"],[508,"United States","El Salvador"],[478,"United States","Cuba"],[466,"Cuba","United States"],[465,"United States","Panama"],[442,"United States","Spain"],[438,"United States","Italy"],[420,"Spain","United States"],[414,"United States","Hong Kong"],[407,"United States","Honduras"],[397,"Guatemala","United States"],[382,"Italy","United States"],[362,"Honduras","United States"],[346,"Aruba","United States"],[344,"United States","Ireland"],[342,"United States","Aruba"],[337,"United States","Peru"],[335,"Ireland","United States"],[332,"Hong Kong","United States"],[329,"Australia","United States"],[325,"Sint Maarten","United States"],[325,"United States","Sint Maarten"],[320,"United Arab Emirates","United States"],[318,"United States","Guatemala"],[314,"Cayman Islands","United States"],[313,"United States","United Arab Emirates"],[310,"United States","Cayman Islands"],[305,"United States","Switzerland"],[300,"United States","Ecuador"],[294,"Switzerland","United States"],[290,"Venezuela","United States"],[279,"Peru","United States"],[268,"Ecuador","United States"],[266,"Taiwan","United States"],[259,"Belgium","United States"],[258,"United States","Australia"],[246,"United States","Venezuela"],[236,"United States","Turks and Caicos Islands"],[235,"United States","Taiwan"],[230,"Turks and Caicos Islands","United States"],[228,"United States","Belgium"],[226,"Haiti","United States"],[225,"United States","Haiti"],[217,"United States","Trinidad and Tobago"],[211,"Trinidad and Tobago","United States"],[202,"United States","Iceland"],[201,"United States","Nicaragua"],[193,"United States","Bermuda"],[193,"United States","Belize"],[188,"Belize","United States"],[185,"United States","Chile"],[183,"Bermuda","United States"],[181,"Iceland","United States"],[180,"Argentina","United States"],[179,"Nicaragua","United States"],[176,"Russia","United States"],[174,"Chile","United States"],[161,"United States","Russia"],[155,"Luxembourg","United States"],[154,"Barbados","United States"],[153,"Denmark","United States"],[152,"United States","Denmark"],[145,"United States","Saint Kitts and Nevis"],[141,"United States","Argentina"],[139,"Saint Kitts and Nevis","United States"],[138,"Turkey","United States"],[136,"United States","Saint Lucia"],[134,"Israel","United States"],[134,"Philippines","United States"],[134,"United States","Portugal"],[134,"United States","Luxembourg"],[130,"United States","Barbados"],[129,"United States","Turkey"],[127,"Portugal","United States"],[127,"United States","Israel"],[126,"Antigua and Barbuda","United States"],[126,"United States","Philippines"],[123,"Saint Lucia","United States"],[121,"Norway","United States"],[119,"United States","Sweden"],[118,"Sweden","United States"],[117,"United States","Antigua and Barbuda"],[115,"United States","Norway"],[111,"New Zealand","United States"],[109,"United States","Qatar"],[108,"Qatar","United States"],[107,"British Virgin Islands","United States"],[90,"Curacao","United States"],[83,"Saudi Arabia","United States"],[83,"United States","Curacao"],[80,"United States","British Virgin Islands"],[74,"United States","New Zealand"],[70,"United States","Saudi Arabia"],[69,"Federated States of Micronesia","United States"],[69,"United States","Federated States of Micronesia"],[64,"Guyana","United States"],[63,"United States","Austria"],[63,"United States","Guyana"],[62,"Austria","United States"],[62,"United States","India"],[62,"United States","Grenada"],[61,"India","United States"],[60,"Paraguay","United States"],[59,"Nigeria","United States"],[59,"United States","Guadeloupe"],[59,"United States","Bonaire, Sint Eustatius, and Saba"],[58,"Bonaire, Sint Eustatius, and Saba","United States"],[56,"Guadeloupe","United States"],[53,"Grenada","United States"],[50,"United States","Nigeria"],[44,"Jordan","United States"],[44,"Martinique","United States"],[44,"United States","Jordan"],[43,"French Polynesia","United States"],[43,"United States","Martinique"],[43,"Uruguay","United States"],[42,"Marshall Islands","United States"],[42,"United States","Senegal"],[41,"Anguilla","United States"],[41,"United States","Saint Barthelemy"],[40,"Senegal","United States"],[40,"United States","South Africa"],[40,"United States","French Polynesia"],[39,"Saint Barthelemy","United States"],[39,"United States","Marshall Islands"],[38,"United States","Anguilla"],[36,"South Africa","United States"],[35,"United States","Kiribati"],[34,"United States","Suriname"],[33,"United States","Poland"],[32,"Kuwait","United States"],[32,"Poland","United States"],[31,"United States","Palau"],[30,"Bolivia","United States"],[30,"Greece","United States"],[30,"Palau","United States"],[28,"United States","Finland"],[28,"United States","Kuwait"],[27,"United States","Dominica"],[26,"Finland","United States"],[26,"Kiribati","United States"],[25,"Samoa","United States"],[25,"United States","Fiji"],[25,"United States","Samoa"],[24,"Fiji","United States"],[23,"United States","Greece"],[21,"Azerbaijan","United States"],[21,"United States","Azerbaijan"],[20,"Cape Verde","United States"],[20,"Dominica","United States"],[20,"United States","Ghana"],[19,"Bahrain","United States"],[19,"Latvia","United States"],[19,"United States","Morocco"],[18,"Ghana","United States"],[15,"Angola","United States"],[15,"Egypt","United States"],[15,"Morocco","United States"],[15,"United States","Latvia"],[15,"United States","Romania"],[14,"Romania","United States"],[14,"Ukraine","United States"],[14,"United States","Cape Verde"],[13,"Cook Islands","United States"],[13,"Czech Republic","United States"],[13,"Ethiopia","United States"],[13,"United States","Angola"],[13,"United States","Ukraine"],[13,"United States","Bolivia"],[13,"United States","Cook Islands"],[13,"United States","Uruguay"],[12,"Pakistan","United States"],[12,"United States","Pakistan"],[12,"United States","Czech Republic"],[12,"United States","Ethiopia"],[12,"United States","Egypt"],[6,"United States","Paraguay"],[5,"French Guiana","United States"],[4,"Algeria","United States"],[4,"United States","Thailand"],[4,"United States","Greenland"],[3,"Bulgaria","United States"],[3,"Papua New Guinea","United States"],[3,"Singapore","United States"],[3,"Thailand","United States"],[3,"Tunisia","United States"],[3,"United States","Malaysia"],[3,"United States","Hungary"],[2,"Croatia","United States"],[2,"Georgia","United States"],[2,"Greenland","United States"],[2,"Hungary","United States"],[2,"Liberia","United States"],[2,"Malaysia","United States"],[2,"Niger","United States"],[2,"United States","Liberia"],[2,"United States","Malta"],[2,"United States","Vietnam"],[2,"United States","Indonesia"],[1,"Burkina Faso","United States"],[1,"Cote d'Ivoire","United States"],[1,"Cyprus","United States"],[1,"Djibouti","United States"],[1,"Indonesia","United States"],[1,"Iraq","United States"],[1,"Kosovo","United States"],[1,"Malta","United States"],[1,"Moldova","United States"],[1,"New Caledonia","United States"],[1,"Saint Vincent and the Grenadines","United States"],[1,"Suriname","United States"],[1,"United States","Croatia"],[1,"United States","Singapore"],[1,"United States","Gibraltar"],[1,"United States","Cyprus"],[1,"United States","Estonia"],[1,"United States","Lithuania"],[1,"United States","Bahrain"],[1,"United States","Bulgaria"],[1,"United States","Papua New Guinea"],[1,"United States","Montenegro"],[1,"United States","Georgia"],[1,"United States","Namibia"],[1,"Zambia","United States"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count","type":"\"long\"","metadata":"{}"},{"name":"dest_country_name","type":"\"string\"","metadata":"{}"},{"name":"origin_country_name","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497635851044,"submitTime":1497635851018,"finishTime":1497635851197,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"67e204e1-c899-4726-ac1e-5575f9859fd1"},{"version":"CommandV1","origId":336718490210120,"guid":"e590de33-74d2-492a-a730-3841b292d564","subtype":"command","commandType":"auto","position":135.0,"command":"%scala\nspark.read.format(\"json\")\n.load(\"/FileStore/tables/8su3wraj1497632771405/*summary-ebaee.json\")\n.sortWithinPartitions(\"count\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res58: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [count: bigint, dest_country_name: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Path does not exist: dbfs:/FileStore/tables/8su3wraj1497632771405/*-summary-ebaee.json;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:367)\n\tat org.apache.spark.sql.execution.datasources.DataSource$$anonfun$14.apply(DataSource.scala:360)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:251)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:251)\n\tat scala.collection.AbstractTraversable.flatMap(Traversable.scala:105)\n\tat org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:360)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:154)\n\tat org.apache.spark.sql.DataFrameReader$$anonfun$load$1.apply(DataFrameReader.scala:148)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:147)\n\tat org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:136)</div>","workflows":[],"startTime":1497636025942,"submitTime":1497636025935,"finishTime":1497636026574,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e141c1b9-eb0f-43c0-a40e-41d9b7896a04"},{"version":"CommandV1","origId":336718490210121,"guid":"639ebce9-f477-491f-8368-d3be056f05ec","subtype":"command","commandType":"auto","position":136.0,"command":"spark.read.format(\"json\")\\\n.load(\"/FileStore/tables/8su3wraj1497632771405/*summary-ebaee.json\")\\\n.sortWithinPartitions(\"count\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">154</span><span class=\"ansired\">]: </span>DataFrame[count: bigint, dest_country_name: string, origin_country_name: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/flight-data/json/*-summary.json;&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-153-3493765d5d75&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>spark<span class=\"ansiyellow\">.</span>read<span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;json&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;/mnt/defg/flight-data/json/*-summary.json&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>sortWithinPartitions<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;count&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/readwriter.py</span> in <span class=\"ansicyan\">load</span><span class=\"ansiblue\">(self, path, format, schema, **options)</span>\n<span class=\"ansigreen\">    147</span>         self<span class=\"ansiyellow\">.</span>options<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">**</span>options<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    148</span>         <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">,</span> basestring<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 149</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_df<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jreader<span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    150</span>         <span class=\"ansigreen\">elif</span> path <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    151</span>             <span class=\"ansigreen\">if</span> type<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">!=</span> list<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&apos;Path does not exist: dbfs:/mnt/defg/flight-data/json/*-summary.json;&apos;</div>","workflows":[],"startTime":1497636040665,"submitTime":1497636040658,"finishTime":1497636041090,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1eb6a8af-19f8-4fa8-a247-5066c66510f3"},{"version":"CommandV1","origId":336718490210122,"guid":"00556d5a-ed6a-4047-9c80-5505c3c50bc8","subtype":"command","commandType":"auto","position":137.0,"command":"%scala\ndf.limit(5).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|   15|    United States|            Romania|\n|    1|    United States|            Croatia|\n|  344|    United States|            Ireland|\n|   15|            Egypt|      United States|\n|   62|    United States|              India|\n+-----+-----------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636052696,"submitTime":1497636052691,"finishTime":1497636052910,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"be66716c-67b2-4603-9e12-8f913bd92ce7"},{"version":"CommandV1","origId":336718490210123,"guid":"36067087-5708-48d4-8a89-e9cc3ecf9565","subtype":"command","commandType":"auto","position":138.0,"command":"df.limit(5).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|   15|    United States|            Romania|\n|    1|    United States|            Croatia|\n|  344|    United States|            Ireland|\n|   15|            Egypt|      United States|\n|   62|    United States|              India|\n+-----+-----------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636062205,"submitTime":1497636062178,"finishTime":1497636062327,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ab658e1f-cd8a-408c-b3f0-95f1f3aada35"},{"version":"CommandV1","origId":336718490210124,"guid":"172f456e-d0a0-4788-8389-b55c24bba8ea","subtype":"command","commandType":"auto","position":139.0,"command":"%scala\ndf.orderBy(expr(\"count desc\")).limit(6).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+--------------------+-------------------+\n|count|   dest_country_name|origin_country_name|\n+-----+--------------------+-------------------+\n|    1|               Malta|      United States|\n|    1|Saint Vincent and...|      United States|\n|    1|       United States|            Croatia|\n|    1|       United States|          Gibraltar|\n|    1|       United States|          Singapore|\n|    1|             Moldova|      United States|\n+-----+--------------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636069535,"submitTime":1497636069507,"finishTime":1497636069699,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2a99eae9-2241-4202-98e5-47bcf23f1b82"},{"version":"CommandV1","origId":336718490210125,"guid":"20b14a85-bb9b-4b2f-98d1-cab1c88b1196","subtype":"command","commandType":"auto","position":140.0,"command":"df.orderBy(expr(\"count desc\")).limit(6).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+--------------------+-------------------+\n|count|   dest_country_name|origin_country_name|\n+-----+--------------------+-------------------+\n|    1|               Malta|      United States|\n|    1|Saint Vincent and...|      United States|\n|    1|       United States|            Croatia|\n|    1|       United States|          Gibraltar|\n|    1|       United States|          Singapore|\n|    1|             Moldova|      United States|\n+-----+--------------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636077533,"submitTime":1497636077506,"finishTime":1497636077755,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4aecbfe9-52a3-4350-b0c5-5de14d2f6538"},{"version":"CommandV1","origId":336718490210126,"guid":"bb70b477-0b29-4406-bed5-29f2aca2b407","subtype":"command","commandType":"auto","position":141.0,"command":"%sql\nSELECT *\nFROM dfTable\nLIMIT 6","commandVersion":0,"state":"finished","results":{"type":"table","data":[[15,"United States","Romania"],[1,"United States","Croatia"],[344,"United States","Ireland"],[15,"Egypt","United States"],[62,"United States","India"],[1,"United States","Singapore"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count","type":"\"long\"","metadata":"{}"},{"name":"dest_country_name","type":"\"string\"","metadata":"{}"},{"name":"origin_country_name","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636086224,"submitTime":1497636086197,"finishTime":1497636086428,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5792e19b-5beb-4841-9f48-ff21167ad221"},{"version":"CommandV1","origId":336718490210127,"guid":"d3714e9b-ea35-40e2-b695-6473c17e1a69","subtype":"command","commandType":"auto","position":142.0,"command":"%scala\ndf.rdd.getNumPartitions","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res61: Int = 1\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636096047,"submitTime":1497636096018,"finishTime":1497636096132,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e8df33a4-3195-46a7-aee0-ae5ecef48220"},{"version":"CommandV1","origId":336718490210128,"guid":"ea6dcecf-8551-4539-bd8d-26a7efee3b72","subtype":"command","commandType":"auto","position":143.0,"command":"df.rdd.getNumPartitions()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">157</span><span class=\"ansired\">]: </span>1\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636105051,"submitTime":1497636105024,"finishTime":1497636105122,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"54ff531d-2b0b-4bab-a3f3-15f4c9890303"},{"version":"CommandV1","origId":336718490210129,"guid":"ea255dc7-1134-47ea-9985-3f6842be24ea","subtype":"command","commandType":"auto","position":144.0,"command":"%scala\ndf.repartition(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res62: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [count: bigint, dest_country_name: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636114496,"submitTime":1497636114469,"finishTime":1497636114562,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cc3b45cb-0dbe-4e2b-90f7-d70571e7e087"},{"version":"CommandV1","origId":336718490210130,"guid":"f0990036-4866-4894-ba1a-6a2d0363ee1c","subtype":"command","commandType":"auto","position":145.0,"command":"df.repartition(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">158</span><span class=\"ansired\">]: </span>DataFrame[count: bigint, dest_country_name: string, origin_country_name: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636120340,"submitTime":1497636120312,"finishTime":1497636120378,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fa385dfd-5eee-4cad-8a13-b7e80bf5c3e8"},{"version":"CommandV1","origId":336718490210131,"guid":"9f8587d5-ab50-415f-9b7b-d9b28733dc01","subtype":"command","commandType":"auto","position":146.0,"command":"%scala\ndf.repartition(col(\"DEST_COUNTRY_NAME\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res63: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [count: bigint, dest_country_name: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636128487,"submitTime":1497636128459,"finishTime":1497636128556,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"083cc5e6-c220-4d46-b332-982d16a9efd0"},{"version":"CommandV1","origId":336718490210132,"guid":"18cb4ed9-d2b4-4de0-97bf-4c62124d1643","subtype":"command","commandType":"auto","position":147.0,"command":"df.repartition(col(\"DEST_COUNTRY_NAME\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">159</span><span class=\"ansired\">]: </span>DataFrame[count: bigint, dest_country_name: string, origin_country_name: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636134326,"submitTime":1497636134299,"finishTime":1497636134364,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8a0f2732-9a85-4e7a-9c3e-f48573ebcfbc"},{"version":"CommandV1","origId":336718490210133,"guid":"94fff91d-563c-47f3-b181-39720f710efc","subtype":"command","commandType":"auto","position":148.0,"command":"%scala\ndf.repartition(5, col(\"DEST_COUNTRY_NAME\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res64: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [count: bigint, dest_country_name: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636141766,"submitTime":1497636141738,"finishTime":1497636141851,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0efe68fc-02df-4d33-bd39-e54bb90525d6"},{"version":"CommandV1","origId":336718490210134,"guid":"03d94253-84df-4915-92b9-60a83ce3bb68","subtype":"command","commandType":"auto","position":149.0,"command":"df.repartition(5, col(\"DEST_COUNTRY_NAME\"))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">160</span><span class=\"ansired\">]: </span>DataFrame[count: bigint, dest_country_name: string, origin_country_name: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636148779,"submitTime":1497636148743,"finishTime":1497636148850,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d9df3ac7-d1ed-426a-9ed2-4e47977085ea"},{"version":"CommandV1","origId":336718490210135,"guid":"5ecafbe1-c23a-4b3a-aced-a18bbf4fb51a","subtype":"command","commandType":"auto","position":150.0,"command":"%scala\ndf.repartition(5, col(\"DEST_COUNTRY_NAME\")).coalesce(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res65: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [count: bigint, dest_country_name: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636155695,"submitTime":1497636155667,"finishTime":1497636155771,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c63f6083-f4d2-4b20-8142-c097cbedcb0c"},{"version":"CommandV1","origId":336718490210136,"guid":"b25a5eff-5fdd-4ef3-9617-116dede3622c","subtype":"command","commandType":"auto","position":151.0,"command":"df.repartition(5, col(\"DEST_COUNTRY_NAME\")).coalesce(2)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">161</span><span class=\"ansired\">]: </span>DataFrame[count: bigint, dest_country_name: string, origin_country_name: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636162342,"submitTime":1497636162314,"finishTime":1497636162463,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c39b9f1c-b6a3-4a87-8b3d-f1125bbb094e"},{"version":"CommandV1","origId":336718490210137,"guid":"d944b32c-d7ac-4a8b-b5d2-efbdf89d1c66","subtype":"command","commandType":"auto","position":152.0,"command":"%scala\nval collectDF = df.limit(10)\ncollectDF.take(5) // take works with an Integer count\ncollectDF.show() // this prints it out nicely\ncollectDF.show(5, false)\ncollectDF.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|   15|    United States|            Romania|\n|    1|    United States|            Croatia|\n|  344|    United States|            Ireland|\n|   15|            Egypt|      United States|\n|   62|    United States|              India|\n|    1|    United States|          Singapore|\n|   62|    United States|            Grenada|\n|  588|       Costa Rica|      United States|\n|   40|          Senegal|      United States|\n|    1|          Moldova|      United States|\n+-----+-----------------+-------------------+\n\n+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|15   |United States    |Romania            |\n|1    |United States    |Croatia            |\n|344  |United States    |Ireland            |\n|15   |Egypt            |United States      |\n|62   |United States    |India              |\n+-----+-----------------+-------------------+\nonly showing top 5 rows\n\ncollectDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [count: bigint, dest_country_name: string ... 1 more field]\nres66: Array[org.apache.spark.sql.Row] = Array([15,United States,Romania], [1,United States,Croatia], [344,United States,Ireland], [15,Egypt,United States], [62,United States,India], [1,United States,Singapore], [62,United States,Grenada], [588,Costa Rica,United States], [40,Senegal,United States], [1,Moldova,United States])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636169530,"submitTime":1497636169503,"finishTime":1497636169922,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"53f70c81-345e-4d32-89ab-8a77a082728f"},{"version":"CommandV1","origId":336718490210138,"guid":"a37ab9a2-5869-4d2e-a2d9-e0d24b4c10f5","subtype":"command","commandType":"auto","position":153.0,"command":"collectDF = df.limit(10)\ncollectDF.take(5) # take works with an Integer count\ncollectDF.show() # this prints it out nicely\ncollectDF.show(5, False)\ncollectDF.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|   15|    United States|            Romania|\n|    1|    United States|            Croatia|\n|  344|    United States|            Ireland|\n|   15|            Egypt|      United States|\n|   62|    United States|              India|\n|    1|    United States|          Singapore|\n|   62|    United States|            Grenada|\n|  588|       Costa Rica|      United States|\n|   40|          Senegal|      United States|\n|    1|          Moldova|      United States|\n+-----+-----------------+-------------------+\n\n+-----+-----------------+-------------------+\n|count|dest_country_name|origin_country_name|\n+-----+-----------------+-------------------+\n|15   |United States    |Romania            |\n|1    |United States    |Croatia            |\n|344  |United States    |Ireland            |\n|15   |Egypt            |United States      |\n|62   |United States    |India              |\n+-----+-----------------+-------------------+\nonly showing top 5 rows\n\n<span class=\"ansired\">Out[</span><span class=\"ansired\">162</span><span class=\"ansired\">]: </span>\n[Row(count=15, dest_country_name=u&apos;United States&apos;, origin_country_name=u&apos;Romania&apos;),\n Row(count=1, dest_country_name=u&apos;United States&apos;, origin_country_name=u&apos;Croatia&apos;),\n Row(count=344, dest_country_name=u&apos;United States&apos;, origin_country_name=u&apos;Ireland&apos;),\n Row(count=15, dest_country_name=u&apos;Egypt&apos;, origin_country_name=u&apos;United States&apos;),\n Row(count=62, dest_country_name=u&apos;United States&apos;, origin_country_name=u&apos;India&apos;),\n Row(count=1, dest_country_name=u&apos;United States&apos;, origin_country_name=u&apos;Singapore&apos;),\n Row(count=62, dest_country_name=u&apos;United States&apos;, origin_country_name=u&apos;Grenada&apos;),\n Row(count=588, dest_country_name=u&apos;Costa Rica&apos;, origin_country_name=u&apos;United States&apos;),\n Row(count=40, dest_country_name=u&apos;Senegal&apos;, origin_country_name=u&apos;United States&apos;),\n Row(count=1, dest_country_name=u&apos;Moldova&apos;, origin_country_name=u&apos;United States&apos;)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497636189496,"submitTime":1497636189466,"finishTime":1497636189869,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"15091ec4-e666-427a-88bd-7ed5770c1e2a"}],"dashboards":[],"guid":"dad1aaba-7d3b-4d53-8668-01467bb31605","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
