<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Definitive Draft Chapter 5-6 - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"serverlessDefaultSparkVersion":"2.2.x-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":14,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":0,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"serverlessClusterProductName":"Serverless Pool","enableTableHandler":false,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"serverlessClustersEnabled":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"perClusterAutoterminationEnabled":false,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"3.0 beta (Scala 2.11)","packageLabel":"spark-image-20adedc466bac7d0c91242baba4ae70dc8487d6e301359af185601969607d211","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-f43ddf8ad9acfd71338f5a51345f077173d236016ad7e39ffd6f698403acd4ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"3.0 beta (Scala 2.10)","packageLabel":"spark-image-a1d408c36c3e2c79b38783b57b626c7c6847c9639fa15dd22eca009c23b89c6f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":6,"class-node":1,"m4.2xlarge":0.5,"r4.xlarge":1,"m4.4xlarge":0.5,"r4.16xlarge":8,"Standard_DS11":0.5,"p2.8xlarge":16,"m4.10xlarge":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.5,"r4.8xlarge":8,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.5,"p2.16xlarge":24,"i3.8xlarge":12,"i3.16xlarge":24,"Standard_DS12_v2":1,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"i3.2xlarge":3,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":0.5,"c4.8xlarge":4,"i3.xlarge":1.5,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.47","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableNonPollingTableCall":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":180,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"enableElasticDisk":false,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"ea633ce26684806264e7bd2cbb05130eb0f98c4d","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewJobList":false,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"enableEBSVolumesUIByTier":false,"singleSignOnComingSoon":false,"enableNewJobClusterEdit":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","maxAutoterminationMinutes":10000,"autoterminateClustersByDefault":true,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":336718490210273,"name":"Definitive Draft Chapter 5-6","language":"python","commands":[{"version":"CommandV1","origId":336718490210275,"guid":"33a3d240-fd60-47ef-a388-fdd15c363455","subtype":"command","commandType":"auto","position":1.0,"command":"%sh cd ..\ncd ..\ncd dbfs/FileStore/tables/1x42p66f1497639007910\nls","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">online_retail_dataset-92e8e.csv\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639277911,"submitTime":1497639277902,"finishTime":1497639278135,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0d690f94-733f-45ea-a1d6-ba3d46ee1122"},{"version":"CommandV1","origId":336718490210276,"guid":"b19ddc01-78a3-4e9b-abbf-91bf3d4fe966","subtype":"command","commandType":"auto","position":2.0,"command":"%scala\nval df = spark.read.format(\"csv\")\n.option(\"header\", \"true\")\n.option(\"inferSchema\", \"true\")\n.load(\"/FileStore/tables/1x42p66f1497639007910/online_retail_dataset-92e8e.csv\")\n.coalesce(5)\ndf.cache()\ndf.createOrReplaceTempView(\"dfTable\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">df: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [InvoiceNo: string, StockCode: string ... 6 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639312779,"submitTime":1497639312768,"finishTime":1497639314852,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"47337530-bae6-4392-bd00-34d768f99773"},{"version":"CommandV1","origId":336718490210277,"guid":"098716e0-5ef9-4a03-bc5c-8cc1e704aeb7","subtype":"command","commandType":"auto","position":3.0,"command":"df = spark.read.format(\"csv\")\\\n.option(\"header\", \"true\")\\\n.option(\"inferSchema\", \"true\")\\\n.load(\"/FileStore/tables/1x42p66f1497639007910/online_retail_dataset-92e8e.csv\")\\\n.coalesce(5)\ndf.cache()\ndf.createOrReplaceTempView(\"dfTable\")\ndf.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">4</span><span class=\"ansired\">]: </span>541909\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639360561,"submitTime":1497639360551,"finishTime":1497639363896,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5f0d613f-6d27-42da-8880-6c9c12641bff"},{"version":"CommandV1","origId":336718490210278,"guid":"2f5cd298-92fc-438d-8f58-80cad4428b1e","subtype":"command","commandType":"auto","position":4.0,"command":"%scala\nimport org.apache.spark.sql.functions.count\ndf.select(count(\"StockCode\")).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.count\nres1: Array[Long] = Array(541909)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639373503,"submitTime":1497639373496,"finishTime":1497639373962,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"eba04d32-d8da-4ee3-8fe8-8892a8ccb964"},{"version":"CommandV1","origId":336718490210279,"guid":"58d6a02d-643c-4c54-9573-11ecd5167b5a","subtype":"command","commandType":"auto","position":5.0,"command":"from pyspark.sql.functions import count\ndf.select(count(\"StockCode\")).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">5</span><span class=\"ansired\">]: </span>[Row(count(StockCode)=541909)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639380817,"submitTime":1497639380808,"finishTime":1497639380989,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3ede18ca-6d78-4de5-bd87-ad09e920f20c"},{"version":"CommandV1","origId":336718490210280,"guid":"28c1147c-3e3e-4314-a813-a43d4336dcd2","subtype":"command","commandType":"auto","position":6.0,"command":"%sql\nSELECT COUNT(*) FROM dfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[541909]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639388121,"submitTime":1497639388104,"finishTime":1497639388225,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f1a1c09a-0d41-4d3c-b42a-4a93130ae910"},{"version":"CommandV1","origId":336718490210281,"guid":"c6df151c-3e5d-4d4a-b6e3-1203490619d2","subtype":"command","commandType":"auto","position":7.0,"command":"%scala\nimport org.apache.spark.sql.functions.countDistinct\ndf.select(countDistinct(\"StockCode\")).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.countDistinct\nres2: Array[org.apache.spark.sql.Row] = Array([4070])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639396271,"submitTime":1497639396261,"finishTime":1497639397208,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d99db97e-03bb-4187-ba55-b2b8d45ba957"},{"version":"CommandV1","origId":336718490210282,"guid":"e9672cca-59e6-4b30-b1a9-6593bb499e42","subtype":"command","commandType":"auto","position":8.0,"command":"from pyspark.sql.functions import countDistinct\ndf.select(countDistinct(\"StockCode\")).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">6</span><span class=\"ansired\">]: </span>[Row(count(DISTINCT StockCode)=4070)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639403287,"submitTime":1497639403277,"finishTime":1497639404014,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"60b9452d-b21a-4867-994e-b1fe83406b6b"},{"version":"CommandV1","origId":336718490210283,"guid":"509e538a-bea7-4863-ba20-e5c6d6e9c25b","subtype":"command","commandType":"auto","position":9.0,"command":"%sql\nSELECT COUNT(DISTINCT *) FROM DFTABLE","commandVersion":0,"state":"finished","results":{"type":"table","data":[[401604]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count(DISTINCT InvoiceNo, StockCode, Description, Quantity, InvoiceDate, UnitPrice, CustomerID, Country)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639412038,"submitTime":1497639412028,"finishTime":1497639413827,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5739467f-932e-439b-a80e-adbde90ea1fa"},{"version":"CommandV1","origId":336718490210284,"guid":"594c8904-c6c0-475d-a189-f5a6d9cde308","subtype":"command","commandType":"auto","position":10.0,"command":"%scala\nimport org.apache.spark.sql.functions.approx_count_distinct\ndf.select(approx_count_distinct(\"StockCode\", 0.1)).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.approx_count_distinct\nres3: Array[org.apache.spark.sql.Row] = Array([3364])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639422534,"submitTime":1497639422525,"finishTime":1497639422925,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aa4e4460-b299-4231-9fd9-06acccb80235"},{"version":"CommandV1","origId":336718490210285,"guid":"a27217b1-7451-4367-b003-1e790cc90236","subtype":"command","commandType":"auto","position":11.0,"command":"from pyspark.sql.functions import approx_count_distinct\ndf.select(approx_count_distinct(\"StockCode\", 0.1)).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">7</span><span class=\"ansired\">]: </span>[Row(approx_count_distinct(StockCode)=3364)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639430547,"submitTime":1497639430537,"finishTime":1497639430770,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"34fe50d2-0b87-49df-be0c-eabadb0a4639"},{"version":"CommandV1","origId":336718490210286,"guid":"e620c589-b04e-4de1-af0f-95e526edea59","subtype":"command","commandType":"auto","position":12.0,"command":"%sql\nSELECT approx_count_distinct(StockCode, 0.1) FROM DFTABLE","commandVersion":0,"state":"finished","results":{"type":"table","data":[[3364]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"approx_count_distinct(StockCode)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639438484,"submitTime":1497639438474,"finishTime":1497639438631,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5f9cd131-c1c6-4fb8-9e1d-e6d56dae1437"},{"version":"CommandV1","origId":336718490210287,"guid":"94ee9c67-3e1b-4f11-a026-2d6afcf8120a","subtype":"command","commandType":"auto","position":13.0,"command":"%scala\nimport org.apache.spark.sql.functions.{first, last}\ndf.select(first(\"StockCode\"), last(\"StockCode\")).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.{first, last}\nres4: Array[org.apache.spark.sql.Row] = Array([85123A,22138])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639446788,"submitTime":1497639446777,"finishTime":1497639447111,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6dd40b64-6c00-496d-bb40-8626715343be"},{"version":"CommandV1","origId":336718490210288,"guid":"5ec1ac4e-17ef-403e-ba23-3ed6bfd6c957","subtype":"command","commandType":"auto","position":14.0,"command":"from pyspark.sql.functions import first, last\ndf.select(first(\"StockCode\"), last(\"StockCode\")).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">8</span><span class=\"ansired\">]: </span>[Row(first(StockCode, false)=u&apos;85123A&apos;, last(StockCode, false)=u&apos;22138&apos;)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639454631,"submitTime":1497639454621,"finishTime":1497639454804,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"072884ad-90a2-4dc3-845e-c3a3cbc529af"},{"version":"CommandV1","origId":336718490210289,"guid":"74ef0658-d541-4e4a-b032-ceb829f87384","subtype":"command","commandType":"auto","position":15.0,"command":"%sql\nSELECT first(StockCode), last(StockCode) FROM dfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[["85123A","22138"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"first(StockCode, false)","type":"\"string\"","metadata":"{}"},{"name":"last(StockCode, false)","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639461732,"submitTime":1497639461721,"finishTime":1497639461822,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"36953e77-e0fe-4e76-980c-afbf139bba4a"},{"version":"CommandV1","origId":336718490210290,"guid":"7f3e5df3-d9d3-42fc-a490-f1e2ec0f7f20","subtype":"command","commandType":"auto","position":16.0,"command":"%scala\nimport org.apache.spark.sql.functions.{min, max}\ndf.select(min(\"Quantity\"), max(\"Quantity\")).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.{min, max}\nres5: Array[org.apache.spark.sql.Row] = Array([-80995,80995])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639473529,"submitTime":1497639473519,"finishTime":1497639473760,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"df514f37-517e-4dea-99e0-138667c896b5"},{"version":"CommandV1","origId":336718490210291,"guid":"118cf3e2-981f-4b6a-b125-3d0f244693b1","subtype":"command","commandType":"auto","position":17.0,"command":"from pyspark.sql.functions import min, max\ndf.select(min(\"Quantity\"), max(\"Quantity\")).collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">9</span><span class=\"ansired\">]: </span>[Row(min(Quantity)=-80995, max(Quantity)=80995)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639482730,"submitTime":1497639482720,"finishTime":1497639482852,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a7d3a3c8-02a2-4117-82d6-4370468d373a"},{"version":"CommandV1","origId":336718490210292,"guid":"b237bd8b-1f1f-446f-a622-71c02f225988","subtype":"command","commandType":"auto","position":18.0,"command":"%sql\nSELECT min(Quantity), max(Quantity) FROM dfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[-80995,80995]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"min(Quantity)","type":"\"integer\"","metadata":"{}"},{"name":"max(Quantity)","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639493967,"submitTime":1497639493955,"finishTime":1497639494070,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ad523bf9-4b98-4068-8a77-2035db463e78"},{"version":"CommandV1","origId":336718490210293,"guid":"c8fbb374-dd1e-439b-997a-a4e11bdcbd3e","subtype":"command","commandType":"auto","position":19.0,"command":"%scala\nimport org.apache.spark.sql.functions.sum\ndf.select(sum(\"Quantity\")).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------+\n|sum(Quantity)|\n+-------------+\n|      5176450|\n+-------------+\n\nimport org.apache.spark.sql.functions.sum\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639503853,"submitTime":1497639503842,"finishTime":1497639504057,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"66aa7eaf-1cf6-453f-b2de-3f11454df15c"},{"version":"CommandV1","origId":336718490210294,"guid":"86eb6db8-e3a1-4cc1-9a76-5678362c4cb7","subtype":"command","commandType":"auto","position":20.0,"command":"from pyspark.sql.functions import sum\ndf.select(sum(\"Quantity\")).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------+\n|sum(Quantity)|\n+-------------+\n|      5176450|\n+-------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639510860,"submitTime":1497639510846,"finishTime":1497639510982,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3e73b696-9897-421a-a5c6-24b6979c6e24"},{"version":"CommandV1","origId":336718490210295,"guid":"1e65ae35-9522-445f-82fe-1d750a5cbaba","subtype":"command","commandType":"auto","position":21.0,"command":"%sql\nSELECT sum(Quantity) FROM dfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[5176450]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"sum(Quantity)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639518548,"submitTime":1497639518535,"finishTime":1497639518643,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fd5da741-7f30-4e82-a1d2-8f1d860fd1b9"},{"version":"CommandV1","origId":336718490210296,"guid":"90a566d3-4266-4a77-8b3e-a05573518690","subtype":"command","commandType":"auto","position":22.0,"command":"%scala\nimport org.apache.spark.sql.functions.sumDistinct\ndf.select(sumDistinct(\"Quantity\")).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------------------+\n|sum(DISTINCT Quantity)|\n+----------------------+\n|                 29310|\n+----------------------+\n\nimport org.apache.spark.sql.functions.sumDistinct\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639528946,"submitTime":1497639528935,"finishTime":1497639529674,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4b671915-7943-4047-b383-1af75e23c81b"},{"version":"CommandV1","origId":336718490210297,"guid":"f0e5dfe8-348a-45f4-b0c1-cf9f6c9a79f4","subtype":"command","commandType":"auto","position":23.0,"command":"from pyspark.sql.functions import sumDistinct\ndf.select(sumDistinct(\"Quantity\")).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------------------+\n|sum(DISTINCT Quantity)|\n+----------------------+\n|                 29310|\n+----------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639537747,"submitTime":1497639537735,"finishTime":1497639538271,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ed3784c2-4e0e-4c55-889b-70962bfd5d45"},{"version":"CommandV1","origId":336718490210298,"guid":"fe37de7f-d210-4d42-9710-ca08000f4e03","subtype":"command","commandType":"auto","position":24.0,"command":"%sql\nSELECT SUM(DISTINCT Quantity) FROM dfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[29310]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"sum(DISTINCT Quantity)","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639545046,"submitTime":1497639545035,"finishTime":1497639545678,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e817335c-aab3-42c3-9e77-d65d3c87551c"},{"version":"CommandV1","origId":336718490210299,"guid":"37358804-95a9-4ca7-948f-cfe1400deb90","subtype":"command","commandType":"auto","position":25.0,"command":"%scala\nimport org.apache.spark.sql.functions.{sum, count, avg, expr}\ndf.select(\ncount(\"Quantity\").alias(\"total_transactions\"),\nsum(\"Quantity\").alias(\"total_purchases\"),\navg(\"Quantity\").alias(\"avg_purchases\"),\nexpr(\"mean(Quantity)\").alias(\"mean_purchases\"))\n.selectExpr(\n\"total_purchases/total_transactions\",\n\"avg_purchases\",\n\"mean_purchases\")\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.{sum, count, avg, expr}\nres8: Array[org.apache.spark.sql.Row] = Array([9.55224954743324,9.55224954743324,9.55224954743324])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639556177,"submitTime":1497639556165,"finishTime":1497639556609,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7802d16b-c523-4c72-bdd5-31baa627a04a"},{"version":"CommandV1","origId":336718490210300,"guid":"d8a5772f-845d-4349-92e5-ea975178df2a","subtype":"command","commandType":"auto","position":26.0,"command":"from pyspark.sql.functions import sum, count, avg, expr\ndf.select(\ncount(\"Quantity\").alias(\"total_transactions\"),\nsum(\"Quantity\").alias(\"total_purchases\"),\navg(\"Quantity\").alias(\"avg_purchases\"),\nexpr(\"mean(Quantity)\").alias(\"mean_purchases\"))\\\n.selectExpr(\n\"total_purchases/total_transactions\",\n\"avg_purchases\",\n\"mean_purchases\")\\\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">12</span><span class=\"ansired\">]: </span>[Row((total_purchases / total_transactions)=9.55224954743324, avg_purchases=9.55224954743324, mean_purchases=9.55224954743324)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639569124,"submitTime":1497639569112,"finishTime":1497639569347,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"49197f5b-48a8-4adb-8c03-3d970915083a"},{"version":"CommandV1","origId":336718490210301,"guid":"44e1e33d-9603-4ceb-b093-979ca784e754","subtype":"command","commandType":"auto","position":27.0,"command":"%scala\nimport org.apache.spark.sql.functions.{var_pop, stddev_pop}\nimport org.apache.spark.sql.functions.{var_samp, stddev_samp}\ndf.select(\n  var_pop(\"Quantity\"),\nvar_samp(\"Quantity\"),\nstddev_pop(\"Quantity\"),\nstddev_samp(\"Quantity\"))\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.{var_pop, stddev_pop}\nimport org.apache.spark.sql.functions.{var_samp, stddev_samp}\nres9: Array[org.apache.spark.sql.Row] = Array([47559.303646609056,47559.391409298754,218.08095663447796,218.08115785023418])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639589404,"submitTime":1497639589393,"finishTime":1497639589748,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9132f7e4-8005-43f9-b19c-f93565e866ac"},{"version":"CommandV1","origId":336718490210302,"guid":"a6edcbd7-ae20-4dd2-98f0-be577282f6b7","subtype":"command","commandType":"auto","position":28.0,"command":"from pyspark.sql.functions import var_pop, stddev_pop\nfrom pyspark.sql.functions import var_samp, stddev_samp\ndf.select(\nvar_pop(\"Quantity\"),\nvar_samp(\"Quantity\"),\nstddev_pop(\"Quantity\"),\nstddev_samp(\"Quantity\"))\\\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">13</span><span class=\"ansired\">]: </span>[Row(var_pop(Quantity)=47559.303646609056, var_samp(Quantity)=47559.391409298754, stddev_pop(Quantity)=218.08095663447796, stddev_samp(Quantity)=218.08115785023418)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639599709,"submitTime":1497639599696,"finishTime":1497639599883,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a353dfe2-c139-4cef-a9f4-775e29b351cd"},{"version":"CommandV1","origId":336718490210303,"guid":"9dbbcc0d-0d4b-4434-be95-19ff6a79b034","subtype":"command","commandType":"auto","position":29.0,"command":"%sql\nSELECT\nvar_pop(Quantity),\nvar_samp(Quantity),\nstddev_pop(Quantity),\nstddev_samp(Quantity)\nFROM\ndfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[47559.303646609056,47559.391409298754,218.08095663447796,218.08115785023418]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"var_pop(CAST(Quantity AS DOUBLE))","type":"\"double\"","metadata":"{}"},{"name":"var_samp(CAST(Quantity AS DOUBLE))","type":"\"double\"","metadata":"{}"},{"name":"stddev_pop(CAST(Quantity AS DOUBLE))","type":"\"double\"","metadata":"{}"},{"name":"stddev_samp(CAST(Quantity AS DOUBLE))","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639609749,"submitTime":1497639609733,"finishTime":1497639609911,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1af84b25-f014-4054-83bf-ae40dac91ba8"},{"version":"CommandV1","origId":336718490210304,"guid":"c232c464-2055-4549-966c-b8d15d4a295d","subtype":"command","commandType":"auto","position":30.0,"command":"%scala\nimport org.apache.spark.sql.functions.{skewness, kurtosis}\ndf.select(\nskewness(\"Quantity\"),\nkurtosis(\"Quantity\"))\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.{skewness, kurtosis}\nres10: Array[org.apache.spark.sql.Row] = Array([-0.2640755761052562,119768.05495536952])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639623575,"submitTime":1497639623562,"finishTime":1497639624147,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3a1b09d3-da2e-4e3d-a899-bdd50c2f5459"},{"version":"CommandV1","origId":336718490210305,"guid":"9f25a77c-e9e8-4f3a-940b-5235ef294454","subtype":"command","commandType":"auto","position":31.0,"command":"from pyspark.sql.functions import skewness, kurtosis\ndf.select(\nskewness(\"Quantity\"),\nkurtosis(\"Quantity\"))\\\n.collect()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">14</span><span class=\"ansired\">]: </span>[Row(skewness(Quantity)=-0.2640755761052562, kurtosis(Quantity)=119768.05495536952)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639632428,"submitTime":1497639632416,"finishTime":1497639632600,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aededeb0-3cf7-4e44-8145-92ed076c2398"},{"version":"CommandV1","origId":336718490210306,"guid":"29d8332a-81dc-4446-a05c-22f0b2ba2ede","subtype":"command","commandType":"auto","position":32.0,"command":"%sql\nSELECT\nskewness(Quantity),\nkurtosis(Quantity)\nFROM\ndfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[-0.2640755761052562,119768.05495536952]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"skewness(CAST(Quantity AS DOUBLE))","type":"\"double\"","metadata":"{}"},{"name":"kurtosis(CAST(Quantity AS DOUBLE))","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639639840,"submitTime":1497639639827,"finishTime":1497639640022,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e511dde1-7484-4b4a-80ac-04a36426aa13"},{"version":"CommandV1","origId":336718490210307,"guid":"2d3357f8-c169-4ca7-9152-1795ee873599","subtype":"command","commandType":"auto","position":33.0,"command":"%scala\nimport org.apache.spark.sql.functions.{corr, covar_pop, covar_samp}\ndf.select(\ncorr(\"InvoiceNo\", \"Quantity\"),\ncovar_samp(\"InvoiceNo\", \"Quantity\"),\ncovar_pop(\"InvoiceNo\", \"Quantity\"))\n.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------------------+-------------------------------+------------------------------+\n|corr(InvoiceNo, Quantity)|covar_samp(InvoiceNo, Quantity)|covar_pop(InvoiceNo, Quantity)|\n+-------------------------+-------------------------------+------------------------------+\n|     4.912186085635685E-4|             1052.7280543902734|            1052.7260778741693|\n+-------------------------+-------------------------------+------------------------------+\n\nimport org.apache.spark.sql.functions.{corr, covar_pop, covar_samp}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639647412,"submitTime":1497639647399,"finishTime":1497639648344,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"db50c531-e61b-46e7-b9e1-05ad6ae25380"},{"version":"CommandV1","origId":336718490210308,"guid":"91f610f9-b5e8-4e77-b601-bafc895282ab","subtype":"command","commandType":"auto","position":34.0,"command":"from pyspark.sql.functions import corr, covar_pop, covar_samp\ndf.select(\ncorr(\"InvoiceNo\", \"Quantity\"),\ncovar_samp(\"InvoiceNo\", \"Quantity\"),\ncovar_pop(\"InvoiceNo\", \"Quantity\"))\\\n.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------------------+-------------------------------+------------------------------+\n|corr(InvoiceNo, Quantity)|covar_samp(InvoiceNo, Quantity)|covar_pop(InvoiceNo, Quantity)|\n+-------------------------+-------------------------------+------------------------------+\n|     4.912186085635685E-4|             1052.7280543902734|            1052.7260778741693|\n+-------------------------+-------------------------------+------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639655347,"submitTime":1497639655334,"finishTime":1497639655870,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"288ee796-3a25-4007-837b-1239933b0239"},{"version":"CommandV1","origId":336718490210309,"guid":"b69c3a95-2fa6-46f1-9eba-29995e93d906","subtype":"command","commandType":"auto","position":35.0,"command":"%sql\nSELECT\ncorr(InvoiceNo, Quantity),\ncovar_samp(InvoiceNo, Quantity),\ncovar_pop(InvoiceNo, Quantity)\nFROM\ndfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[4.912186085635685E-4,1052.7280543902734,1052.7260778741693]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"corr(CAST(InvoiceNo AS DOUBLE), CAST(Quantity AS DOUBLE))","type":"\"double\"","metadata":"{}"},{"name":"covar_samp(CAST(InvoiceNo AS DOUBLE), CAST(Quantity AS DOUBLE))","type":"\"double\"","metadata":"{}"},{"name":"covar_pop(CAST(InvoiceNo AS DOUBLE), CAST(Quantity AS DOUBLE))","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639663708,"submitTime":1497639663695,"finishTime":1497639664017,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0a938efc-27e8-4287-8169-cc1769ea1478"},{"version":"CommandV1","origId":336718490210310,"guid":"2c3c8725-25a2-4785-8b04-a554663d8544","subtype":"command","commandType":"auto","position":36.0,"command":"%scala\nimport org.apache.spark.sql.functions.{collect_set, collect_list}\ndf.agg(\ncollect_set(\"Country\"),\ncollect_list(\"Country\"))\n.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+---------------------+\n|collect_set(Country)|collect_list(Country)|\n+--------------------+---------------------+\n|[Portugal, Italy,...| [United Kingdom, ...|\n+--------------------+---------------------+\n\nimport org.apache.spark.sql.functions.{collect_set, collect_list}\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639672727,"submitTime":1497639672714,"finishTime":1497639673512,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"66eec887-916f-4f97-85c6-df083a8b19df"},{"version":"CommandV1","origId":336718490210311,"guid":"4e1dec0f-06d3-439b-844b-16b27625624d","subtype":"command","commandType":"auto","position":37.0,"command":"from pyspark.sql.functions import collect_set, collect_list\ndf.agg(\ncollect_set(\"Country\"),\ncollect_list(\"Country\"))\\\n.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+--------------------+---------------------+\n|collect_set(Country)|collect_list(Country)|\n+--------------------+---------------------+\n|[Portugal, Italy,...| [United Kingdom, ...|\n+--------------------+---------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639679571,"submitTime":1497639679558,"finishTime":1497639680045,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5a76ab44-e7c3-4008-add8-6c44bdf976ee"},{"version":"CommandV1","origId":336718490210312,"guid":"f4c7476c-eff5-4948-8cb4-87fa6f27d633","subtype":"command","commandType":"auto","position":38.0,"command":"%sql\nSELECT\ncollect_set(Country),\ncollect_set(Country)\nFROM\ndfTable","commandVersion":0,"state":"finished","results":{"type":"table","data":[[["Portugal","Italy","Finland","Germany","Canada","RSA","Switzerland","Greece","Spain","Sweden","Hong Kong","Singapore","Lebanon","Belgium","Cyprus","United Arab Emirates","Australia","Denmark","United Kingdom","Japan","Iceland","Unspecified","Lithuania","EIRE","Bahrain","Austria","Poland","Brazil","Malta","Saudi Arabia","Netherlands","France","Channel Islands","European Community","Norway","Israel","USA","Czech Republic"],["Portugal","Italy","Finland","Germany","Canada","RSA","Switzerland","Greece","Spain","Sweden","Hong Kong","Singapore","Lebanon","Belgium","Cyprus","United Arab Emirates","Australia","Denmark","United Kingdom","Japan","Iceland","Unspecified","Lithuania","EIRE","Bahrain","Austria","Poland","Brazil","Malta","Saudi Arabia","Netherlands","France","Channel Islands","European Community","Norway","Israel","USA","Czech Republic"]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"collect_set(Country)","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"collect_set(Country)","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639687113,"submitTime":1497639687100,"finishTime":1497639687446,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e5ad9beb-bda2-4752-a26d-c7ea8f740cad"},{"version":"CommandV1","origId":336718490210313,"guid":"cd373cfa-bce9-4fcf-b634-b2fae4e8ac49","subtype":"command","commandType":"auto","position":39.0,"command":"df.groupBy(\"invoiceNo\").count().show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+-----+\n|invoiceNo|count|\n+---------+-----+\n|   536596|    6|\n|   536938|   14|\n|   537252|    1|\n|   537691|   20|\n|   538041|    1|\n|   538184|   26|\n|   538517|   53|\n|   538879|   19|\n|   539275|    6|\n|   539630|   12|\n|   540499|   24|\n|   540540|   22|\n|  C540850|    1|\n|   540976|   48|\n|   541432|    4|\n|   541518|  101|\n|   541783|   35|\n|   542026|    9|\n|   542375|    6|\n|  C542604|    8|\n+---------+-----+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639700011,"submitTime":1497639699996,"finishTime":1497639700640,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"38525672-46a1-4006-8ed4-c391d1aee4cd"},{"version":"CommandV1","origId":336718490210314,"guid":"1f3bc744-ba6b-43c4-bddb-cc20a966ed9f","subtype":"command","commandType":"auto","position":40.0,"command":"%scala\ndf.groupBy(\"InvoiceNo\", \"CustomerId\")\n.count()\n.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+----------+-----+\n|InvoiceNo|CustomerId|count|\n+---------+----------+-----+\n|   536846|     14573|   76|\n|   537026|     12395|   12|\n|   537883|     14437|    5|\n|   538068|     17978|   12|\n|   538279|     14952|    7|\n|   538800|     16458|   10|\n|   538942|     17346|   12|\n|  C539947|     13854|    1|\n|   540096|     13253|   16|\n|   540530|     14755|   27|\n|   541225|     14099|   19|\n|   541978|     13551|    4|\n|   542093|     17677|   16|\n|   536596|      null|    6|\n|   537252|      null|    1|\n|   538041|      null|    1|\n|   543188|     12567|   63|\n|   543590|     17377|   19|\n|  C543757|     13115|    1|\n|  C544318|     12989|    1|\n+---------+----------+-----+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-18-a7f26ccdcc49&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">2</span>\n<span class=\"ansiyellow\">    .count()</span>\n<span class=\"ansigrey\">    ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n</div>","workflows":[],"startTime":1497639717023,"submitTime":1497639717009,"finishTime":1497639717844,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"05ce180a-d070-4f21-a10f-455ada21e769"},{"version":"CommandV1","origId":336718490210315,"guid":"95ee20af-9aeb-4efd-bfc6-59e2b698e4f9","subtype":"command","commandType":"auto","position":41.0,"command":"%sql\nSELECT\ncount(*)\nFROM\ndfTable\nGROUP BY\nInvoiceNo, CustomerId","commandVersion":0,"state":"finished","results":{"type":"table","data":[[76],[12],[5],[12],[7],[10],[12],[1],[16],[27],[19],[4],[16],[6],[1],[1],[63],[19],[1],[1],[1],[20],[30],[17],[48],[13],[4],[13],[2],[34],[11],[1],[3],[14],[2],[25],[9],[34],[1],[6],[31],[24],[4],[37],[5],[8],[26],[3],[24],[1],[1],[1],[1],[1],[58],[15],[12],[20],[13],[31],[7],[7],[39],[7],[15],[30],[23],[2],[11],[12],[4],[35],[37],[5],[70],[6],[3],[28],[1],[7],[22],[1],[1],[32],[71],[4],[31],[9],[1],[23],[11],[18],[37],[19],[32],[1],[2],[4],[1],[49],[25],[1],[54],[5],[23],[21],[27],[14],[31],[7],[44],[6],[11],[5],[2],[58],[1],[1],[73],[1],[1],[1],[6],[78],[1],[4],[3],[11],[35],[2],[28],[6],[16],[1],[11],[15],[2],[2],[15],[1],[13],[13],[1],[1],[1],[1],[534],[71],[3],[4],[14],[15],[1],[8],[2],[12],[5],[1],[23],[3],[38],[56],[6],[20],[2],[94],[18],[4],[1],[14],[21],[66],[1],[47],[31],[16],[26],[10],[1],[1],[1],[11],[1],[153],[1],[2],[1],[5],[2],[1],[1],[9],[7],[41],[20],[9],[1],[1],[18],[13],[13],[9],[5],[2],[6],[34],[50],[4],[14],[24],[107],[11],[4],[18],[11],[2],[3],[41],[21],[3],[55],[1],[3],[20],[25],[30],[25],[1],[1],[1],[1],[1],[15],[15],[13],[14],[94],[1],[16],[19],[38],[27],[24],[121],[1],[34],[1],[1],[2],[1],[19],[10],[32],[3],[11],[17],[11],[65],[29],[14],[11],[3],[4],[23],[1],[1],[9],[20],[4],[24],[1],[22],[1],[1],[38],[24],[3],[8],[16],[1],[3],[13],[28],[1],[1],[2],[58],[7],[32],[15],[1],[14],[17],[28],[8],[1],[5],[14],[19],[32],[6],[2],[20],[4],[19],[27],[12],[5],[1],[1],[30],[1],[13],[1],[1],[45],[1],[37],[11],[7],[1],[1],[2],[9],[20],[52],[1],[29],[6],[13],[8],[9],[12],[17],[1],[34],[15],[6],[184],[1],[94],[1],[16],[24],[2],[2],[8],[26],[19],[1],[19],[26],[27],[2],[13],[5],[1],[13],[1],[2],[23],[26],[1],[38],[34],[2],[10],[25],[14],[10],[27],[217],[182],[1],[65],[1],[1],[1],[48],[6],[14],[74],[24],[20],[8],[7],[15],[1],[1],[21],[4],[47],[518],[1],[4],[27],[4],[7],[3],[4],[1],[10],[7],[1],[3],[11],[35],[7],[1],[536],[1],[1],[1],[32],[23],[12],[1],[1],[20],[1],[14],[51],[3],[9],[21],[25],[19],[32],[1],[50],[21],[20],[5],[7],[12],[37],[26],[6],[11],[36],[9],[1],[18],[19],[9],[92],[15],[4],[9],[8],[31],[1],[1],[1],[1],[1],[44],[1],[1],[1],[4],[1],[1],[1],[1],[42],[5],[12],[33],[2],[43],[1],[24],[40],[4],[16],[25],[5],[47],[27],[7],[1],[1],[1],[1],[1],[1],[8],[18],[2],[3],[19],[29],[40],[5],[7],[60],[20],[45],[1],[4],[1],[1],[2],[36],[6],[39],[12],[16],[16],[7],[22],[1],[1],[1],[31],[6],[19],[93],[18],[1],[32],[10],[8],[51],[42],[7],[31],[2],[6],[19],[1],[32],[57],[11],[1],[80],[20],[2],[1],[1],[1],[21],[1],[22],[4],[5],[12],[9],[2],[18],[1],[46],[13],[6],[5],[1],[26],[27],[5],[1],[1],[8],[1],[3],[3],[3],[5],[2],[1],[20],[9],[1],[35],[27],[31],[17],[5],[6],[21],[15],[2],[1],[1],[11],[29],[66],[7],[9],[1],[35],[1],[8],[1],[3],[7],[10],[18],[1],[4],[13],[12],[1],[1],[10],[4],[8],[45],[45],[133],[7],[9],[19],[22],[10],[6],[22],[14],[68],[13],[1],[15],[1],[138],[1],[6],[1],[1],[17],[39],[1],[1],[1],[126],[6],[1],[263],[22],[4],[41],[10],[17],[3],[4],[1],[51],[8],[48],[2],[36],[26],[3],[1],[31],[17],[16],[15],[5],[15],[20],[11],[1],[2],[16],[19],[6],[31],[4],[5],[20],[15],[53],[1],[1],[23],[39],[5],[45],[44],[23],[35],[52],[9],[25],[24],[24],[1],[29],[30],[22],[34],[6],[29],[24],[2],[5],[7],[29],[1],[3],[1],[9],[1],[44],[5],[1],[61],[15],[37],[16],[4],[18],[19],[5],[22],[5],[16],[44],[10],[2],[1],[16],[6],[1],[44],[36],[26],[21],[1],[14],[31],[1],[42],[9],[59],[15],[15],[1],[9],[3],[1],[31],[12],[18],[5],[7],[125],[11],[129],[48],[15],[5],[33],[7],[1],[18],[3],[57],[3],[1],[1],[91],[2],[2],[1],[2],[27],[18],[19],[19],[2],[22],[3],[1],[6],[66],[26],[49],[4],[9],[2],[5],[2],[1],[9],[2],[39],[1],[1],[1],[16],[7],[1],[45],[3],[40],[1],[6],[1],[16],[5],[7],[1],[119],[137],[1],[5],[10],[25],[2],[11],[6],[15],[1],[45],[8],[7],[20],[25],[15],[1],[90],[43],[17],[1],[31],[2],[1],[8],[1],[2],[18],[30],[15],[85],[11],[4],[9],[10],[76],[22],[14],[4],[18],[2],[10],[36],[16],[14],[1],[1],[12],[23],[28],[1],[5],[29],[2],[1],[34],[3],[13],[3],[6],[11],[2],[1],[2],[1],[1],[1],[10],[6],[27],[18],[15],[32],[2],[1],[39],[9],[8],[3],[40],[16],[38],[37],[17],[27],[58],[55],[7],[7],[22],[5],[3],[13],[16],[1],[32],[6],[2],[1],[1],[16],[10],[19],[9],[17],[1],[27],[1],[28],[12],[15],[72],[1],[8],[8],[49],[3],[1],[9],[21],[22],[36],[18],[48],[32],[1],[12],[26],[26],[23],[34],[43],[1],[1],[23],[5],[2],[16],[5],[16],[111],[1],[1],[1],[1],[1],[11],[20],[3],[19],[6],[11],[2],[1],[20],[26],[1],[24],[3],[17],[11],[1],[1],[7],[52],[8],[37],[11],[39],[7],[3],[21],[1],[4],[33],[1],[21],[52],[27],[9],[24],[5],[1],[1],[1],[1],[1],[1],[2],[1],[6],[14],[22],[12],[9],[13]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"count(1)","type":"\"long\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639727148,"submitTime":1497639727139,"finishTime":1497639727719,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"922325b5-cb6f-4062-b184-c0f216896452"},{"version":"CommandV1","origId":336718490210316,"guid":"111fb19b-367a-4c41-9e5e-9e045ed96620","subtype":"command","commandType":"auto","position":42.0,"command":"%scala\nimport org.apache.spark.sql.functions.count\ndf.groupBy(\"InvoiceNo\")\n.agg(\ncount(\"Quantity\").alias(\"quan\"),\nexpr(\"count(Quantity)\"))\n.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+----+---------------+\n|InvoiceNo|quan|count(Quantity)|\n+---------+----+---------------+\n|   536596|   6|              6|\n|   536938|  14|             14|\n|   537252|   1|              1|\n|   537691|  20|             20|\n|   538041|   1|              1|\n|   538184|  26|             26|\n|   538517|  53|             53|\n|   538879|  19|             19|\n|   539275|   6|              6|\n|   539630|  12|             12|\n|   540499|  24|             24|\n|   540540|  22|             22|\n|  C540850|   1|              1|\n|   540976|  48|             48|\n|   541432|   4|              4|\n|   541518| 101|            101|\n|   541783|  35|             35|\n|   542026|   9|              9|\n|   542375|   6|              6|\n|  C542604|   8|              8|\n+---------+----+---------------+\nonly showing top 20 rows\n\nimport org.apache.spark.sql.functions.count\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639738407,"submitTime":1497639738393,"finishTime":1497639739557,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"78a43f6d-a7f5-4b24-9311-c18cafda7484"},{"version":"CommandV1","origId":336718490210317,"guid":"26139e17-1c86-4b6a-ace8-5f45d3655b46","subtype":"command","commandType":"auto","position":43.0,"command":"from pyspark.sql.functions import count\ndf.groupBy(\"InvoiceNo\")\\\n.agg(\ncount(\"Quantity\").alias(\"quan\"),\nexpr(\"count(Quantity)\"))\\\n.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+----+---------------+\n|InvoiceNo|quan|count(Quantity)|\n+---------+----+---------------+\n|   536596|   6|              6|\n|   536938|  14|             14|\n|   537252|   1|              1|\n|   537691|  20|             20|\n|   538041|   1|              1|\n|   538184|  26|             26|\n|   538517|  53|             53|\n|   538879|  19|             19|\n|   539275|   6|              6|\n|   539630|  12|             12|\n|   540499|  24|             24|\n|   540540|  22|             22|\n|  C540850|   1|              1|\n|   540976|  48|             48|\n|   541432|   4|              4|\n|   541518| 101|            101|\n|   541783|  35|             35|\n|   542026|   9|              9|\n|   542375|   6|              6|\n|  C542604|   8|              8|\n+---------+----+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639751098,"submitTime":1497639751083,"finishTime":1497639751471,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c876443f-b3c6-4963-ab1d-b3653e9a5b78"},{"version":"CommandV1","origId":336718490210318,"guid":"a57c5e82-07e6-4273-94db-8b7e6eb53b01","subtype":"command","commandType":"auto","position":44.0,"command":"%scala\ndf.groupBy(\"InvoiceNo\")\n.agg(\n\"Quantity\" ->\"avg\",\n\"Quantity\" -> \"stddev_pop\")\n.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+------------------+--------------------+\n|InvoiceNo|     avg(Quantity)|stddev_pop(Quantity)|\n+---------+------------------+--------------------+\n|   536596|               1.5|  1.1180339887498947|\n|   536938|33.142857142857146|  20.698023172885524|\n|   537252|              31.0|                 0.0|\n|   537691|              8.15|   5.597097462078001|\n|   538041|              30.0|                 0.0|\n|   538184|12.076923076923077|   8.142590198943392|\n|   538517|3.0377358490566038|  2.3946659604837897|\n|   538879|21.157894736842106|  11.811070444356483|\n|   539275|              26.0|  12.806248474865697|\n|   539630|20.333333333333332|  10.225241100118645|\n|   540499|              3.75|  2.6653642652865788|\n|   540540|2.1363636363636362|  1.0572457590557278|\n|  C540850|              -1.0|                 0.0|\n|   540976|10.520833333333334|   6.496760677872902|\n|   541432|             12.25|  10.825317547305483|\n|   541518| 23.10891089108911|  20.550782784878713|\n|   541783|11.314285714285715|   8.467657556242811|\n|   542026| 7.666666666666667|   4.853406592853679|\n|   542375|               8.0|  3.4641016151377544|\n|  C542604|              -8.0|  15.173990905493518|\n+---------+------------------+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639771197,"submitTime":1497639771183,"finishTime":1497639772013,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f3d71833-88f0-4e23-ae4b-194bb13cb4cd"},{"version":"CommandV1","origId":336718490210319,"guid":"c256d163-478a-4552-8d66-62faaa62487b","subtype":"command","commandType":"auto","position":45.0,"command":"df.groupBy(\"InvoiceNo\")\\\n.agg(expr(\"avg(Quantity)\"),\nexpr(\"stddev_pop(Quantity)\"))\\\n.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---------+------------------+--------------------+\n|InvoiceNo|     avg(Quantity)|stddev_pop(Quantity)|\n+---------+------------------+--------------------+\n|   536596|               1.5|  1.1180339887498947|\n|   536938|33.142857142857146|  20.698023172885524|\n|   537252|              31.0|                 0.0|\n|   537691|              8.15|   5.597097462078001|\n|   538041|              30.0|                 0.0|\n|   538184|12.076923076923077|   8.142590198943392|\n|   538517|3.0377358490566038|  2.3946659604837897|\n|   538879|21.157894736842106|  11.811070444356483|\n|   539275|              26.0|  12.806248474865697|\n|   539630|20.333333333333332|  10.225241100118645|\n|   540499|              3.75|  2.6653642652865788|\n|   540540|2.1363636363636362|  1.0572457590557278|\n|  C540850|              -1.0|                 0.0|\n|   540976|10.520833333333334|   6.496760677872902|\n|   541432|             12.25|  10.825317547305483|\n|   541518| 23.10891089108911|  20.550782784878713|\n|   541783|11.314285714285715|   8.467657556242811|\n|   542026| 7.666666666666667|   4.853406592853679|\n|   542375|               8.0|  3.4641016151377544|\n|  C542604|              -8.0|  15.173990905493518|\n+---------+------------------+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639778825,"submitTime":1497639778811,"finishTime":1497639779150,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"40309146-1beb-411e-a76a-0c308ec543b1"},{"version":"CommandV1","origId":336718490210320,"guid":"c46bb68f-be87-4282-9d86-91aa000852b6","subtype":"command","commandType":"auto","position":46.0,"command":"%sql\nSELECT\navg(Quantity),\nstddev_pop(Quantity),\nInvoiceNo\nFROM\ndfTable\nGROUP BY\nInvoiceNo","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1.5,1.1180339887498947,"536596"],[33.142857142857146,20.698023172885524,"536938"],[31.0,0.0,"537252"],[8.15,5.597097462078001,"537691"],[30.0,0.0,"538041"],[12.076923076923077,8.142590198943392,"538184"],[3.0377358490566038,2.3946659604837897,"538517"],[21.157894736842106,11.811070444356483,"538879"],[26.0,12.806248474865697,"539275"],[20.333333333333332,10.225241100118645,"539630"],[3.75,2.6653642652865788,"540499"],[2.1363636363636362,1.0572457590557278,"540540"],[-1.0,0.0,"C540850"],[10.520833333333334,6.496760677872902,"540976"],[12.25,10.825317547305483,"541432"],[23.10891089108911,20.550782784878713,"541518"],[11.314285714285715,8.467657556242811,"541783"],[7.666666666666667,4.853406592853679,"542026"],[8.0,3.4641016151377544,"542375"],[-8.0,15.173990905493518,"C542604"],[6.125,8.053531833922307,"543641"],[1.3902439024390243,0.6941585107686686,"544303"],[7.8125,6.866756421338972,"545583"],[-3.0,0.0,"C546174"],[12.9375,8.488733341906787,"547122"],[2.0,0.0,"547557"],[12.5,7.262919523166975,"548542"],[8.0,0.0,"548998"],[-7.0,0.0,"549160"],[-12.0,0.0,"C549913"],[5.129032258064516,8.838121007003881,"550469"],[9.095238095238095,5.85462586259188,"550617"],[-100.0,0.0,"C550672"],[6.0,4.0,"550831"],[8.0,0.0,"551990"],[2000.0,0.0,"552172"],[3.3333333333333335,3.944053188733078,"552191"],[-41.0,0.0,"552215"],[43.0,46.36809247747852,"552238"],[2.621212121212121,3.5665327850055912,"552277"],[1.793103448275862,1.3741281962187089,"552677"],[3.467741935483871,3.0885728092306386,"552852"],[2.3655913978494625,2.7622063264777177,"553390"],[120.45454545454545,57.213100274108605,"553470"],[1.0,0.0,"553559"],[9.2,4.773737679069874,"553658"],[22.666666666666668,1.8856180831641267,"553708"],[9.285714285714286,4.934261725477299,"553738"],[4.285714285714286,2.3733211036908783,"553835"],[18.52,15.038936132585974,"554072"],[16.0,0.0,"554284"],[8.666666666666666,6.143779923307128,"554441"],[11.175,13.074569782597056,"554630"],[12.5,11.5,"554792"],[-4.0,2.0,"C556414"],[4.628571428571429,2.819176316238631,"556441"],[5.235294117647059,3.622306898433095,"556462"],[14.0,0.0,"551692"],[4.576923076923077,4.604956167193684,"556732"],[12.5,11.5,"556929"],[6.291666666666667,6.278131135581318,"557271"],[4.923076923076923,6.696285290098574,"557757"],[5.434782608695652,7.020628529750098,"558100"],[3.341463414634146,5.539700423781675,"558700"],[47.4,42.166811593953845,"559062"],[24.0,9.106774035482234,"559174"],[7.578947368421052,5.860804592452656,"559295"],[1.2,0.4,"560095"],[9.764705882352942,8.440305345499029,"560145"],[11.571428571428571,6.091144458665098,"560536"],[2.5,1.5,"561057"],[15.846153846153847,10.683172633389058,"561352"],[2.4054054054054053,3.490988084857844,"561519"],[2.787878787878788,3.874998148641401,"562204"],[9.166666666666666,12.870077268178653,"562271"],[-6.0,0.0,"562463"],[13.833333333333334,8.091490729292238,"562600"],[13.6,7.71621668954417,"562890"],[425.0,0.0,"562945"],[-6.0,0.0,"C562959"],[16.041666666666668,10.212244148841895,"563020"],[10.3,3.163858403911275,"565747"],[9.0,8.703447592764606,"566248"],[14.11111111111111,6.911254017815104,"566431"],[14.5,11.280514172678478,"567163"],[-42.0,0.0,"567695"],[10.206896551724139,6.4774372877616235,"567879"],[10.636363636363637,2.705977466570403,"568222"],[15.25,9.575359001102779,"568711"],[11.541666666666666,8.467974800518848,"569020"],[10.625,3.7893765978060294,"569560"],[1.4782608695652173,0.9869980199409517,"569823"],[3.5833333333333335,2.542691050398726,"570234"],[-22.0,0.0,"570264"],[48.0,0.0,"570281"],[7.438356164383562,11.910610328345681,"570592"],[-16.0,0.0,"571010"],[3.0,0.0,"571906"],[8.05,7.559596550081228,"572049"],[14.038461538461538,10.04022972933147,"572458"],[8.272727272727273,4.726923063991264,"573020"],[12.0,0.0,"573256"],[4.0,0.0,"573409"],[-67.0,0.0,"573726"],[7.25,4.4651427748729375,"574592"],[6.846153846153846,5.418574235494254,"574844"],[6.0,3.640054944640259,"574966"],[11.552631578947368,5.008925551458656,"575091"],[16.65,12.14197265686264,"575671"],[8.75,8.98262211161084,"575948"],[2.769230769230769,1.5268794800984005,"575961"],[2.8181818181818183,5.223516436936152,"576059"],[10.9,7.4959989327640635,"576112"],[-3.5,2.5,"C576393"],[5.131578947368421,2.903455768848916,"577022"],[-2.0,0.0,"C577362"],[3.1739130434782608,5.4025128928727195,"577511"],[9.333333333333334,9.18245393767158,"577541"],[4.607142857142857,8.755974636597271,"578057"],[-1.0,0.0,"C578132"],[5.902777777777778,8.759375488618884,"578292"],[28.0,26.0,"578459"],[6.21875,8.814882213478521,"578941"],[31.1,39.22868848177313,"580490"],[2.5,0.5,"580739"],[27.0,13.076696830622021,"580906"],[125.0,43.30127018922193,"581138"],[2.5357142857142856,2.7448932175059566,"536597"],[10.0,2.8284271247461903,"536608"],[19.0,0.0,"536765"],[1.0,0.0,"537439"],[12.0,0.0,"537631"],[-77.0,0.0,"537870"],[1.0,0.0,"538142"],[2.445692883895131,3.125923112686676,"538177"],[16.75,9.64040974232942,"538308"],[1.3333333333333333,0.4714045207910317,"539064"],[10.285714285714286,6.180945043652553,"539570"],[3.0,0.816496580927726,"540184"],[-6.0,0.0,"C540347"],[21.555555555555557,15.741742887488744,"540998"],[10.571428571428571,8.17849344940991,"542006"],[-1.625,0.6959705453537527,"C542245"],[2.0,0.0,"542512"],[1.0,0.0,"542515"],[11.148148148148149,7.933537362939891,"543484"],[-6.0,0.0,"543521"],[2.8181818181818183,1.849726359034164,"543536"],[144.0,0.0,"544605"],[12.4,5.571355310873648,"544643"],[10.909090909090908,10.86658385271559,"544941"],[3.357142857142857,2.99063163077976,"545577"],[-675.0,0.0,"546016"],[19.36,16.513945621807043,"546317"],[7.3125,2.9731874730665737,"546686"],[1.7908496732026145,1.9424854194698178,"546892"],[7.583333333333333,5.8088773059478145,"546908"],[100.0,28.0,"547045"],[26.0,14.0,"547688"],[10.608695652173912,13.51243913370769,"547938"],[18.0,8.48528137423857,"547949"],[19.333333333333332,3.39934634239519,"548267"],[1.7647058823529411,0.4241825029957634,"548707"],[-6.0,0.0,"C548738"],[3.3076923076923075,2.2662953634855745,"549130"],[-158.0,0.0,"549510"],[7.4,3.96316371938716,"549718"],[10.0,0.0,"549752"],[5.5,3.5707142142714243,"549907"],[96.0,0.0,"549941"],[-1.0,0.0,"C550614"],[34.96875,35.486779558555334,"551351"],[57.6,27.288092641296863,"551726"],[84.0,60.0,"551902"],[-1.0,0.0,"C552015"],[-1.0,0.0,"C552019"],[15.0,8.94427190999916,"552193"],[7.666666666666667,3.7267799624996494,"552723"],[72.0,0.0,"552885"],[-1.0,0.0,"C552919"],[11.636363636363637,8.171710928816085,"553042"],[-1.0,0.0,"C553370"],[10.0,6.718843437888485,"554067"],[13.588235294117647,19.62608954946095,"554126"],[2.260869565217391,1.870070710226658,"554163"],[41.6,41.826307510943394,"554496"],[13.142857142857142,8.3397254396151,"554579"],[7.888888888888889,5.476098457934047,"554671"],[4300.0,0.0,"554868"],[12.555555555555555,9.376224199906568,"554997"],[8.0,6.944222218666552,"555538"],[10.0,0.0,"555813"],[14.428571428571429,7.451886488997128,"555829"],[10.4,12.92439553712281,"556084"],[-618.0,0.0,"556319"],[14.375,30.935164053225904,"547107"],[8.874125874125873,9.273518303126458,"554151"],[1.523076923076923,1.241682386091143,"557019"],[6.6,5.326662494783515,"557040"],[11.055555555555555,6.843262885026428,"557066"],[-2.0,0.0,"C557154"],[2.909090909090909,2.372361518309071,"557283"],[26.571428571428573,29.67373606819502,"557325"],[-1.3333333333333333,0.4714045207910317,"C557654"],[-3.0,0.0,"C557656"],[85.42857142857143,137.8144271349361,"557760"],[2.3333333333333335,1.0671873729054748,"558104"],[12.533333333333333,8.081803979035593,"558271"],[10.666666666666666,10.269967002002598,"558638"],[9.818181818181818,3.5475518272383493,"558731"],[76.0,31.496031496047245,"558870"],[11.333333333333334,5.174724898753341,"558879"],[-1.0,0.0,"C559344"],[129.2,18.74459922217597,"559700"],[-2.0,0.0,"C560044"],[1.0,0.0,"560413"],[4.603960396039604,5.9703544978597956,"560996"],[8.142857142857142,2.849991049037143,"561070"],[24.541666666666668,18.25052320406794,"561073"],[19.75,15.506047207460707,"561203"],[68.22727272727273,37.64418561668988,"561474"],[1.9411764705882353,2.2176808651919515,"561893"],[7.833333333333333,3.0776975521032313,"562290"],[4.1891891891891895,9.293525319064846,"562427"],[2.5652173913043477,2.3742474680827907,"562840"],[5.311111111111111,6.469835039017515,"563350"],[12.0,0.0,"563465"],[9.833333333333334,2.511086528886561,"564020"],[18.833333333333332,14.194091102364471,"564543"],[17.25,8.714212528966687,"564551"],[-1.0,0.0,"C565671"],[9.904761904761905,9.039093727774988,"566202"],[2.9166666666666665,5.392252672945593,"566240"],[1.0,0.0,"566478"],[12.0,0.0,"566670"],[18.23076923076923,9.700545949377092,"567794"],[12.0,0.0,"567895"],[1.0,0.0,"568092"],[15.76923076923077,8.56337322243668,"568146"],[-5.5,1.5,"C568649"],[8.25,6.7370245657857,"568674"],[7.90625,6.074328023534784,"568919"],[18.0,4.242640687119285,"569418"],[4.333333333333333,2.357022603955158,"569907"],[6.0,0.0,"569925"],[10.333333333333334,9.672412085697939,"570220"],[7.0,3.0,"572034"],[12.846153846153847,6.943133341058343,"572213"],[10.555555555555555,5.977323402805673,"572655"],[16.0,0.0,"572739"],[-1.0,0.0,"C572850"],[9.379310344827585,12.994465116437336,"572910"],[-1.0,0.0,"C573306"],[12.857142857142858,11.605769149479944,"573442"],[10.833333333333334,8.091490729292238,"573629"],[-4.0,0.0,"C574483"],[11.0,4.123105625617661,"574586"],[18.0,14.0,"574736"],[11.5,9.920517459622086,"574960"],[9.095238095238095,6.675504346238117,"575707"],[-12.0,0.0,"C575841"],[5.586956521739131,4.1366657806400475,"575932"],[22.96,18.99995789469019,"576093"],[-1.75,0.8291561975888501,"C576850"],[12.28,8.226882763234201,"577613"],[12.833333333333334,9.676718911329855,"577851"],[19.2,5.878775382679628,"577905"],[15.428571428571429,6.651683843898752,"578353"],[-149.0,0.0,"578475"],[13.323529411764707,6.990416078819436,"578539"],[6.8,7.721830525637471,"578791"],[12.222222222222221,7.62711213410245,"579493"],[11.926470588235293,5.40510699809908,"579792"],[5.0,0.0,"580715"],[-48.0,0.0,"580990"],[-17.818181818181817,8.020634545495556,"C581229"],[-11.0,1.0,"C581468"],[56.0,0.0,"536414"],[7.571428571428571,3.200765214629726,"537246"],[72.36363636363636,132.93557751254946,"537256"],[3.4444444444444446,2.6712922844825124,"537634"],[4.92,9.256003457216295,"537871"],[1.0,0.0,"537874"],[5.1,3.031501278244824,"538365"],[16.529411764705884,11.867492163141062,"538558"],[-36.0,0.0,"C539068"],[2.710526315789474,2.7232710085758236,"539075"],[4.888888888888889,6.822258414670555,"539242"],[3.2222222222222223,1.6850834320114558,"539298"],[6.363636363636363,4.7915214374925235,"540003"],[1.55,1.2031209415515964,"541128"],[12.875,7.30475016684349,"541172"],[12.76,7.382574076837969,"541569"],[10.761904761904763,6.085930393360942,"541813"],[10.0,0.0,"542896"],[-234.0,0.0,"543310"],[72.0,0.0,"543738"],[6.0,0.0,"543782"],[8.0,3.3466401061363023,"544084"],[12.375,9.479418494823403,"544098"],[8.5,0.5,"544600"],[21.0,18.57417562100671,"544794"],[3.0,2.0,"545306"],[11.321428571428571,6.233856702536168,"545515"],[11.956521739130435,9.364494744231788,"545590"],[1.0,0.0,"545889"],[10.4375,12.727768608440366,"546239"],[6.0,8.847288274037505,"546426"],[-2.0,0.0,"C546501"],[60.0,70.72953178599917,"546677"],[12.954545454545455,11.857016613600852,"546687"],[6.428571428571429,7.798482322260675,"546790"],[82.0,22.686266036231405,"547032"],[14.3,7.425855730710995,"547066"],[1.6666666666666667,1.3662601021279464,"547398"],[-2.0,0.0,"C547495"],[9.666666666666666,6.69991708074726,"548017"],[33.0,27.0,"548410"],[6.684210526315789,5.477731297371658,"548545"],[1.0,0.0,"548725"],[4.375,2.446298223847616,"548734"],[2.8636363636363638,3.951932260937847,"548792"],[10.380952380952381,6.938341989925331,"549614"],[11.854166666666666,7.3823821339877975,"549789"],[-1.0,0.0,"C549930"],[8.75,2.165063509461097,"549932"],[26.333333333333332,16.579773487261185,"549936"],[-9.0,0.0,"C550770"],[10.133333333333333,8.55466084787832,"551391"],[7.785714285714286,5.327537241655331,"551548"],[2.0,0.0,"551848"],[3.4153846153846152,3.0528287396461447,"552624"],[132.0,144.33294842134973,"553170"],[36.666666666666664,9.706813185707357,"553471"],[2.5833333333333335,1.320248293146238,"553655"],[12.818181818181818,10.061792555081208,"553660"],[3.6842105263157894,3.7797145289811174,"553859"],[-1.0,0.0,"C554477"],[2.3448275862068964,2.1379310344827585,"554487"],[15.923076923076923,5.889515305400299,"554545"],[12.566666666666666,8.413019011561122,"554650"],[3.3783783783783785,2.258334130729771,"554979"],[150.0,0.0,"555075"],[9.192307692307692,7.452512383646362,"555523"],[8.0,2.0,"556228"],[7.5,8.965210538520553,"556580"],[-420.0,0.0,"C556925"],[12.0,0.0,"557110"],[8.894736842105264,6.348598990428851,"557279"],[-19.0,0.0,"C557487"],[1.8478260869565217,2.029321918280863,"557644"],[-1.0,0.0,"C557649"],[-1.0,0.0,"C557874"],[-3.0,0.0,"C558081"],[8.866666666666667,6.661998365522333,"558339"],[72.0,24.0,"558363"],[12.454545454545455,6.597019111464268,"558686"],[-1.5,0.5,"C559348"],[8.545454545454545,15.979325485614421,"559861"],[25.56,27.09550516229583,"559865"],[13.172413793103448,7.474411361979322,"560285"],[21.0,15.748015748023622,"560790"],[2.888888888888889,4.222806977051176,"560861"],[2.1176470588235294,1.6407441977625121,"560863"],[20.51219512195122,9.581796642005958,"560895"],[6.458333333333333,5.243878706538594,"561204"],[14.378378378378379,15.961696298379273,"561534"],[168.0,0.0,"561637"],[11.714285714285714,4.589250972631145,"561857"],[216.0,0.0,"562155"],[-90.0,0.0,"562383"],[44.357142857142854,42.019735402133435,"562433"],[8.916666666666666,5.648869110027442,"562575"],[10.631578947368421,6.547080717997743,"562615"],[-3.0,2.160246899469287,"C562618"],[8.4,3.693237062523878,"562718"],[81.32291666666667,79.63490843526509,"562789"],[14.848484848484848,7.675704338903062,"562965"],[1.0,0.0,"563228"],[14.363636363636363,8.171710928816085,"563518"],[-2.0,0.0,"C563609"],[-1.0,0.0,"C563716"],[4.0,0.0,"563851"],[14.6,8.662563131083086,"563857"],[11.541666666666666,5.845077463606068,"564216"],[7.666666666666667,6.749485577105529,"564666"],[1.8940092165898617,2.296623660843541,"565917"],[19.5,4.9749371855331,"566311"],[13.5,6.722681343366235,"566561"],[216.0,0.0,"566727"],[3.4285714285714284,6.106460022233808,"567507"],[11.428571428571429,10.577700841961867,"567975"],[20.44,26.52708804222582,"568158"],[63.666666666666664,48.448139512495445,"568343"],[-1.0,0.0,"C568581"],[-3.5,2.5,"C568646"],[16.75,4.9180788932265,"568873"],[-1.0,0.0,"C569034"],[-458.0,0.0,"569341"],[3.0,0.0,"569359"],[13.666666666666666,14.787382008545892,"569364"],[13.806451612903226,7.241989366851776,"569844"],[14.666666666666666,6.599663291074443,"570707"],[5.743589743589744,4.253010690587761,"571425"],[7.5476190476190474,5.233601968927423,"571438"],[9.815384615384616,14.561162577943485,"571554"],[3.8372093023255816,2.3814226015882456,"571715"],[5.655172413793103,6.109776575117923,"572918"],[9.714285714285714,12.197356689220891,"572925"],[2400.0,0.0,"573003"],[10.555555555555555,6.921963612076675,"573019"],[1.7258064516129032,0.9361788297375128,"573269"],[8.666666666666666,4.109609335312651,"573324"],[14.666666666666666,15.638272140986535,"573408"],[1.0,0.0,"573488"],[50.5,49.5,"573895"],[81.8,42.92116804872239,"574056"],[4.9523809523809526,7.840530779385687,"574100"],[-42.0,0.0,"574173"],[1.0,0.0,"574519"],[7.0,4.516635916254486,"571657"],[2.1666666666666665,1.8408935028645435,"574891"],[-2.3333333333333335,2.560381915956203,"C575064"],[2.7084942084942085,4.219595450215575,"575176"],[14.8,7.892612579705995,"575194"],[15.333333333333334,6.18241233033047,"575197"],[4.333333333333333,1.247219128924647,"575301"],[23.636363636363637,4.312196809320517,"575611"],[6.821428571428571,5.182756929256387,"575969"],[6.074074074074074,5.682500270817976,"576069"],[100.0,88.07950953541919,"576219"],[4.888888888888889,0.9938079899999064,"576845"],[42.5,30.5081956201936,"577067"],[48.0,33.94112549695428,"577443"],[2.0,0.0,"577964"],[14.0,6.0,"578319"],[60.0,7.58946638440411,"578668"],[16.48148148148148,17.820858295766932,"579510"],[12.75,10.615436872781073,"579528"],[34.833333333333336,26.96242241012892,"579531"],[12.266666666666667,12.81388136184956,"579558"],[1.793103448275862,1.398997432765572,"580295"],[6.615384615384615,4.0485222667510055,"580362"],[8.842105263157896,8.713348246978896,"580402"],[47.714285714285715,48.593692376434106,"580662"],[-1.5714285714285714,0.7284313590846836,"C581117"],[3.857142857142857,3.6421567954234173,"581356"],[13.368421052631579,6.599126946369014,"581578"],[3.652173913043478,2.314579418122811,"537111"],[29.166666666666668,49.66862412250033,"537350"],[2.8333333333333335,1.0137937550497031,"537467"],[24.0,0.0,"537469"],[2.1343283582089554,2.182156419336053,"537666"],[10.0,0.0,"538001"],[-177.0,0.0,"538092"],[-4.0,0.0,"C538798"],[40.0,11.313708498984761,"539085"],[8.1875,7.178254923726239,"539752"],[-20.5,19.5,"C540841"],[-84.0,0.0,"541601"],[11.0,8.18535277187245,"541732"],[-21.0,0.0,"C541964"],[-1.0,0.0,"542551"],[7.875,3.0695072894521678,"542667"],[320.0,0.0,"543049"],[10.137931034482758,8.236688897563374,"543342"],[-1.6666666666666667,0.4714045207910317,"C543830"],[11.416666666666666,8.657447019121102,"544568"],[5.425,3.1771646164465572,"545081"],[7.538461538461538,3.650403236216822,"545534"],[-19.0,0.0,"546010"],[5.15625,9.243610546615429,"546013"],[-82.0,0.0,"546379"],[-25.0,0.0,"546661"],[2.7758620689655173,2.9127727248263415,"547243"],[7.25,6.166103577895309,"547414"],[22.0,10.0,"547516"],[12.5,7.466592261534039,"547573"],[24.0,0.0,"547991"],[2.090909090909091,3.0137426280455957,"548165"],[2.5576923076923075,1.4860047305347308,"548198"],[147.2,161.61980076710898,"548687"],[-31.0,0.0,"549008"],[-6.0,0.0,"549032"],[70.0,0.0,"549327"],[-1.0,0.0,"C549540"],[4.173913043478261,4.842315058200297,"550057"],[14.25,8.499591493451645,"550479"],[1.0,0.0,"551176"],[6.909090909090909,2.4291616756158887,"551437"],[-2.0,0.0,"551704"],[7.2,3.655133376499413,"552283"],[24.571428571428573,12.590894020874686,"552657"],[45.2,45.17255804135958,"552960"],[4.375,6.799586384479573,"553174"],[2.727272727272727,2.6773203164983803,"553423"],[6.7368421052631575,4.1528950620166025,"553843"],[33.785714285714285,29.279877467124003,"553997"],[-1.0,0.0,"C554197"],[64.0,0.0,"554634"],[25.181818181818183,15.68333326014468,"554643"],[19.147058823529413,15.208612793880539,"554938"],[16.058823529411764,10.026263090358912,"555603"],[-42.0,0.0,"556310"],[-4.0,0.0,"551444"],[18.0,0.0,"551523"],[1.0,0.0,"556810"],[7.777777777777778,5.701418493629999,"556958"],[10.875,5.988269783501742,"557307"],[11.0,0.0,"557847"],[15.432432432432432,14.120218474193244,"558067"],[2.2063492063492065,1.7380771181196526,"558105"],[11.4,7.851114570556208,"559004"],[4.0,5.379700407140554,"559360"],[-110.0,0.0,"559373"],[1.0,0.0,"559503"],[342.4,164.91646370208161,"559637"],[2.0,2.6457513110645907,"560117"],[8.0,0.0,"561216"],[1440.0,0.0,"561638"],[-18.5,5.5,"C562559"],[-72.0,24.0,"C562811"],[100.0,0.0,"564533"],[400.0,0.0,"564633"],[7.4375,3.6737030024213992,"564634"],[-2.0,0.0,"C565085"],[101.0,0.0,"565288"],[-5.0,6.045283661289563,"C565962"],[9.31578947368421,6.070226143181396,"566572"],[14.23076923076923,10.51119437079306,"566987"],[17.142857142857142,19.474735071945112,"567144"],[16.0,8.0,"567531"],[8.11111111111111,5.858411700650697,"567922"],[11.777777777777779,5.632796380282922,"568171"],[8.8,4.1182520563948,"569684"],[7.857142857142857,5.1941882750565265,"569716"],[-2.0,0.0,"C570066"],[97.0,1.7320508075688767,"570429"],[4.967741935483871,6.625872412273367,"571244"],[10.89090909090909,7.34023216693197,"571409"],[24.0,0.0,"572105"],[8.333333333333334,17.999228378522844,"572447"],[20.0,16.69730517179344,"572860"],[8.956521739130435,4.964905190824416,"573100"],[9.4,3.8,"573141"],[48.0,0.0,"573231"],[42.0,6.0,"573357"],[1.5714285714285714,0.6226998490772391,"574695"],[11.0,0.0,"574904"],[27.2,22.292599668948437,"574917"],[40.0,0.0,"575196"],[1.8644067796610169,3.212568680891594,"575368"],[-21.0,0.0,"575716"],[22.285714285714285,11.876919823329445,"576224"],[41.81818181818182,29.999449030753222,"576768"],[5.60655737704918,7.568872165208319,"576911"],[-1.5,0.5,"C576974"],[18.58823529411765,15.639538219184816,"577429"],[84.0,76.52450587883597,"578346"],[11.5,9.772410142846033,"579446"],[8.105263157894736,6.137844099837158,"579530"],[-2.5,1.5,"C579532"],[8.8,3.340658617698013,"579901"],[9.571428571428571,5.51250896616421,"580049"],[13.75,4.630064794363034,"580280"],[-3.5,2.5,"C580597"],[3.5833333333333335,2.5644470922381863,"580688"],[-12.0,0.0,"C580764"],[2.6122448979591835,4.164065549341012,"580893"],[8.0,2.390457218668787,"581004"],[20.0,0.0,"581102"],[1.5802469135802468,1.3865687067505368,"581166"],[1.0,0.0,"536550"],[-1.6666666666666667,1.0540925533894598,"C537805"],[1.0,0.0,"537878"],[-2.0,0.0,"C538103"],[11.6875,9.081015568206015,"538851"],[14.421052631578947,8.222663094499918,"539098"],[200.0,0.0,"539332"],[-1.5,0.5,"C539710"],[4.733333333333333,3.492213560989012,"540371"],[36.888888888888886,36.74671397083447,"540906"],[-4.0,0.0,"C541007"],[13.875,9.413255281782174,"541357"],[1.0,0.0,"541494"],[-57.0,0.0,"541882"],[6.25,3.897114317029974,"539727"],[20.714285714285715,15.144204791784553,"543027"],[3.5,2.598076211353316,"543601"],[48.0,0.0,"543691"],[1.0,0.0,"543796"],[-2.0,0.816496580927726,"C544436"],[17.5,8.930285549745877,"544582"],[1.6571428571428573,1.1938618523300675,"544767"],[200.0,0.0,"546112"],[7.666666666666667,5.7115866641610396,"546760"],[-1.0,0.0,"C546887"],[34.285714285714285,10.033955955097847,"546899"],[-201.0,0.0,"549426"],[2.4,1.8547236990991405,"549694"],[20.0,0.0,"549979"],[16.8,15.67673435381234,"550054"],[-26.666666666666668,9.977753031397176,"C551180"],[33.3,28.34095975791928,"552464"],[2.216,3.193954288965325,"553035"],[16.133333333333333,10.818913480053755,"553552"],[7.142857142857143,3.3563828927059225,"553850"],[-1.0,0.0,"C554308"],[-1.0,0.0,"C555256"],[1.75,0.82915619758885,"555502"],[54.166666666666664,9.316949906249123,"555950"],[14.379310344827585,12.40526527007494,"556517"],[9.428571428571429,6.253162465211225,"556680"],[-1.0,0.0,"C557666"],[2.15,1.1521718621802914,"557896"],[2.7669172932330826,7.105951353074219,"558066"],[-36.0,0.0,"C558436"],[10.3,7.746612162745725,"558623"],[12.238095238095237,4.878570847567885,"558750"],[152.28571428571428,75.45995018307826,"559703"],[13.11111111111111,8.899993064222572,"560235"],[-1.0,0.0,"C561016"],[10.0,2.0,"562568"],[33.0,9.9498743710662,"562572"],[4.666666666666667,8.506206884126177,"563062"],[10.043478260869565,4.005195114061402,"563567"],[19.5,16.635804759614125,"563812"],[18.285714285714285,14.319958955590478,"564203"],[6.533333333333333,6.108645967442831,"564268"],[4.666666666666667,2.494438257849294,"565082"],[10.413793103448276,6.682541543038485,"565410"],[21.23076923076923,9.592896780381475,"565513"],[11.521739130434783,6.309892614103055,"565727"],[12.380952380952381,5.02826478141497,"565990"],[-1.0,0.0,"C566940"],[1.0,0.0,"566982"],[24.0,8.48528137423857,"567141"],[49.333333333333336,42.37399621885521,"567425"],[2.588235294117647,3.896587096865693,"567475"],[3.260869565217391,1.566424655187115,"567817"],[-12.0,0.0,"567932"],[3.380952380952381,5.2127090462548376,"568411"],[47.8,82.93226151504612,"568471"],[1.375,0.7806247497997998,"568667"],[4.96875,3.8118595773585366,"569232"],[2.491228070175439,3.40547962470777,"569246"],[1.0,0.0,"569634"],[36.0,0.0,"569869"],[-3.5,0.5,"C570199"],[9.263157894736842,7.662912083969657,"570416"],[8.053571428571429,9.020650203950977,"570428"],[1.9036144578313252,1.4446782927107078,"570442"],[12.857142857142858,11.356918236772453,"570825"],[8.5,6.745368781616021,"570859"],[-207.0,0.0,"571011"],[-1.0,0.0,"C572117"],[-2.3333333333333335,1.8856180831641267,"C572489"],[11.368421052631579,4.986408118874531,"572563"],[762.0,438.0,"572670"],[2.129277566539924,2.414786958726723,"572758"],[17.15,15.946081023248313,"573385"],[15.625,9.109576005501024,"573504"],[14.382978723404255,8.988297809384466,"573511"],[6.166666666666667,9.240610850419406,"573656"],[7.470588235294118,4.088975811054769,"573745"],[30.666666666666668,12.364824660660938,"574021"],[14.25,9.921567416492215,"574024"],[2.1,1.8138357147217055,"574705"],[34.0,2.0,"571749"],[-1.0,0.0,"C574865"],[8.192307692307692,19.368926801549616,"575075"],[6.0,0.0,"575987"],[7.0,3.605551275463989,"576891"],[48.0,33.94112549695428,"577097"],[-10.0,0.0,"C577384"],[-1.0,0.0,"C577390"],[2.955223880597015,2.570979462702624,"577469"],[10.2,12.967652061957864,"577534"],[1.2,0.4706787243316416,"577778"],[7.125,4.02919036532155,"577812"],[6.0,0.0,"578042"],[14.3,17.22817459860446,"578331"],[18.0,6.0,"578514"],[12.6,10.131140113531151,"578698"],[46.18181818181818,62.854548084255875,"578819"],[10.133333333333333,7.736206362868617,"579143"],[9.8,4.4,"579276"],[1.0,0.0,"579409"],[20.923076923076923,18.679324392582124,"580357"],[60.0,16.97056274847714,"580892"],[1.0,0.0,"580976"],[5.142857142857143,3.1312918519568758,"581404"],[-4.0,0.0,"C579415"],[6.071428571428571,11.990855359185097,"536943"],[3.761904761904762,6.523983313639298,"537051"],[3.75,2.8613807855648994,"537141"],[-1.0,0.0,"C537600"],[4.566666666666666,6.810204761157252,"537614"],[-1.0,0.0,"C538105"],[-1.0,0.0,"C538711"],[14.0,8.838418809879036,"540121"],[-939.0,0.0,"540241"],[11.966442953020135,9.273195917007364,"540458"],[9.41025641025641,4.583795027848726,"540471"],[3.7916666666666665,4.915783819042041,"540975"],[11.514285714285714,6.800720249971127,"541530"],[11.235294117647058,15.641308098466121,"541846"],[-2.0,0.7559289460184544,"C542060"],[-1.3333333333333333,0.4714045207910317,"C542787"],[10.5,5.5362442142665635,"543007"],[9.333333333333334,3.7712361663282534,"543128"],[-1.75,0.4330127018922193,"C543175"],[150.0,0.0,"543675"],[4.045454545454546,4.476984300815903,"543973"],[12.5,6.534871494876197,"544111"],[20.79310344827586,30.854362358919445,"544295"],[6.9375,4.307968633822674,"544668"],[12.707692307692307,23.52721702259751,"545701"],[2.983050847457627,2.062510609515425,"545797"],[-1.0,0.0,"C545903"],[17.125,10.833253204831871,"545907"],[7.529411764705882,4.08897581105477,"547715"],[10.653061224489797,10.85441886957803,"547822"],[10.458333333333334,5.901829989267924,"547962"],[-30.0,0.0,"548209"],[40.0,0.0,"548746"],[6.0,0.0,"548901"],[-194.0,0.0,"548980"],[12.875,13.760791219984409,"549719"],[5.5625,6.909854828431636,"549728"],[1.7241379310344827,1.551340948855447,"550311"],[4.2727272727272725,4.778567854891427,"550437"],[-6.0,0.0,"C550611"],[26.0,20.09975124224178,"550635"],[1.5555555555555556,0.8314794192830981,"550641"],[-1.0,0.0,"C550809"],[-68.0,0.0,"550908"],[38.8,25.910615585122635,"551652"],[10.586206896551724,6.122413550335501,"551658"],[84.7,65.54166613689341,"552038"],[1.6363636363636365,1.1695163936607826,"552667"],[9.030303030303031,6.254621798923304,"553703"],[7.888888888888889,3.899984172174277,"554121"],[1.0,0.0,"554653"],[573.3333333333334,409.1921580654036,"555099"],[8.23076923076923,4.676518201098666,"555470"],[7.5,5.408326913195984,"555522"],[9.444444444444445,8.845728549997842,"555556"],[4.833333333333333,6.833333333333332,"555645"],[6.857142857142857,18.110206841357023,"555701"],[7.090909090909091,4.273694281288421,"555852"],[7.7272727272727275,3.707263364382488,"556290"],[-48.0,0.0,"556317"],[14.804878048780488,10.177017417775863,"556942"],[-4.0,0.0,"557028"],[1.125,0.33071891388307384,"557151"],[3.6666666666666665,1.3743685418725535,"558064"],[-12.0,0.0,"C558329"],[-1.5,0.8660254037844386,"C559105"],[2.923076923076923,4.322775790223728,"559168"],[26.0,0.0,"560358"],[95.43333333333334,59.00292836423931,"560445"],[13.3125,9.764212397833221,"560698"],[1.5384615384615385,0.8426500884694863,"560714"],[8.466666666666667,6.009621914526367,"561125"],[12.0,0.0,"561386"],[5.45,3.5843409436045564,"562256"],[12.0,0.0,"562941"],[1.0,0.0,"563229"],[-1.0,0.0,"C564208"],[-1.0,0.0,"C564211"],[-16.0,0.0,"C564276"],[-7.0,4.2895221179054435,"C564279"],[20.0,0.0,"564419"],[25.5,11.124297730643494,"564901"],[8.64,14.217960472585368,"565415"],[9.6,2.939387691339814,"566063"],[11.434782608695652,7.773008409576676,"566230"],[15.2,7.332121111929345,"566322"],[-7.0,0.0,"C567715"],[4.6,3.06521704868604,"567821"],[-30.0,0.0,"567933"],[-41.0,0.0,"568371"],[5.9,4.334743360338648,"568423"],[16.0,10.430723848324238,"568785"],[24.25,26.42796813983247,"569768"],[25.294117647058822,24.66266060551906,"571030"],[26.0,37.24835566840502,"571203"],[4.290322580645161,3.342720047401003,"571266"],[11.277777777777779,5.031076266074858,"571323"],[9.533333333333333,6.75146074729182,"571892"],[12.142857142857142,10.398194505758768,"572352"],[-1.0,0.0,"C573257"],[-1.4,0.4898979485566356,"C573864"],[15.333333333333334,14.772346537440226,"574698"],[4.0989010989010985,4.50410056163708,"574863"],[20.058823529411764,30.196358542118162,"574880"],[14.333333333333334,5.90668171555645,"575392"],[7.25,3.8324274291889733,"575847"],[15.8,9.14111590562115,"575914"],[9.368421052631579,4.975841915704628,"575939"],[1.4285714285714286,0.7284313590846836,"575958"],[10.135135135135135,8.959856906923756,"576019"],[-288.0,0.0,"576369"],[4.0,0.0,"576673"],[-24.0,0.0,"577115"],[2.388888888888889,1.6712898840545916,"577730"],[15.1,10.202450685987166,"577950"],[12.714285714285714,10.83267920578793,"578006"],[100.0,0.0,"578359"],[5.9523809523809526,3.552010704566003,"578786"],[-1.0,0.0,"C579169"],[21.0,46.01304162952064,"579174"],[30.0,18.0,"579262"],[-1.0,0.0,"C580507"],[6.708333333333333,6.06547034907892,"581381"],[1.0,0.0,"581474"],[11.285714285714286,8.80282885885937,"536460"],[-11.0,0.0,"C537445"],[1.7142857142857142,0.45175395145262565,"538627"],[1.0,0.0,"538724"],[5.416666666666667,4.071411166768702,"539379"],[36.0,0.0,"539406"],[1.411764705882353,0.8926569226816471,"539708"],[1.8102189781021898,2.149631938331947,"539718"],[1296.0,0.0,"539721"],[-36.0,0.0,"539980"],[3.0625,3.613667631368441,"540043"],[12.38888888888889,10.651754622746896,"540472"],[5.102564102564102,4.211065227285724,"540489"],[3.480769230769231,2.205677853381905,"540859"],[19.6,7.735631842325486,"541107"],[12.037037037037036,7.9975990910304136,"541972"],[-1.5,0.5,"C542376"],[13.3,13.539202339872169,"542527"],[9.476190476190476,8.226664241060734,"543010"],[194.8,106.22316131616495,"543831"],[8.818181818181818,3.4855071841237844,"544675"],[5.0,3.674234614174767,"544885"],[9.8,2.08806130178211,"544919"],[1.3793103448275863,0.6110360395403224,"545036"],[21.0,11.61895003862225,"545070"],[144.0,0.0,"545185"],[-1.0,0.0,"C546906"],[13.5,22.28040993039999,"547018"],[31.0,17.05872210923198,"547371"],[1.0,0.0,"547970"],[3.1875,2.0530084632071053,"548308"],[232.0,260.95210288480143,"548359"],[7.538461538461538,3.4997886664853306,"549189"],[9.71875,11.737318622134273,"549526"],[5.43859649122807,4.660462833199811,"549546"],[-6.0,0.0,"549846"],[42.25,58.78084296775609,"550164"],[-3.5,2.5,"C550176"],[5.2926829268292686,6.069692411698911,"550297"],[9.555555555555555,9.656444147834486,"550301"],[11.526315789473685,9.659292886033208,"550316"],[-1.0,0.0,"C550349"],[-1.5,0.8660254037844387,"C550646"],[-1.5,0.8660254037844387,"C551659"],[-1.0,0.0,"C552343"],[6.615384615384615,3.932868624973605,"552357"],[9.2,7.472616676907762,"553198"],[-2.0,0.0,"C554012"],[42.0,51.94502588588934,"554853"],[12.0,0.0,"554953"],[96.0,0.0,"551165"],[-4.0,0.0,"551168"],[20.0,5.656854249492381,"556631"],[12.0,0.0,"557415"],[26.0,14.0,"557498"],[8.666666666666666,7.370038013298189,"558642"],[-16.0,4.0,"C558739"],[3.2758620689655173,2.786212586770109,"558888"],[4.0,2.0,"559304"],[42.0,18.0,"559339"],[-39.0,0.0,"559378"],[10.594594594594595,7.122326751080716,"559813"],[16.0,4.0,"559823"],[11.192307692307692,7.6611870478567825,"559909"],[3.9873417721518987,6.006312440787305,"560209"],[1.0,0.0,"560373"],[30.666666666666668,21.186998109427602,"560697"],[-530.0,0.0,"561086"],[-36.0,0.0,"C561227"],[10.5625,11.548640342048929,"561860"],[2.6,1.7435595774162693,"563194"],[11.666666666666666,11.657138966697142,"563268"],[8.0,0.0,"563853"],[-36.0,0.0,"C564257"],[2.9649122807017543,2.9733607441937377,"564436"],[7.948717948717949,6.038121281719568,"564489"],[48.0,0.0,"564564"],[61.0,59.0,"564906"],[11.517241379310345,5.424215752340879,"565219"],[-72.0,0.0,"565275"],[-1.8571428571428572,1.7261494247992248,"C565284"],[14.428571428571429,7.825911957029907,"565458"],[4.107142857142857,2.6368174230403176,"565751"],[9.333333333333334,2.494438257849294,"566439"],[16.0,5.656854249492381,"566630"],[3.5,2.5,"567169"],[11.821428571428571,7.181591404559355,"567798"],[3.5555555555555554,1.5475986974649025,"567944"],[11.7,3.536947836765479,"568063"],[1.8275862068965518,2.3054502966133485,"568075"],[9.891891891891891,4.740759340385016,"568162"],[19.785714285714285,24.231557262110474,"568402"],[-1.0,0.0,"C568562"],[2.0472972972972974,2.3142754965164536,"568712"],[-21.0,0.0,"568724"],[12.133333333333333,3.7570674142947658,"568800"],[7.555555555555555,7.514594852849296,"569006"],[2.0,0.0,"569915"],[5.714285714285714,9.709557672936581,"570096"],[13.428571428571429,7.068181072487418,"570411"],[2.0,0.0,"571109"],[4.774193548387097,3.4239166162155708,"571197"],[360.0,0.0,"571259"],[14.8,5.6000000000000005,"572320"],[92.6,95.27769938448345,"572734"],[11.81132075471698,10.49358582842995,"573123"],[41.142857142857146,8.741176309016202,"573132"],[3.0784313725490198,7.684573641342235,"573496"],[19.45945945945946,6.700522749250339,"574029"],[2.6354166666666665,3.5827125188962,"574063"],[23.75,16.322913342905427,"574066"],[2.0634920634920637,2.6056898417740193,"574287"],[10.877551020408163,13.379290504756307,"574545"],[20.671755725190838,16.262372975061925,"574740"],[7.36,7.5730046877048744,"574824"],[11.263157894736842,5.664683809294194,"574560"],[24.0,0.0,"575203"],[-4.2,3.4292856398964493,"C575608"],[7.0,0.0,"576385"],[-200.0,0.0,"C577614"],[1.3709677419354838,1.5370045329937347,"578022"],[16.285714285714285,9.34595841931207,"579144"],[2.5,0.5,"579437"],[24.0,0.0,"579788"],[13.23076923076923,13.934759229814464,"580309"],[48.0,0.0,"580315"],[1.8125,1.260890062614501,"580876"],[2.2333333333333334,2.0604745947367458,"581246"],[5.224489795918367,12.393654245460391,"581467"],[6.0,0.0,"536626"],[84.0,36.0,"536968"],[6.928571428571429,3.9724818747098087,"537049"],[2.0,1.2878418324335692,"537054"],[183.33333333333334,84.98365855987974,"537476"],[2.027027027027027,1.9975636487484132,"538148"],[10.0,2.0,"538310"],[2.4594594594594597,3.0632485370449154,"538419"],[5.722222222222222,5.299953412327274,"538504"],[1.95,1.7168284713389397,"538510"],[3.44,2.940476151918257,"538513"],[1.0,0.0,"539081"],[-1.0,0.0,"C540952"],[8.0,2.8284271247461903,"540985"],[-41.0,0.0,"541000"],[-1.0,0.0,"C541650"],[2.0,2.5773740789526736,"542239"],[-31.0,0.0,"542391"],[1.5714285714285714,1.049781318335648,"542673"],[-207.0,0.0,"542861"],[2.393939393939394,1.0132274846848779,"543458"],[4.363636363636363,2.804954294643911,"544835"],[-1.0,0.0,"C545556"],[19.803571428571427,14.752021220905316,"545937"],[-4.666666666666667,1.8856180831641267,"C546903"],[1.0,0.0,"547009"],[-153.0,0.0,"547487"],[16.857142857142858,16.69779406180985,"547510"],[13.571428571428571,6.332617216943286,"547647"],[-6.0,0.0,"C548155"],[-32.0,14.0,"C548463"],[4.0,0.0,"548638"],[100.0,0.0,"548649"],[-6.0,0.0,"549375"],[13.88888888888889,13.609183536980089,"549467"],[14.153846153846153,8.355984993230935,"549918"],[12.25,8.011710179481033,"549944"],[-1.0,0.0,"C550455"],[8.857142857142858,5.9143547269955565,"550921"],[9.0,0.0,"551145"],[-15.0,0.0,"C551179"],[-5.0,0.0,"551583"],[14.444444444444445,7.987644780271746,"552312"],[7.75,3.491060010942235,"552319"],[11.515151515151516,5.898747746517319,"552337"],[3.525,3.0494876618868294,"552951"],[1.0588235294117647,0.23529411764705882,"553015"],[-1.0,0.0,"C553150"],[-1.0,0.0,"C553378"],[74.4,32.25895224584952,"553469"],[3.2413793103448274,2.2992528383682274,"553507"],[-2.0,0.0,"C553568"],[13.6,10.229369482035537,"553578"],[11.636363636363637,6.852640198197365,"554042"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"avg(Quantity)","type":"\"double\"","metadata":"{}"},{"name":"stddev_pop(CAST(Quantity AS DOUBLE))","type":"\"double\"","metadata":"{}"},{"name":"InvoiceNo","type":"\"string\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639785916,"submitTime":1497639785901,"finishTime":1497639786213,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8902e22a-2f9a-40ee-b316-16d1c8ac5af2"},{"version":"CommandV1","origId":336718490210321,"guid":"ef6b6728-0505-4d27-8e07-2f447f81c23f","subtype":"command","commandType":"auto","position":47.0,"command":"%scala\nimport org.apache.spark.sql.functions.col\nval dfWithDate = df.withColumn(\"date\", col(\"InvoiceDate\").cast(\"date\"))\ndfWithDate.createOrReplaceTempView(\"dfWithDate\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.col\ndfWithDate: org.apache.spark.sql.DataFrame = [InvoiceNo: string, StockCode: string ... 7 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639800632,"submitTime":1497639800614,"finishTime":1497639800691,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ba3e62cd-ea2f-4d23-97a8-fbf71831bb31"},{"version":"CommandV1","origId":336718490210322,"guid":"7c6deb9e-5930-4b0e-8662-ef8e9354d773","subtype":"command","commandType":"auto","position":48.0,"command":"from pyspark.sql.functions import col\ndfWithDate = df.withColumn(\"date\", col(\"InvoiceDate\").cast(\"date\"))\ndfWithDate.createOrReplaceTempView(\"dfWithDate\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639808663,"submitTime":1497639808645,"finishTime":1497639808735,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ee37f985-5376-49be-8257-8b4406884a83"},{"version":"CommandV1","origId":336718490210323,"guid":"3aca9d76-a66f-47bf-ad06-f1106e053ea9","subtype":"command","commandType":"auto","position":49.0,"command":"%scala\nimport org.apache.spark.sql.expressions.Window\nimport org.apache.spark.sql.functions.col\nval windowSpec = Window\n.partitionBy(\"CustomerId\", \"date\")\n.orderBy(col(\"Quantity\").desc)\n.rowsBetween(Window.unboundedPreceding, Window.currentRow)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.expressions.Window\nimport org.apache.spark.sql.functions.col\nwindowSpec: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@74e11258\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639817589,"submitTime":1497639817569,"finishTime":1497639817652,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e7d5592a-318c-4692-ae2f-24c153ca29f0"},{"version":"CommandV1","origId":336718490210324,"guid":"ae193095-e83d-4b61-831a-d0871593e89b","subtype":"command","commandType":"auto","position":50.0,"command":"from pyspark.sql.window import Window\nfrom pyspark.sql.functions import desc\nwindowSpec = Window\\\n.partitionBy(\"CustomerId\", \"date\")\\\n.orderBy(desc(\"Quantity\"))\\\n.rowsBetween(Window.unboundedPreceding, Window.currentRow)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639825926,"submitTime":1497639825907,"finishTime":1497639825998,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"510a9984-54db-40da-8d3c-533aea493708"},{"version":"CommandV1","origId":336718490210325,"guid":"1f744e9f-216d-44a6-ae72-d965e1d88f4b","subtype":"command","commandType":"auto","position":51.0,"command":"%scala\nimport org.apache.spark.sql.functions.max\nval maxPurchaseQuantity = max(col(\"Quantity\"))\n.over(windowSpec)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.max\nmaxPurchaseQuantity: org.apache.spark.sql.Column = max(Quantity) OVER (PARTITION BY CustomerId, date ORDER BY Quantity DESC NULLS LAST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639836192,"submitTime":1497639836173,"finishTime":1497639836251,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4b9f8f26-e20a-4056-99c9-a136fddbae0f"},{"version":"CommandV1","origId":336718490210326,"guid":"c57229be-85f9-4023-a438-9a6d61ca0d92","subtype":"command","commandType":"auto","position":52.0,"command":"from pyspark.sql.functions import max\nmaxPurchaseQuantity = max(col(\"Quantity\"))\\\n.over(windowSpec)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639851702,"submitTime":1497639851683,"finishTime":1497639851773,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9ae0d4ae-1155-494d-ad3e-6eecdd4ea2eb"},{"version":"CommandV1","origId":336718490210327,"guid":"011ce06e-d1aa-4655-b84b-4e8a9b2859cd","subtype":"command","commandType":"auto","position":53.0,"command":"%scala\nimport org.apache.spark.sql.functions.{dense_rank, rank}\nval purchaseDenseRank = dense_rank()\n.over(windowSpec)\nval purchaseRank = rank()\n.over(windowSpec)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.{dense_rank, rank}\npurchaseDenseRank: org.apache.spark.sql.Column = DENSE_RANK() OVER (PARTITION BY CustomerId, date ORDER BY Quantity DESC NULLS LAST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)\npurchaseRank: org.apache.spark.sql.Column = RANK() OVER (PARTITION BY CustomerId, date ORDER BY Quantity DESC NULLS LAST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639859452,"submitTime":1497639859434,"finishTime":1497639859513,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"29fb1ad5-e72b-4335-b90f-ef3fed7da11f"},{"version":"CommandV1","origId":336718490210328,"guid":"ef4617c6-ab59-4daf-b59a-85cbc674c3ef","subtype":"command","commandType":"auto","position":54.0,"command":"from pyspark.sql.functions import dense_rank, rank\npurchaseDenseRank = dense_rank()\\\n.over(windowSpec)\npurchaseRank = rank()\\\n.over(windowSpec)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639867536,"submitTime":1497639867517,"finishTime":1497639867607,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e12fec2c-18c9-4201-a9fc-65e1575eb7ca"},{"version":"CommandV1","origId":336718490210329,"guid":"6bb1dc7f-7501-47e2-be45-ce1dab08f7f6","subtype":"command","commandType":"auto","position":55.0,"command":"%scala\nimport org.apache.spark.sql.functions.col\ndfWithDate\n.where(\"CustomerId IS NOT NULL\")\n.orderBy(\"CustomerId\")\n.select(\ncol(\"CustomerId\"),\ncol(\"date\"),\ncol(\"Quantity\"),\npurchaseRank.alias(\"quantityRank\"),\npurchaseDenseRank.alias(\"quantityDenseRank\"),\nmaxPurchaseQuantity.alias(\"maxPurchaseQuantity\"))\n.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------+----+--------+------------+-----------------+-------------------+\n|CustomerId|date|Quantity|quantityRank|quantityDenseRank|maxPurchaseQuantity|\n+----------+----+--------+------------+-----------------+-------------------+\n|     12346|null|   74215|           1|                1|              74215|\n|     12346|null|  -74215|           2|                2|              74215|\n|     12347|null|     240|           1|                1|                240|\n|     12347|null|      48|           2|                2|                240|\n|     12347|null|      36|           3|                3|                240|\n|     12347|null|      36|           3|                3|                240|\n|     12347|null|      36|           3|                3|                240|\n|     12347|null|      36|           3|                3|                240|\n|     12347|null|      36|           3|                3|                240|\n|     12347|null|      36|           3|                3|                240|\n|     12347|null|      30|           9|                4|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n+----------+----+--------+------------+-----------------+-------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.sql.functions.col\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497639876577,"submitTime":1497639876570,"finishTime":1497639877578,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"342d2f4a-5dc3-4dc6-9618-b5eab48d3317"},{"version":"CommandV1","origId":336718490210330,"guid":"215c9534-f0e3-4f30-857c-5d59340af303","subtype":"command","commandType":"auto","position":56.0,"command":"from pyspark.sql.functions import col\ndfWithDate\\\n.where(\"CustomerId IS NOT NULL\")\\\n.orderBy(\"CustomerId\")\\\n.select(\ncol(\"CustomerId\"),\ncol(\"date\"),\ncol(\"Quantity\"),\npurchaseRank.alias(\"quantityRank\"),\npurchaseDenseRank.alias(\"quantityDenseRank\"),\nmaxPurchaseQuantity.alias(\"maxPurchaseQuantity\"))\\\n.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------+----+--------+------------+-----------------+-------------------+\n|CustomerId|date|Quantity|quantityRank|quantityDenseRank|maxPurchaseQuantity|\n+----------+----+--------+------------+-----------------+-------------------+\n|     12346|null|   74215|           1|                1|              74215|\n|     12346|null|  -74215|           2|                2|              74215|\n|     12347|null|     240|           1|                1|                240|\n|     12347|null|      48|           2|                2|                240|\n|     12347|null|      36|           3|                3|                240|\n|     12347|null|      36|           3|                3|                240|\n|     12347|null|      36|           3|                3|                240|\n|     12347|null|      36|           3|                3|                240|\n|     12347|null|      36|           3|                3|                240|\n|     12347|null|      36|           3|                3|                240|\n|     12347|null|      30|           9|                4|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n|     12347|null|      24|          10|                5|                240|\n+----------+----+--------+------------+-----------------+-------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641121568,"submitTime":1497641121537,"finishTime":1497641122093,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cad69520-4b11-4433-9ae3-c237479d4726"},{"version":"CommandV1","origId":2060825016293486,"guid":"4ad1e1d4-9b42-4446-98ac-c08300af2591","subtype":"command","commandType":"auto","position":57.0,"command":"%sql\nSELECT\nCustomerId,\ndate,\nQuantity,\nrank(Quantity) OVER (PARTITION BY CustomerId, date\nORDER BY Quantity DESC NULLS LAST\nROWS BETWEEN\nUNBOUNDED PRECEDING AND\nCURRENT ROW) as rank,\ndense_rank(Quantity) OVER (PARTITION BY CustomerId, date\nORDER BY Quantity DESC NULLS LAST\nROWS BETWEEN\nUNBOUNDED PRECEDING AND\nCURRENT ROW) as dRank,\nmax(Quantity) OVER (PARTITION BY CustomerId, date\nORDER BY Quantity DESC NULLS LAST\nROWS BETWEEN\nUNBOUNDED PRECEDING AND\nCURRENT ROW) as maxPurchase\nFROM\ndfWithDate\nWHERE\nCustomerId IS NOT NULL\nORDER BY\nCustomerId","commandVersion":0,"state":"finished","results":{"type":"table","data":[[12346,null,74215,1,1,74215],[12346,null,-74215,2,2,74215],[12347,null,24,10,5,240],[12347,null,4,145,13,240],[12347,null,6,124,12,240],[12347,null,6,124,12,240],[12347,null,6,124,12,240],[12347,null,30,9,4,240],[12347,null,4,145,13,240],[12347,null,12,44,9,240],[12347,null,20,36,6,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,12,44,9,240],[12347,null,24,10,5,240],[12347,null,8,109,11,240],[12347,null,12,44,9,240],[12347,null,24,10,5,240],[12347,null,6,124,12,240],[12347,null,6,124,12,240],[12347,null,12,44,9,240],[12347,null,6,124,12,240],[12347,null,12,44,9,240],[12347,null,6,124,12,240],[12347,null,12,44,9,240],[12347,null,6,124,12,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,20,36,6,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,10,100,10,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,24,10,5,240],[12347,null,24,10,5,240],[12347,null,4,145,13,240],[12347,null,12,44,9,240],[12347,null,3,177,14,240],[12347,null,16,42,8,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,3,177,14,240],[12347,null,12,44,9,240],[12347,null,3,177,14,240],[12347,null,24,10,5,240],[12347,null,24,10,5,240],[12347,null,240,1,1,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,10,100,10,240],[12347,null,10,100,10,240],[12347,null,8,109,11,240],[12347,null,8,109,11,240],[12347,null,24,10,5,240],[12347,null,36,3,3,240],[12347,null,8,109,11,240],[12347,null,12,44,9,240],[12347,null,24,10,5,240],[12347,null,12,44,9,240],[12347,null,24,10,5,240],[12347,null,4,145,13,240],[12347,null,10,100,10,240],[12347,null,6,124,12,240],[12347,null,24,10,5,240],[12347,null,36,3,3,240],[12347,null,6,124,12,240],[12347,null,6,124,12,240],[12347,null,36,3,3,240],[12347,null,24,10,5,240],[12347,null,12,44,9,240],[12347,null,6,124,12,240],[12347,null,12,44,9,240],[12347,null,6,124,12,240],[12347,null,24,10,5,240],[12347,null,6,124,12,240],[12347,null,12,44,9,240],[12347,null,6,124,12,240],[12347,null,24,10,5,240],[12347,null,6,124,12,240],[12347,null,12,44,9,240],[12347,null,6,124,12,240],[12347,null,24,10,5,240],[12347,null,6,124,12,240],[12347,null,12,44,9,240],[12347,null,6,124,12,240],[12347,null,20,36,6,240],[12347,null,24,10,5,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,12,44,9,240],[12347,null,4,145,13,240],[12347,null,12,44,9,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,4,145,13,240],[12347,null,20,36,6,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,18,40,7,240],[12347,null,4,145,13,240],[12347,null,12,44,9,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,12,44,9,240],[12347,null,4,145,13,240],[12347,null,18,40,7,240],[12347,null,12,44,9,240],[12347,null,16,42,8,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,24,10,5,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,4,145,13,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,3,177,14,240],[12347,null,2,181,15,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,24,10,5,240],[12347,null,12,44,9,240],[12347,null,2,181,15,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,48,2,2,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,36,3,3,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,24,10,5,240],[12347,null,36,3,3,240],[12347,null,24,10,5,240],[12347,null,36,3,3,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,10,100,10,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,24,10,5,240],[12347,null,12,44,9,240],[12347,null,24,10,5,240],[12347,null,24,10,5,240],[12347,null,24,10,5,240],[12347,null,10,100,10,240],[12347,null,10,100,10,240],[12347,null,24,10,5,240],[12347,null,10,100,10,240],[12347,null,12,44,9,240],[12347,null,10,100,10,240],[12347,null,12,44,9,240],[12347,null,8,109,11,240],[12347,null,12,44,9,240],[12347,null,8,109,11,240],[12347,null,8,109,11,240],[12347,null,8,109,11,240],[12347,null,12,44,9,240],[12347,null,8,109,11,240],[12347,null,8,109,11,240],[12347,null,12,44,9,240],[12347,null,8,109,11,240],[12347,null,24,10,5,240],[12347,null,12,44,9,240],[12347,null,8,109,11,240],[12347,null,6,124,12,240],[12347,null,8,109,11,240],[12347,null,12,44,9,240],[12347,null,12,44,9,240],[12347,null,8,109,11,240],[12347,null,8,109,11,240],[12347,null,6,124,12,240],[12348,null,24,22,7,144],[12348,null,1,29,10,144],[12348,null,120,7,2,144],[12348,null,120,7,2,144],[12348,null,144,1,1,144],[12348,null,48,20,6,144],[12348,null,24,22,7,144],[12348,null,24,22,7,144],[12348,null,96,12,3,144],[12348,null,6,28,9,144],[12348,null,144,1,1,144],[12348,null,20,27,8,144],[12348,null,96,12,3,144],[12348,null,24,22,7,144],[12348,null,144,1,1,144],[12348,null,24,22,7,144],[12348,null,72,15,5,144],[12348,null,48,20,6,144],[12348,null,120,7,2,144],[12348,null,72,15,5,144],[12348,null,1,29,10,144],[12348,null,80,14,4,144],[12348,null,120,7,2,144],[12348,null,72,15,5,144],[12348,null,1,29,10,144],[12348,null,120,7,2,144],[12348,null,144,1,1,144],[12348,null,72,15,5,144],[12348,null,144,1,1,144],[12348,null,144,1,1,144],[12348,null,72,15,5,144],[12349,null,1,70,12,36],[12349,null,12,7,5,36],[12349,null,6,35,8,36],[12349,null,4,52,9,36],[12349,null,12,7,5,36],[12349,null,10,28,6,36],[12349,null,3,57,10,36],[12349,null,24,5,3,36],[12349,null,6,35,8,36],[12349,null,1,70,12,36],[12349,null,12,7,5,36],[12349,null,6,35,8,36],[12349,null,12,7,5,36],[12349,null,6,35,8,36],[12349,null,6,35,8,36],[12349,null,25,3,2,36],[12349,null,6,35,8,36],[12349,null,6,35,8,36],[12349,null,16,6,4,36],[12349,null,3,57,10,36],[12349,null,12,7,5,36],[12349,null,4,52,9,36],[12349,null,4,52,9,36],[12349,null,12,7,5,36],[12349,null,12,7,5,36],[12349,null,4,52,9,36],[12349,null,4,52,9,36],[12349,null,12,7,5,36],[12349,null,3,57,10,36],[12349,null,12,7,5,36],[12349,null,8,29,7,36],[12349,null,12,7,5,36],[12349,null,3,57,10,36],[12349,null,8,29,7,36],[12349,null,3,57,10,36],[12349,null,8,29,7,36],[12349,null,3,57,10,36],[12349,null,1,70,12,36],[12349,null,2,64,11,36],[12349,null,8,29,7,36],[12349,null,3,57,10,36],[12349,null,12,7,5,36],[12349,null,2,64,11,36],[12349,null,12,7,5,36],[12349,null,2,64,11,36],[12349,null,8,29,7,36],[12349,null,2,64,11,36],[12349,null,2,64,11,36],[12349,null,12,7,5,36],[12349,null,2,64,11,36],[12349,null,8,29,7,36],[12349,null,6,35,8,36],[12349,null,6,35,8,36],[12349,null,1,70,12,36],[12349,null,25,3,2,36],[12349,null,6,35,8,36],[12349,null,12,7,5,36],[12349,null,36,1,1,36],[12349,null,6,35,8,36],[12349,null,36,1,1,36],[12349,null,12,7,5,36],[12349,null,6,35,8,36],[12349,null,6,35,8,36],[12349,null,12,7,5,36],[12349,null,12,7,5,36],[12349,null,6,35,8,36],[12349,null,6,35,8,36],[12349,null,12,7,5,36],[12349,null,12,7,5,36],[12349,null,6,35,8,36],[12349,null,12,7,5,36],[12349,null,6,35,8,36],[12349,null,12,7,5,36],[12350,null,12,2,2,24],[12350,null,12,2,2,24],[12350,null,12,2,2,24],[12350,null,12,2,2,24],[12350,null,12,2,2,24],[12350,null,12,2,2,24],[12350,null,12,2,2,24],[12350,null,12,2,2,24],[12350,null,12,2,2,24],[12350,null,12,2,2,24],[12350,null,10,15,3,24],[12350,null,12,2,2,24],[12350,null,12,2,2,24],[12350,null,12,2,2,24],[12350,null,1,17,5,24],[12350,null,24,1,1,24],[12350,null,6,16,4,24],[12352,null,3,54,8,16],[12352,null,2,69,9,16],[12352,null,2,69,9,16],[12352,null,12,4,2,16],[12352,null,3,54,8,16],[12352,null,2,69,9,16],[12352,null,12,4,2,16],[12352,null,5,39,6,16],[12352,null,3,54,8,16],[12352,null,6,29,5,16],[12352,null,2,69,9,16],[12352,null,2,69,9,16],[12352,null,2,69,9,16],[12352,null,6,29,5,16],[12352,null,6,29,5,16],[12352,null,12,4,2,16],[12352,null,4,40,7,16],[12352,null,12,4,2,16],[12352,null,12,4,2,16],[12352,null,8,28,4,16],[12352,null,1,80,10,16],[12352,null,12,4,2,16],[12352,null,12,4,2,16],[12352,null,-1,86,11,16],[12352,null,-12,92,14,16],[12352,null,4,40,7,16],[12352,null,-12,92,14,16],[12352,null,12,4,2,16],[12352,null,16,1,1,16],[12352,null,3,54,8,16],[12352,null,3,54,8,16],[12352,null,10,27,3,16],[12352,null,12,4,2,16],[12352,null,3,54,8,16],[12352,null,3,54,8,16],[12352,null,6,29,5,16],[12352,null,3,54,8,16],[12352,null,6,29,5,16],[12352,null,6,29,5,16],[12352,null,3,54,8,16],[12352,null,1,80,10,16],[12352,null,3,54,8,16],[12352,null,6,29,5,16],[12352,null,3,54,8,16],[12352,null,3,54,8,16],[12352,null,16,1,1,16],[12352,null,6,29,5,16],[12352,null,3,54,8,16],[12352,null,3,54,8,16],[12352,null,12,4,2,16],[12352,null,12,4,2,16],[12352,null,12,4,2,16],[12352,null,6,29,5,16],[12352,null,2,69,9,16],[12352,null,6,29,5,16],[12352,null,2,69,9,16],[12352,null,12,4,2,16],[12352,null,2,69,9,16],[12352,null,2,69,9,16],[12352,null,12,4,2,16],[12352,null,2,69,9,16],[12352,null,1,80,10,16],[12352,null,4,40,7,16],[12352,null,4,40,7,16],[12352,null,12,4,2,16],[12352,null,1,80,10,16],[12352,null,1,80,10,16],[12352,null,-1,86,11,16],[12352,null,1,80,10,16],[12352,null,4,40,7,16],[12352,null,4,40,7,16],[12352,null,-1,86,11,16],[12352,null,12,4,2,16],[12352,null,-3,89,12,16],[12352,null,4,40,7,16],[12352,null,-6,90,13,16],[12352,null,12,4,2,16],[12352,null,-6,90,13,16],[12352,null,12,4,2,16],[12352,null,4,40,7,16],[12352,null,-12,92,14,16],[12352,null,4,40,7,16],[12352,null,-12,92,14,16],[12352,null,16,1,1,16],[12352,null,4,40,7,16],[12352,null,4,40,7,16],[12352,null,12,4,2,16],[12352,null,12,4,2,16],[12352,null,12,4,2,16],[12352,null,3,54,8,16],[12352,null,12,4,2,16],[12352,null,4,40,7,16],[12352,null,4,40,7,16],[12352,null,4,40,7,16],[12352,null,12,4,2,16],[12353,null,4,3,3,8],[12353,null,2,4,4,8],[12353,null,6,2,2,8],[12353,null,8,1,1,8],[12354,null,6,27,6,32],[12354,null,12,10,3,32],[12354,null,4,35,8,32],[12354,null,24,5,2,32],[12354,null,32,1,1,32],[12354,null,32,1,1,32],[12354,null,4,35,8,32],[12354,null,3,41,9,32],[12354,null,2,45,10,32],[12354,null,12,10,3,32],[12354,null,24,5,2,32],[12354,null,12,10,3,32],[12354,null,32,1,1,32],[12354,null,6,27,6,32],[12354,null,4,35,8,32],[12354,null,10,17,4,32],[12354,null,5,34,7,32],[12354,null,32,1,1,32],[12354,null,10,17,4,32],[12354,null,2,45,10,32],[12354,null,4,35,8,32],[12354,null,10,17,4,32],[12354,null,24,5,2,32],[12354,null,10,17,4,32],[12354,null,4,35,8,32],[12354,null,10,17,4,32],[12354,null,4,35,8,32],[12354,null,12,10,3,32],[12354,null,12,10,3,32],[12354,null,3,41,9,32],[12354,null,3,41,9,32],[12354,null,24,5,2,32],[12354,null,3,41,9,32],[12354,null,10,17,4,32],[12354,null,12,10,3,32],[12354,null,2,45,10,32],[12354,null,2,45,10,32],[12354,null,2,45,10,32],[12354,null,8,23,5,32],[12354,null,8,23,5,32],[12354,null,24,5,2,32],[12354,null,2,45,10,32],[12354,null,8,23,5,32],[12354,null,8,23,5,32],[12354,null,2,45,10,32],[12354,null,2,45,10,32],[12354,null,2,45,10,32],[12354,null,6,27,6,32],[12354,null,6,27,6,32],[12354,null,1,54,11,32],[12354,null,1,54,11,32],[12354,null,1,54,11,32],[12354,null,1,54,11,32],[12354,null,12,10,3,32],[12354,null,1,54,11,32],[12354,null,6,27,6,32],[12354,null,6,27,6,32],[12354,null,6,27,6,32],[12355,null,8,5,5,96],[12355,null,6,6,6,96],[12355,null,6,6,6,96],[12355,null,2,12,7,96],[12355,null,24,3,3,96],[12355,null,6,6,6,96],[12355,null,60,2,2,96],[12355,null,12,4,4,96],[12355,null,6,6,6,96],[12355,null,2,12,7,96],[12355,null,6,6,6,96],[12355,null,6,6,6,96],[12355,null,96,1,1,96],[12356,null,12,38,13,120],[12356,null,4,51,17,120],[12356,null,4,51,17,120],[12356,null,24,18,8,120],[12356,null,12,38,13,120],[12356,null,16,36,11,120],[12356,null,48,6,4,120],[12356,null,12,38,13,120],[12356,null,48,6,4,120],[12356,null,12,38,13,120],[12356,null,8,49,15,120],[12356,null,24,18,8,120],[12356,null,6,50,16,120],[12356,null,36,15,6,120],[12356,null,24,18,8,120],[12356,null,3,57,18,120],[12356,null,24,18,8,120],[12356,null,20,33,9,120],[12356,null,120,1,1,120],[12356,null,32,16,7,120],[12356,null,24,18,8,120],[12356,null,12,38,13,120],[12356,null,24,18,8,120],[12356,null,48,6,4,120],[12356,null,24,18,8,120],[12356,null,12,38,13,120],[12356,null,12,38,13,120],[12356,null,12,38,13,120],[12356,null,48,6,4,120],[12356,null,48,6,4,120],[12356,null,120,1,1,120],[12356,null,4,51,17,120],[12356,null,24,18,8,120],[12356,null,4,51,17,120],[12356,null,24,18,8,120],[12356,null,24,18,8,120],[12356,null,2,59,19,120],[12356,null,32,16,7,120],[12356,null,48,6,4,120],[12356,null,3,57,18,120],[12356,null,48,6,4,120],[12356,null,24,18,8,120],[12356,null,72,3,2,120],[12356,null,60,5,3,120],[12356,null,18,34,10,120],[12356,null,72,3,2,120],[12356,null,18,34,10,120],[12356,null,24,18,8,120],[12356,null,15,37,12,120],[12356,null,12,38,13,120],[12356,null,12,38,13,120],[12356,null,48,6,4,120],[12356,null,24,18,8,120],[12356,null,24,18,8,120],[12356,null,10,48,14,120],[12356,null,24,18,8,120],[12356,null,40,14,5,120],[12356,null,4,51,17,120],[12356,null,4,51,17,120],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,24,21,6,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,30,18,5,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,8,110,11,96],[12357,null,24,21,6,96],[12357,null,6,117,12,96],[12357,null,6,117,12,96],[12357,null,36,13,4,96],[12357,null,16,61,8,96],[12357,null,12,67,9,96],[12357,null,36,13,4,96],[12357,null,30,18,5,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,48,6,3,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,72,3,2,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,8,110,11,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,8,110,11,96],[12357,null,8,110,11,96],[12357,null,24,21,6,96],[12357,null,36,13,4,96],[12357,null,16,61,8,96],[12357,null,6,117,12,96],[12357,null,6,117,12,96],[12357,null,3,130,14,96],[12357,null,6,117,12,96],[12357,null,6,117,12,96],[12357,null,24,21,6,96],[12357,null,96,1,1,96],[12357,null,12,67,9,96],[12357,null,96,1,1,96],[12357,null,30,18,5,96],[12357,null,24,21,6,96],[12357,null,48,6,3,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,72,3,2,96],[12357,null,48,6,3,96],[12357,null,12,67,9,96],[12357,null,72,3,2,96],[12357,null,36,13,4,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,24,21,6,96],[12357,null,16,61,8,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,24,21,6,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,48,6,3,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,48,6,3,96],[12357,null,24,21,6,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,48,6,3,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,12,67,9,96],[12357,null,24,21,6,96],[12357,null,24,21,6,96],[12357,null,12,67,9,96],[12357,null,36,13,4,96],[12357,null,12,67,9,96],[12357,null,9,108,10,96],[12357,null,24,21,6,96],[12357,null,9,108,10,96],[12357,null,8,110,11,96],[12357,null,8,110,11,96],[12357,null,8,110,11,96],[12357,null,48,6,3,96],[12357,null,24,21,6,96],[12357,null,1,131,15,96],[12357,null,6,117,12,96],[12357,null,24,21,6,96],[12357,null,24,21,6,96],[12357,null,20,60,7,96],[12357,null,16,61,8,96],[12357,null,6,117,12,96],[12357,null,6,117,12,96],[12357,null,6,117,12,96],[12357,null,16,61,8,96],[12357,null,4,127,13,96],[12357,null,4,127,13,96],[12357,null,16,61,8,96],[12357,null,24,21,6,96],[12357,null,4,127,13,96],[12358,null,24,2,2,36],[12358,null,2,17,6,36],[12358,null,24,2,2,36],[12358,null,24,2,2,36],[12358,null,12,6,3,36],[12358,null,4,15,5,36],[12358,null,2,17,6,36],[12358,null,2,17,6,36],[12358,null,36,1,1,36],[12358,null,12,6,3,36],[12358,null,6,14,4,36],[12358,null,12,6,3,36],[12358,null,12,6,3,36],[12358,null,12,6,3,36],[12358,null,12,6,3,36],[12358,null,24,2,2,36],[12358,null,12,6,3,36],[12358,null,12,6,3,36],[12358,null,4,15,5,36],[12359,null,6,85,8,25],[12359,null,3,167,11,25],[12359,null,3,167,11,25],[12359,null,10,55,6,25],[12359,null,3,167,11,25],[12359,null,12,14,5,25],[12359,null,12,14,5,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,8,74,7,25],[12359,null,3,167,11,25],[12359,null,8,74,7,25],[12359,null,3,167,11,25],[12359,null,3,167,11,25],[12359,null,3,167,11,25],[12359,null,12,14,5,25],[12359,null,3,167,11,25],[12359,null,6,85,8,25],[12359,null,12,14,5,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,12,14,5,25],[12359,null,12,14,5,25],[12359,null,1,238,13,25],[12359,null,1,238,13,25],[12359,null,12,14,5,25],[12359,null,10,55,6,25],[12359,null,12,14,5,25],[12359,null,8,74,7,25],[12359,null,3,167,11,25],[12359,null,16,10,4,25],[12359,null,8,74,7,25],[12359,null,12,14,5,25],[12359,null,6,85,8,25],[12359,null,3,167,11,25],[12359,null,3,167,11,25],[12359,null,6,85,8,25],[12359,null,12,14,5,25],[12359,null,3,167,11,25],[12359,null,3,167,11,25],[12359,null,3,167,11,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,12,14,5,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,10,55,6,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,20,7,3,25],[12359,null,10,55,6,25],[12359,null,6,85,8,25],[12359,null,6,85,8,25],[12359,null,4,124,10,25],[12359,null,-1,249,14,25],[12359,null,12,14,5,25],[12359,null,25,1,1,25],[12359,null,-2,251,15,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,12,14,5,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,12,14,5,25],[12359,null,4,124,10,25],[12359,null,6,85,8,25],[12359,null,3,167,11,25],[12359,null,6,85,8,25],[12359,null,12,14,5,25],[12359,null,12,14,5,25],[12359,null,3,167,11,25],[12359,null,3,167,11,25],[12359,null,3,167,11,25],[12359,null,3,167,11,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,16,10,4,25],[12359,null,25,1,1,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,12,14,5,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,12,14,5,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,12,14,5,25],[12359,null,2,191,12,25],[12359,null,4,124,10,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,1,238,13,25],[12359,null,1,238,13,25],[12359,null,1,238,13,25],[12359,null,1,238,13,25],[12359,null,-1,249,14,25],[12359,null,1,238,13,25],[12359,null,10,55,6,25],[12359,null,8,74,7,25],[12359,null,-2,251,15,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,10,55,6,25],[12359,null,12,14,5,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,10,55,6,25],[12359,null,12,14,5,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,10,55,6,25],[12359,null,10,55,6,25],[12359,null,12,14,5,25],[12359,null,4,124,10,25],[12359,null,8,74,7,25],[12359,null,4,124,10,25],[12359,null,12,14,5,25],[12359,null,8,74,7,25],[12359,null,12,14,5,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,8,74,7,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,16,10,4,25],[12359,null,6,85,8,25],[12359,null,6,85,8,25],[12359,null,3,167,11,25],[12359,null,6,85,8,25],[12359,null,6,85,8,25],[12359,null,12,14,5,25],[12359,null,3,167,11,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,12,14,5,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,12,14,5,25],[12359,null,12,14,5,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,10,55,6,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,12,14,5,25],[12359,null,12,14,5,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,12,14,5,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,1,238,13,25],[12359,null,6,85,8,25],[12359,null,5,123,9,25],[12359,null,1,238,13,25],[12359,null,24,3,2,25],[12359,null,24,3,2,25],[12359,null,4,124,10,25],[12359,null,-2,251,15,25],[12359,null,10,55,6,25],[12359,null,12,14,5,25],[12359,null,20,7,3,25],[12359,null,4,124,10,25],[12359,null,12,14,5,25],[12359,null,10,55,6,25],[12359,null,10,55,6,25],[12359,null,10,55,6,25],[12359,null,4,124,10,25],[12359,null,12,14,5,25],[12359,null,10,55,6,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,10,55,6,25],[12359,null,12,14,5,25],[12359,null,20,7,3,25],[12359,null,12,14,5,25],[12359,null,4,124,10,25],[12359,null,8,74,7,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,8,74,7,25],[12359,null,12,14,5,25],[12359,null,8,74,7,25],[12359,null,3,167,11,25],[12359,null,3,167,11,25],[12359,null,12,14,5,25],[12359,null,3,167,11,25],[12359,null,12,14,5,25],[12359,null,6,85,8,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,12,14,5,25],[12359,null,16,10,4,25],[12359,null,2,191,12,25],[12359,null,6,85,8,25],[12359,null,6,85,8,25],[12359,null,6,85,8,25],[12359,null,2,191,12,25],[12359,null,10,55,6,25],[12359,null,2,191,12,25],[12359,null,10,55,6,25],[12359,null,1,238,13,25],[12359,null,1,238,13,25],[12359,null,10,55,6,25],[12359,null,24,3,2,25],[12359,null,24,3,2,25],[12359,null,-2,251,15,25],[12359,null,4,124,10,25],[12359,null,12,14,5,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12359,null,4,124,10,25],[12360,null,12,9,4,36],[12360,null,12,9,4,36],[12360,null,6,79,7,36],[12360,null,8,53,6,36],[12360,null,6,79,7,36],[12360,null,6,79,7,36],[12360,null,4,112,8,36],[12360,null,6,79,7,36],[12360,null,6,79,7,36],[12360,null,4,112,8,36],[12360,null,8,53,6,36],[12360,null,8,53,6,36],[12360,null,12,9,4,36],[12360,null,12,9,4,36],[12360,null,4,112,8,36],[12360,null,12,9,4,36],[12360,null,4,112,8,36],[12360,null,6,79,7,36],[12360,null,6,79,7,36],[12360,null,12,9,4,36],[12360,null,12,9,4,36],[12360,null,6,79,7,36],[12360,null,24,2,2,36],[12360,null,6,79,7,36],[12360,null,4,112,8,36],[12360,null,4,112,8,36],[12360,null,8,53,6,36],[12360,null,10,48,5,36],[12360,null,10,48,5,36],[12360,null,12,9,4,36],[12360,null,6,79,7,36],[12360,null,6,79,7,36],[12360,null,12,9,4,36],[12360,null,12,9,4,36],[12360,null,12,9,4,36],[12360,null,6,79,7,36],[12360,null,12,9,4,36],[12360,null,6,79,7,36],[12360,null,4,112,8,36],[12360,null,6,79,7,36],[12360,null,12,9,4,36],[12360,null,6,79,7,36],[12360,null,8,53,6,36],[12360,null,8,53,6,36],[12360,null,8,53,6,36],[12360,null,8,53,6,36],[12360,null,6,79,7,36],[12360,null,12,9,4,36],[12360,null,6,79,7,36],[12360,null,12,9,4,36],[12360,null,4,112,8,36],[12360,null,6,79,7,36],[12360,null,10,48,5,36],[12360,null,6,79,7,36],[12360,null,12,9,4,36],[12360,null,8,53,6,36],[12360,null,12,9,4,36],[12360,null,12,9,4,36],[12360,null,6,79,7,36],[12360,null,6,79,7,36],[12360,null,8,53,6,36],[12360,null,6,79,7,36]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"CustomerId","type":"\"integer\"","metadata":"{}"},{"name":"date","type":"\"date\"","metadata":"{}"},{"name":"Quantity","type":"\"integer\"","metadata":"{}"},{"name":"rank","type":"\"integer\"","metadata":"{}"},{"name":"dRank","type":"\"integer\"","metadata":"{}"},{"name":"maxPurchase","type":"\"integer\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641136738,"submitTime":1497641136718,"finishTime":1497641137969,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"10f840ff-14d5-4d11-98c6-432819f57e4c"},{"version":"CommandV1","origId":2060825016293487,"guid":"f8308bda-9775-4a5a-ae2c-a4e16a979f57","subtype":"command","commandType":"auto","position":58.0,"command":"%scala\nval rolledUpDF = dfWithDate.rollup(\"Date\", \"Country\")\n.agg(sum(\"Quantity\"))\n.selectExpr(\"Date\", \"Country\", \"`sum(Quantity)` as total_quantity\")\n.orderBy(\"Date\")\nrolledUpDF.show(20)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+--------------------+--------------+\n|Date|             Country|total_quantity|\n+----+--------------------+--------------+\n|null|             Germany|        117448|\n|null|      Czech Republic|           592|\n|null|      United Kingdom|       4263829|\n|null|  European Community|           497|\n|null|           Australia|         83653|\n|null|               Italy|          7999|\n|null|United Arab Emirates|           982|\n|null|              Israel|          4353|\n|null|                null|       5176450|\n|null|                null|       5176450|\n|null|             Lebanon|           386|\n|null|         Unspecified|          3300|\n|null|               Spain|         26824|\n|null|                EIRE|        142637|\n|null|              France|        110480|\n|null|           Lithuania|           652|\n|null|              Norway|         19247|\n|null|               Malta|           944|\n|null|             Iceland|          2458|\n|null|              Poland|          3653|\n+----+--------------------+--------------+\nonly showing top 20 rows\n\nrolledUpDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Date: date, Country: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641150956,"submitTime":1497641150926,"finishTime":1497641151883,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f0e0440f-f930-4893-a735-ecc83074fdfa"},{"version":"CommandV1","origId":2060825016293488,"guid":"4bc0db44-a9ee-4cec-83e9-6cdbdd4c562d","subtype":"command","commandType":"auto","position":59.0,"command":"rolledUpDF = dfWithDate.rollup(\"Date\", \"Country\")\\\n.agg(sum(\"Quantity\"))\\\n.selectExpr(\"Date\", \"Country\", \"`sum(Quantity)` as total_quantity\")\\\n.orderBy(\"Date\")\nrolledUpDF.show(20)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+--------------------+--------------+\n|Date|             Country|total_quantity|\n+----+--------------------+--------------+\n|null|  European Community|           497|\n|null|      United Kingdom|       4263829|\n|null|             Germany|        117448|\n|null|      Czech Republic|           592|\n|null|           Australia|         83653|\n|null|United Arab Emirates|           982|\n|null|                null|       5176450|\n|null|               Italy|          7999|\n|null|              Israel|          4353|\n|null|                null|       5176450|\n|null|             Lebanon|           386|\n|null|               Spain|         26824|\n|null|                EIRE|        142637|\n|null|         Unspecified|          3300|\n|null|              France|        110480|\n|null|           Lithuania|           652|\n|null|             Iceland|          2458|\n|null|              Norway|         19247|\n|null|              Poland|          3653|\n|null|               Malta|           944|\n+----+--------------------+--------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641160828,"submitTime":1497641160806,"finishTime":1497641161472,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"00e0b11c-a68e-45ab-a39b-58a58d05f1f8"},{"version":"CommandV1","origId":2060825016293489,"guid":"2158a5b7-ea3b-454c-93f4-f88cc7999143","subtype":"command","commandType":"auto","position":60.0,"command":"rolledUpDF.where(\"Country IS NULL\").show()\nrolledUpDF.where(\"Date IS NULL\").show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+-------+--------------+\n|Date|Country|total_quantity|\n+----+-------+--------------+\n|null|   null|       5176450|\n|null|   null|       5176450|\n+----+-------+--------------+\n\n+----+--------------------+--------------+\n|Date|             Country|total_quantity|\n+----+--------------------+--------------+\n|null|  European Community|           497|\n|null|           Australia|         83653|\n|null|      United Kingdom|       4263829|\n|null|             Germany|        117448|\n|null|      Czech Republic|           592|\n|null|                null|       5176450|\n|null|United Arab Emirates|           982|\n|null|               Italy|          7999|\n|null|              Israel|          4353|\n|null|                null|       5176450|\n|null|             Lebanon|           386|\n|null|                EIRE|        142637|\n|null|               Spain|         26824|\n|null|         Unspecified|          3300|\n|null|              France|        110480|\n|null|           Lithuania|           652|\n|null|              Norway|         19247|\n|null|             Iceland|          2458|\n|null|               Malta|           944|\n|null|              Poland|          3653|\n+----+--------------------+--------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641170122,"submitTime":1497641170099,"finishTime":1497641171331,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9755a2b4-dc81-42a0-8dc4-b7d8daaf0085"},{"version":"CommandV1","origId":2060825016293490,"guid":"b4b6b171-2552-42a7-bafe-bcb0ae514a95","subtype":"command","commandType":"auto","position":61.0,"command":"%scala\ndfWithDate.cube(\"Date\", \"Country\")\n.agg(sum(col(\"Quantity\")))\n.select(\"Date\", \"Country\", \"sum(Quantity)\")\n.orderBy(\"Date\")\n.show(20)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+--------------------+-------------+\n|Date|             Country|sum(Quantity)|\n+----+--------------------+-------------+\n|null|  European Community|          497|\n|null|              Norway|        19247|\n|null|  European Community|          497|\n|null|      United Kingdom|      4263829|\n|null|             Germany|       117448|\n|null|      Czech Republic|          592|\n|null|      Czech Republic|          592|\n|null|               Spain|        26824|\n|null|             Denmark|         8188|\n|null|                 USA|         1034|\n|null|           Australia|        83653|\n|null|     Channel Islands|         9479|\n|null|           Singapore|         5234|\n|null|United Arab Emirates|          982|\n|null|             Lebanon|          386|\n|null|              Cyprus|         6317|\n|null|           Hong Kong|         4769|\n|null|             Finland|        10666|\n|null|         Unspecified|         3300|\n|null|                null|      5176450|\n+----+--------------------+-------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641180572,"submitTime":1497641180550,"finishTime":1497641181322,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e765ad36-a6a9-4b30-8dcc-0468a311ef64"},{"version":"CommandV1","origId":2060825016293491,"guid":"5e0e7d93-e276-48d7-950f-5ecfc9962bd0","subtype":"command","commandType":"auto","position":62.0,"command":"dfWithDate.cube(\"Date\", \"Country\")\\\n.agg(sum(col(\"Quantity\")))\\\n.select(\"Date\", \"Country\", \"sum(Quantity)\")\\\n.orderBy(\"Date\")\\\n.show(20)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+--------------------+-------------+\n|Date|             Country|sum(Quantity)|\n+----+--------------------+-------------+\n|null|  European Community|          497|\n|null|  European Community|          497|\n|null|      United Kingdom|      4263829|\n|null|              Norway|        19247|\n|null|             Denmark|         8188|\n|null|             Germany|       117448|\n|null|      Czech Republic|          592|\n|null|      Czech Republic|          592|\n|null|           Australia|        83653|\n|null|                 USA|         1034|\n|null|               Spain|        26824|\n|null|     Channel Islands|         9479|\n|null|              Cyprus|         6317|\n|null|           Hong Kong|         4769|\n|null|           Singapore|         5234|\n|null|United Arab Emirates|          982|\n|null|             Lebanon|          386|\n|null|                null|      5176450|\n|null|               Italy|         7999|\n|null|             Finland|        10666|\n+----+--------------------+-------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641189102,"submitTime":1497641189079,"finishTime":1497641189734,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e638126c-acfa-4d09-a5a1-b9f385a3bd5f"},{"version":"CommandV1","origId":2060825016293492,"guid":"2a00fed7-e730-4c3e-a8b0-f362c278c93b","subtype":"command","commandType":"auto","position":63.0,"command":"%scala\nval pivoted = dfWithDate\n.groupBy(\"date\")\n.pivot(\"Country\")\n.agg(\"quantity\" -> \"sum\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">pivoted: org.apache.spark.sql.DataFrame = [date: date, Australia: bigint ... 37 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641197868,"submitTime":1497641197844,"finishTime":1497641198821,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ff504a5e-fa37-4c95-a228-fdbd8c64f5d2"},{"version":"CommandV1","origId":2060825016293493,"guid":"ab3cb445-4e7e-4089-a0ed-5eb44bc9c30c","subtype":"command","commandType":"auto","position":64.0,"command":"pivoted = dfWithDate\\\n.groupBy(\"date\")\\\n.pivot(\"Country\")\\\n.agg({\"quantity\":\"sum\"})","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641206824,"submitTime":1497641206802,"finishTime":1497641207549,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ae4f6199-e3d3-49ba-8a0e-093e8e394f37"},{"version":"CommandV1","origId":2060825016293494,"guid":"c2e7675c-b83b-4cc1-8973-5fa1463a4bd9","subtype":"command","commandType":"auto","position":65.0,"command":"pivoted.columns\npivoted.where(\"date > '2011-12-05'\").select(\"USA\").show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+\n|USA|\n+---+\n+---+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641216488,"submitTime":1497641216456,"finishTime":1497641217497,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4bfc957d-e0fb-402b-b7e5-8f2a322602cf"},{"version":"CommandV1","origId":2060825016293495,"guid":"5fb1696a-0cfd-4ab5-b967-85964b59cac3","subtype":"command","commandType":"auto","position":66.0,"command":"%scala\nimport org.apache.spark.sql.expressions.MutableAggregationBuffer\nimport org.apache.spark.sql.expressions.UserDefinedAggregateFunction\nimport org.apache.spark.sql.Row\nimport org.apache.spark.sql.types._\nclass BoolAnd extends UserDefinedAggregateFunction {\ndef inputSchema: org.apache.spark.sql.types.StructType =\n  StructType(StructField(\"value\", BooleanType) :: Nil)\ndef bufferSchema: StructType = StructType(\n  StructField(\"result\", BooleanType) :: Nil\n)\ndef dataType: DataType = BooleanType\ndef deterministic: Boolean = true\ndef initialize(buffer: MutableAggregationBuffer): Unit = {\n  buffer(0) = true\n}\ndef update(buffer: MutableAggregationBuffer, input: Row): Unit = {\n  buffer(0) = buffer.getAs[Boolean](0) && input.getAs[Boolean](0)\n}\ndef merge(buffer1: MutableAggregationBuffer, buffer2: Row): Unit = {\n  buffer1(0) = buffer1.getAs[Boolean](0) && buffer2.getAs[Boolean](0)\n}\ndef evaluate(buffer: Row): Any = {\n  buffer(0)\n}\n}\nval ba = new BoolAnd\nspark.udf.register(\"booland\", ba)\nimport org.apache.spark.sql.functions._\nspark.range(1)\n.selectExpr(\"explode(array(TRUE, TRUE, TRUE)) as t\")\n.selectExpr(\"explode(array(TRUE, FALSE, TRUE)) as f\", \"t\")\n.select(ba(col(\"t\")), expr(\"booland(f)\"))\n.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------+----------+\n|booland(t)|booland(f)|\n+----------+----------+\n|      true|     false|\n+----------+----------+\n\nimport org.apache.spark.sql.expressions.MutableAggregationBuffer\nimport org.apache.spark.sql.expressions.UserDefinedAggregateFunction\nimport org.apache.spark.sql.Row\nimport org.apache.spark.sql.types._\ndefined class BoolAnd\nba: BoolAnd = $iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$BoolAnd@75c3bce8\nimport org.apache.spark.sql.functions._\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">Unclosed block</div>","error":null,"workflows":[],"startTime":1497641307738,"submitTime":1497641307730,"finishTime":1497641308469,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1eaeab5d-a451-4763-a5b5-4ca1481fbf07"},{"version":"CommandV1","origId":2060825016293496,"guid":"fd580a96-f842-4102-9053-7ad8ac5891a1","subtype":"command","commandType":"auto","position":67.0,"command":"%scala\nval person = Seq(\n(0, \"Bill Chambers\", 0, Seq(100)),\n(1, \"Matei Zaharia\", 1, Seq(500, 250, 100)),\n(2, \"Michael Armbrust\", 1, Seq(250, 100)))\n.toDF(\"id\", \"name\", \"graduate_program\", \"spark_status\")\nval graduateProgram = Seq(\n(0, \"Masters\", \"School of Information\", \"UC Berkeley\"),\n(2, \"Masters\", \"EECS\", \"UC Berkeley\"),\n(1, \"Ph.D.\", \"EECS\", \"UC Berkeley\"))\n.toDF(\"id\", \"degree\", \"department\", \"school\")\nval sparkStatus = Seq(\n(500, \"Vice President\"),\n(250, \"PMC Member\"),\n(100, \"Contributor\"))\n.toDF(\"id\", \"status\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">person: org.apache.spark.sql.DataFrame = [id: int, name: string ... 2 more fields]\ngraduateProgram: org.apache.spark.sql.DataFrame = [id: int, degree: string ... 2 more fields]\nsparkStatus: org.apache.spark.sql.DataFrame = [id: int, status: string]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:2: error: ';' expected but string literal found.\n       Masters&quot;, &quot;School of Information&quot;, &quot;UC Berkeley&quot;),\n                            ^\n&lt;console&gt;:2: error: unclosed string literal\n       Masters&quot;, &quot;School of Information&quot;, &quot;UC Berkeley&quot;),\n                                                       ^\n</div>","error":null,"workflows":[],"startTime":1497641377076,"submitTime":1497641377052,"finishTime":1497641377780,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c4d60e4c-23a5-4e43-9dd1-5b037176e684"},{"version":"CommandV1","origId":2060825016293497,"guid":"1a8bc5a4-7938-4dfa-be15-d575f5b4734e","subtype":"command","commandType":"auto","position":68.0,"command":"person = spark.createDataFrame([\n(0, \"Bill Chambers\", 0, [100]),\n(1, \"Matei Zaharia\", 1, [500, 250, 100]),\n(2, \"Michael Armbrust\", 1, [250, 100])])\\\n.toDF(\"id\", \"name\", \"graduate_program\", \"spark_status\")\ngraduateProgram = spark.createDataFrame([\n(0, \"Masters\", \"School of Information\", \"UC Berkeley\"),\n(2, \"Masters\", \"EECS\", \"UC Berkeley\"),\n(1, \"Ph.D.\", \"EECS\", \"UC Berkeley\")])\\\n.toDF(\"id\", \"degree\", \"department\", \"school\")\nsparkStatus = spark.createDataFrame([\n(500, \"Vice President\"),\n(250, \"PMC Member\"),\n(100, \"Contributor\")])\\\n.toDF(\"id\", \"status\")\nperson.createOrReplaceTempView(\"person\")\ngraduateProgram.createOrReplaceTempView(\"graduateProgram\")\nsparkStatus.createOrReplaceTempView(\"sparkStatus\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641394086,"submitTime":1497641394077,"finishTime":1497641394366,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"51ba758b-4531-4b35-a74f-79082d1425b0"},{"version":"CommandV1","origId":2060825016293498,"guid":"a44fa899-bf83-4e11-aef9-979e4dacf6df","subtype":"command","commandType":"auto","position":69.0,"command":"%scala\nval joinExpression = person.col(\"graduate_program\") === graduateProgram.col(\"id\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">joinExpression: org.apache.spark.sql.Column = (graduate_program = id)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641404182,"submitTime":1497641404159,"finishTime":1497641404278,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"118be4d4-ec01-4cc6-9a9d-6deb50e317f5"},{"version":"CommandV1","origId":2060825016293499,"guid":"6dfb0d50-0bd6-442a-a0e2-068e3fbe8465","subtype":"command","commandType":"auto","position":70.0,"command":"joinExpression = person[\"graduate_program\"] == graduateProgram['id']","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641410685,"submitTime":1497641410660,"finishTime":1497641410757,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7e7b6f44-f19f-4c38-8b9e-75f6b9f588f9"},{"version":"CommandV1","origId":2060825016293500,"guid":"630801f1-1206-4990-bea3-e689f2e30400","subtype":"command","commandType":"auto","position":71.0,"command":"%scala\nval wrongJoinExpression = person.col(\"name\") === graduateProgram.col(\"school\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">wrongJoinExpression: org.apache.spark.sql.Column = (name = school)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641417566,"submitTime":1497641417542,"finishTime":1497641417671,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9e8de781-303e-4774-b3f5-26bd685b06d2"},{"version":"CommandV1","origId":2060825016293501,"guid":"9dbb4b1f-9a05-434a-89f9-f63b63fcd882","subtype":"command","commandType":"auto","position":72.0,"command":"wrongJoinExpression = person[\"name\"] == graduateProgram[\"school\"]\nperson.join(graduateProgram, joinExpression).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n| id|            name|graduate_program|   spark_status| id| degree|          department|     school|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|  0|   Bill Chambers|               0|          [100]|  0|Masters|School of Informa...|UC Berkeley|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|  2|Michael Armbrust|               1|     [250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641434737,"submitTime":1497641434713,"finishTime":1497641435562,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"32df4e9d-e974-4c2c-a994-116740593012"},{"version":"CommandV1","origId":2060825016293502,"guid":"53293860-062f-43a4-aad0-318c437e4d01","subtype":"command","commandType":"auto","position":73.0,"command":"%sql\nSELECT\n*\nFROM\nperson\nJOIN graduateProgram\nON person.graduate_program = graduateProgram.id","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"Bill Chambers",0,[100],0,"Masters","School of Information","UC Berkeley"],[1,"Matei Zaharia",1,[500,250,100],1,"Ph.D.","EECS","UC Berkeley"],[2,"Michael Armbrust",1,[250,100],1,"Ph.D.","EECS","UC Berkeley"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"graduate_program","type":"\"long\"","metadata":"{}"},{"name":"spark_status","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"},{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"degree","type":"\"string\"","metadata":"{}"},{"name":"department","type":"\"string\"","metadata":"{}"},{"name":"school","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641444491,"submitTime":1497641444484,"finishTime":1497641445119,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5e112f86-9732-4e8c-9ceb-1ac38d61be98"},{"version":"CommandV1","origId":2060825016293503,"guid":"aaaa0fee-f404-4619-9934-6c946740ae0c","subtype":"command","commandType":"auto","position":74.0,"command":"%scala\nvar joinType = \"inner\"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">joinType: String = inner\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641454472,"submitTime":1497641454447,"finishTime":1497641454552,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0b432d9d-abe6-47c3-994e-7a2a4d872c03"},{"version":"CommandV1","origId":2060825016293504,"guid":"6ceff242-91ed-40f6-b125-1886c1d5da91","subtype":"command","commandType":"auto","position":75.0,"command":"joinType = \"inner\"\nperson.join(graduateProgram, joinExpression, joinType).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n| id|            name|graduate_program|   spark_status| id| degree|          department|     school|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|  0|   Bill Chambers|               0|          [100]|  0|Masters|School of Informa...|UC Berkeley|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|  2|Michael Armbrust|               1|     [250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641474411,"submitTime":1497641474386,"finishTime":1497641474984,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"259344b3-4251-44fe-88f1-9ea875c2e85f"},{"version":"CommandV1","origId":2060825016293505,"guid":"e7d324f4-974b-41a6-be0b-c24d8a22f87e","subtype":"command","commandType":"auto","position":76.0,"command":"%sql\nSELECT\n*\nFROM\nperson\nINNER JOIN graduateProgram\nON person.graduate_program = graduateProgram.id","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"Bill Chambers",0,[100],0,"Masters","School of Information","UC Berkeley"],[1,"Matei Zaharia",1,[500,250,100],1,"Ph.D.","EECS","UC Berkeley"],[2,"Michael Armbrust",1,[250,100],1,"Ph.D.","EECS","UC Berkeley"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"graduate_program","type":"\"long\"","metadata":"{}"},{"name":"spark_status","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"},{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"degree","type":"\"string\"","metadata":"{}"},{"name":"department","type":"\"string\"","metadata":"{}"},{"name":"school","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641481939,"submitTime":1497641481932,"finishTime":1497641482565,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"812d9bbb-f519-4572-9083-76df6ab68bff"},{"version":"CommandV1","origId":2060825016293506,"guid":"fc0d3a51-e8c0-4404-b0f3-2bb33896a051","subtype":"command","commandType":"auto","position":77.0,"command":"joinType = \"outer\"\nperson.join(graduateProgram, joinExpression, joinType).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|  id|            name|graduate_program|   spark_status| id| degree|          department|     school|\n+----+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|   0|   Bill Chambers|               0|          [100]|  0|Masters|School of Informa...|UC Berkeley|\n|   1|   Matei Zaharia|               1|[500, 250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|   2|Michael Armbrust|               1|     [250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|null|            null|            null|           null|  2|Masters|                EECS|UC Berkeley|\n+----+----------------+----------------+---------------+---+-------+--------------------+-----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641490395,"submitTime":1497641490366,"finishTime":1497641491170,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"996f39b4-e937-4ec7-9357-b195e01e6fb5"},{"version":"CommandV1","origId":2060825016293507,"guid":"9aabad96-6b5e-49f4-8723-4201687ca66d","subtype":"command","commandType":"auto","position":78.0,"command":"%sql\nSELECT\n*\nFROM\nperson\nOUTER JOIN graduateProgram\nON graduate_program = graduateProgram.id","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"Bill Chambers",0,[100],0,"Masters","School of Information","UC Berkeley"],[1,"Matei Zaharia",1,[500,250,100],1,"Ph.D.","EECS","UC Berkeley"],[2,"Michael Armbrust",1,[250,100],1,"Ph.D.","EECS","UC Berkeley"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"graduate_program","type":"\"long\"","metadata":"{}"},{"name":"spark_status","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"},{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"degree","type":"\"string\"","metadata":"{}"},{"name":"department","type":"\"string\"","metadata":"{}"},{"name":"school","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641516408,"submitTime":1497641516383,"finishTime":1497641516954,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ae136202-ad4a-4153-8abf-fe28d1cf57fe"},{"version":"CommandV1","origId":2060825016293508,"guid":"d5ecb3f9-cdb1-457a-adc4-eabe013dee5d","subtype":"command","commandType":"auto","position":79.0,"command":"joinType = \"left_outer\"\ngraduateProgram.join(person, joinExpression, joinType).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-------+--------------------+-----------+----+----------------+----------------+---------------+\n| id| degree|          department|     school|  id|            name|graduate_program|   spark_status|\n+---+-------+--------------------+-----------+----+----------------+----------------+---------------+\n|  0|Masters|School of Informa...|UC Berkeley|   0|   Bill Chambers|               0|          [100]|\n|  1|  Ph.D.|                EECS|UC Berkeley|   1|   Matei Zaharia|               1|[500, 250, 100]|\n|  1|  Ph.D.|                EECS|UC Berkeley|   2|Michael Armbrust|               1|     [250, 100]|\n|  2|Masters|                EECS|UC Berkeley|null|            null|            null|           null|\n+---+-------+--------------------+-----------+----+----------------+----------------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641525081,"submitTime":1497641525055,"finishTime":1497641525706,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6cb3950d-6239-4f3b-98b0-c9e69454b1fa"},{"version":"CommandV1","origId":2060825016293509,"guid":"e9faa216-01bf-4250-b7c7-b989c039b013","subtype":"command","commandType":"auto","position":80.0,"command":"%sql\nSELECT\n*\nFROM\ngraduateProgram\nJOIN person\nON person.graduate_program = graduateProgram.id","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"Masters","School of Information","UC Berkeley",0,"Bill Chambers",0,[100]],[1,"Ph.D.","EECS","UC Berkeley",1,"Matei Zaharia",1,[500,250,100]],[1,"Ph.D.","EECS","UC Berkeley",2,"Michael Armbrust",1,[250,100]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"degree","type":"\"string\"","metadata":"{}"},{"name":"department","type":"\"string\"","metadata":"{}"},{"name":"school","type":"\"string\"","metadata":"{}"},{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"graduate_program","type":"\"long\"","metadata":"{}"},{"name":"spark_status","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641533945,"submitTime":1497641533920,"finishTime":1497641534509,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fd4ca7ca-c5e9-4de9-836a-66543db1ebb0"},{"version":"CommandV1","origId":2060825016293510,"guid":"935e8089-960c-4225-9aab-5971c8ac5def","subtype":"command","commandType":"auto","position":81.0,"command":"joinType = \"right_outer\"\nperson.join(graduateProgram, joinExpression, joinType).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|  id|            name|graduate_program|   spark_status| id| degree|          department|     school|\n+----+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|   0|   Bill Chambers|               0|          [100]|  0|Masters|School of Informa...|UC Berkeley|\n|   1|   Matei Zaharia|               1|[500, 250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|   2|Michael Armbrust|               1|     [250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|null|            null|            null|           null|  2|Masters|                EECS|UC Berkeley|\n+----+----------------+----------------+---------------+---+-------+--------------------+-----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641549222,"submitTime":1497641549191,"finishTime":1497641549846,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7b43c827-e518-4672-9847-e2b3f682219b"},{"version":"CommandV1","origId":2060825016293511,"guid":"699198e3-34b5-48d3-9ff0-6c5f5b7019fb","subtype":"command","commandType":"auto","position":82.0,"command":"%sql\nSELECT\n*\nFROM\nperson\nRIGHT OUTER JOIN graduateProgram\nON person.graduate_program = graduateProgram.id","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"Bill Chambers",0,[100],0,"Masters","School of Information","UC Berkeley"],[1,"Matei Zaharia",1,[500,250,100],1,"Ph.D.","EECS","UC Berkeley"],[2,"Michael Armbrust",1,[250,100],1,"Ph.D.","EECS","UC Berkeley"],[null,null,null,null,2,"Masters","EECS","UC Berkeley"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"graduate_program","type":"\"long\"","metadata":"{}"},{"name":"spark_status","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"},{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"degree","type":"\"string\"","metadata":"{}"},{"name":"department","type":"\"string\"","metadata":"{}"},{"name":"school","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641558201,"submitTime":1497641558174,"finishTime":1497641558761,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a834ae44-a632-4da5-afbb-536149d19587"},{"version":"CommandV1","origId":2060825016293512,"guid":"12b24857-3be8-46ea-853a-8c3d7c5f8483","subtype":"command","commandType":"auto","position":83.0,"command":"joinType = \"left_semi\"\ngraduateProgram.join(person, joinExpression, joinType).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-------+--------------------+-----------+\n| id| degree|          department|     school|\n+---+-------+--------------------+-----------+\n|  0|Masters|School of Informa...|UC Berkeley|\n|  1|  Ph.D.|                EECS|UC Berkeley|\n+---+-------+--------------------+-----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641566016,"submitTime":1497641565990,"finishTime":1497641566598,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8bc4caae-2bdf-4a19-a658-4545d2a20fd6"},{"version":"CommandV1","origId":2060825016293513,"guid":"e2f8b22a-1923-4df3-a9bb-b7ef2515bc96","subtype":"command","commandType":"auto","position":84.0,"command":"%scala\nval gradProgram2 = graduateProgram\n.union(Seq(\n(0, \"Masters\", \"Duplicated Row\", \"Duplicated School\")).toDF())\ngradProgram2.createOrReplaceTempView(\"gradProgram2\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">gradProgram2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: int, degree: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641574457,"submitTime":1497641574429,"finishTime":1497641574838,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"43347802-cafc-4fc2-aa64-73ea816a44d8"},{"version":"CommandV1","origId":2060825016293514,"guid":"0b9473ce-e670-45d3-aebb-e4b79f20b6d9","subtype":"command","commandType":"auto","position":85.0,"command":"gradProgram2 = graduateProgram\\\n.union(spark.createDataFrame([\n(0, \"Masters\", \"Duplicated Row\", \"Duplicated School\")]))\ngradProgram2.createOrReplaceTempView(\"gradProgram2\")\ngradProgram2.join(person, joinExpression, joinType).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-------+--------------------+-----------------+\n| id| degree|          department|           school|\n+---+-------+--------------------+-----------------+\n|  0|Masters|School of Informa...|      UC Berkeley|\n|  0|Masters|      Duplicated Row|Duplicated School|\n|  1|  Ph.D.|                EECS|      UC Berkeley|\n+---+-------+--------------------+-----------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641581438,"submitTime":1497641581409,"finishTime":1497641582112,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"41e35dff-125e-4a0a-b627-2077dc2209c9"},{"version":"CommandV1","origId":2060825016293515,"guid":"b186aa72-181e-4bae-a272-4f3efefa76a5","subtype":"command","commandType":"auto","position":86.0,"command":"%sql\nSELECT *\nFROM\ngradProgram2\nLEFT SEMI JOIN person\nON gradProgram2.id = person.graduate_program","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"Masters","School of Information","UC Berkeley"],[0,"Masters","Duplicated Row","Duplicated School"],[1,"Ph.D.","EECS","UC Berkeley"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"degree","type":"\"string\"","metadata":"{}"},{"name":"department","type":"\"string\"","metadata":"{}"},{"name":"school","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641596759,"submitTime":1497641596731,"finishTime":1497641597376,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"be068522-71cb-4158-8cbe-c2cd41146375"},{"version":"CommandV1","origId":2060825016293516,"guid":"6c7662a0-bfc0-430b-92e9-d2215d2b7a04","subtype":"command","commandType":"auto","position":87.0,"command":"joinType = \"left_anti\"\ngraduateProgram.join(person, joinExpression, joinType).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-------+----------+-----------+\n| id| degree|department|     school|\n+---+-------+----------+-----------+\n|  2|Masters|      EECS|UC Berkeley|\n+---+-------+----------+-----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641605272,"submitTime":1497641605227,"finishTime":1497641605896,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"74862c53-c971-43a3-a5ba-a594fb09922a"},{"version":"CommandV1","origId":2060825016293517,"guid":"300160b8-c5b7-4f1c-a46c-bd4efb8b4e1b","subtype":"command","commandType":"auto","position":88.0,"command":"%sql\nSELECT\n*\nFROM\ngraduateProgram\nLEFT ANTI JOIN person\nON graduateProgram.id = person.graduate_program","commandVersion":0,"state":"finished","results":{"type":"table","data":[[2,"Masters","EECS","UC Berkeley"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"degree","type":"\"string\"","metadata":"{}"},{"name":"department","type":"\"string\"","metadata":"{}"},{"name":"school","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641613140,"submitTime":1497641613112,"finishTime":1497641613689,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"13f070d1-ce79-4597-9c55-42e756fb6687"},{"version":"CommandV1","origId":2060825016293518,"guid":"bf1e09aa-dd62-42a4-b6f8-4c0083cf7ea1","subtype":"command","commandType":"auto","position":89.0,"command":"joinType = \"cross\"\ngraduateProgram.join(person, joinExpression, joinType).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+-------+--------------------+-----------+---+----------------+----------------+---------------+\n| id| degree|          department|     school| id|            name|graduate_program|   spark_status|\n+---+-------+--------------------+-----------+---+----------------+----------------+---------------+\n|  0|Masters|School of Informa...|UC Berkeley|  0|   Bill Chambers|               0|          [100]|\n|  1|  Ph.D.|                EECS|UC Berkeley|  1|   Matei Zaharia|               1|[500, 250, 100]|\n|  1|  Ph.D.|                EECS|UC Berkeley|  2|Michael Armbrust|               1|     [250, 100]|\n+---+-------+--------------------+-----------+---+----------------+----------------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641622479,"submitTime":1497641622451,"finishTime":1497641623054,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a81c3c66-f26c-43ce-bb47-3b5bdc4d4ade"},{"version":"CommandV1","origId":2060825016293519,"guid":"bcda218f-ce76-4024-a249-f9e0791fddfd","subtype":"command","commandType":"auto","position":90.0,"command":"%sql\nSELECT\n*\nFROM\ngraduateProgram\nCROSS JOIN person\nON graduateProgram.id = person.graduate_program","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"Masters","School of Information","UC Berkeley",0,"Bill Chambers",0,[100]],[1,"Ph.D.","EECS","UC Berkeley",1,"Matei Zaharia",1,[500,250,100]],[1,"Ph.D.","EECS","UC Berkeley",2,"Michael Armbrust",1,[250,100]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"degree","type":"\"string\"","metadata":"{}"},{"name":"department","type":"\"string\"","metadata":"{}"},{"name":"school","type":"\"string\"","metadata":"{}"},{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"graduate_program","type":"\"long\"","metadata":"{}"},{"name":"spark_status","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641629971,"submitTime":1497641629943,"finishTime":1497641630512,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bfcc67bf-bec9-4847-bd7c-6a267e36a8fc"},{"version":"CommandV1","origId":2060825016293520,"guid":"f9e6a882-0023-49a7-a11e-09ae2571adc2","subtype":"command","commandType":"auto","position":91.0,"command":"person.crossJoin(graduateProgram).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n| id|            name|graduate_program|   spark_status| id| degree|          department|     school|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n|  0|   Bill Chambers|               0|          [100]|  0|Masters|School of Informa...|UC Berkeley|\n|  0|   Bill Chambers|               0|          [100]|  2|Masters|                EECS|UC Berkeley|\n|  0|   Bill Chambers|               0|          [100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|  0|Masters|School of Informa...|UC Berkeley|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|  2|Masters|                EECS|UC Berkeley|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n|  2|Michael Armbrust|               1|     [250, 100]|  0|Masters|School of Informa...|UC Berkeley|\n|  2|Michael Armbrust|               1|     [250, 100]|  2|Masters|                EECS|UC Berkeley|\n|  2|Michael Armbrust|               1|     [250, 100]|  1|  Ph.D.|                EECS|UC Berkeley|\n+---+----------------+----------------+---------------+---+-------+--------------------+-----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641640263,"submitTime":1497641640234,"finishTime":1497641641372,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"864e3204-e4f0-4914-bffc-a6b811c9870c"},{"version":"CommandV1","origId":2060825016293521,"guid":"35cf8416-e816-4ac6-b797-98906fce08e6","subtype":"command","commandType":"auto","position":92.0,"command":"%sql\nSELECT\n*\nFROM\ngraduateProgram\nCROSS JOIN person","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"Masters","School of Information","UC Berkeley",0,"Bill Chambers",0,[100]],[0,"Masters","School of Information","UC Berkeley",1,"Matei Zaharia",1,[500,250,100]],[0,"Masters","School of Information","UC Berkeley",2,"Michael Armbrust",1,[250,100]],[2,"Masters","EECS","UC Berkeley",0,"Bill Chambers",0,[100]],[2,"Masters","EECS","UC Berkeley",1,"Matei Zaharia",1,[500,250,100]],[2,"Masters","EECS","UC Berkeley",2,"Michael Armbrust",1,[250,100]],[1,"Ph.D.","EECS","UC Berkeley",0,"Bill Chambers",0,[100]],[1,"Ph.D.","EECS","UC Berkeley",1,"Matei Zaharia",1,[500,250,100]],[1,"Ph.D.","EECS","UC Berkeley",2,"Michael Armbrust",1,[250,100]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"degree","type":"\"string\"","metadata":"{}"},{"name":"department","type":"\"string\"","metadata":"{}"},{"name":"school","type":"\"string\"","metadata":"{}"},{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"graduate_program","type":"\"long\"","metadata":"{}"},{"name":"spark_status","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641647351,"submitTime":1497641647322,"finishTime":1497641648341,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d727a71e-aeb4-4369-a47b-0305049d29fe"},{"version":"CommandV1","origId":2060825016293522,"guid":"3750641b-74ce-4c9d-bff8-5077a2f6f6a5","subtype":"command","commandType":"auto","position":93.0,"command":"%scala\nimport org.apache.spark.sql.functions.expr\nperson\n.withColumnRenamed(\"id\", \"personId\")\n.join(sparkStatus, expr(\"array_contains(spark_status, id)\"))\n.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions.expr\nres22: Array[org.apache.spark.sql.Row] = Array([0,Bill Chambers,0,WrappedArray(100),100,Contributor], [1,Matei Zaharia,1,WrappedArray(500, 250, 100),500,Vice President], [1,Matei Zaharia,1,WrappedArray(500, 250, 100),250,PMC Member], [1,Matei Zaharia,1,WrappedArray(500, 250, 100),100,Contributor], [2,Michael Armbrust,1,WrappedArray(250, 100),250,PMC Member])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641660443,"submitTime":1497641660411,"finishTime":1497641660688,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aa681a8e-c01b-4ac1-a1fd-afdec6b84bee"},{"version":"CommandV1","origId":2060825016293523,"guid":"cc3b281c-174f-4f7c-9b38-f501e99dcdb3","subtype":"command","commandType":"auto","position":94.0,"command":"from pyspark.sql.functions import expr\nperson\\\n.withColumnRenamed(\"id\", \"personId\")\\\n.join(sparkStatus, expr(\"array_contains(spark_status, id)\"))\\\n.take(5)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">48</span><span class=\"ansired\">]: </span>\n[Row(personId=0, name=u&apos;Bill Chambers&apos;, graduate_program=0, spark_status=[100], id=100, status=u&apos;Contributor&apos;),\n Row(personId=1, name=u&apos;Matei Zaharia&apos;, graduate_program=1, spark_status=[500, 250, 100], id=500, status=u&apos;Vice President&apos;),\n Row(personId=1, name=u&apos;Matei Zaharia&apos;, graduate_program=1, spark_status=[500, 250, 100], id=250, status=u&apos;PMC Member&apos;),\n Row(personId=1, name=u&apos;Matei Zaharia&apos;, graduate_program=1, spark_status=[500, 250, 100], id=100, status=u&apos;Contributor&apos;),\n Row(personId=2, name=u&apos;Michael Armbrust&apos;, graduate_program=1, spark_status=[250, 100], id=250, status=u&apos;PMC Member&apos;)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641666099,"submitTime":1497641666070,"finishTime":1497641667207,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8d0b780d-7d5c-479a-a63a-7a24b1596aa1"},{"version":"CommandV1","origId":2060825016293524,"guid":"9088625f-dfd9-4213-abe8-95eac41811b7","subtype":"command","commandType":"auto","position":95.0,"command":"%sql\nSELECT\n*\nFROM\n(select id as personId, name, graduate_program, spark_status FROM person)\nINNER JOIN sparkStatus\non array_contains(spark_status, id)\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0,"Bill Chambers",0,[100],100,"Contributor"],[1,"Matei Zaharia",1,[500,250,100],500,"Vice President"],[1,"Matei Zaharia",1,[500,250,100],250,"PMC Member"],[1,"Matei Zaharia",1,[500,250,100],100,"Contributor"],[2,"Michael Armbrust",1,[250,100],250,"PMC Member"],[2,"Michael Armbrust",1,[250,100],100,"Contributor"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"personId","type":"\"long\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"graduate_program","type":"\"long\"","metadata":"{}"},{"name":"spark_status","type":"{\"type\":\"array\",\"elementType\":\"long\",\"containsNull\":true}","metadata":"{}"},{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"status","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641673472,"submitTime":1497641673442,"finishTime":1497641674496,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1f8c58ed-7a66-4a92-8d4f-30eca4a08355"},{"version":"CommandV1","origId":2060825016293525,"guid":"06d30de6-2714-487c-81b6-17b0c0608b19","subtype":"command","commandType":"auto","position":96.0,"command":"%scala\nval gradProgramDupe = graduateProgram.withColumnRenamed(\"id\", \"graduate_program\")\nval joinExpr = gradProgramDupe.col(\"graduate_program\") === person.col(\"graduate_program\")\nperson.join(gradProgramDupe, joinExpr).show()\n","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\">+---+----------------+----------------+---------------+----------------+-------+--------------------+-----------+\n| id|            name|graduate_program|   spark_status|graduate_program| degree|          department|     school|\n+---+----------------+----------------+---------------+----------------+-------+--------------------+-----------+\n|  0|   Bill Chambers|               0|          [100]|               0|Masters|School of Informa...|UC Berkeley|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|               1|  Ph.D.|                EECS|UC Berkeley|\n|  2|Michael Armbrust|               1|     [250, 100]|               1|  Ph.D.|                EECS|UC Berkeley|\n+---+----------------+----------------+---------------+----------------+-------+--------------------+-----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Reference 'graduate_program' is ambiguous, could be: graduate_program#11705, graduate_program#12494.;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolve(LogicalPlan.scala:264)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveChildren(LogicalPlan.scala:148)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10$$anonfun$35.apply(Analyzer.scala:616)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10$$anonfun$35.apply(Analyzer.scala:616)\n\tat org.apache.spark.sql.catalyst.analysis.package$.withPosition(package.scala:48)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveReferences$$anonfun$$resolve$1(Analyzer.scala:616)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10$$anonfun$org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveReferences$$anonfun$$resolve$1$2.apply(Analyzer.scala:621)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10$$anonfun$org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveReferences$$anonfun$$resolve$1$2.apply(Analyzer.scala:621)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveReferences$$anonfun$$resolve$1(Analyzer.scala:621)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10$$anonfun$applyOrElse$30.apply(Analyzer.scala:623)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10$$anonfun$applyOrElse$30.apply(Analyzer.scala:623)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpression$1(QueryPlan.scala:266)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1(QueryPlan.scala:276)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1$1.apply(QueryPlan.scala:280)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1(QueryPlan.scala:280)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$6.apply(QueryPlan.scala:285)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.mapExpressions(QueryPlan.scala:285)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10.applyOrElse(Analyzer.scala:623)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10.applyOrElse(Analyzer.scala:556)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:60)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$.apply(Analyzer.scala:556)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$.apply(Analyzer.scala:493)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:85)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:82)\n\tat scala.collection.LinearSeqOptimized$class.foldLeft(LinearSeqOptimized.scala:111)\n\tat scala.collection.immutable.List.foldLeft(List.scala:84)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:82)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:74)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:74)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:60)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:77)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:75)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply$mcV$sp(QueryExecution.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:55)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:63)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$withPlan(Dataset.scala:2826)\n\tat org.apache.spark.sql.Dataset.select(Dataset.scala:1136)\n\tat org.apache.spark.sql.Dataset.select(Dataset.scala:1154)</div>","workflows":[],"startTime":1497641735043,"submitTime":1497641735043,"finishTime":1497641735258,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"237f0aa2-cbe7-471c-8e61-73a433d84146"},{"version":"CommandV1","origId":2060825016293526,"guid":"d766c2c4-cc60-4e37-9146-bb60471bd02b","subtype":"command","commandType":"auto","position":97.0,"command":"%scala\nperson\n.join(gradProgramDupe, joinExpr)\n.select(\"graduate_program\")\n.show()\nperson\n.join(gradProgramDupe, \"graduate_program\")\n.select(\"graduate_program\")\n.show()\n","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.sql.AnalysisException: Reference 'graduate_program' is ambiguous, could be: graduate_program#11705, graduate_program#12378.;","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolve(LogicalPlan.scala:264)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveChildren(LogicalPlan.scala:148)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10$$anonfun$35.apply(Analyzer.scala:616)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10$$anonfun$35.apply(Analyzer.scala:616)\n\tat org.apache.spark.sql.catalyst.analysis.package$.withPosition(package.scala:48)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveReferences$$anonfun$$resolve$1(Analyzer.scala:616)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10$$anonfun$org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveReferences$$anonfun$$resolve$1$2.apply(Analyzer.scala:621)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10$$anonfun$org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveReferences$$anonfun$$resolve$1$2.apply(Analyzer.scala:621)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:305)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveReferences$$anonfun$$resolve$1(Analyzer.scala:621)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10$$anonfun$applyOrElse$30.apply(Analyzer.scala:623)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10$$anonfun$applyOrElse$30.apply(Analyzer.scala:623)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpression$1(QueryPlan.scala:266)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1(QueryPlan.scala:276)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1$1.apply(QueryPlan.scala:280)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:244)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:244)\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:105)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1(QueryPlan.scala:280)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$6.apply(QueryPlan.scala:285)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.mapExpressions(QueryPlan.scala:285)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10.applyOrElse(Analyzer.scala:623)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$10.applyOrElse(Analyzer.scala:556)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan$$anonfun$resolveOperators$1.apply(LogicalPlan.scala:61)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:60)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$.apply(Analyzer.scala:556)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$.apply(Analyzer.scala:493)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:85)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:82)\n\tat scala.collection.LinearSeqOptimized$class.foldLeft(LinearSeqOptimized.scala:111)\n\tat scala.collection.immutable.List.foldLeft(List.scala:84)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:82)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:74)\n\tat scala.collection.immutable.List.foreach(List.scala:318)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:74)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$analyzed$1.apply(QueryExecution.scala:78)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:60)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:77)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:75)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply$mcV$sp(QueryExecution.scala:58)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$assertAnalyzed$1.apply(QueryExecution.scala:55)\n\tat org.apache.spark.sql.execution.SQLExecution$.withFileAccessAudit(SQLExecution.scala:53)\n\tat org.apache.spark.sql.execution.QueryExecution.withFileAccessAudit(QueryExecution.scala:50)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:55)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:63)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$withPlan(Dataset.scala:2826)\n\tat org.apache.spark.sql.Dataset.select(Dataset.scala:1136)\n\tat org.apache.spark.sql.Dataset.select(Dataset.scala:1154)</div>","workflows":[],"startTime":1497641764081,"submitTime":1497641764081,"finishTime":1497641764200,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ea8c8618-2411-402d-a74e-8f62c5a44542"},{"version":"CommandV1","origId":2060825016293527,"guid":"dee906aa-8a10-4a84-8ffd-c86956fc3dca","subtype":"command","commandType":"auto","position":98.0,"command":"%scala\nperson\n.join(gradProgramDupe, joinExpr)\n.drop(person.col(\"graduate_program\"))\n.select(\"graduate_program\")\n.show()\nval joinExpr = person.col(\"graduate_program\") === graduateProgram.col(\"id\")\nperson\n.join(graduateProgram, joinExpr)\n.drop(graduateProgram.col(\"id\"))\n.show()","commandVersion":0,"state":"error","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"java.lang.NullPointerException","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.Dataset$$anonfun$15.apply(Dataset.scala:844)\n\tat org.apache.spark.sql.Dataset$$anonfun$15.apply(Dataset.scala:844)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$withPlan(Dataset.scala:2826)\n\tat org.apache.spark.sql.Dataset.join(Dataset.scala:843)\n\tat org.apache.spark.sql.Dataset.join(Dataset.scala:807)</div>","workflows":[],"startTime":1497641784032,"submitTime":1497641784032,"finishTime":1497641784143,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"22282c72-cde7-42e4-be0f-83eda365fcc2"},{"version":"CommandV1","origId":2060825016293528,"guid":"b3fd81a4-56bf-478d-b6a7-9b934b680a12","subtype":"command","commandType":"auto","position":99.0,"command":"%scala\nval gradProgram3 = graduateProgram\n.withColumnRenamed(\"id\", \"grad_id\")\nval joinExpr = person.col(\"graduate_program\") === gradProgram3.col(\"grad_id\")\nperson\n.join(gradProgram3, joinExpr)\n.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+---+----------------+----------------+---------------+-------+-------+--------------------+-----------+\n| id|            name|graduate_program|   spark_status|grad_id| degree|          department|     school|\n+---+----------------+----------------+---------------+-------+-------+--------------------+-----------+\n|  0|   Bill Chambers|               0|          [100]|      0|Masters|School of Informa...|UC Berkeley|\n|  1|   Matei Zaharia|               1|[500, 250, 100]|      1|  Ph.D.|                EECS|UC Berkeley|\n|  2|Michael Armbrust|               1|     [250, 100]|      1|  Ph.D.|                EECS|UC Berkeley|\n+---+----------------+----------------+---------------+-------+-------+--------------------+-----------+\n\ngradProgram3: org.apache.spark.sql.DataFrame = [grad_id: int, degree: string ... 2 more fields]\njoinExpr: org.apache.spark.sql.Column = (graduate_program = grad_id)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641794176,"submitTime":1497641794144,"finishTime":1497641794350,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"43f882cc-77ef-498b-87a5-179bdb64990b"},{"version":"CommandV1","origId":2060825016293529,"guid":"4379bacc-ba95-4a29-a7cb-9978c9722e1b","subtype":"command","commandType":"auto","position":100.0,"command":"%scala\nval joinExpr = person.col(\"graduate_program\") === graduateProgram.col(\"id\")\nperson\n.join(graduateProgram, joinExpr)\n.explain()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*BroadcastHashJoin [graduate_program#11705], [id#11721], Inner, BuildRight\n:- LocalTableScan [id#11703, name#11704, graduate_program#11705, spark_status#11706]\n+- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)))\n   +- LocalTableScan [id#11721, degree#11722, department#11723, school#11724]\njoinExpr: org.apache.spark.sql.Column = (graduate_program = id)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641807551,"submitTime":1497641807520,"finishTime":1497641807669,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b4e65a79-6bbc-4c1f-b15a-02ca5c1f6a5b"},{"version":"CommandV1","origId":2060825016293530,"guid":"783a794a-baeb-4304-8064-70769ab977e7","subtype":"command","commandType":"auto","position":101.0,"command":"%scala\nimport org.apache.spark.sql.functions.broadcast\nval joinExpr = person.col(\"graduate_program\") === graduateProgram.col(\"id\")\nperson\n.join(broadcast(graduateProgram), joinExpr)\n.explain()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">== Physical Plan ==\n*BroadcastHashJoin [graduate_program#11705], [id#11721], Inner, BuildRight\n:- LocalTableScan [id#11703, name#11704, graduate_program#11705, spark_status#11706]\n+- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)))\n   +- LocalTableScan [id#11721, degree#11722, department#11723, school#11724]\nimport org.apache.spark.sql.functions.broadcast\njoinExpr: org.apache.spark.sql.Column = (graduate_program = id)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1497641823140,"submitTime":1497641823110,"finishTime":1497641823244,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"46386209-9bd3-42cd-ac9b-e97abe91d1ac"}],"dashboards":[],"guid":"15447f8a-df06-41a4-9c28-431f5155aabe","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
